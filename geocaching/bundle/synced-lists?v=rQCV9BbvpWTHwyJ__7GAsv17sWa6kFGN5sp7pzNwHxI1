webpackJsonp([23],{1:function(n){n.exports=$},75:function(n,t,i){"use strict";function f(n){return n&&n.__esModule?n:{"default":n}}var s=i(1),r=f(s),o=i(76),h=i(0),u=f(h),c=i(3),e=f(c);i(9);var l=i(77),a=f(l),v=i(78),y=f(v);i(79);r.default(function(){!function(){var t,n,i,c=new Date,f=!1,l=e.default.Model.extend({postNewList:function(n){return this.get("availableLists").create({name:n,description:"",lastUpdateUtc:c.toISOString()},{wait:!0,url:"/api/proxy/web/v1/lists",headers:{Authorization:"bearer "+t},error:function(n,t){this.get("availableLists").trigger("error",n,t)}.bind(this),success:function(){this.get("availableLists").trigger("list:add")}.bind(this)})}}),s=new l,v=e.default.Model.extend({defaults:{count:0,type:{code:"bm"}},parse:function(n){return this.set("id",n.referenceCode),n},url:function(){return"/api/proxy/web/v1/lists/"+this.get("referenceCode")+"/geocaches"},initialize:function(){u.default.bindAll(this,"testFull")},testFull:function(){return this.get("count")>=1e3},addToCount:function(n){return this.set("count",this.get("count")+n),this}}),p=e.default.Collection.extend({url:"/web/v1/lists",model:v,comparator:function(n){return-Date.parse(n.get("lastUpdateUtc"))},parse:function(n){return n.errors&&console.log(n.errors),n.data},initialize:function(){r.default.ajax({url:"/api/proxy/web/v1/lists",type:"GET",headers:{Authorization:"bearer "+t},data:{type:"bm",skip:0,take:100},success:function(n){this.add(n.data);this.trigger("fetch-complete")}.bind(this)})}}),w=e.default.View.extend({template:a.default,events:{"keyup #newListName":"createList","click .add-list-submit":"createList","click .list-item":"addToExisting","click .btn-close":"destroy","click .status.error":"showStatusMessage"},initialize:function(t){this.gcRefCode=t.gcRefCode;this.model.set(window.addToListTemplateResources);this.spinnerTpl=y.default();n.on("list:add",this.newListAddSuccess,this);n.on("error",this.validationFailed,this)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.attr("data-cid",this.cid),this.delegateEvents(),this.$inputControl=this.$(".input-control"),this.$addStatus=this.$(".add-list-status"),this.$saveBtn=this.$(".add-list-submit"),"true"!==ListResources.isPremium.toLowerCase()?(this.$saveBtn.attr("disabled",!0).show(),this.$inputControl.attr("disabled",!0),this.bindPremiumUpsell(this.$inputControl)):this.$("#newListName").trigger("focus").one("keydown",function(){this.$inputControl.addClass("active");this.$saveBtn.fadeIn()}.bind(this)),r.default("#Content").one("click",function(n){0===r.default(n.currentTarget).closest(this.$el).length&&this.destroy()}.bind(this)),this},bindPremiumUpsell:function(n){n.qtip({content:{text:window.ListResources.upsellContent},style:{classes:"qtip-shadow qtip-upsell",tip:{width:24,height:12}},position:{at:"bottom left",my:"top center",adjust:{x:8}},hide:{fixed:!0,delay:300},show:{solo:!0}})},newListAddSuccess:function(){this.putToList(this.model.get("availableLists").at(0).cid,!0)},showStatusMessage:function(n){var t=r.default(n.target);t.siblings(".status-message").html(t.attr("title")).fadeIn()},createList:function(n){(n.keyCode&&13===n.keyCode||"click"===n.type)&&(o.gaSend(n.target),this.$spinner=r.default(this.spinnerTpl),this.model.postNewList(this.$(".add-menu input").val()),this.$saveBtn.fadeOut("fast",function(){this.$addStatus.append(this.$spinner)}.bind(this)))},_getElByCid:function(n){return this.$('[data-cid="'+n+'"]')},validationFailed:function(n,t){var i,r=this._getElByCid(n.cid);return 0===r.length&&(r=this.$inputControl.parent()),i=r.children(".status-message"),console.log("ERROR:",JSON.parse(t.responseText).statusMessage,t),t.status>=400&&t.status<500?i.text(ListResources.badRequest).show():t.status>=500&&t.status<600&&i.text(ListResources.serverError).show()},showSaved:function(n){var t=this._getElByCid(n),i=t.children(".status");this.$(".loading").fadeOut("fast",function(){i.hide().removeClass("error").addClass("success").html(ListResources.saveSuccess).fadeIn()})},addToExisting:function(n){o.gaSend(n.target);var t=r.default(n.target),i=t.closest("li");t.prop("disabled")||(i.find(".status").append(this.spinnerTpl),this.putToList(i.data("cid"),!1))},putToList:function(n,i){var e=s.get("availableLists").get(n),o={referenceCode:this.gcRefCode};return!f&&(f=!0,r.default.ajax({url:e.url(),type:"PUT",method:"PUT",dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify([o]),headers:{Authorization:"bearer "+t},error:function(n,t,i){s.get("availableLists").trigger("error",n,i,e)},success:function(t){e.addToCount(t.updatedGeocaches.total);!0===i?this.$spinner.fadeOut(function(){u.default.delay(u.default.bind(function(){this.$inputControl.addClass("success");this.$addStatus.append("<span class='status success'>"+ListResources.saveSuccess+"<\/span>")},this),100)}.bind(this)):this.showSaved(n)}.bind(this)}).then(function(){f=!1;u.default.delay(u.default.bind(this.destroy,this),1100)}.bind(this)))},destroy:function(){f?u.default.delay(u.default.bind(this.destroy,this),1e3):this.qTipApi.hide()}}),b=function(r){t=r.access_token;n=new p;n.on("fetch-complete",function(){s.set("availableLists",n);i=new w({model:s})})},h=0,k=function(n){h++;console.log("ACCESS TOKEN ERROR: attempt "+h,n);h<3&&d()},d=function(){return!(window.serverParameters&&!window.serverParameters["user:info"].isLoggedIn)&&r.default.ajax({type:"POST",url:"/account/oauth/token",timeout:1e4,dataType:"json",contentType:"application/json; charset=utf-8",success:b,error:k})}(),g;window.FireAddToList=function(n){var t=r.default(n.currentTarget);"true"===ListResources.isPremium.toLowerCase()&&t.qtip({content:{text:function(n,r){return i.gcRefCode=t.attr("data-gcRefCode"),i.qTipApi=r,i.render().$el}},style:{classes:"qtip-light qtip-shadow pop-modal",def:!1,tip:{width:24,height:12}},show:{event:!1,solo:!0,ready:!0},hide:{event:"unfocus"},position:{at:"center left",my:"center right"}});n.preventDefault()};r.default("#Content").on("click touchstart ",".btn-add-to-list",window.FireAddToList);r.default("#Content").on("mouseover ",".btn-add-to-list",function(n){var t=r.default(n.currentTarget);"False"===ListResources.isPremium&&(g=t.qtip({content:{text:window.ListResources.upsellContent},style:{classes:"qtip-shadow qtip-upsell",tip:{width:24,height:12}},position:{at:"bottom center",my:"top center"},hide:{fixed:!0,delay:300},show:{ready:!0}}))})}()})},76:function(n){"use strict";n.exports.gaSend=function(n){var t=n.getAttribute("data-event-label"),i=n.getAttribute("data-event-action")||t,r=n.getAttribute("data-event-category");r&&i&&ga(function(n){n.send({eventAction:i,eventCategory:r,eventLabel:t,hitType:"event"})})}},77:function(n,t,i){var r=i(10);n.exports=(r.default||r).template({1:function(n,t,i,r,u){var e,f,o=null!=t?t:n.nullContext||{};return'<label class="add-list-label">'+n.escapeExpression((f=null!=(f=i.addToListLabel||(null!=t?t.addToListLabel:t))?f:i.helperMissing,"function"==typeof f?f.call(o,{name:"addToListLabel",hash:{},data:u}):f))+'<\/label>\n<ul class="add-list">\n'+(null!=(e=i.each.call(o,null!=(e=null!=t?t.availableLists:t)?e.models:e,{name:"each",hash:{},fn:n.program(2,u,0),inverse:n.noop,data:u}))?e:"")+"<\/ul>\n"},2:function(n,t,i,r,u){var f,e,o=null!=t?t:n.nullContext||{},s=n.escapeExpression;return'\t\t<li data-cid="'+s((e=null!=(e=i.cid||(null!=t?t.cid:t))?e:i.helperMissing,"function"==typeof e?e.call(o,{name:"cid",hash:{},data:u}):e))+'">\n\t\t\t<button class="list-item event-tracking" type="button" '+(null!=(f=i.if.call(o,null!=t?t.testFull:t,{name:"if",hash:{},fn:n.program(3,u,0),inverse:n.noop,data:u}))?f:"")+' data-event-category="data" data-event-label="Add to List" data-event-action="Call to Action">'+s(n.lambda(null!=(f=null!=t?t.attributes:t)?f.name:f,t))+'<\/button>\n\t\t\t<span class="status '+(null!=(f=i.if.call(o,null!=t?t.testFull:t,{name:"if",hash:{},fn:n.program(5,u,0),inverse:n.noop,data:u}))?f:"")+'" \n\t\t\t\t'+(null!=(f=i.if.call(o,null!=t?t.testFull:t,{name:"if",hash:{},fn:n.program(7,u,0),inverse:n.noop,data:u}))?f:"")+'><\/span>\n\t\t\t<p class="status-message">\n\t\t\t\t'+(null!=(f=i.if.call(o,null!=t?t.testFull:t,{name:"if",hash:{},fn:n.program(9,u,0),inverse:n.noop,data:u}))?f:"")+"\n\t\t\t<\/p>\n\t\t<\/li>\n"},3:function(){return"disabled"},5:function(){return"error"},7:function(n,t,i,r,u){var f;return'title="'+n.escapeExpression((f=null!=(f=i.listFullError||(null!=t?t.listFullError:t))?f:i.helperMissing,"function"==typeof f?f.call(null!=t?t:n.nullContext||{},{name:"listFullError",hash:{},data:u}):f))+'" '},9:function(n,t,i,r,u){var f;return n.escapeExpression((f=null!=(f=i.listFullError||(null!=t?t.listFullError:t))?f:i.helperMissing,"function"==typeof f?f.call(null!=t?t:n.nullContext||{},{name:"listFullError",hash:{},data:u}):f))},compiler:[7,">= 4.0.0"],main:function(n,t,i,r,u){var e,f,o=null!=t?t:n.nullContext||{},s=i.helperMissing,h=n.escapeExpression;return'<div class="add-menu">\n\t<label for="newListName">'+h((f=null!=(f=i.listNameLabel||(null!=t?t.listNameLabel:t))?f:s,"function"==typeof f?f.call(o,{name:"listNameLabel",hash:{},data:u}):f))+'<\/label>\n\t<div class="input-control">\n\t\t<input type="text" class="" id="newListName" name="newListName" maxlength="150" placeholder="'+h((f=null!=(f=i.listNamePlaceholder||(null!=t?t.listNamePlaceholder:t))?f:s,"function"==typeof f?f.call(o,{name:"listNamePlaceholder",hash:{},data:u}):f))+'" />\n\t\t<div class="add-list-status">\n\t\t\t<button class="add-list-submit event-tracking" type="button"  data-event-category="data" data-event-label="Add to New List" data-event-action="Call to Action">\n\t\t\t\t'+h((f=null!=(f=i.addButton||(null!=t?t.addButton:t))?f:s,"function"==typeof f?f.call(o,{name:"addButton",hash:{},data:u}):f))+'\n\t\t\t<\/button>\n\t\t<\/div>\n\t<\/div>\n\t<p class="status-message"><\/p>\n<\/div>\n'+(null!=(e=i.if.call(o,null!=(e=null!=t?t.availableLists:t)?e.length:e,{name:"if",hash:{},fn:n.program(1,u,0),inverse:n.noop,data:u}))?e:"")},useData:!0})},78:function(n,t,i){var r=i(10);n.exports=(r.default||r).template({compiler:[7,">= 4.0.0"],main:function(){return'<div class="loading"><\/div>'},useData:!0})},79:function(n,t,i){var r=i(80);"string"==typeof r&&(r=[[n.i,r,""]]);i(13)(r,{});r.locals&&(n.exports=r.locals)},80:function(n,t,i){t=n.exports=i(12)();t.push([n.i,'.list-tooltip{font-size:14px;position:absolute;background:#fff;z-index:3;box-shadow:-1px 3px 24px 1px hsla(45,2%,49%,.5);width:100%;padding:14px;text-align:left;margin-bottom:25px;color:#4a4a4a;line-height:1.3}.list-tooltip a{color:#006cff;font-size:14px}.list-tooltip a:hover{border-bottom-color:#006cff}.list-tooltip p{margin-top:0}.list-tooltip .btn{float:right;clear:none;margin:0}.list-tooltip label{float:left}.cssfilters .list-tooltip{box-shadow:none;-webkit-filter:drop-shadow(0 1px 8px hsla(45,2%,49%,.5));-moz-filter:drop-shadow(0 1px 8px hsla(45,2%,49%,.5));filter:drop-shadow(0 1px 8px rgba(126,125,122,.5));border-left-color:#fff}.pop-modal{position:fixed;font-size:14px;z-index:3;width:300px;background-color:#fff;border:1px solid #dfdfdf;text-align:left;color:#4a4a4a;box-shadow:0 0 13px 0 #9b9b9b}.pop-modal .qtip-content{padding:24px}.cssfilters .pop-modal.sit-left:before{border-left-color:#fff}.cssfilters .pop-modal.sit-right:before{border-right-color:#fff}.pop-modal input{color:#4a4a4a}.pop-modal.sit-left:after,.pop-modal.sit-left:before{content:" ";height:0;width:0;position:absolute;pointer-events:none;border:solid hsla(0,0%,100%,0)}.pop-modal.sit-left:after{border-color:hsla(0,0%,100%,0);border-width:19px;right:-38px;border-left-color:#fff;bottom:0;margin-bottom:23px}.pop-modal.sit-left:before{border-color:hsla(0,0%,100%,0);border-width:20px;right:-40px;border-left-color:rgba(0,0,0,.35);bottom:0;margin-bottom:22px}.pop-modal.sit-right:after,.pop-modal.sit-right:before{content:" ";height:0;width:0;position:absolute;pointer-events:none;border:solid hsla(0,0%,100%,0)}.pop-modal.sit-right:after{border-color:hsla(0,0%,100%,0);border-width:19px;left:-38px;border-right-color:#fff;top:0;margin-top:23px}.pop-modal.sit-right:before{border-color:hsla(0,0%,100%,0);border-width:20px;left:-40px;border-right-color:rgba(0,0,0,.35);top:0;margin-top:22px}.pop-modal label{color:#7e7d7a;display:block;margin-bottom:.5em}.pop-modal .add-menu input{border:2px solid #00b265;border-right:none;border-radius:0;font-size:14px;height:20px;line-height:20px;margin:0;padding:9px}.pop-modal .add-menu input::-webkit-input-placeholder{font-size:14px;color:#9b9b9b}.pop-modal .add-menu input:-moz-placeholder,.pop-modal .add-menu input::-moz-placeholder{font-size:14px;color:#9b9b9b}.pop-modal .add-menu input:-ms-input-placeholder{font-size:14px;color:#9b9b9b}.pop-modal .input-control{display:flex;flex-flow:row nowrap;margin-bottom:1.5em;position:relative;width:100%}.pop-modal .input-control.success .add-list-submit{display:none}.pop-modal .input-control.success .add-list-status,.pop-modal .input-control.success input{border-color:#fff}.pop-modal .input-control.success span{padding:5px 10px}.pop-modal .status{cursor:pointer;position:absolute;right:5px;width:100px;height:25px;text-align:right;top:2px}.pop-modal .status .loading{height:25px;width:25px;position:absolute;right:4px}.pop-modal .status.success{color:#e0b70a}.pop-modal .status.error{color:#f35c00;width:35px!important;height:25px;display:block;margin-top:-3px;background:url('+i(81)+") 50% no-repeat}.pop-modal .status-message{margin:0;max-width:95%;display:none;color:#f35c00;font-size:14px;line-height:1.3}.add-list-label{border-bottom:1px solid #dfdfdf;display:inline-block;padding-bottom:2px}.add-list-status{border:2px solid #00b265;border-left:none;display:table-cell;width:100%;height:38px;margin:0;vertical-align:top}.add-list-status .loading{width:30px;height:30px;margin:4px;float:right}.add-list-submit{background:#00b265;border:0;color:#fff;display:none;font-size:1.15em;height:38px;overflow:hidden;padding:0 10px;width:100%;cursor:pointer}.add-list-submit[disabled]{background:#dfdfdf}.add-list{margin:0 10px 10px;padding:0;max-height:200px;overflow-y:auto}.add-list li{line-height:1.3;list-style-type:none;text-align:left;padding:7px 0;position:relative}.add-list li button{background:0;border:0;max-width:100%;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;padding:0;color:#4a4a4a;cursor:pointer;font-size:16px;margin-bottom:6px}.add-list li button:active,.add-list li button:hover{background:0;color:#00b265}.add-list li button[disabled]{color:#9b9b9b}.add-list li button:focus{outline:none}.loading{background:url("+i(82)+") no-repeat 50%;background-size:100%;font-size:20px;margin:0 auto;width:100%;max-width:150px;height:150px;position:relative;text-indent:-9999em}.spinner{margin:13px 0 0 50px;width:30px;text-align:center}.spinner>div{width:7px;height:7px;background-color:#00b265;border-radius:100%;display:inline-block;-webkit-animation:sk-bouncedelay 1.4s infinite ease-in-out both;animation:sk-bouncedelay 1.4s infinite ease-in-out both}.spinner .bounce1{-webkit-animation-delay:-.32s;animation-delay:-.32s}.spinner .bounce2{-webkit-animation-delay:-.16s;animation-delay:-.16s}@-webkit-keyframes sk-bouncedelay{0%,80%,to{-webkit-transform:scale(0)}40%{-webkit-transform:scale(1)}}@keyframes sk-bouncedelay{0%,80%,to{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}",""])},81:function(n,t,i){n.exports=i.p+"d444e0bf317df75975d25c6357ac73ad.svg"},82:function(n,t,i){n.exports=i.p+"a00f325cb5e466806b2d06787da65c29.svg"},9:function(n){n.exports=void 0}},[75])