

  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <style>.async-hide { opacity: 0 !important} </style>
    <script>
      (function() {
        var optimizeId = 'GTM-NGM64B',
            gtmId = 'GTM-PZ7GMV9',
            dataLayerName = 'dataLayer',
            hideObj = {},
            hideGTMId = Math.random() < 0.5 ? optimizeId : gtmId;
            hideObj[hideGTMId] = true;

        var dPush = function(status) {
          window[dataLayerName].push({
            event: 'optimize_anti_flicker_test',
            milestones: {
              antiFlickerStart: window[dataLayerName].hide.start,
              antiFlickerEnd: new Date().getTime(),
              testStatus: status
            }
          });
        };

        (function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;h.end=i=function(){clearTimeout(t); s.className=s.className.replace(RegExp(' ?'+y),'')};(a[n]=a[n]||[]).hide=h;var t = setTimeout(function(){dPush('timeout');i();h.end=null},c);h.timeout=c;})(window,document.documentElement,'async-hide',dataLayerName,4000,hideObj);

        if (hideGTMId === optimizeId) {
          var el = document.createElement('script');
          el.src = 'https://www.googleoptimize.com/optimize.js?id=' + optimizeId;
          el.addEventListener('error', function() {
            dPush('optimizeSnippetError');
            window[dataLayerName].hide.end && window[dataLayerName].hide.end();
          });
          document.head.appendChild(el);
        } else {
          window[dataLayerName].push({
            gtmOptimize: true
          });
        }
        function gtag() {dataLayer.push(arguments)};
        gtag('event', 'optimize.callback', {
          callback: function() {
            dPush(hideGTMId === optimizeId ? 'optimizeSnippet' : 'gtmTag');
          }
        });
      })();
    </script>
    
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Snowplow Analytics - Custom Tag Template | Simo Ahava's blog</title>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/custom-templates/snowplow-analytics/">
    
    <meta name="description" content="This is the official template for the Snowplow Analytics SDK. It supports the full spread of features for the JavaScript tracker, with a few exceptions due to the sandbox of custom templates.">
    <meta property="og:description" content="This is the official template for the Snowplow Analytics SDK. It supports the full spread of features for the JavaScript tracker, with a few exceptions due to the sandbox of custom templates.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Snowplow Analytics - Custom Tag Template">
    <meta property="og:url" content="https://www.simoahava.com/custom-templates/snowplow-analytics/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Snowplow Analytics - Custom Tag Template">
    <meta name="twitter:description" content="This is the official template for the Snowplow Analytics SDK. It supports the full spread of features for the JavaScript tracker, with a few exceptions due to the sandbox of custom templates.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2020/05/snowplow-analytics.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2020/05/snowplow-analytics.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="1">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="1">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="1"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      Snowplow Analytics - Custom Tag Template
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-05-20T07:51:19Z">
	Latest release: 
  May 20, 2020

      </time>
      
      

       | <a href="https://www.simoahava.com/custom-templates/snowplow-analytics/#commento">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              


<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/snowplow-analytics.jpg" title="Snowplow Analytics">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/snowplow-analytics.jpg#ZgotmplZ" alt="Snowplow Analytics">
  
    </a>
  
  
</div>


<p>The <strong>Snowplow Analytics</strong> <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/">custom tag template</a> is an <strong>official</strong> tag template for <a href="https://tagmanager.google.com/">Google Tag Manager's</a> <a href="https://tagmanager.google.com/gallery/">community template gallery</a>.</p>
<table>
<thead>
<tr>
<th>Resource</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/snowplow/snowplow/wiki/javascript-tracker">Vendor documentation</a></td>
</tr>
<tr>
<td><a href="https://www.simoahava.com/analytics/snowplow-analytics-templates-google-tag-manager/">Blog post</a></td>
</tr>
<tr>
<td><a href="https://tagmanager.google.com/gallery/#/owners/snowplow/templates/snowplow-gtm-custom-template">Gallery entry</a></td>
</tr>
<tr>
<td><a href="https://github.com/snowplow/snowplow-gtm-custom-template">GitHub repo</a></td>
</tr>
</tbody>
</table>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/snowplow-analytics-permissions.jpg" title="Snowplow Analytics Permissions">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/snowplow-analytics-permissions.jpg#ZgotmplZ" alt="Snowplow Analytics Permissions">
  
    </a>
  
  
</div>


<h1 id="table-of-contents">Table of Contents</h1><nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#install-the-template">Install the template</a></li>
    <li><a href="#caveats">Caveats</a></li>
    <li><a href="#instructions">Instructions</a>
      <ul>
        <li><a href="#tracker-name">Tracker Name</a></li>
        <li><a href="#collector-endpoint-hostname">Collector Endpoint Hostname</a></li>
        <li><a href="#advanced-configuration">Advanced Configuration</a>
          <ul>
            <li><a href="#update-permissions">Update permissions</a></li>
          </ul>
        </li>
        <li><a href="#tag-type">Tag Type</a>
          <ul>
            <li><a href="#tags-with-a-parameter-object">Tags with a parameter object</a></li>
            <li><a href="#special-tags">Special tags</a></li>
            <li><a href="#custom-commands">Custom Commands</a></li>
          </ul>
        </li>
        <li><a href="#additional-tracking-parameters">Additional Tracking Parameters</a></li>
        <li><a href="#tracker-configuration-parameters">Tracker Configuration Parameters</a></li>
        <li><a href="#advanced-configuration-1">Advanced Configuration</a></li>
      </ul>
    </li>
    <li><a href="#release-notes">Release notes</a></li>
  </ul>
</nav>
<h2 id="description">Description</h2>
<p>This template implements the <a href="https://github.com/snowplow/snowplow/wiki/javascript-tracker">Snowplow Analytics JavaScript tracker</a>. The template supports the full spread of features of the tracker, with a few exceptions due to the limitations of custom templates&rsquo; sandboxed JavaScript.</p>
<h2 id="install-the-template">Install the template</h2>
<p>To <strong>install the template</strong>, browse to <strong>Templates</strong> in the Google Tag Manager user interface.</p>
<p>Under <strong>Tag Templates</strong>, click <strong>Search Gallery</strong>, and type <code>snowplow</code> into the gallery overlay search bar.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/import-tag-template.jpg" title="Import tag template">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/import-tag-template.jpg#ZgotmplZ" alt="Import tag template">
  
    </a>
  
  
</div>


<p>Click the <strong>Snowplow Analytics</strong> template name, and then click <strong>Add to Workspace</strong> in the next screen. Review the permissions and click <strong>Add</strong> to finalize the import.</p>
<p>After importing the template, you can follow the normal process of creating a <strong>new tag</strong> in Google Tag Manager, and the <strong>Snowplow Analytics</strong> template will be listed among the <strong>Custom</strong> tag types you can choose from.</p>
<h2 id="caveats">Caveats</h2>
<p>To begin with, some of the caveats of using the Custom Template.</p>
<ul>
<li>Any methods that require the parsing of HTML elements (e.g. <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#enableLinkClickTracking">link tracking filter functions</a>) will not work and are thus disabled.</li>
<li>Automatic error tracking does not work due to lack of support for the <code>ErrorEvent</code> API.</li>
<li>There is no implementation for the <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#ecommerce">standard ecommerce</a> events. Users are encouraged to implement the <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#enhanced-ecommerce">enhanced ecommerce</a> setup instead.</li>
</ul>
<h2 id="instructions">Instructions</h2>
<p>Here are basic instructions for how to instrument the JavaScript tracker. You are encouraged to consult the <a href="https://github.com/snowplow/snowplow/wiki/javascript-tracker">technical documentation</a> for more information on each individual feature.</p>
<p>In general, when the tag fires, it first checks if the Snowplow JavaScript library has been loaded from the self-hosted URL provided in the template settings (more on this below). Then, the tag checks whether a tracker with the given <strong>Tracker Name</strong> has already been initialized. If not, it proceeds to initialize the new tracker.</p>
<p>Finally, the tag bundles a <strong>command</strong> from the settings in the tag, and sends it to the given <strong>Collector Endpoint</strong>.</p>
<h3 id="tracker-name">Tracker Name</h3>
<p>The first field requires you to add the <strong>tracker name</strong>. The reason you might have more than one tracker name generated on the site is if you have different configuration objects or tracking endpoints to which you want to send commands.</p>
<p>When the tag runs, it first checks if a tag with this name has already been initialized. If it has, it then proceeds to send the command to this tracker name. If a tracker with this name has <em>not</em> been initialized, a new tracker is initialized with the tracker configuration derived from the tag (or from the linked <a href="https://www.simoahava.com/custom-templates/snowplow-analytics-settings/">Snowplow Analytics Settings variable</a>).</p>
<p>This means that a tracker configuration is applied <strong>only once</strong> to the tracker. Thus if you have more than one tag running on the site, each with the same tracker name but different tracker configurations, only the configuration of the tag that fires <em>first</em> will be applied to the tracker.</p>
<h3 id="collector-endpoint-hostname">Collector Endpoint Hostname</h3>
<p>This needs to be set to the hostname (e.g. <code>www.domain.com</code>) on which you've configured the <a href="https://github.com/snowplow/snowplow/wiki/Setting-up-a-Collector">Snowplow Analytics collector</a>.</p>
<h3 id="advanced-configuration">Advanced Configuration</h3>
<p>Jumping to the end of the template, the <strong>Advanced Configuration</strong> group has two important settings:</p>
<ol>
<li><strong>Global Method Name</strong>: If you want to change the global namespace from <code>snowplow</code> to something else (due to a conflict, for example), change the value in this field.</li>
<li><strong>Self-hosted Library URL</strong>: You need to host the Snowplow JavaScript library yourself. Set this field to the URL where the browser will download the JavaScript library from.</li>
</ol>
<h4 id="update-permissions">Update permissions</h4>
<p>If you change the <strong>Global Method Name</strong> from <code>snowplow</code> to anything else, you need to make a <strong>change to the template</strong>. Open the template for editing (from the &ldquo;Templates&rdquo; section of the container), and browse to the <strong>Permissions</strong> tab. Under <strong>Accesses Global Variables</strong>, edit the four permissions that start with the name <code>snowplow</code>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/edit-snowplow-method.jpg" title="Edit Snowplow method name.jpg">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/edit-snowplow-method.jpg#ZgotmplZ" alt="Edit Snowplow method name.jpg">
  
    </a>
  
  
</div>


<p>Change the text <code>snowplow</code> to whatever your preferred method name is (it must match the name set in the tag once you create it). Remember to leave everything else as it is: permissions and suffixes. This is what the changed list would look like if the method name were changed to <code>some_other_snowplow</code>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/snowplow-method-name-changed.jpg" title="Method name changed">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/snowplow-method-name-changed.jpg#ZgotmplZ" alt="Method name changed">
  
    </a>
  
  
</div>


<blockquote>
<p><strong>UPDATE 18 May 2020</strong>: The template has been updated to have <strong>AWS Cloudfront</strong> and <strong>Google Cloud Storage</strong> destinations supported by default (<code>https://*.cloudfront.net/*</code> and <code>https://storage.cloud.google.com/*</code>). If you load the library from either location, you do <strong>not</strong> need to update permissions for <code>injectScript</code>!</p>
</blockquote>
<p>Next, once you have the Snowplow library <a href="https://github.com/snowplow/snowplow/wiki/Self-hosting-snowplow-js">self-hosted</a>, you need to update the <strong>Injects Scripts</strong> permission to reflect the new location. Delete the content of the <strong>Allowed URL Match Patterns</strong> field, and type the full URL to the library there. Again, it must match what you input into the tag itself when creating it.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/template-permissions-snowplow.jpg" title="Modify Snowplow permissions">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/template-permissions-snowplow.jpg#ZgotmplZ" alt="Modify Snowplow permissions">
  
    </a>
  
  
</div>


<p>Unfortunately, modifying permissions <strong>breaks the gallery link</strong> and you will no longer be notified about updates to the template. Being able to modify permissions without having the link break is a feature request I hope will get solved very soon.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/broken-link-warning.jpg" title="Broken link warning">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/broken-link-warning.jpg#ZgotmplZ" alt="Broken link warning">
  
    </a>
  
  
</div>


<h3 id="tag-type">Tag Type</h3>
<p>Under <strong>Tag Type</strong>, you can choose what type of command is compiled and sent to the endpoint. The tag types are split here into three groups: commands that utilize a common <strong>parameters</strong> object, commands that have <strong>special conditions</strong>, and <strong>custom commands</strong>.</p>
<h4 id="tags-with-a-parameter-object">Tags with a parameter object</h4>
<p>Tags that can derive their parameters from a Google Tag Manager variable are:</p>
<ul>
<li>Ad Tracking</li>
<li>Cart Tracking</li>
<li>Error Tracking</li>
<li>Consent</li>
<li>Self-describing Event</li>
<li>Site Search</li>
<li>Social Interaction</li>
<li>Structured Event</li>
<li>Timing</li>
</ul>
<p>You can set the <strong>Retrieve Parameters From Variable</strong> setting to a Google Tag Manager variable. This parameter <em>must</em> return an object. In the object, the key-value pairs should reflect the named parameters in the <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker">event documentation</a>. For example, to have the variable populate an <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#trackError">Error event</a>, you could use a Custom JavaScript variable like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#00a">function</span>() {
  <span style="color:#00a">return</span> {
    message: <span style="color:#a50">&#39;Some Error Happened&#39;</span>,
    filename: <span style="color:#a50">&#39;somefile.js&#39;</span>,
    lineno: <span style="color:#099">5</span>,
    colno: <span style="color:#099">236</span>,
    error: <span style="color:#00a">null</span>
  }
}
</code></pre></div>
<p>Alternatively, you can set the drop-down to the value <code>No</code>, and add the parameters manually instead:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/manual-parameters.jpg" title="Manual parameters">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/manual-parameters.jpg#ZgotmplZ" alt="Manual parameters">
  
    </a>
  
  
</div>


<p>Some tag types will add additional selections to this section. Follow the official tracker documentation for more information about what each option does.</p>
<h4 id="special-tags">Special tags</h4>
<p>Some tag types have special conditions and have been separated into their own configurations.</p>
<h5 id="enhanced-ecommerce">Enhanced Ecommerce</h5>
<p>When you select Enhanced Ecommerce, you are left with two options: <strong>Use Data Layer</strong> or <strong>Choose Variable</strong>. The way it works is very similar to Enhanced Ecommerce in Google Analytics.</p>
<p>If you choose the first, the template will look into the <code>dataLayer</code> structure for the <strong>most recently</strong> pushed <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/#data-types-actions">Enhanced Ecommerce object</a>, and map this object to the request to Snowplow Analytics.</p>
<p>If you selected <strong>Choose Variable</strong>, you need to provide a GTM variable that returns an object in the correct, expected format.</p>
<h5 id="form-tracking">Form Tracking</h5>
<p>Form tracking has just two options, because <strong>filters</strong> and <strong>transformations</strong> won't work with the custom template (due to lack of support for processing HTML elements). The options are to set form and/or field <strong>blacklists</strong> and <strong>whitelists</strong>.</p>
<p>Blacklists and whitelists for forms are a list of comma-separated HTML class names. If blacklisted, then any form element with a listed class will not trigger the form event. If whitelisted, then <em>only</em> form elements with a listed classname will be tracked.</p>
<p>For fields, blacklists and whitelists work similarly, except they use the <code>name</code> attribute rather than the class.</p>
<h5 id="link-click-tracking">Link Click Tracking</h5>
<p>The <strong>Track Link Click</strong> event is similar to regular parameter-based events, as it lets you add parameters and track a link click as a manually encoded hit.</p>
<p>The <strong>Enable Automatic Link Click Tracking</strong> adds listeners to the page, which will track clicks on links permitting they adhere to the blacklisted/whitelisted class names you can optionally provide.</p>
<p>The <strong>Fix Middle-click Tracking</strong> adds a fix for some browsers where middle-clicks were not tracked properly.</p>
<p>If you check <strong>Track HTML Content Of Clicked Link</strong>, then the full text content of the link element will be sent to Snowplow as well.</p>
<h5 id="page-view">Page View</h5>
<p>You can provide a <strong>Custom Page Title</strong> if you wish, and you can add a <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#trackPageView">custom context function</a> to the request.</p>
<p>If you enable <strong>Page Activity Tracking</strong>, the tag will setup a <em>heartbeat</em> tracker, and send page pings to Snowplow at intervals that you can specify.</p>
<p>The <strong>Callback Function</strong> is something you can set to a JavaScript function. If you set the callback, then instead of sending the page ping to Snowplow, the function gets invoked instead.</p>
<h4 id="custom-commands">Custom Commands</h4>
<p>Here is the list of custom commands you can execute, with details about the arguments (if any).</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
<th>Arguments</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>flushBuffer</code></td>
<td>Sends all the queued events in the buffer.</td>
<td>N/A</td>
</tr>
<tr>
<td><code>setVisitorCookieTimeout</code></td>
<td>Change the timeout (default 2 years) of the visitor cookie / localStorage entry.</td>
<td>Timeout in seconds. Set <code>0</code> to use a session cookie, and <code>-1</code> to disable persisting this information.</td>
</tr>
<tr>
<td><code>setCountPreRendered</code></td>
<td>To enable tracking for pre-rendered pages, set to <code>true</code>.</td>
<td>Set to <code>true</code> to enable.</td>
</tr>
<tr>
<td><code>setUserId</code></td>
<td>Set the user ID to a custom value.</td>
<td>Variable or hard-coded value for the user ID.</td>
</tr>
<tr>
<td><code>setUserIdFromCookie</code></td>
<td>Set the user ID with a 1st party cookie value.</td>
<td>Cookie name.</td>
</tr>
<tr>
<td><code>setUserIdFromLocation</code></td>
<td>Set the user ID with a URL parameter value.</td>
<td>URL parameter name.</td>
</tr>
<tr>
<td><code>setUserIdFromReferrer</code></td>
<td>Set the user ID with a URL parameter value in <strong>the <code>document.referrer</code></strong>.</td>
<td>URL parameter name.</td>
</tr>
<tr>
<td><code>setCustomUrl</code></td>
<td>Set the current page URL to a custom value.</td>
<td>URL string.</td>
</tr>
<tr>
<td><code>setReferrerUrl</code></td>
<td>Set the referring page URL to a custom value.</td>
<td>URL string.</td>
</tr>
<tr>
<td><code>preservePageViewId</code></td>
<td>Restore the (buggy) way the <code>webPage</code> context used to work on single-page apps.</td>
<td>N/A</td>
</tr>
<tr>
<td><code>updatePageActivity</code></td>
<td>Trigger a page ping manually.</td>
<td>N/A</td>
</tr>
<tr>
<td><code>refreshLinkClickTracking</code></td>
<td>Parse the page for new links to track with automatic link click tracking.</td>
<td>N/A</td>
</tr>
<tr>
<td><code>setOptOutCookie</code></td>
<td>Give the name of a cookie. If this cookie exists, the user will not be tracked.</td>
<td>Cookie name.</td>
</tr>
<tr>
<td><code>enableGdprContext</code></td>
<td>Set a GDPR context object for all events that fire after this command is run.</td>
<td>GTM variable that returns a <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#316-gdpr-context">Context object</a>.</td>
</tr>
<tr>
<td><code>addGlobalContexts</code></td>
<td>Set to an array of global contexts to add to events.</td>
<td>GTM variable that returns <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#31851-addglobalcontexts">the global contexts array</a>.</td>
</tr>
<tr>
<td><code>removeGlobalContexts</code></td>
<td>Set to an array of global contexts to remove.</td>
<td>GTM variable that returns <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#31851-addglobalcontexts">the global contexts array</a>.</td>
</tr>
<tr>
<td><code>clearGlobalContexts</code></td>
<td>Remove all global contexts.</td>
<td>N/A</td>
</tr>
</tbody>
</table>
<h3 id="additional-tracking-parameters">Additional Tracking Parameters</h3>
<p>You can choose a Google Tag Manager variable from the drop-down titled <strong>Add Custom Contexts</strong>. This lets you add <a href="https://github.com/snowplow/snowplow/wiki/2-Specific-event-tracking-with-the-Javascript-tracker#custom-contexts">custom contexts</a> to the current hit. The variable <strong>must</strong> return an array of valid context objects.</p>
<p>You can also choose to override the device timestamp with the <strong>Set Custom Timestamp</strong> field. The format must be UNIX time in milliseconds.</p>
<h3 id="tracker-configuration-parameters">Tracker Configuration Parameters</h3>
<p>In this group, you can establish the tracker configuration which is applied when the tracker is first created.</p>
<blockquote>
<p><strong>NOTE!</strong> If you are adding configurations to a tracker that has already been created, the configuration fields will not do anything.</p>
</blockquote>
<p>You have <strong>three</strong> ways of applying the configuration:</p>
<ol>
<li>Using only a <a href="https://www.simoahava.com/custom-templates/snowplow-analytics-settings/">Snowplow Analytics Settings variable</a>.</li>
<li>Using only manually added parameters.</li>
<li>Using a combination of the two.</li>
</ol>
<p>If you choose to use a Snowplow Analytics Settings variable, you need to pick the variable from the drop-down menu. If you choose a variable that is <strong>not</strong> a &ldquo;Snowplow Analytics Settings&rdquo; variable, the tag will <strong>fail</strong>, so be careful.</p>
<p>You can also check the <strong>Enable Overriding Settings For This Tag</strong> option. This expands a parameter field where you can add key-value pairs of individual tracker configuration fields. <a href="https://github.com/snowplow/snowplow/wiki/1-General-parameters-for-the-Javascript-tracker">See the documentation</a> to know what fields are available.</p>
<p>If you choose to use both a Snowplow Analytics Settings variable <strong>and</strong> the manually entered parameters, then any conflict between the two will be resolved in favor of the <strong>manually entered parameters</strong>. For example, here we use a Snowplow Analytics Settings variable, but we've decided to override some fields in the configuration.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/05/override-settings.jpg" title="Overridden settings">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/05/override-settings.jpg#ZgotmplZ" alt="Overridden settings">
  
    </a>
  
  
</div>


<h3 id="advanced-configuration-1">Advanced Configuration</h3>
<p><a href="#advanced-configuration">See above</a>.</p>
<h2 id="release-notes">Release notes</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Changeset</th>
</tr>
</thead>
<tbody>
<tr>
<td>20 May 2020</td>
<td>Updated <code>injectScript</code> permissions to default to GCS and AWS Cloudfront.</td>
</tr>
<tr>
<td>14 May 2020</td>
<td>Initial release.</td>
</tr>
</tbody>
</table>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/custom-templates/snowplow-analytics-settings/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/custom-templates/snowplow-analytics/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Snowplow%20Analytics%20-%20Custom%20Tag%20Template%20https://www.simoahava.com/custom-templates/snowplow-analytics/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/custom-templates/snowplow-analytics/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://cdn.commento.io/js/commento.js"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/custom-templates/snowplow-analytics-settings/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/custom-templates/snowplow-analytics/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Snowplow%20Analytics%20-%20Custom%20Tag%20Template%20https://www.simoahava.com/custom-templates/snowplow-analytics/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/custom-templates/snowplow-analytics/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="1">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/custom-templates/snowplow-analytics/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Snowplow%20Analytics%20-%20Custom%20Tag%20Template%20https://www.simoahava.com/custom-templates/snowplow-analytics/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/custom-templates/snowplow-analytics/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://cdn.commento.io/js/count.js"></script>


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

