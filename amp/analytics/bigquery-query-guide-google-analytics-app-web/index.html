

  
    
  


  

<!doctype html>



<html âš¡ lang="en-us" class="no-js">
    <head>

      <meta charset="utf-8">
        <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script><script async custom-element="amp-accordion" src="https://cdn.ampproject.org/v0/amp-accordion-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

<script async src="https://cdn.ampproject.org/v0.js"></script>


<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<style amp-custom>
  .type-simmer {
      padding: 8px;
      background: rgba(179,138,197,0.2);
      box-shadow: 2px 2px 1px #ccc;
      border-radius: 5px;
  }
    /*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.hidden{text-indent:-9999px;visibility:hidden;display:none}.inner{position:relative;width:80%;max-width:710px;margin:0 auto}.vertical{display:table-cell;vertical-align:middle}.site-wrapper{position:relative;z-index:10;min-height:100%;background:#fff;-webkit-transition:-webkit-transform .5s ease;transition:-webkit-transform .5s ease;transition:transform .5s ease;transition:transform .5s ease,-webkit-transform .5s ease}html{font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body,html{height:100%;max-height:100%}body{font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.8rem;line-height:1.75em;color:#3a4145;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1;text-rendering:geometricPrecision}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{-webkit-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-moz-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-o-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;color:#2e2e2e;line-height:1.15em;margin:0 0 .4em;font-family:Open Sans,sans-serif;text-rendering:geometricPrecision}h1{font-size:5rem;letter-spacing:-2px;text-indent:-3px}h2{font-size:3.6rem;letter-spacing:-1px}h3{font-size:3rem}h4{font-size:2.5rem}h5,h6{font-size:2rem}a,a:active,a:hover,a:visited{color:#4a4a4a;-webkit-transition:color .3s ease;transition:color .3s ease}a:active,a:hover{color:#111}dl,ol,p,ul{-webkit-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-moz-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-o-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;margin:0 0 1.75em;text-rendering:geometricPrecision}ol,ul{padding-left:3rem}ol ol,ol ul,ul ol,ul ul{margin:0 0 .4em;padding-left:2em}dl dt{float:left;width:180px;overflow:hidden;clear:left;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd,dl dt{margin-bottom:1em}dl dd{margin-left:200px}li{margin:.4em 0}li li{margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:3.2em 0;padding:0}blockquote{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0 1.75em -2.2em;padding:0 0 0 1.75em;border-left:.4em solid #4a4a4a}blockquote p{margin:.8em 0;font-style:italic}blockquote small{display:inline-block;margin:.8em 0 .8em 1.5em;font-size:.9em;color:#ccc}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:400}mark{background-color:#ffc336}code,tt{padding:1px 3px;font-size:.85em;white-space:pre-wrap;border:1px solid #e3edf3;border-radius:2px}code,pre,tt{font-family:Inconsolata,monospace,sans-serif;background:#f7fafb}pre{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 0 1.75em;border:1px solid #e3edf3;width:100%;padding:10px;font-size:.9em;white-space:pre;overflow:auto;border-radius:3px}pre code,pre tt{font-size:inherit;white-space:pre-wrap;background:transparent;border:none;padding:0}kbd{display:inline-block;margin-bottom:.4em;padding:1px 8px;border:1px solid #ccc;color:#666;text-shadow:#fff 0 1px 0;font-size:.9em;font-weight:700;background:#f4f4f4;border-radius:4px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 1px 0 0 #fff inset;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 1px 0 0 #fff}table{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0;width:100%;max-width:100%;background-color:transparent}table td,table th{padding:8px;line-height:20px;text-align:left;vertical-align:top;border-top:1px solid #efefef}table th{color:#000}table caption+thead tr:first-child td,table caption+thead tr:first-child th,table colgroup+thead tr:first-child td,table colgroup+thead tr:first-child th,table thead:first-child tr:first-child td,table thead:first-child tr:first-child th{border-top:0}table tbody+tbody{border-top:2px solid #efefef}table table table{background-color:#fff}table tbody>tr:nth-child(odd)>td,table tbody>tr:nth-child(odd)>th{background-color:#f6f6f6}table.plain tbody>tr:nth-child(odd)>td,table.plain tbody>tr:nth-child(odd)>th{background:transparent}.fluid-width-video-wrapper,iframe{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe{margin:0}.main-header{position:relative;display:table;width:100%;height:100vh;margin-bottom:5rem;text-align:center;background:#222 no-repeat 50%;background-size:cover;overflow:hidden}.main-header.cover{background-image:url("https://www.simoahava.com/images/maisema.jpg")}.main-header.list-cover{background-image:url("/")}.main-header .inner{width:80%}.main-header a.bloglogo{text-decoration:none}.main-header a.bloglogo .icon-facebook,.main-header a.bloglogo .icon-github,.main-header a.bloglogo .icon-google-plus,.main-header a.bloglogo .icon-instagram,.main-header a.bloglogo .icon-linkedin,.main-header a.bloglogo .icon-pinterest,.main-header a.bloglogo .icon-twitter{color:#fff;font-size:2em}.main-nav{position:relative;padding:35px 40px;margin:0 0 30px}.main-nav a{text-decoration:none;font-family:Open Sans,sans-serif}.scroll-down{display:block;position:absolute;z-index:100;bottom:45px;left:50%;font-size:1.5em;text-align:center;-webkit-animation:bounce 4s 2s infinite;animation:bounce 4s 2s infinite}.scroll-down:hover{color:#fff;-webkit-animation:none;animation:none}.home-template .main-header:after{display:block;content:" ";width:150px;height:130px;border-radius:100%;position:absolute;bottom:0;left:50%;margin-left:-75px;background:radial-gradient(ellipse at center,rgba(0,0,0,.15) 0,transparent 70%,transparent 100%)}.archive-template .main-header:after,.archive-template .scroll-down,.no-cover.main-header:after,.no-cover .scroll-down{display:none}.blog-logo{display:block;float:left}.blog-logo img{display:block;padding:1px 0 5px;width:auto}.blog-logo img,.menu-button{-webkit-box-sizing:border-box;box-sizing:border-box;height:38px}.menu-button{display:inline-block;float:right;padding:0 15px;border:1px solid #bfc8cd;opacity:1;color:#9eabb3;text-align:center;font-size:12px;text-transform:uppercase;line-height:35px;white-space:nowrap;border-radius:3px;background:rgba(0,0,0,.1);-webkit-transition:all .5s ease;transition:all .5s ease}.menu-button:focus{outline:0}.menu-button .fa-bars{font-size:12px;margin-right:6px}.main-nav.overlay{position:absolute;top:0;left:0;right:0;height:70px;border:none;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(transparent));background:linear-gradient(180deg,rgba(0,0,0,.2) 0,transparent)}.no-cover .main-nav.overlay,.no-cover .menu-button{background:none}.main-nav.overlay a{color:#fff}.main-nav.overlay .menu-button{border-color:hsla(0,0%,100%,.6)}.cover .main-nav.overlay a.menu-button:hover{color:#222;border-color:#fff;background:#fff}.menu-button:hover,.no-cover .main-nav.overlay .menu-button:hover{border-color:#555;color:#555}.page-title{margin:10px 0;font-size:5rem;letter-spacing:-1px;font-weight:700;font-family:Open Sans,sans-serif;color:#fff}.page-description{margin:0;font-size:2rem;line-height:1.5em;font-weight:400;font-family:Merriweather,serif;letter-spacing:.01rem;color:hsla(0,0%,100%,.8)}.no-cover.main-header{min-height:160px;max-height:40vh;background:#f5f8fa}.no-cover .page-title{color:rgba(0,0,0,.8)}.no-cover .page-description{color:rgba(0,0,0,.5)}.no-cover .main-nav.overlay .menu-button{color:rgba(0,0,0,.4);border-color:rgba(0,0,0,.3)}.main-header-content .page-title{-webkit-animation:fade-in-down .6s;animation:fade-in-down .6s;-webkit-animation-delay:.2s;animation-delay:.2s}.main-header-content .page-description{-webkit-animation:fade-in-down .9s;animation:fade-in-down .9s;-webkit-animation-delay:.1s;animation-delay:.1s}.post{position:relative;width:80%;max-width:710px;margin:4rem auto;padding-bottom:4rem;border-bottom:1px solid #ebf2f6;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.post-header{padding-bottom:10px}.post:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}body:not(.post-template) .post-title{font-size:3.6rem}.post-title a{text-decoration:none}.post-excerpt p{margin:0;font-size:.9em;line-height:1.7em}.read-more{font-size:.8em;text-decoration:none;font-style:italic}.post-meta{display:block;margin:1.75rem 0 0;font-family:Open Sans,sans-serif;font-size:1.5rem;line-height:2.2rem;color:#9eabb3}.author-thumb{width:24px;height:24px;float:left;margin-right:9px;border-radius:100%}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.user-meta{position:relative;padding:.3rem 40px 0 100px;min-height:77px}.post-date{display:inline-block;margin-left:8px;padding-left:12px;border-left:1px solid #d5dbde;text-transform:uppercase;font-size:1.3rem;white-space:nowrap}.user-image{position:absolute;top:0;left:0}.user-name{display:block;font-weight:700}.user-bio{display:block;max-width:440px;font-size:1.4rem;line-height:1.5em}.publish-meta{position:absolute;top:0;right:0;padding:4.3rem 0 4rem;text-align:right}.publish-heading{display:block;font-weight:700}.publish-date{display:block;font-size:1.4rem;line-height:1.5em}figure.no-margin{margin:0}figure.center{margin-left:auto;margin-right:auto}.amp-image-lightbox-caption{text-align:center;font-size:.8em}@media only screen and (min-width:501px){figure.polaroid:after,figure.polaroid:before{content:"";position:absolute;z-index:-2;bottom:10px;width:50%;height:20%;max-width:480px;-webkit-box-shadow:0 15px 10px rgba(0,0,0,.7);box-shadow:0 15px 10px rgba(0,0,0,.7)}figure.polaroid:after{right:10px;left:auto;-webkit-transform:rotate(3deg);transform:rotate(3deg)}figure.polaroid:before{left:10px;right:auto;-webkit-transform:rotate(-3deg);transform:rotate(-3deg)}figure.polaroid{width:450px;position:relative;padding:15px;border:none;background:#fff;-webkit-box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset;box-shadow:0 1px 4px rgba(0,0,0,.3),inset 0 0 40px rgba(0,0,0,.1);border-radius:4px;margin-bottom:1.5em;max-width:100%}figure.polaroid div[fallback]{border:none;margin:0;padding:0}figure.polaroid amp-img{display:block;outline:1px solid #ccc;padding:0;margin:0}figure.polaroid figcaption{font-size:1.3em;font-weight:400;font-family:Kaushan Script,cursive;text-align:right;padding:.8em .5em .4em}}@media only screen and (max-width:501px){figure.polaroid{background:#fff;border-radius:1px;margin-bottom:1em}figure.polaroid figcaption{font-size:.8em;font-style:italic;text-align:center;border-top:1px solid #d3d3d3;border-bottom:1px solid #d3d3d3;margin-top:.5em;padding:.2em}}.main-header.cover .main-header-content .social-link a,.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.main-header.cover .main-header-content .social-link a:visited,.scroll-down a,.scroll-down a:active,.scroll-down a:hover,.scroll-down a:visited{text-decoration:none;font-size:2em}.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.scroll-down a:active,.scroll-down a:hover{color:#fff}.main-header.no-cover .main-header-content .social-link a,.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover,.main-header.no-cover .main-header-content .social-link a:visited{text-decoration:none;font-size:2em;color:#a2a2a2}.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover{color:#000}.post-template .post-header{margin-bottom:3.4rem}.post-template .post-title{margin-bottom:0}.post-template .post-meta{margin:0}.post-template .post-date{padding:0;margin:0;border:none}.post-template .content{overflow:hidden}.post-template .post{margin-top:0;border-bottom:none;padding-bottom:0}.post-template .post:after{display:none}.post-content{text-align:justify}.post-footer{position:relative;margin:6rem 0 0;padding:6rem 0 0;border-top:1px solid #ebf2f6}.post-footer h4{font-size:1.8rem;margin:0}.post-footer p{margin:1rem 0;font-size:1.4rem;line-height:1.75em}.author-meta{padding:0;margin:0;list-style:none;font-size:1.4rem;line-height:1;font-style:italic}.author-meta,.author-meta a{color:#9eabb3}.author-meta a:hover{color:#111}.post-footer .author{margin-right:180px}.post-footer h4 a{color:#2e2e2e;text-decoration:none}.post-footer h4 a:hover{text-decoration:underline}.post-footer .share{position:absolute;top:6rem;right:0;width:180px}.post-footer .share a{font-size:1.8rem;display:inline-block;margin:1rem 1.6rem 1.6rem 0;color:#bbc7cc;text-decoration:none}.post-footer .share a:hover{color:#50585d}.post-head.main-header{height:65vh;min-height:180px}.no-cover.post-head.main-header{height:85px;min-height:0;margin-bottom:0;background:transparent}.author-head.main-header,.tag-head.main-header{height:40vh;min-height:180px}.no-cover.author-head.main-header{height:10vh;min-height:100px;background:transparent}.author-profile{padding:0 15px 5rem;border-bottom:1px solid #ebf2f6;text-align:center}.author-profile:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.author-image{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;top:-56px;left:50%;margin-left:-40px;width:80px;height:80px;border-radius:100%;overflow:hidden;padding:6px;background:#fff;z-index:2;-webkit-box-shadow:#e7eef2 0 0 0 1px;box-shadow:0 0 0 1px #e7eef2}.author-image .img{position:relative;display:block;width:100%;height:100%;background-size:cover;background-position:50%;border-radius:100%;background-image:url("https://www.simoahava.com/images/simo.png")}.author-profile .author-image{position:relative;left:auto;top:auto;width:120px;height:120px;padding:3px;margin:-100px auto 0;-webkit-box-shadow:none;box-shadow:none}.author-title{margin:1.5rem 0 1rem}.author-bio{font-size:1.8rem;line-height:1.5em;font-weight:200;color:#50585d;letter-spacing:0;text-indent:0}.author-meta{margin:1.6rem 0}.author-profile .author-meta{margin:2rem 0;font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.7rem}.author-meta span{display:inline-block;margin:0 2rem 1rem 0;word-wrap:break-word}.author-meta a{text-decoration:none}.archive-template .author-profile .author-meta{display:none}@-webkit-keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@-webkit-keyframes bounce{0%,10%,25%,40%,50%{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}20%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}30%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}40%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}60%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}#sidebar{background:rgba(0,0,0,.7);text-align:left;overflow-y:auto;font-family:Open Sans,Verdana,sans-serif;font-weight:700;font-size:11px;color:#909090;width:400px}#sidebar .nav-title{position:absolute;top:45px;left:30px;font-size:1.5em;font-weight:100;text-transform:uppercase;color:#fff}#sidebar .nav-section{color:#d8d8d8}#sidebar .nav-close{position:absolute;top:38px;right:25px;width:20px;height:20px;padding:0;font-size:10px}#sidebar .nav-close:focus{outline:0}#sidebar .nav-close:after,#sidebar .nav-close:before{content:"";position:absolute;top:0;width:20px;height:1px;background:#969696;top:15px;-webkit-transition:background .15s ease;transition:background .15s ease}#sidebar .nav-close:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}#sidebar .nav-close:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}#sidebar .nav-close:hover:after,#sidebar .nav-close:hover:before{background:#fff}#sidebar amp-accordion .nav-section{margin:.4em 0 .2em;background:none;border:none;font-size:2rem}#sidebar amp-accordion section[expanded] .nav-section .fa{width:1ch}#sidebar amp-accordion section[expanded] .nav-section .section-open{display:inline-block}#sidebar amp-accordion section[expanded] .nav-section .section-close{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-open{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-close{display:inline-block}#sidebar ul{padding:90px 9% 5%;list-style:none;counter-reset:item}#sidebar li:before{display:block;float:right;padding-right:4%;padding-left:5px;text-align:right;font-size:1.2rem;vertical-align:bottom;color:#b8b8b8;content:counter(item,lower-roman);counter-increment:item}#sidebar li{margin:0}#sidebar li a{text-decoration:none;line-height:1.4;font-size:1.4rem;display:block;padding:.6rem 4%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#sidebar li a:after{display:inline-block;content:" ...............................................................";color:hsla(0,0%,100%,.2);margin-left:5px}#sidebar .nav-current:before{color:#fff}#sidebar .nav-current a:after{content:" ";border-bottom:1px solid hsla(0,0%,100%,.5);width:100%;height:1px}#sidebar a,#sidebar a:active,#sidebar a:hover,#sidebar a:visited{color:#b8b8b8}#sidebar a:active,#sidebar a:hover,#sidebar li.nav-current a{color:#fff}.subscribe-button{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;bottom:30px;left:30px;right:30px;height:38px;padding:0 20px;text-align:center;font-size:12px;font-family:Open Sans,sans-serif;text-transform:uppercase;text-decoration:none;line-height:35px;border-radius:3px;background:#fff;-webkit-transition:all .3s ease;transition:all .3s ease}.subscribe-button:before{font-size:9px;margin-right:6px}.pagination{position:relative;width:80%;max-width:710px;margin:4rem auto;font-family:Open Sans,sans-serif;font-size:1.3rem;color:#9eabb3;text-align:center}.pagination a{color:#9eabb3;-webkit-transition:all .2s ease;transition:all .2s ease}.newer-posts,.older-posts{position:absolute;display:inline-block;padding:0 15px;border:1px solid #bfc8cd;text-decoration:none;border-radius:4px;-webkit-transition:border .3s ease;transition:border .3s ease}.older-posts{right:0}.page-number{display:inline-block;padding:2px 0;min-width:100px}.newer-posts{left:0}.newer-posts:hover,.older-posts:hover{color:#889093;border-color:#98a0a4}.extra-pagination{display:none;border-bottom:1px solid #ebf2f6}.extra-pagination:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.extra-pagination .pagination{width:auto}.archive-template .main-header{max-height:30vh}.archive-template .extra-pagination{display:block}.site-footer{position:relative;margin:8rem 0 0;padding:.5rem 15px;font-family:Open Sans,sans-serif;font-size:1rem;line-height:1.75em;color:#bbc7cc}.site-footer a{color:#bbc7cc;text-decoration:none;font-weight:700}.site-footer a:hover{color:#50585d}.poweredby{float:right;text-align:right}.copyright,.poweredby{display:block;width:45%}.copyright{float:left}@media only screen and (max-width:900px){blockquote{margin-left:0}.main-header{-webkit-box-sizing:border-box;box-sizing:border-box;height:auto;min-height:240px;height:60vh;padding:15% 0}.home-template .main-header:after,.scroll-down{display:none}.archive-template .main-header{min-height:180px;padding:10% 0}.blog-logo img{padding:4px 0}.page-title{font-size:4rem;letter-spacing:-1px}.page-description{font-size:1.8rem;line-height:1.5em}.post{font-size:.95em}body:not(.post-template) .post-title{font-size:3.2rem}hr{margin:2.4em 0}ol,ul{padding-left:2em}h1{font-size:4.5rem;text-indent:-2px}h2{font-size:3.6rem}h3{font-size:3.1rem}h4{font-size:2.5rem}h5{font-size:2.2rem}h6{font-size:1.8rem}.author-profile{padding-bottom:4rem}.author-profile .author-bio{font-size:1.6rem}.author-meta span{display:block;margin:1.5rem 0}.author-profile .author-meta span{font-size:1.6rem}.post-head.main-header{height:45vh}.author-head.main-header,.tag-head.main-header{height:30vh}.no-cover.post-head.main-header{height:55px;padding:0}.no-cover.author-head.main-header{padding:0}}@media only screen and (max-width:500px){.main-header{margin-bottom:15px;height:40vh}.no-cover.main-header{height:30vh}.archive-template .main-header{max-height:20vh;min-height:160px;padding:10% 0}.main-nav{margin-bottom:2rem}.blog-logo,.main-nav{padding:5px}.blog-logo img{height:30px}.menu-button{padding:0 5px;border-radius:0;border-color:transparent;color:#2e2e2e;background:transparent}.menu-button:hover{color:#2e2e2e;border-color:transparent;background:none}body.nav-opened .menu-button{background:none;border:transparent}.main-nav.overlay a:hover{color:#fff;border-color:transparent;background:transparent}.no-cover .main-nav.overlay{background:none}.no-cover .main-nav.overlay .menu-button{border:none}.main-nav.overlay .menu-button{border-color:transparent}.nav-title{top:25px}.nav-close{position:absolute;top:18px}.nav ul{padding:60px 9% 5%}.inner,.pagination{width:auto;margin:2rem auto}.post{width:auto;margin:2rem 16px;padding-bottom:2rem;line-height:1.65em}.post-template .post-header{margin-bottom:2rem}.post-template .post-date{display:inline-block}hr{margin:1.75em 0}dl,ol,p,ul{font-size:.95em;margin:0 0 2.5rem}.page-title{font-size:3rem}.post-excerpt p{font-size:.85em}.page-description{font-size:1.6rem}h1,h2,h3,h4,h5,h6{margin:0 0 .3em}h1{font-size:2.8rem;letter-spacing:-1px}h2{font-size:2.4rem;letter-spacing:0}h3{font-size:2.1rem}h4{font-size:1.9rem}h5,h6{font-size:1.8rem}body:not(.post-template) .post-title{font-size:2.5rem}.post-template .post{padding-bottom:0;margin-bottom:0}.post-template .site-footer{margin-top:0}.post-meta{font-size:1.3rem;margin-top:1rem}.post-footer{padding:5rem 0 3rem;text-align:center}.post-footer .author{margin:0 0 2rem;padding:0 0 1.6rem;border-bottom:1px dashed #ebf2f6}.post-footer .share{position:static;width:auto}.post-footer .share a{margin:1.4rem .8rem 0}.author-meta li{float:none;margin:0;line-height:1.75em}.author-meta li:before{display:none}.newer-posts,.older-posts{position:static;margin:10px 0}.page-number{display:block}.site-footer{margin-top:3rem}.author-profile{padding-bottom:2rem}.post-head.main-header{height:30vh}.author-head.main-header,.tag-head.main-header{height:20vh}.author-profile .author-image{margin-top:-70px}.author-profile .author-meta span{font-size:1.4rem}.archive-template .main-header .page-description{display:none}}header.post-header{line-height:1.1em}.post-content amp-img{max-width:100%;height:auto;border:1px solid #777;-webkit-box-shadow:5px 5px 2px rgba(0,0,0,.4);box-shadow:5px 5px 2px rgba(0,0,0,.4);margin-bottom:20px}.social-link a{color:#dfdfdf}pre.chroma{text-align:left}.badge-primary{color:#fff;background-color:#007bff}.badge{display:inline-block;padding:.25em .4em;font-size:80%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:middle;border-radius:.25rem}
    

</style>

        <link rel="canonical" href="https://www.simoahava.com/analytics/bigquery-query-guide-google-analytics-app-web/">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

        

        <link href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,700,700i|Open+Sans:400,700|Kaushan+Script" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

        <meta name="theme-color" content="#ffffff" />

        
        <title>#BigQueryTips: Query Guide to Google Analytics: App &#43; Web | Simo Ahava's blog</title>
        



  

<meta property="og:title" content="#BigQueryTips: Query Guide to Google Analytics: App &#43; Web" />
<meta name="description" content="This is a Getting Started guide to using BigQuery with the dataset pulled in from a Google Analytics App&#43;Web view." />
<meta property="og:description" content="This is a Getting Started guide to using BigQuery with the dataset pulled in from a Google Analytics App&#43;Web view." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.simoahava.com/amp/analytics/bigquery-query-guide-google-analytics-app-web/" />

      <meta name="twitter:image" content="https://www.simoahava.com/images/2019/09/bigquery-guide-app-web.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2019/09/bigquery-guide-app-web.jpg">
    


    
        <meta property="article:published_time" content="2019-10-15T05:00:00Z"/>
    
    
        <meta property="article:modified_time" content="2019-10-15T05:00:00Z"/>
    




    


    <meta property="og:site_name" content="Simo Ahava&#39;s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development." />









    
        
        
            
        
        
        
    
    
    
        
            <meta property="article:section" content="Analytics" />
        
    
    
        
            <meta property="article:tag" content="bigquery" />
        
            <meta property="article:tag" content="app&#43;web" />
        
            <meta property="article:tag" content="firebase" />
        
    







    
        <meta name="twitter:card" content="summary"/>
    

    
        
        
            
        
        
        
    



<meta itemprop="name" content="#BigQueryTips: Query Guide To Google Analytics: App &#43; Web">
<meta itemprop="description" content="This is a Getting Started guide to using BigQuery with the dataset pulled in from a Google Analytics App&#43;Web view.">
<meta itemprop="datePublished" content="2019-10-15T08:00:00&#43;03:00" />
<meta itemprop="dateModified" content="2019-10-15T08:00:00&#43;03:00" />
<meta itemprop="wordCount" content="4652">



<meta itemprop="keywords" content="bigquery,app&#43;web,firebase," />
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Simo Ahava\u0027s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.",
    
    "url": "https:\/\/www.simoahava.com\/amp\/"
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "#BigQueryTips: Query Guide To Google Analytics: App \u002b Web | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2019\/09\/bigquery-guide-app-web.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/amp\/analytics\/bigquery-query-guide-google-analytics-app-web\/",
  "datePublished": "2019-10-15T08:00:00\u002b03:00",
  "dateModified": "2019-10-15T08:00:00\u002b03:00",
  "description": "This is a Getting Started guide to using BigQuery with the dataset pulled in from a Google Analytics App\u002bWeb view.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>












    </head>
<body>

<amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-5BH2HM&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics>
  <amp-sidebar id="sidebar" layout="nodisplay" side="right">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close" on="tap:sidebar.close" role="button" tabindex="1">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/categories/gtm-tips/">GTM Tips</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/about-simo-ahava/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/tools/">Tools</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/blog-statistics/">Blog Statistics</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/upcoming-talks/">Upcoming Talks</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/custom-templates/">Templates</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/newsletter/">Newsletter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/">Full (non-AMP) site</a>
            </li>
        
        <amp-accordion>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Categories
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/gtm-tips/">gtm-tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-development/">web-development</a></li>
                
                </div>
            </section>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Tags
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ab-testing/">ab-testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/accelerated-mobile-pages/">accelerated-mobile-pages</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ad-blocker/">ad-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adblocker/">adblocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/add-on/">add-on</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adwords/">adwords</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/agile/">agile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amazon/">amazon</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amp/">amp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/android/">android</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/api/">api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app/">app</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app&#43;web/">app&#43;web</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app-engine/">app-engine</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/approval/">approval</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps/">apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps-script/">apps-script</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/array/">array</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/attribution/">attribution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audience-design/">audience-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audit/">audit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-event-tracking/">auto-event-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-link-domains/">auto-link-domains</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/aws/">aws</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/azure/">azure</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/basketball/">basketball</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/beforeunload/">beforeunload</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/best-practices/">best-practices</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/big-data/">big-data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bigquery/">bigquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/blogger/">blogger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bounce-rate/">bounce-rate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/built-in-variables/">built-in-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/calculated-metrics/">calculated-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/callback/">callback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/campaign-tracking/">campaign-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/celebration/">celebration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/change-history/">change-history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome/">chrome</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome-extension/">chrome-extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-tracking/">click-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-variables/">click-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clickstream/">clickstream</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-id/">client-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-template/">client-template</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clientid/">clientid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-functions/">cloud-functions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-run/">cloud-run</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cms/">cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cname/">cname</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conferences/">conferences</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent/">consent</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent-mode/">consent-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container/">container</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-export/">container-export</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-snippet/">container-snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content/">content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-analysis/">content-analysis</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-blocker/">content-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-engagement/">content-engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-grouping/">content-grouping</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management-system/">content-management-system</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-security-policy/">content-security-policy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-strategy/">content-strategy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/context/">context</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversion/">conversion</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversions-api/">conversions-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookie/">cookie</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookiedomain/">cookiedomain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookies/">cookies</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/core-web-vitals/">core-web-vitals</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/creative/">creative</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain/">cross-domain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain-tracking/">cross-domain-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/csp/">csp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css/">css</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css-selectors/">css-selectors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom/">custom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimension/">custom-dimension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimensions/">custom-dimensions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html/">custom-html</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tag/">custom-html-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tags/">custom-html-tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-javascript/">custom-javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-metrics/">custom-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-templates/">custom-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/customtask/">customtask</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dan-wilkerson/">dan-wilkerson</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dashboard/">dashboard</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data/">data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-collection/">data-collection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer/">data-layer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer-variable/">data-layer-variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-model/">data-model</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-quality/">data-quality</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/datalayer/">datalayer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debug/">debug</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debugging/">debugging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/definition-of-success/">definition-of-success</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer/">developer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer-tools/">developer-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/development/">development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/document.write/">document.write</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dom/">dom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/duplicate/">duplicate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dynamic-content/">dynamic-content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/easter-egg/">easter-egg</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecomemrce/">ecomemrce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecommerce/">ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/education/">education</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/element-visibility/">element-visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/engagement/">engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/enhanced-ecommerce/">enhanced-ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/enrichment/">enrichment</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/environments/">environments</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/errors/">errors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event/">event</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listener/">event-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listeners/">event-listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/eventcallback/">eventcallback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/events/">events</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/excel/">excel</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exceptions/">exceptions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/experimentation/">experimentation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exploit/">exploit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/extension/">extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/facebook/">facebook</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/false/">false</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/family/">family</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fields-to-set/">fields-to-set</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firebase/">firebase</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firestore/">firestore</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firing-rules/">firing-rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/folders/">folders</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form/">form</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form-tracking/">form-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/format-value/">format-value</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/forms/">forms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fpid/">fpid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga-spy/">ga-spy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga4/">ga4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gcp/">gcp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gdpr/">gdpr</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google/">google</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-ads/">google-ads</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics/">google-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-4/">google-analytics-4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-settings/">google-analytics-settings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-bigquery/">google-bigquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud-platform/">google-cloud-platform</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-optimize/">google-optimize</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-sheets/">google-sheets</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag/">google-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag-manager/">google-tag-manager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-trends/">google-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/googletagmanager/">googletagmanager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/governance/">governance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag/">gtag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag.js/">gtag.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-sonar/">gtm-sonar</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-tools/">gtm-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm360/">gtm360</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtmtips/">gtmtips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guest-post/">guest-post</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guide/">guide</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hack/">hack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history/">history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-change-trigger/">history-change-trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-listener/">history-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hugo/">hugo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/iframe/">iframe</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/intelligent-tracking-prevention/">intelligent-tracking-prevention</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/internal-traffic/">internal-traffic</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ios/">ios</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ip/">ip</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/it-department/">it-department</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/itp/">itp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/javascript/">javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/jquery/">jquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/klipfolio/">klipfolio</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/learning/">learning</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lighthouse/">lighthouse</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/links/">links</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/listeners/">listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/local/">local</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/localstorage/">localstorage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lookup-table/">lookup-table</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/macros/">macros</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketer/">marketer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketing/">marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/measurement-protocol/">measurement-protocol</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/meta-description/">meta-description</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/metrics/">metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/migration/">migration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mixcloud/">mixcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mobile/">mobile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modern-cms/">modern-cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modular-architecture/">modular-architecture</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/monitor/">monitor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/navigation/">navigation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/netbooster/">netbooster</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/new-ui/">new-ui</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/node.js/">node.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/nodejs/">nodejs</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/non-technical/">non-technical</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/open-source/">open-source</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/opt-out/">opt-out</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/owasp/">owasp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-load-time/">page-load-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-timings/">page-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/parameter-reporting/">parameter-reporting</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/penguin/">penguin</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/performance/">performance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/permissions/">permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/persistence/">persistence</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal-experience/">personal-experience</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/php/">php</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pii/">pii</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pitch/">pitch</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/plugins/">plugins</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/poetry/">poetry</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/postmessage/">postmessage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ppc/">ppc</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview/">preview</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview-mode/">preview-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/process/">process</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/proxy/">proxy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/public-speaking/">public-speaking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/query-string/">query-string</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/queue-time/">queue-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/r/">r</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/race-condition/">race-condition</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/reaktor/">reaktor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/recaptcha/">recaptcha</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/referral/">referral</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/regular-expression/">regular-expression</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/release/">release</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/resources/">resources</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/rules/">rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/safari/">safari</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sales/">sales</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/samesite/">samesite</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/schema/">schema</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/score-card/">score-card</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/scroll-depth/">scroll-depth</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search/">search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-api/">search-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-engine-optimization/">search-engine-optimization</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-trends/">search-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/security/">security</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/selection/">selection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo-report/">seo-report</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/serp/">serp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/server-side/">server-side</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/server-side-tagging/">server-side-tagging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/session/">session</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sessions/">sessions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/simmer/">simmer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/single-page-apps/">single-page-apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-search/">site-search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-speed/">site-speed</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/slack/">slack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snippet/">snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snowplow/">snowplow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/social-interactions/">social-interactions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/soundcloud/">soundcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/spa/">spa</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/splash-page/">splash-page</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/static-site/">static-site</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/still-running/">still-running</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/storage/">storage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/support/">support</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/swift/">swift</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/syntax-highlight/">syntax-highlight</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solution/">tag-management-solution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solutions/">tag-management-solutions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-sequencing/">tag-sequencing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-templates/">tag-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tags/">tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tasks/">tasks</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/technique/">technique</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/test/">test</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/testing/">testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timer/">timer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timings/">timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tips/">tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tools/">tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker/">tracker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker-object/">tracker-object</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracking-protections/">tracking-protections</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/training/">training</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/transformations/">transformations</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger/">trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger-groups/">trigger-groups</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/triggers/">triggers</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/troubleshoot/">troubleshoot</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/undefined/">undefined</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/universal-analytics/">universal-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-id/">user-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-interface/">user-interface</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-permissions/">user-permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-timings/">user-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/v2/">v2</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable/">variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable-templates/">variable-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variables/">variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/videos/">videos</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/visibility/">visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/wcag/">wcag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/weather/">weather</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-development/">web-development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/webkit/">webkit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/website-redesign/">website-redesign</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workflow/">workflow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workspaces/">workspaces</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/youtube/">youtube</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/zones/">zones</a></li>
                
                </div>
            </section>
        
        </amp-accordion>
    </ul>
</amp-sidebar>

<div class="site-wrapper">



    <header class="main-header post-head no-cover">
    <nav class="main-nav clearfix">


    <a class="menu-button" on="tap:sidebar.toggle" role="button"><i class="fa fa-bars" aria-hidden="true"></i><span class="menu-button-label">Menu</span></a>


  </nav>
</header>



<main class="content" role="main">

  <article class="post type-post">

    <header class="post-header">
        <h1 class="post-title">#BigQueryTips: Query Guide to Google Analytics: App &#43; Web</h1>
        <small>This is a Getting Started guide to using BigQuery with the dataset pulled in from a Google Analytics App&#43;Web view.</small>

        <section class="post-meta">
            


    




    <amp-img class="author-thumb" src="https://www.simoahava.com/images/simo.png" layout="fixed" width="24" height="24" alt="Author image"></amp-img>

Simo Ahava

in
    
        <a href="https://www.simoahava.com/amp/categories/analytics">Analytics</a>
    


on
    
        <a href="https://www.simoahava.com/amp/tags/bigquery">#bigquery</a>
    
        , <a href="https://www.simoahava.com/amp/tags/app&#43;web">#app&#43;web</a>
    
        , <a href="https://www.simoahava.com/amp/tags/firebase">#firebase</a>
    


<time class="post-date" datetime="2019-10-15T08:00:00&#43;03:00">
    15 October 2019
</time>


<span class="post-date"><a href="https://www.simoahava.com/analytics/bigquery-query-guide-google-analytics-app-web/">Non-AMP version</a></span>


        </section>
    </header>

    <section class="post-content">
      
        
        
          <p>I&rsquo;ve thoroughly enjoyed writing short (and sometimes a bit longer) bite-sized tips for my <a href="https://www.simoahava.com/amp/categories/gtm-tips/">#GTMTips</a> topic. With the advent of <a href="https://www.blog.google/products/marketingplatform/analytics/new-way-unify-app-and-website-measurement-google-analytics/">Google Analytics: App + Web</a> and particularly the opportunity to <a href="https://www.simoahava.com/amp/analytics/enable-bigquery-export-google-analytics-app-web/">access raw data through BigQuery</a>, I thought it was a good time to get started on a new tip topic: <strong>#BigQueryTips</strong>.</p>
<p>For Universal Analytics, getting access to the BigQuery export with Google Analytics 360 has been one of the major selling points for the expensive platform. The hybrid approach of getting access to <strong>raw</strong> data that has nevertheless been annotated with Google Analytics&rsquo; sessionization schema and any integrations (e.g. Google Ads) the user might have enabled is a powerful thing indeed.</p>
<p>With <strong>Google Analytics: App + Web</strong>, the platform is moving away from the data model that has existed since the days of Urchin, and is instead converging with <a href="https://firebase.google.com/docs/analytics">Firebase Analytics</a>, to which we have already had access with native Android and iOS applications.</p>


    <a href="https://www.simoahava.com/amp/images/2019/09/bigquery-guide-app-web.jpg" title="BigQuery Guide App&#43;Web">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/bigquery-guide-app-web.jpg" layout="responsive" alt="BigQuery Guide App&#43;Web" height="1862" width="2806"></amp-img>
  
    </a>
  

<p>Fortunately, <a href="https://www.simoahava.com/amp/analytics/enable-bigquery-export-google-analytics-app-web/">BigQuery export for App + Web properties</a> comes at no additional platform costs - you only pay for storage and queries just as you would if creating a BigQuery project by yourself in Google&rsquo;s cloud platform.</p>
<p>So, with data flowing into BigQuery, I thought it time to start writing about how to build queries against this columnar data store. One of the reasons is because I want to challenge myself, but the other reason is that there just isn&rsquo;t that much information available online when it comes to using SQL with Firebase Analytics&rsquo; BigQuery exports.</p>


    <a href="https://www.simoahava.com/amp/images/2019/10/pawel.jpg" title="Pawel">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/pawel.jpg" layout="responsive" alt="Pawel" height="256" width="256"></amp-img>
  
    </a>
  

<p>To get things started with this new topic, I&rsquo;ve enlisted the help of my favorite SQL wizard in <a href="https://www.measure.chat/">#measure</a>, <a href="https://twitter.com/AlienDeg"><strong>Pawel Kapuscinski</strong></a>. He&rsquo;s never short of a solution when tricky BigQuery questions pop up in Measure Slack, so I thought it would be great to get him to contribute with some of his favorite tips for how to approach querying BigQuery data with SQL.</p>
<!-- raw HTML omitted -->
<p>Hopefully, <strong>#BigQueryTips</strong> will expand to more articles in the future. There certainly is a lot of ground to cover!</p>

        
        <article class="post type-simmer">
    <header class="post-header">
        <h2 class="post-title"><a href="https://www.simoahava.com/amp/newsletter/">The Simmer Newsletter</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
	Follow <a href="https://www.teamsimmer.com/newsletter/">this link</a> to subscribe to the <strong>Simmer Newsletter</strong>! Stay up-to-date with the latest content from Simo Ahava and the <a href="https://www.teamsimmer.com/">Simmer online course platform</a>.
      </p>
      </section>
</article>

        
          <h2 id="getting-started">Getting started</h2>
<p>First of all, you&rsquo;ll naturally need a <strong>Google Analytics: App + Web</strong> property. Here are some guides for getting started:</p>
<ul>
<li><a href="https://www.kristaseiden.com/step-by-step-setting-up-an-app-web-property/">Step by Step: Setting up an App + Web Property</a> (Krista Seiden)</li>
<li><a href="https://www.simoahava.com/amp/analytics/getting-started-with-google-analytics-app-web/">Getting Started With Google Analytics: App + Web</a> (Simo)</li>
<li><a href="https://developers.google.cn/analytics/devguides/collection/app-web/tag-guide">App + Web Properties tag and instrumentation guide</a> (Google)</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2019/08/link-toggle-on.jpg" title="Link toggle on">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/08/link-toggle-on.jpg" layout="responsive" alt="Link toggle on" height="508" width="672"></amp-img>
  
    </a>
  

<p>Next, you need to enable the BigQuery export for the new property, and for that you should follow <a href="https://www.simoahava.com/amp/analytics/enable-bigquery-export-google-analytics-app-web/">this guide</a>.</p>


    <a href="https://www.simoahava.com/amp/images/2019/09/mode-sql-tutorial.jpg" title="Mode SQL Tutorial">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/mode-sql-tutorial.jpg" layout="responsive" alt="Mode SQL Tutorial" height="856" width="2290"></amp-img>
  
    </a>
  

<p>Once you have the export up-and-running, it&rsquo;s a good time to take a moment to learn and/or get a refresher on how SQL works. For that, there is no other tutorial online that comes even close to the <a href="https://mode.com/sql-tutorial/">free, interactive SQL tutorial at Mode Analytics</a>.</p>


    <a href="https://www.simoahava.com/amp/images/2019/09/firebase-bigquery-sample.jpg" title="Bigquery sample">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/firebase-bigquery-sample.jpg" layout="responsive" alt="Bigquery sample" height="1128" width="1732"></amp-img>
  
    </a>
  

<p>And once you&rsquo;ve learned the difference between <code>LEFT JOIN</code> and <code>CROSS JOIN</code>, you can take a look at some of the sample data sets for <a href="https://bigquery.cloud.google.com/dataset/firebase-analytics-sample-data:ios_dataset?pli=1">iOS Firebase Analytics</a> and <a href="https://bigquery.cloud.google.com/dataset/firebase-analytics-sample-data:android_dataset">Android Firebase Analytics</a>. Play around with them, trying to figure out just how much querying a typical relational database differs from accessing data stored in columnar structure as BigQuery does.</p>
<p>At this point, you should have your BigQuery table collecting daily data dumps from the <strong>App + Web</strong> tags firing on your site, so let&rsquo;s work with Pawel and introduce some pretty useful <strong>BigQuery SQL queries</strong> to get started on that data analysis path!</p>

        
          <h2 id="tip-1-case-and-group-by">Tip #1: CASE and GROUP BY</h2>
<p>Our first tip covers two extremely useful SQL statements: <code>CASE</code> and <code>GROUP BY</code>. Use these to aggregate and group your data!</p>
<h3 id="case">CASE</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/case-when.jpg" title="CASE WHEN">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/case-when.jpg" layout="responsive" alt="CASE WHEN" height="616" width="1367"></amp-img>
  
    </a>
  

<p><code>CASE</code> statements are similar to the <code>if...else</code> statements used in other languages. The condition is introduced with the <code>WHEN</code> keyword, and the first <code>WHEN</code> condition that matches will have its <code>THEN</code> value returned as the value for that column.</p>
<p>You can use the <code>ELSE</code> keyword at the end to specify a default value. If <code>ELSE</code> is not defined and no conditions are met, the column gets the value <code>null</code>.</p>
<h4 id="source-table">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>15</td>
</tr>
<tr>
<td>23456</td>
<td>54</td>
</tr>
</tbody>
</table>
<h4 id="sql">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">user</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span>
  <span class="k">CASE</span>
    <span class="k">WHEN</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">90</span> <span class="k">THEN</span> <span class="s2">&#34;90+&#34;</span>
    <span class="k">WHEN</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">50</span> <span class="k">THEN</span> <span class="s2">&#34;50-89&#34;</span>
    <span class="k">WHEN</span> <span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">20</span> <span class="k">THEN</span> <span class="s2">&#34;20-49&#34;</span>
    <span class="k">ELSE</span> <span class="s2">&#34;0-19&#34;</span>
  <span class="k">END</span> <span class="k">AS</span> <span class="n">age_bucket</span>
<span class="k">FROM</span> <span class="n">some_table</span></code></pre></div>
<h4 id="query-result">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>age</th>
<th>age_bucket</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>15</td>
<td>0-19</td>
</tr>
<tr>
<td>23456</td>
<td>54</td>
<td>50-89</td>
</tr>
</tbody>
</table>
<p>The <code>CASE</code> statement is useful for quick transformations and for aggregating the data based on simple conditions.</p>
<h3 id="group-by">GROUP BY</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/group-by.jpg" title="GROUP BY">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/group-by.jpg" layout="responsive" alt="GROUP BY" height="558" width="1381"></amp-img>
  
    </a>
  

<p><code>GROUP BY</code> is required every time you want to <strong>summarize</strong> your data. For example, when you do calculations with <code>COUNT</code> (to return the number of instances) or <code>SUM</code> (to return the sum of instances), you need to indicate a column to group these calculations by (unless you&rsquo;re <em>only</em> retrieving the calculated column) . <code>GROUP BY</code> is thus most often used with <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators#aggregate-functions">aggregate functions</a> such as <code>COUNT</code>, <code>MAX</code>, <code>ANY_VALUE</code>, <code>SUM</code>, and <code>AVG</code>. It&rsquo;s also used with some string functions such as <code>STRING_AGG</code> when aggregating multiple rows into a single string.</p>
<h4 id="source-table-1">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>mobile_device_model</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>iPhone 5</td>
</tr>
<tr>
<td>12345</td>
<td>Nokia 3310</td>
</tr>
<tr>
<td>23456</td>
<td>iPhone 7</td>
</tr>
</tbody>
</table>
<h4 id="sql-1">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> 
  <span class="k">user</span><span class="p">,</span> 
  <span class="k">COUNT</span><span class="p">(</span><span class="n">mobile_device_model</span><span class="p">)</span> <span class="k">AS</span> <span class="n">device_count</span>
<span class="k">FROM</span> <span class="k">table</span>
<span class="k">GROUP</span> <span class="k">BY</span> <span class="mi">1</span></code></pre></div>
<h4 id="query-result-1">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>device_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>2</td>
</tr>
<tr>
<td>23456</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>In the query above, we assume that a single user can have more than one device associated with them in the table that is being queried. As we do a <code>COUNT</code> of all the devices for a given user, we need to group the results by the <code>user</code> column for the query to work.</p>
<h3 id="use-case-device-category-distribution-across-users">USE CASE: Device category distribution across users</h3>
<p>Let&rsquo;s keep the theme of users and devices alive for a moment.</p>
<p><strong>Users</strong> and <strong>events</strong> are the key metrics for App + Web. This is fundamentally different to the <strong>session</strong>-centric approach of Google Analytics (even though there are reverberations of &ldquo;sessions&rdquo; in App + Web, too). It&rsquo;s much closer to a true <em>hit stream</em> model than before.</p>
<p>However, event counts alone tell as nothing without us drilling into <em>what kind of event happened</em>.</p>
<p>In this first tip, we&rsquo;ll learn to <strong>calculate the number of users per device category</strong>. As the concept of &ldquo;User&rdquo; is still bound to a unique browser client ID, if the same person visited the website on two different browser instances or devices, they would be counted as two users.</p>
<p>This is what the query looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">SELECT</span>
  <span class="k">CASE</span>
    <span class="k">WHEN</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s2">&#34;desktop&#34;</span> <span class="k">THEN</span> <span class="s2">&#34;desktop&#34;</span>
    <span class="k">WHEN</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s2">&#34;tablet&#34;</span> <span class="k">AND</span> <span class="n">app_info</span><span class="p">.</span><span class="n">id</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s2">&#34;tablet-web&#34;</span>
    <span class="k">WHEN</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s2">&#34;mobile&#34;</span> <span class="k">AND</span> <span class="n">app_info</span><span class="p">.</span><span class="n">id</span> <span class="k">IS</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s2">&#34;mobile-web&#34;</span>
    <span class="k">WHEN</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s2">&#34;tablet&#34;</span> <span class="k">AND</span> <span class="n">app_info</span><span class="p">.</span><span class="n">id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s2">&#34;tablet-app&#34;</span>
    <span class="k">WHEN</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s2">&#34;mobile&#34;</span> <span class="k">AND</span> <span class="n">app_info</span><span class="p">.</span><span class="n">id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s2">&#34;mobile-app&#34;</span>
  <span class="k">END</span> <span class="k">AS</span> <span class="n">device</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_pseudo_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">users</span>
<span class="k">FROM</span>
  <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_2</span><span class="o">*`</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/09/group-by-case-output.jpg" title="Group by and case output">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/group-by-case-output.jpg" layout="responsive" alt="Group by and case output" height="580" width="639"></amp-img>
  
    </a>
  

<p>The query itself is simple, but it makes use of the two statements covered in this chapter effectively. <code>CASE</code> is used to segment &ldquo;mobile&rdquo; and &ldquo;tablet&rdquo; users further into web and app groups (something you&rsquo;ll find useful once you start collecting data from both websites and mobile apps), and <code>GROUP BY</code> displays the count of unique device IDs per device category.</p>

        
          <h2 id="tip-2-distinct-and-having">Tip #2: DISTINCT and HAVING</h2>
<p>The next two keywords we&rsquo;ll cover are <code>HAVING</code> and <code>DISTINCT</code>. The first is great for filtering results based on aggregated values. The latter is used to deduplicate results to avoid calculating the same result multiple times.</p>
<h3 id="distinct">DISTINCT</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/distinct.jpg" title="DISTINCT">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/distinct.jpg" layout="responsive" alt="DISTINCT" height="566" width="1472"></amp-img>
  
    </a>
  

<p>The <code>DISTINCT</code> keyword is used to deduplicate results.</p>
<h4 id="source-table-2">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>device_category</th>
<th>session_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>desktop</td>
<td>abc123</td>
</tr>
<tr>
<td>12345</td>
<td>desktop</td>
<td>def234</td>
</tr>
<tr>
<td>12345</td>
<td>tablet</td>
<td>efg345</td>
</tr>
<tr>
<td>23456</td>
<td>mobile</td>
<td>fgh456</td>
</tr>
</tbody>
</table>
<h4 id="sql-2">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="k">user</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">device_category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">device_category_count</span>
<span class="k">FROM</span>
  <span class="k">table</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span></code></pre></div>
<h4 id="query-result-2">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>device_category_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>2</td>
</tr>
<tr>
<td>23456</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>For example, if the user had three sessions with device categories <code>desktop</code>, <code>desktop</code>, and <code>tablet</code>, then a query for <code>COUNT(DISTINCT device.category)</code> would return <code>2</code>, as there are just two instances of <em>distinct</em> device categories.</p>
<h3 id="having">HAVING</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/having.jpg" title="HAVING">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/having.jpg" layout="responsive" alt="HAVING" height="745" width="1427"></amp-img>
  
    </a>
  

<p>The <code>HAVING</code> clause can be used at the end of the query, after all calculations have been done, to filter the results. All the rows selected for the query are still processed, even if the <code>HAVING</code> statement strips out some of them from the result table.</p>
<h4 id="source-table-3">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>device_category</th>
<th>session_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>desktop</td>
<td>abc123</td>
</tr>
<tr>
<td>12345</td>
<td>desktop</td>
<td>def234</td>
</tr>
<tr>
<td>12345</td>
<td>tablet</td>
<td>efg345</td>
</tr>
<tr>
<td>23456</td>
<td>mobile</td>
<td>fgh456</td>
</tr>
</tbody>
</table>
<h4 id="sql-3">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="k">user</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">device_category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">device_category_count</span>
<span class="k">FROM</span>
  <span class="k">table</span>
<span class="k">GROUP</span> <span class="k">BY</span> 
  <span class="mi">1</span>
<span class="k">HAVING</span>
  <span class="n">device_category_count</span> <span class="o">&gt;</span> <span class="mi">1</span></code></pre></div>
<h4 id="query-result-3">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>device_category_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>It&rsquo;s similar to <code>WHERE</code> (see next chapter), but unlike <code>WHERE</code> which is used to filter the actual records that are processed by the query, <code>HAVING</code> is used to filter on aggregated values. In the query above, <code>device_category_count</code> is an aggregated count of all the distinct device categories found in the data set.</p>
<h3 id="use-case-distinct-device-categories-per-user">USE CASE: Distinct device categories per user</h3>
<p>Since the very name, <strong>App + Web</strong>, implies cross-device measurement, exploring some ways of grouping and filtering data based on users with more than one device in use seems fruitful.</p>
<p>The query is similar to the one in the previous chapter, but this time instead of grouping by device category, we&rsquo;re grouping by user and counting the number of unique device categories each user has visited the site with. We&rsquo;re filtering the data to only include users with more than one device category in the data set.</p>
<p>This is an exploratory query. You can then extend it to actually detect different models instead of just using device category. Device category is a fickle dimension to use, as in the example dataset used for this article, many times a device labelled as &ldquo;Apple iPhone&rdquo; was actually counted as a Desktop device.</p>
<p>See <a href="https://medium.com/@optimiseordie/rapid-mining-for-ecommerce-conversion-53d1aab2e21">this article by Craig Sullivan</a> to understand how messed up device attribution in web analytics actually is.</p>
<div class="highlight"><pre class="chroma"><code class="language-SQL" data-lang="SQL"><span class="k">SELECT</span>
  <span class="n">user_pseudo_id</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">used_devices_count</span><span class="p">,</span>
  <span class="n">STRING_AGG</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">device</span><span class="p">.</span><span class="n">category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">distinct_devices</span><span class="p">,</span>
  <span class="n">STRING_AGG</span><span class="p">(</span><span class="n">device</span><span class="p">.</span><span class="n">category</span><span class="p">)</span> <span class="k">AS</span> <span class="n">devices</span>
<span class="k">FROM</span>
  <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_2</span><span class="o">*`</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span>
<span class="k">HAVING</span>
  <span class="n">used_devices_count</span> <span class="o">&gt;</span> <span class="mi">1</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/09/cross-device-query.jpg" title="cross-device query">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/cross-device-query.jpg" layout="responsive" alt="cross-device query" height="676" width="971"></amp-img>
  
    </a>
  

<p>As a bonus, you can see how <code>STRING_AGG</code> can be used to concatenate multiple values into a single column. This is useful for identifying patterns that emerge across multiple rows of data!</p>

        
          <h2 id="tip-3-where">Tip #3: WHERE</h2>
<h3 id="where">WHERE</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/where.jpg" title="WHERE">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/where.jpg" layout="responsive" alt="WHERE" height="733" width="1391"></amp-img>
  
    </a>
  

<p>If you want to filter the records against which you&rsquo;ll run your query, <code>WHERE</code> is your best friend. As it filters the records that are processed, it&rsquo;s also a great way to reduce the (performance and monetary) cost of your queries.</p>
<h4 id="source-table-4">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>session_id</th>
<th>landing_page_path</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>abc123</td>
<td>/home/</td>
</tr>
<tr>
<td>12345</td>
<td>bcd234</td>
<td>/purchase/</td>
</tr>
<tr>
<td>23456</td>
<td>cde345</td>
<td>/home/</td>
</tr>
<tr>
<td>34567</td>
<td>def456</td>
<td>/contact-us/</td>
</tr>
</tbody>
</table>
<h4 id="sql-4">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="o">*</span>
<span class="k">FROM</span>
  <span class="k">table</span>
<span class="k">WHERE</span>
  <span class="k">user</span> <span class="o">=</span> <span class="s1">&#39;12345&#39;</span></code></pre></div>
<h4 id="query-result-4">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>session_id</th>
<th>landing_page_path</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>abc123</td>
<td>/home/</td>
</tr>
<tr>
<td>12345</td>
<td>bcd234</td>
<td>/purchase/</td>
</tr>
</tbody>
</table>
<p>The <code>WHERE</code> clause is used to filter the rows against which the rest of the query is made. It is introduced directly after the <code>FROM</code> statement, and it reads as &ldquo;return all the rows in the <code>FROM</code> table that match the condition of the <code>WHERE</code> clause&rdquo;.</p>
<p>Do note that <code>WHERE</code> <strong>can&rsquo;t be used with aggregate values</strong>. So if you&rsquo;ve done any calculations with the rows returned from the table, you need to use <code>HAVING</code> instead.</p>
<p>Due to this, <code>WHERE</code> is less expensive in terms of query processing than <code>HAVING</code>.</p>
<h3 id="use-case-engaged-users">USE CASE: Engaged users</h3>
<p>As mentioned before, <strong>App + Web</strong> is event-driven. With Firebase Analytics, Google introduced a number of <a href="https://support.google.com/firebase/answer/6317485?hl=en">automatically collected</a>, pre-defined events to help users gather useful data from their apps and websites without having to flex a single muscle.</p>
<p>One such event is <strong>user_engagement</strong>. This is fired when the user has engaged with the website or app for a specified period of time.</p>
<p>Since this is readily available as a custom event, we can create a simple query that uses the <code>WHERE</code> clause to return only those records where the user was engaged.</p>
<p>The key to <code>WHERE</code> is that it&rsquo;s executed after the <code>FROM</code> clause (which specifies the table to be queried). If a row doesn&rsquo;t match the condition in <code>WHERE</code>, it won&rsquo;t be used to match the rest of the query against.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="n">event_date</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_pseudo_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">engaged_users</span>
<span class="k">FROM</span>
  <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_20190922</span><span class="o">`</span>
<span class="k">WHERE</span>
  <span class="n">event_name</span> <span class="o">=</span> <span class="s2">&#34;user_engagement&#34;</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/09/engaged-users.jpg" title="Engaged users">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/engaged-users.jpg" layout="responsive" alt="Engaged users" height="533" width="645"></amp-img>
  
    </a>
  

<p>See how we&rsquo;re including data from just one date? We&rsquo;re also only including <code>DISTINCT</code> users, so if a user was engaged more than once during the day we&rsquo;re only counting them once.</p>

        
          <h2 id="tip-4-subqueries-and-analytic-functions">Tip #4: SUBQUERIES and ANALYTIC functions</h2>
<p>A <strong>subquery</strong> in SQL means a query within a query. They can emerge in multiple different places, such as within <code>SELECT</code> clauses, <code>FROM</code> clauses, and <code>WHERE</code> clauses.</p>
<p><strong>Analytic</strong> functions let you do calculations that cover <em>other</em> rows than just the one that is being processed. It&rsquo;s similar to aggregations such as <code>SUM</code> and <code>AVG</code> except it doesn&rsquo;t result in rows getting grouped into a single result. That&rsquo;s why analytic functions are perfectly suited for things like <em>running totals/averages</em> or, in analytics contexts, determining session boundaries by looking at first and last timestamps, for example.</p>
<h3 id="subquery">SUBQUERY</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/subquery.jpg" title="SUBQUERY">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/subquery.jpg" layout="responsive" alt="SUBQUERY" height="777" width="1427"></amp-img>
  
    </a>
  

<p>The point of a subquery is to run calculations on table data, and return the result of those calculations to the enclosing query. This lets you logically organize your queries, and it makes it possible to do calculations on calculations, which would not be possible in a single query.</p>
<h4 id="source-table-5">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>event_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>session_start</td>
</tr>
<tr>
<td>23456</td>
<td>user_engagement</td>
</tr>
<tr>
<td>34567</td>
<td>user_engagement</td>
</tr>
<tr>
<td>45678</td>
<td>link_click</td>
</tr>
</tbody>
</table>
<h4 id="sql-5">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">user</span><span class="p">)</span> <span class="k">AS</span> <span class="n">all_users</span><span class="p">,</span>
  <span class="p">(</span>
    <span class="k">SELECT</span>
      <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="k">user</span><span class="p">)</span>
    <span class="k">FROM</span>
      <span class="k">table</span>
    <span class="k">WHERE</span>
      <span class="n">event_name</span> <span class="o">=</span> <span class="s1">&#39;user_engagement&#39;</span>
  <span class="p">)</span> <span class="k">AS</span> <span class="n">engaged_users</span>
<span class="k">FROM</span>
  <span class="k">table</span></code></pre></div>
<h4 id="query-result-5">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>all_users</th>
<th>engaged_users</th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>In this example, the subquery is within the <code>SELECT</code> statement, meaning the subquery result is bundled into a single column of the main query.</p>
<p>Here, the <code>engaged_users</code> column retrieves the count of all distinct user IDs from the table, where these users had an event named <code>user_engagement</code> collected at any time.</p>
<p>The main query then combines this with a count of all distinct user IDs without any restrictions, and thus you get both counts in the same table.</p>
<p>You couldn&rsquo;t have achieved with just the main query, since the <code>WHERE</code> statement applies to all <code>SELECT</code> columns in the table. That&rsquo;s why we needed the subquery - we had to use a <code>WHERE</code> statement that only applied to the <code>engaged_users</code> column.</p>
<h3 id="analytic-functions">ANALYTIC FUNCTIONS</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/analytic-function.jpg" title="Analytic function">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/analytic-function.jpg" layout="responsive" alt="Analytic function" height="785" width="1536"></amp-img>
  
    </a>
  

<p>Analytic functions can be really difficult to understand, since with SQL you&rsquo;re used to going over the table row-by-row, and comparing the query against each row one at a time.</p>
<p>With an analytic function, you stretch this logic a bit. The query still goes over the source table row-by-row, but this time you can reference other rows when doing calculations.</p>
<h4 id="source-table-6">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>event_name</th>
<th>event_timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>click</td>
<td>1001</td>
</tr>
<tr>
<td>12345</td>
<td>click</td>
<td>1002</td>
</tr>
<tr>
<td>23456</td>
<td>session_start</td>
<td>1012</td>
</tr>
<tr>
<td>23456</td>
<td>user_engagement</td>
<td>1009</td>
</tr>
<tr>
<td>34567</td>
<td>click</td>
<td>1000</td>
</tr>
</tbody>
</table>
<h4 id="sql-6">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="n">event_name</span><span class="p">,</span>
  <span class="k">user</span><span class="p">,</span>
  <span class="n">event_timestamp</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="k">user</span><span class="p">,</span>
    <span class="n">event_name</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">,</span>
    <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">event_name</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">event_timestamp</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rank</span>
  <span class="k">FROM</span>
    <span class="k">table</span>
<span class="p">)</span> 
<span class="k">WHERE</span>
  <span class="n">rank</span> <span class="o">=</span> <span class="mi">1</span></code></pre></div>
<h4 id="query-result-6">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>event_name</th>
<th>user</th>
<th>event_timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td>click</td>
<td>34567</td>
<td>1000</td>
</tr>
<tr>
<td>user_engagement</td>
<td>23456</td>
<td>1009</td>
</tr>
<tr>
<td>session_start</td>
<td>23456</td>
<td>1012</td>
</tr>
</tbody>
</table>
<p>In this query, we take each event and see which user sent the <em>first</em> such event in the table.</p>
<p>For each row in the table, the <code>RANK() OVER (PARTITION BY event_name ORDER BY event_timestamp) AS rank</code> is run. The <em>partition</em> is basically a &ldquo;reference&rdquo; table with all the event names matching the current row&rsquo;s event name, and their respective timestamps.</p>
<p>These timestamps are then ordered in ascending order (within the partition). The <code>RANK() OVER</code> part of the function returns the current event name&rsquo;s <em>rank</em> in this table.</p>
<p>To walk through an example, let&rsquo;s say the query engine encounters the first row of the table. The <code>RANK() OVER (PARTITION BY event_name ORDER BY event_timestamp)</code> creates the reference table that looks like this for the first row:</p>
<table>
<thead>
<tr>
<th>user</th>
<th>event_name</th>
<th>event_timestamp</th>
<th>rank</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>click</td>
<td>1000</td>
<td>1</td>
</tr>
<tr>
<td>12345</td>
<td>click</td>
<td>1001</td>
<td>2</td>
</tr>
<tr>
<td>12345</td>
<td>click</td>
<td>1002</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>The query then checks how the current row matches against this partition, and returns <code>2</code> as the first row in the table was rank <code>2</code> of its partition.</p>
<p>This partition is ephemeral - it&rsquo;s <strong>only</strong> used to calculate the result of the analytic function.</p>
<p>For the purposes of this exercise, this analytic function is furthermore done in a subquery, so that the main query can filter the result using a <code>WHERE</code> for just those items that had rank <code>1</code> (first timestamp of any given event).</p>
<p>I recommend checking out the first paragraphs in <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/analytic-function-concepts">this</a> document - it explains how the partitioning works.</p>
<h3 id="use-case-first-interaction-per-event">USE CASE: First interaction per event</h3>
<p>Let&rsquo;s extend the example from above into the App + Web dataset.</p>
<p>We&rsquo;ll create a list of client IDs together with the event name, the timestamp, and the timestamp converted to a readable (date) format.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="n">user_pseudo_id</span><span class="p">,</span>
  <span class="n">event_name</span><span class="p">,</span>
  <span class="n">event_timestamp</span><span class="p">,</span>
  <span class="n">DATETIME</span><span class="p">(</span><span class="n">TIMESTAMP_MICROS</span><span class="p">(</span><span class="n">event_timestamp</span><span class="p">),</span> <span class="s2">&#34;Europe/Helsinki&#34;</span><span class="p">)</span> <span class="k">AS</span> <span class="nb">date</span>
<span class="k">FROM</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="n">user_pseudo_id</span><span class="p">,</span>
    <span class="n">event_name</span><span class="p">,</span>
    <span class="n">event_timestamp</span><span class="p">,</span>
    <span class="n">RANK</span><span class="p">()</span> <span class="n">OVER</span> <span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">event_name</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">event_timestamp</span><span class="p">)</span> <span class="k">AS</span> <span class="n">rank</span>
  <span class="k">FROM</span>
    <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_20190922</span><span class="o">`</span> <span class="p">)</span>
<span class="k">WHERE</span>
  <span class="n">rank</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">ORDER</span> <span class="k">BY</span>
  <span class="n">event_timestamp</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/10/first-interaction-timestamp.jpg" title="First interaction timestamp">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/first-interaction-timestamp.jpg" layout="responsive" alt="First interaction timestamp" height="749" width="654"></amp-img>
  
    </a>
  

<p>The logic is exactly the same as in the introduction to analytic functions above. The only difference is how we use the <code>DATETIME</code> and <code>TIMESTAMP_MICROS</code> to turn the UNIX timestamp (stored in BigQuery) into a readable date format.</p>
<p>Don&rsquo;t worry - analytic functions in particular are a tough concept to understand. Play around with the different analytic functions to get an idea of how they work with the source idea.</p>
<p>There are quite a few articles and videos online that explain the concept further, so I recommend checking out the web for more information. We will also return to analytic functions many, many times in future #BigQueryTips posts.</p>

        
          <h2 id="tip-5-unnest-and-cross-join">Tip #5: UNNEST and CROSS JOIN</h2>
<p>The dataset exported by App + Web does not end up in a relational database where we could use the <code>JOIN</code> key to quickly pull in extra information about pages, sessions, and users.</p>
<p>Instead, BigQuery arranges data in nested and repeated fields - that&rsquo;s how it can have a single row represent all the hits of a session (as in the Google Analytics dataset).</p>
<p>The problem with this approach is that it&rsquo;s not too intuitive to access these nested values.</p>
<p>Enter <code>UNNEST</code>, particularly when coupled with <code>CROSS JOIN</code>.</p>
<p><code>UNNEST</code> means that the nested structure is actually expanded so that each item within can be joined with the rest of the columns in the row. This results in the single row becoming multiple rows, where each row corresponds to one value in the nested structure. This column-to-rows is achieved with a <code>CROSS JOIN</code>, where every item in the unnested structure is joined with each column in the rest of the table.</p>
<h3 id="unnest-and-cross-join">UNNEST and CROSS JOIN</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/unnest-cross-join.jpg" title="UNNEST CROSS JOIN">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/unnest-cross-join.jpg" layout="responsive" alt="UNNEST CROSS JOIN" height="450" width="1380"></amp-img>
  
    </a>
  

<p>The two keywords go intrinsically together, so we&rsquo;ll treat them as such.</p>
<h4 id="source-table-7">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>timestamp</th>
<th>event</th>
<th>params.key</th>
<th>params.value</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>click</td>
<td>time<!-- raw HTML omitted -->type<!-- raw HTML omitted -->device</td>
<td>10<!-- raw HTML omitted -->right-click<!-- raw HTML omitted -->iPhone</td>
</tr>
</tbody>
</table>
<h4 id="sql-7">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="k">timestamp</span><span class="p">,</span>
  <span class="n">event</span><span class="p">,</span>
  <span class="n">event_params</span><span class="p">.</span><span class="k">key</span> <span class="k">AS</span> <span class="n">event_params_key</span>
<span class="k">FROM</span>
  <span class="k">table</span> <span class="k">AS</span> <span class="n">t</span>
  <span class="k">CROSS</span> <span class="k">JOIN</span> <span class="k">UNNEST</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">params</span><span class="p">)</span> <span class="k">AS</span> <span class="n">event_params</span></code></pre></div>
<h4 id="query-result-7">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>timestamp</th>
<th>event</th>
<th>event_params_key</th>
</tr>
</thead>
<tbody>
<tr>
<td>1000</td>
<td>click</td>
<td>time</td>
</tr>
<tr>
<td>1000</td>
<td>click</td>
<td>type</td>
</tr>
<tr>
<td>1000</td>
<td>click</td>
<td>device</td>
</tr>
</tbody>
</table>
<p>See what happened? The nested structure within <code>params</code> was <em>unnested</em> so that each item was treated as a separate row in its own column. Then, this unnested structure was <strong>cross-joined</strong> with the table. A <code>CROSS JOIN</code> combines every row from <code>table</code> with every row from the unnested structure.</p>
<p>This is how you end up with a structure that you can then use for calculations in your main query.</p>
<p>It&rsquo;s a bit complicated since you always need to do the <code>UNNEST</code> - <code>CROSS JOIN</code> exercise, but once you&rsquo;ve done it a few times it should become second nature.</p>
<p>In fact, there&rsquo;s a shorthand for writing the <code>CROSS JOIN</code> that might make things easier to read (or not). You can replace the <code>CROSS JOIN</code> statement with a comma. This is what the example query would look like when thus modified.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="k">timestamp</span><span class="p">,</span>
  <span class="n">event</span><span class="p">,</span>
  <span class="n">event_params</span><span class="p">.</span><span class="k">key</span> <span class="k">AS</span> <span class="n">event_params_key</span>
<span class="k">FROM</span>
  <span class="k">table</span> <span class="k">AS</span> <span class="n">t</span><span class="p">,</span>
  <span class="k">UNNEST</span> <span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">params</span><span class="p">)</span> <span class="k">AS</span> <span class="n">event_params</span></code></pre></div>
<h3 id="use-case-pageviews-and-unique-pageviews-per-user">USE CASE: Pageviews and Unique Pageviews per user</h3>
<p>Let&rsquo;s look at a query for getting the count of pageviews and unique pageviews per user.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="n">event_date</span><span class="p">,</span>
  <span class="n">event_params</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">string_value</span> <span class="k">as</span> <span class="n">page_url</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">AS</span> <span class="n">pageviews</span><span class="p">,</span>
  <span class="k">COUNT</span><span class="p">(</span><span class="k">DISTINCT</span> <span class="n">user_pseudo_id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">unique_pageviews</span>
<span class="k">FROM</span>
  <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_20190922</span><span class="o">`</span> <span class="k">AS</span> <span class="n">t</span><span class="p">,</span>
  <span class="k">UNNEST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">event_params</span><span class="p">)</span> <span class="k">AS</span> <span class="n">event_params</span>
<span class="k">WHERE</span>
  <span class="n">event_params</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="s2">&#34;page_location&#34;</span>
  <span class="k">AND</span> <span class="n">event_name</span> <span class="o">=</span> <span class="s2">&#34;page_view&#34;</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span><span class="p">,</span>
  <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span>
  <span class="mi">3</span> <span class="k">DESC</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/09/pageviews.jpg" title="Page views">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/pageviews.jpg" layout="responsive" alt="Page views" height="622" width="932"></amp-img>
  
    </a>
  

<p>In the <code>FROM</code> statement we define the table as usual, and we give it an alias <code>t</code> (good practice, as it helps keep the queries lean).</p>
<p>The next step is to <code>UNNEST</code> one of those nested fields, and then <code>CROSS JOIN</code> it with the rest of our table. The <code>WHERE</code> clause is used to make sure only rows that have the <code>page_location</code> key and the <code>page_view</code> event type are included in the final table.</p>
<p>Finally, we <code>GROUP BY</code>  the event date and page URL, and then we sort everything by the count of pageviews in descending order.</p>
<p>Conceptually, the <code>UNNEST</code> and <code>CROSS JOIN</code> create a new table that has a crazy number of rows, as every row in the original table is multiplied by the number of rows in the <code>event_params</code> nested structure. The <code>WHERE</code> clause is thus your friend in making sure you only analyze the data that answers the question you have.</p>

        
          <h2 id="tip-6-withas-and-left-join">Tip #6: WITH&hellip;AS and LEFT JOIN</h2>
<p>The final keywords we&rsquo;ll go through are <code>WITH...AS</code> and <code>LEFT JOIN</code>. The first lets you create a type of subquery that you can reference in your other queries as a separate table. The second lets you join two datasets together while preserving rows that do not match against the join condition.</p>
<h3 id="withas">WITH&hellip;AS</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/with-as.jpg" title="WITH...AS">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/with-as.jpg" layout="responsive" alt="WITH...AS" height="269" width="1415"></amp-img>
  
    </a>
  

<p><code>WITH...AS</code> is very similar conceptually to a subquery. It allows you to build a table expression that can then be used by your queries. The main difference to a subquery is that the table gets an alias, and you can then use this alias wherever you want to refer to the table&rsquo;s data. A subquery would need to be repeated in all places where you want to reference it, so <code>WITH</code> makes custom queries more accessible.</p>
<h4 id="source-table-8">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>event_name</th>
<th>event_timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>click</td>
<td>1000</td>
</tr>
<tr>
<td>12345</td>
<td>user_engagement</td>
<td>1005</td>
</tr>
<tr>
<td>12345</td>
<td>click</td>
<td>1006</td>
</tr>
<tr>
<td>23456</td>
<td>session_start</td>
<td>1002</td>
</tr>
<tr>
<td>34567</td>
<td>session_start</td>
<td>1000</td>
</tr>
<tr>
<td>34567</td>
<td>click</td>
<td>1002</td>
</tr>
</tbody>
</table>
<h4 id="sql-8">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">WITH</span> <span class="n">users_who_clicked</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="k">DISTINCT</span> <span class="k">user</span>
  <span class="k">FROM</span>
    <span class="k">table</span>
  <span class="k">WHERE</span> <span class="n">event_name</span> <span class="o">=</span> <span class="s1">&#39;click&#39;</span>
<span class="p">)</span>
<span class="k">SELECT</span>
  <span class="o">*</span>
<span class="k">FROM</span>
  <span class="n">users_who_clicked</span></code></pre></div>
<h4 id="query-result-8">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
</tr>
<tr>
<td>34567</td>
</tr>
</tbody>
</table>
<p>It&rsquo;s not the most mind-blowing of examples, but it should illustrate how to use table aliases. After the <code>WITH...AS</code> clause, you can then reference the table in e.g. <code>FROM</code> statements and in joins.</p>
<p>See the next example where we make this more interesting.</p>
<h3 id="left-join">LEFT JOIN</h3>


    <a href="https://www.simoahava.com/amp/images/2019/10/left-join.jpg" title="LEFT JOIN">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/10/left-join.jpg" layout="responsive" alt="LEFT JOIN" height="792" width="1497"></amp-img>
  
    </a>
  

<p>A <code>LEFT JOIN</code> is one of the most useful data joins because it allows you to account for unmatched rows as well.</p>
<p>A <code>LEFT JOIN</code> takes <strong>all</strong> rows in the first table (&ldquo;left&rdquo; table), and the rows that <strong>match</strong> a specific join criterion in the second table (&ldquo;right&rdquo; table). For all the rows that did not have a match, the first table is populated with a <em>null</em> value. Rows in the <em>second</em> table that do not have a match in the first table are discarded.</p>
<h4 id="source-table-9">SOURCE TABLE</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>event_name</th>
<th>event_timestamp</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>click</td>
<td>1000</td>
</tr>
<tr>
<td>12345</td>
<td>user_engagement</td>
<td>1005</td>
</tr>
<tr>
<td>12345</td>
<td>click</td>
<td>1006</td>
</tr>
<tr>
<td>23456</td>
<td>session_start</td>
<td>1002</td>
</tr>
<tr>
<td>34567</td>
<td>session_start</td>
<td>1000</td>
</tr>
<tr>
<td>34567</td>
<td>click</td>
<td>1002</td>
</tr>
</tbody>
</table>
<h4 id="sql-9">SQL</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">WITH</span> <span class="n">users_who_clicked</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="k">DISTINCT</span> <span class="k">user</span>
  <span class="k">FROM</span>
    <span class="k">table</span>
  <span class="k">WHERE</span> <span class="n">event_name</span> <span class="o">=</span> <span class="s1">&#39;click&#39;</span>
<span class="p">)</span>
<span class="k">SELECT</span>
  <span class="n">t1</span><span class="p">.</span><span class="k">user</span><span class="p">,</span>
  <span class="k">CASE</span>
    <span class="k">WHEN</span> <span class="n">t2</span><span class="p">.</span><span class="k">user</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="k">THEN</span> <span class="s2">&#34;true&#34;</span>
    <span class="k">ELSE</span> <span class="s2">&#34;false&#34;</span>
  <span class="k">END</span> <span class="k">AS</span> <span class="n">user_did_click</span>
<span class="k">FROM</span>
  <span class="k">table</span> <span class="k">as</span> <span class="n">t1</span>
<span class="k">LEFT</span> <span class="k">JOIN</span>
  <span class="n">users_who_clicked</span> <span class="k">as</span> <span class="n">t2</span>
<span class="k">ON</span> 
  <span class="n">t1</span><span class="p">.</span><span class="k">user</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="k">user</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span></code></pre></div>
<h4 id="query-result-9">QUERY RESULT</h4>
<table>
<thead>
<tr>
<th>user</th>
<th>user_did_click</th>
</tr>
</thead>
<tbody>
<tr>
<td>12345</td>
<td>true</td>
</tr>
<tr>
<td>23456</td>
<td>false</td>
</tr>
<tr>
<td>34567</td>
<td>true</td>
</tr>
</tbody>
</table>
<p>With the <code>LEFT JOIN</code>, we take all the user IDs in the main table, and then we take all the rows in the <code>users_who_clicked</code> table (that we created in the <code>WITH...AS</code> tutorial above). For all the rows where the user ID from the main table has a match in the <code>users_who_clicked</code> table, we populate a new column named <code>user_did_click</code> with the value <strong>true</strong>.</p>
<p>For all the user IDs that do not have a match in the <code>users_who_clicked</code> table, the value <strong>false</strong> is used instead.</p>
<h4 id="use-case-simple-segmenting">USE CASE: Simple segmenting</h4>
<p>Let&rsquo;s put a bunch of things we&rsquo;ve now learned together, and replicate some simple segmenting functionality from Google Analytics in BigQuery.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">WITH</span>
  <span class="n">engaged_users_table</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="k">DISTINCT</span> <span class="n">event_date</span><span class="p">,</span>
    <span class="n">user_pseudo_id</span>
  <span class="k">FROM</span>
    <span class="o">`</span><span class="n">dataset</span><span class="p">.</span><span class="n">analytics_accountId</span><span class="p">.</span><span class="n">events_20190922</span><span class="o">`</span>
  <span class="k">WHERE</span>
    <span class="n">EVENT_NAME</span> <span class="o">=</span> <span class="s2">&#34;user_engagement&#34;</span><span class="p">),</span>
  <span class="n">pageviews_table</span> <span class="k">AS</span> <span class="p">(</span>
  <span class="k">SELECT</span>
    <span class="k">DISTINCT</span> <span class="n">event_date</span><span class="p">,</span>
    <span class="n">event_params</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">string_value</span> <span class="k">AS</span> <span class="n">page_url</span><span class="p">,</span>
    <span class="n">user_pseudo_id</span>
  <span class="k">FROM</span>
    <span class="o">`</span><span class="n">simoahava</span><span class="o">-</span><span class="n">com</span><span class="p">.</span><span class="n">analytics_206575074</span><span class="p">.</span><span class="n">events_20190922</span><span class="o">`</span> <span class="k">AS</span> <span class="n">t</span><span class="p">,</span>
    <span class="k">UNNEST</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">event_params</span><span class="p">)</span> <span class="k">AS</span> <span class="n">event_params</span>
  <span class="k">WHERE</span>
    <span class="n">event_params</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="s2">&#34;page_location&#34;</span>
    <span class="k">AND</span> <span class="n">event_name</span> <span class="o">=</span> <span class="s2">&#34;page_view&#34;</span><span class="p">)</span>
<span class="k">SELECT</span>
  <span class="n">t1</span><span class="p">.</span><span class="n">event_date</span><span class="p">,</span>
  <span class="n">page_url</span><span class="p">,</span>
  <span class="n">COUNTIF</span><span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">engaged_users_visited</span><span class="p">,</span>
  <span class="n">COUNTIF</span><span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">not_engaged_users_visited</span>
<span class="k">FROM</span>
  <span class="n">pageviews_table</span> <span class="k">AS</span> <span class="n">t1</span>
<span class="k">LEFT</span> <span class="k">JOIN</span>
  <span class="n">engaged_users_table</span> <span class="k">AS</span> <span class="n">t2</span>
<span class="k">ON</span>
  <span class="n">t1</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span><span class="p">,</span>
  <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span>
  <span class="mi">3</span> <span class="k">DESC</span></code></pre></div>


    <a href="https://www.simoahava.com/amp/images/2019/09/with-as-table.jpg" title="With AS table">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/with-as-table.jpg" layout="responsive" alt="With AS table" height="678" width="981"></amp-img>
  
    </a>
  

<p>Let&rsquo;s chop this down to pieces again.</p>
<p>In the query above, we have <strong>two</strong> table aliases created. The first one named <code>engaged_users_table</code> should be familiar - it&rsquo;s the query we built in <a href="#use-case-engaged-users">tip #3</a>.</p>
<p>The second one named <code>pageviews_table</code> should ring a bell as well. We built it in <a href="#use-case-pageviews-and-unique-pageviews-per-user">tip #5</a>.</p>
<p>We create these as table aliases so that we can use them in the subsequent join.</p>
<p>Now, let&rsquo;s look at the rest of the query:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
  <span class="n">t1</span><span class="p">.</span><span class="n">event_date</span><span class="p">,</span>
  <span class="n">page_url</span><span class="p">,</span>
  <span class="n">COUNTIF</span><span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">engaged_users_visited</span><span class="p">,</span>
  <span class="n">COUNTIF</span><span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NULL</span><span class="p">)</span> <span class="k">AS</span> <span class="n">not_engaged_users_visited</span>
<span class="k">FROM</span>
  <span class="n">pageviews_table</span> <span class="k">AS</span> <span class="n">t1</span>
<span class="k">LEFT</span> <span class="k">JOIN</span>
  <span class="n">engaged_users_table</span> <span class="k">AS</span> <span class="n">t2</span>
<span class="k">ON</span>
  <span class="n">t1</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span>
<span class="k">GROUP</span> <span class="k">BY</span>
  <span class="mi">1</span><span class="p">,</span>
  <span class="mi">2</span>
<span class="k">ORDER</span> <span class="k">BY</span>
  <span class="mi">3</span> <span class="k">DESC</span></code></pre></div>
<p>Focus on the part after the <code>FROM</code> clause. Here, we take the two tables, and we <code>LEFT JOIN</code> them. The <code>pageviews_table</code> is the &ldquo;left&rdquo; table, and <code>engaged_users</code> is the &ldquo;right&rdquo; table.</p>
<p><code>LEFT JOIN</code> takes <strong>all the rows</strong> in the &ldquo;left&rdquo; table and the <strong>matching rows</strong> from the &ldquo;right&rdquo; table. The matching criterion is established in the <code>ON</code> clause. Thus, a match is made if the <code>user_pseudo_id</code> is the same between the two tables.</p>
<p>To illustrate, this is what a simple <code>LEFT JOIN</code> without any calculations or aggregations would look like:</p>


    <a href="https://www.simoahava.com/amp/images/2019/09/left-join-example.jpg" title="LEFT JOIN example">
  
    <amp-img src="https://www.simoahava.com/amp/images/2019/09/left-join-example.jpg" layout="responsive" alt="LEFT JOIN example" height="347" width="774"></amp-img>
  
    </a>
  

<p>Here you can see that on rows <strong>1</strong>, <strong>9</strong>, and <strong>10</strong> there was no match for the <code>user_pseudo_id</code> in the <code>engaged_users</code> table. This means that the user who dispatched this pageview was not considered &ldquo;engaged&rdquo; in the date range selected for analysis.</p>
<p>If you&rsquo;re wondering what <code>COUNTIF</code> does, then check out these two statements detail:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">COUNTIF</span><span class="p">(</span>
  <span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">engaged_users_visited</span><span class="p">,</span>

<span class="n">COUNTIF</span><span class="p">(</span>
  <span class="n">t2</span><span class="p">.</span><span class="n">user_pseudo_id</span> <span class="k">IS</span> <span class="k">NULL</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">not_engaged_users_visited</span></code></pre></div>
<p>The first one increments the <code>engaged_users_visited</code> counter by one for all the rows where the user visited the page AND had a row in the <code>engaged_users</code> table.</p>
<p>The second one increments the <code>not_engaged_users_visited</code> counter by one for all the rows where the user visited the page and DID NOT have a row in the <code>engaged_users</code> table.</p>
<p>We can do this because the <code>LEFT JOIN</code> leaves the <code>t2.*</code> columns <code>null</code> in case the user ID from the <code>pageviews_table</code> was not found in the <code>engaged_users_table</code>.</p>

        
          <h2 id="summary">SUMMARY</h2>
<p>Phew!</p>
<p>That wasn&rsquo;t a quick foray into BigQuery after all.</p>
<p>However, if you already possess a rudimentary understanding of SQL (and if you don&rsquo;t, just take a look at the <a href="https://mode.com/sql-tutorial/">Mode Analytics</a> tutorial), then the most complex things you need to wrap your head around are the ways in which BigQuery leverages its unique columnar format.</p>
<p>It&rsquo;s quite different to a relational database, where joins are the most powerful tool in your kit for running analyses against different data structure.</p>
<p>In BigQuery, you need to understand the <a href="#tip-5-unnest-and-cross-join">nested structures and how to <code>UNNEST</code> them</a>. This, for many, is a difficult concept to grasp, but once you consider how <code>UNNEST</code> and <code>CROSS JOIN</code> simply populate the table as if it had been a flat structure all along, it should help you build the queries you want.</p>
<p><a href="#analytic-functions">Analytic functions</a> are arguably the coolest thing since Arnold Schwarzenegger played Mr. Freeze. They let you do aggregations and calculations without having to build a complicated mess of subqueries across all the rows you want to process. We&rsquo;ve only explored a very simple use case here, but in subsequent articles we&rsquo;ll definitely cover these in more detail.</p>
<p>Finally, huge thanks to Pawel for providing the SQL examples and walkthroughs. Simo contributed some enhancements to the queries, but his contribution is mainly editorial. Thus, direct all criticism and suggestions for improvement to him, and him alone.</p>
<p>If you&rsquo;re an analyst working with Google Analytics and thinking about what you should do to improve your skill set, we recommend learning SQL and then going to town on either any one of the copious BigQuery sample datasets out there, or on your very own <a href="https://www.simoahava.com/amp/analytics/enable-bigquery-export-google-analytics-app-web/">App + Web export</a>.</p>
<p>Let us know in the comments if questions arose from this guide!</p>

        
      
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://www.simoahava.com/amp/"></a>
    </figure>
    

    
    
    
        
    
    

    <section class="author">
      <h4>Simo Ahava</h4>
      
        <p>Husband | Father | Analytics developer</p>
      
      <div class="author-meta">
        <span class="author-location icon-location">Espoo, Finland</span>
        <span class="author-link icon-link"><a href="https://www.simoahava.com/">https://www.simoahava.com/</a></span>
      </div>
    </section>


    
    <div class="social">

<amp-social-share type="twitter"
  width="60"
  height="44"> </amp-social-share>





<amp-social-share type="linkedin"
                  width="60"
                  height="44"></amp-social-share>


    <amp-social-share type="facebook"
                      width="60"
                      height="44"></amp-social-share>

</div>


    
  </footer>
</article>

</main>
</div>

</body>
</html>

