

  
    
  


  

<!doctype html>



<html âš¡ lang="en-us" class="no-js">
    <head>

      <meta charset="utf-8">
        <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script><script async custom-element="amp-accordion" src="https://cdn.ampproject.org/v0/amp-accordion-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

<script async src="https://cdn.ampproject.org/v0.js"></script>


<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<style amp-custom>
  .type-simmer {
      padding: 8px;
      background: rgba(179,138,197,0.2);
      box-shadow: 2px 2px 1px #ccc;
      border-radius: 5px;
  }
    /*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.hidden{text-indent:-9999px;visibility:hidden;display:none}.inner{position:relative;width:80%;max-width:710px;margin:0 auto}.vertical{display:table-cell;vertical-align:middle}.site-wrapper{position:relative;z-index:10;min-height:100%;background:#fff;-webkit-transition:-webkit-transform .5s ease;transition:-webkit-transform .5s ease;transition:transform .5s ease;transition:transform .5s ease,-webkit-transform .5s ease}html{font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body,html{height:100%;max-height:100%}body{font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.8rem;line-height:1.75em;color:#3a4145;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1;text-rendering:geometricPrecision}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{-webkit-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-moz-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-o-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;color:#2e2e2e;line-height:1.15em;margin:0 0 .4em;font-family:Open Sans,sans-serif;text-rendering:geometricPrecision}h1{font-size:5rem;letter-spacing:-2px;text-indent:-3px}h2{font-size:3.6rem;letter-spacing:-1px}h3{font-size:3rem}h4{font-size:2.5rem}h5,h6{font-size:2rem}a,a:active,a:hover,a:visited{color:#4a4a4a;-webkit-transition:color .3s ease;transition:color .3s ease}a:active,a:hover{color:#111}dl,ol,p,ul{-webkit-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-moz-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-o-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;margin:0 0 1.75em;text-rendering:geometricPrecision}ol,ul{padding-left:3rem}ol ol,ol ul,ul ol,ul ul{margin:0 0 .4em;padding-left:2em}dl dt{float:left;width:180px;overflow:hidden;clear:left;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd,dl dt{margin-bottom:1em}dl dd{margin-left:200px}li{margin:.4em 0}li li{margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:3.2em 0;padding:0}blockquote{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0 1.75em -2.2em;padding:0 0 0 1.75em;border-left:.4em solid #4a4a4a}blockquote p{margin:.8em 0;font-style:italic}blockquote small{display:inline-block;margin:.8em 0 .8em 1.5em;font-size:.9em;color:#ccc}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:400}mark{background-color:#ffc336}code,tt{padding:1px 3px;font-size:.85em;white-space:pre-wrap;border:1px solid #e3edf3;border-radius:2px}code,pre,tt{font-family:Inconsolata,monospace,sans-serif;background:#f7fafb}pre{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 0 1.75em;border:1px solid #e3edf3;width:100%;padding:10px;font-size:.9em;white-space:pre;overflow:auto;border-radius:3px}pre code,pre tt{font-size:inherit;white-space:pre-wrap;background:transparent;border:none;padding:0}kbd{display:inline-block;margin-bottom:.4em;padding:1px 8px;border:1px solid #ccc;color:#666;text-shadow:#fff 0 1px 0;font-size:.9em;font-weight:700;background:#f4f4f4;border-radius:4px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 1px 0 0 #fff inset;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 1px 0 0 #fff}table{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0;width:100%;max-width:100%;background-color:transparent}table td,table th{padding:8px;line-height:20px;text-align:left;vertical-align:top;border-top:1px solid #efefef}table th{color:#000}table caption+thead tr:first-child td,table caption+thead tr:first-child th,table colgroup+thead tr:first-child td,table colgroup+thead tr:first-child th,table thead:first-child tr:first-child td,table thead:first-child tr:first-child th{border-top:0}table tbody+tbody{border-top:2px solid #efefef}table table table{background-color:#fff}table tbody>tr:nth-child(odd)>td,table tbody>tr:nth-child(odd)>th{background-color:#f6f6f6}table.plain tbody>tr:nth-child(odd)>td,table.plain tbody>tr:nth-child(odd)>th{background:transparent}.fluid-width-video-wrapper,iframe{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe{margin:0}.main-header{position:relative;display:table;width:100%;height:100vh;margin-bottom:5rem;text-align:center;background:#222 no-repeat 50%;background-size:cover;overflow:hidden}.main-header.cover{background-image:url("https://www.simoahava.com/images/maisema.jpg")}.main-header.list-cover{background-image:url("/")}.main-header .inner{width:80%}.main-header a.bloglogo{text-decoration:none}.main-header a.bloglogo .icon-facebook,.main-header a.bloglogo .icon-github,.main-header a.bloglogo .icon-google-plus,.main-header a.bloglogo .icon-instagram,.main-header a.bloglogo .icon-linkedin,.main-header a.bloglogo .icon-pinterest,.main-header a.bloglogo .icon-twitter{color:#fff;font-size:2em}.main-nav{position:relative;padding:35px 40px;margin:0 0 30px}.main-nav a{text-decoration:none;font-family:Open Sans,sans-serif}.scroll-down{display:block;position:absolute;z-index:100;bottom:45px;left:50%;font-size:1.5em;text-align:center;-webkit-animation:bounce 4s 2s infinite;animation:bounce 4s 2s infinite}.scroll-down:hover{color:#fff;-webkit-animation:none;animation:none}.home-template .main-header:after{display:block;content:" ";width:150px;height:130px;border-radius:100%;position:absolute;bottom:0;left:50%;margin-left:-75px;background:radial-gradient(ellipse at center,rgba(0,0,0,.15) 0,transparent 70%,transparent 100%)}.archive-template .main-header:after,.archive-template .scroll-down,.no-cover.main-header:after,.no-cover .scroll-down{display:none}.blog-logo{display:block;float:left}.blog-logo img{display:block;padding:1px 0 5px;width:auto}.blog-logo img,.menu-button{-webkit-box-sizing:border-box;box-sizing:border-box;height:38px}.menu-button{display:inline-block;float:right;padding:0 15px;border:1px solid #bfc8cd;opacity:1;color:#9eabb3;text-align:center;font-size:12px;text-transform:uppercase;line-height:35px;white-space:nowrap;border-radius:3px;background:rgba(0,0,0,.1);-webkit-transition:all .5s ease;transition:all .5s ease}.menu-button:focus{outline:0}.menu-button .fa-bars{font-size:12px;margin-right:6px}.main-nav.overlay{position:absolute;top:0;left:0;right:0;height:70px;border:none;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(transparent));background:linear-gradient(180deg,rgba(0,0,0,.2) 0,transparent)}.no-cover .main-nav.overlay,.no-cover .menu-button{background:none}.main-nav.overlay a{color:#fff}.main-nav.overlay .menu-button{border-color:hsla(0,0%,100%,.6)}.cover .main-nav.overlay a.menu-button:hover{color:#222;border-color:#fff;background:#fff}.menu-button:hover,.no-cover .main-nav.overlay .menu-button:hover{border-color:#555;color:#555}.page-title{margin:10px 0;font-size:5rem;letter-spacing:-1px;font-weight:700;font-family:Open Sans,sans-serif;color:#fff}.page-description{margin:0;font-size:2rem;line-height:1.5em;font-weight:400;font-family:Merriweather,serif;letter-spacing:.01rem;color:hsla(0,0%,100%,.8)}.no-cover.main-header{min-height:160px;max-height:40vh;background:#f5f8fa}.no-cover .page-title{color:rgba(0,0,0,.8)}.no-cover .page-description{color:rgba(0,0,0,.5)}.no-cover .main-nav.overlay .menu-button{color:rgba(0,0,0,.4);border-color:rgba(0,0,0,.3)}.main-header-content .page-title{-webkit-animation:fade-in-down .6s;animation:fade-in-down .6s;-webkit-animation-delay:.2s;animation-delay:.2s}.main-header-content .page-description{-webkit-animation:fade-in-down .9s;animation:fade-in-down .9s;-webkit-animation-delay:.1s;animation-delay:.1s}.post{position:relative;width:80%;max-width:710px;margin:4rem auto;padding-bottom:4rem;border-bottom:1px solid #ebf2f6;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.post-header{padding-bottom:10px}.post:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}body:not(.post-template) .post-title{font-size:3.6rem}.post-title a{text-decoration:none}.post-excerpt p{margin:0;font-size:.9em;line-height:1.7em}.read-more{font-size:.8em;text-decoration:none;font-style:italic}.post-meta{display:block;margin:1.75rem 0 0;font-family:Open Sans,sans-serif;font-size:1.5rem;line-height:2.2rem;color:#9eabb3}.author-thumb{width:24px;height:24px;float:left;margin-right:9px;border-radius:100%}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.user-meta{position:relative;padding:.3rem 40px 0 100px;min-height:77px}.post-date{display:inline-block;margin-left:8px;padding-left:12px;border-left:1px solid #d5dbde;text-transform:uppercase;font-size:1.3rem;white-space:nowrap}.user-image{position:absolute;top:0;left:0}.user-name{display:block;font-weight:700}.user-bio{display:block;max-width:440px;font-size:1.4rem;line-height:1.5em}.publish-meta{position:absolute;top:0;right:0;padding:4.3rem 0 4rem;text-align:right}.publish-heading{display:block;font-weight:700}.publish-date{display:block;font-size:1.4rem;line-height:1.5em}figure.no-margin{margin:0}figure.center{margin-left:auto;margin-right:auto}.amp-image-lightbox-caption{text-align:center;font-size:.8em}@media only screen and (min-width:501px){figure.polaroid:after,figure.polaroid:before{content:"";position:absolute;z-index:-2;bottom:10px;width:50%;height:20%;max-width:480px;-webkit-box-shadow:0 15px 10px rgba(0,0,0,.7);box-shadow:0 15px 10px rgba(0,0,0,.7)}figure.polaroid:after{right:10px;left:auto;-webkit-transform:rotate(3deg);transform:rotate(3deg)}figure.polaroid:before{left:10px;right:auto;-webkit-transform:rotate(-3deg);transform:rotate(-3deg)}figure.polaroid{width:450px;position:relative;padding:15px;border:none;background:#fff;-webkit-box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset;box-shadow:0 1px 4px rgba(0,0,0,.3),inset 0 0 40px rgba(0,0,0,.1);border-radius:4px;margin-bottom:1.5em;max-width:100%}figure.polaroid div[fallback]{border:none;margin:0;padding:0}figure.polaroid amp-img{display:block;outline:1px solid #ccc;padding:0;margin:0}figure.polaroid figcaption{font-size:1.3em;font-weight:400;font-family:Kaushan Script,cursive;text-align:right;padding:.8em .5em .4em}}@media only screen and (max-width:501px){figure.polaroid{background:#fff;border-radius:1px;margin-bottom:1em}figure.polaroid figcaption{font-size:.8em;font-style:italic;text-align:center;border-top:1px solid #d3d3d3;border-bottom:1px solid #d3d3d3;margin-top:.5em;padding:.2em}}.main-header.cover .main-header-content .social-link a,.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.main-header.cover .main-header-content .social-link a:visited,.scroll-down a,.scroll-down a:active,.scroll-down a:hover,.scroll-down a:visited{text-decoration:none;font-size:2em}.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.scroll-down a:active,.scroll-down a:hover{color:#fff}.main-header.no-cover .main-header-content .social-link a,.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover,.main-header.no-cover .main-header-content .social-link a:visited{text-decoration:none;font-size:2em;color:#a2a2a2}.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover{color:#000}.post-template .post-header{margin-bottom:3.4rem}.post-template .post-title{margin-bottom:0}.post-template .post-meta{margin:0}.post-template .post-date{padding:0;margin:0;border:none}.post-template .content{overflow:hidden}.post-template .post{margin-top:0;border-bottom:none;padding-bottom:0}.post-template .post:after{display:none}.post-content{text-align:justify}.post-footer{position:relative;margin:6rem 0 0;padding:6rem 0 0;border-top:1px solid #ebf2f6}.post-footer h4{font-size:1.8rem;margin:0}.post-footer p{margin:1rem 0;font-size:1.4rem;line-height:1.75em}.author-meta{padding:0;margin:0;list-style:none;font-size:1.4rem;line-height:1;font-style:italic}.author-meta,.author-meta a{color:#9eabb3}.author-meta a:hover{color:#111}.post-footer .author{margin-right:180px}.post-footer h4 a{color:#2e2e2e;text-decoration:none}.post-footer h4 a:hover{text-decoration:underline}.post-footer .share{position:absolute;top:6rem;right:0;width:180px}.post-footer .share a{font-size:1.8rem;display:inline-block;margin:1rem 1.6rem 1.6rem 0;color:#bbc7cc;text-decoration:none}.post-footer .share a:hover{color:#50585d}.post-head.main-header{height:65vh;min-height:180px}.no-cover.post-head.main-header{height:85px;min-height:0;margin-bottom:0;background:transparent}.author-head.main-header,.tag-head.main-header{height:40vh;min-height:180px}.no-cover.author-head.main-header{height:10vh;min-height:100px;background:transparent}.author-profile{padding:0 15px 5rem;border-bottom:1px solid #ebf2f6;text-align:center}.author-profile:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.author-image{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;top:-56px;left:50%;margin-left:-40px;width:80px;height:80px;border-radius:100%;overflow:hidden;padding:6px;background:#fff;z-index:2;-webkit-box-shadow:#e7eef2 0 0 0 1px;box-shadow:0 0 0 1px #e7eef2}.author-image .img{position:relative;display:block;width:100%;height:100%;background-size:cover;background-position:50%;border-radius:100%;background-image:url("https://www.simoahava.com/images/simo.png")}.author-profile .author-image{position:relative;left:auto;top:auto;width:120px;height:120px;padding:3px;margin:-100px auto 0;-webkit-box-shadow:none;box-shadow:none}.author-title{margin:1.5rem 0 1rem}.author-bio{font-size:1.8rem;line-height:1.5em;font-weight:200;color:#50585d;letter-spacing:0;text-indent:0}.author-meta{margin:1.6rem 0}.author-profile .author-meta{margin:2rem 0;font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.7rem}.author-meta span{display:inline-block;margin:0 2rem 1rem 0;word-wrap:break-word}.author-meta a{text-decoration:none}.archive-template .author-profile .author-meta{display:none}@-webkit-keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@-webkit-keyframes bounce{0%,10%,25%,40%,50%{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}20%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}30%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}40%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}60%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}#sidebar{background:rgba(0,0,0,.7);text-align:left;overflow-y:auto;font-family:Open Sans,Verdana,sans-serif;font-weight:700;font-size:11px;color:#909090;width:400px}#sidebar .nav-title{position:absolute;top:45px;left:30px;font-size:1.5em;font-weight:100;text-transform:uppercase;color:#fff}#sidebar .nav-section{color:#d8d8d8}#sidebar .nav-close{position:absolute;top:38px;right:25px;width:20px;height:20px;padding:0;font-size:10px}#sidebar .nav-close:focus{outline:0}#sidebar .nav-close:after,#sidebar .nav-close:before{content:"";position:absolute;top:0;width:20px;height:1px;background:#969696;top:15px;-webkit-transition:background .15s ease;transition:background .15s ease}#sidebar .nav-close:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}#sidebar .nav-close:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}#sidebar .nav-close:hover:after,#sidebar .nav-close:hover:before{background:#fff}#sidebar amp-accordion .nav-section{margin:.4em 0 .2em;background:none;border:none;font-size:2rem}#sidebar amp-accordion section[expanded] .nav-section .fa{width:1ch}#sidebar amp-accordion section[expanded] .nav-section .section-open{display:inline-block}#sidebar amp-accordion section[expanded] .nav-section .section-close{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-open{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-close{display:inline-block}#sidebar ul{padding:90px 9% 5%;list-style:none;counter-reset:item}#sidebar li:before{display:block;float:right;padding-right:4%;padding-left:5px;text-align:right;font-size:1.2rem;vertical-align:bottom;color:#b8b8b8;content:counter(item,lower-roman);counter-increment:item}#sidebar li{margin:0}#sidebar li a{text-decoration:none;line-height:1.4;font-size:1.4rem;display:block;padding:.6rem 4%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#sidebar li a:after{display:inline-block;content:" ...............................................................";color:hsla(0,0%,100%,.2);margin-left:5px}#sidebar .nav-current:before{color:#fff}#sidebar .nav-current a:after{content:" ";border-bottom:1px solid hsla(0,0%,100%,.5);width:100%;height:1px}#sidebar a,#sidebar a:active,#sidebar a:hover,#sidebar a:visited{color:#b8b8b8}#sidebar a:active,#sidebar a:hover,#sidebar li.nav-current a{color:#fff}.subscribe-button{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;bottom:30px;left:30px;right:30px;height:38px;padding:0 20px;text-align:center;font-size:12px;font-family:Open Sans,sans-serif;text-transform:uppercase;text-decoration:none;line-height:35px;border-radius:3px;background:#fff;-webkit-transition:all .3s ease;transition:all .3s ease}.subscribe-button:before{font-size:9px;margin-right:6px}.pagination{position:relative;width:80%;max-width:710px;margin:4rem auto;font-family:Open Sans,sans-serif;font-size:1.3rem;color:#9eabb3;text-align:center}.pagination a{color:#9eabb3;-webkit-transition:all .2s ease;transition:all .2s ease}.newer-posts,.older-posts{position:absolute;display:inline-block;padding:0 15px;border:1px solid #bfc8cd;text-decoration:none;border-radius:4px;-webkit-transition:border .3s ease;transition:border .3s ease}.older-posts{right:0}.page-number{display:inline-block;padding:2px 0;min-width:100px}.newer-posts{left:0}.newer-posts:hover,.older-posts:hover{color:#889093;border-color:#98a0a4}.extra-pagination{display:none;border-bottom:1px solid #ebf2f6}.extra-pagination:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.extra-pagination .pagination{width:auto}.archive-template .main-header{max-height:30vh}.archive-template .extra-pagination{display:block}.site-footer{position:relative;margin:8rem 0 0;padding:.5rem 15px;font-family:Open Sans,sans-serif;font-size:1rem;line-height:1.75em;color:#bbc7cc}.site-footer a{color:#bbc7cc;text-decoration:none;font-weight:700}.site-footer a:hover{color:#50585d}.poweredby{float:right;text-align:right}.copyright,.poweredby{display:block;width:45%}.copyright{float:left}@media only screen and (max-width:900px){blockquote{margin-left:0}.main-header{-webkit-box-sizing:border-box;box-sizing:border-box;height:auto;min-height:240px;height:60vh;padding:15% 0}.home-template .main-header:after,.scroll-down{display:none}.archive-template .main-header{min-height:180px;padding:10% 0}.blog-logo img{padding:4px 0}.page-title{font-size:4rem;letter-spacing:-1px}.page-description{font-size:1.8rem;line-height:1.5em}.post{font-size:.95em}body:not(.post-template) .post-title{font-size:3.2rem}hr{margin:2.4em 0}ol,ul{padding-left:2em}h1{font-size:4.5rem;text-indent:-2px}h2{font-size:3.6rem}h3{font-size:3.1rem}h4{font-size:2.5rem}h5{font-size:2.2rem}h6{font-size:1.8rem}.author-profile{padding-bottom:4rem}.author-profile .author-bio{font-size:1.6rem}.author-meta span{display:block;margin:1.5rem 0}.author-profile .author-meta span{font-size:1.6rem}.post-head.main-header{height:45vh}.author-head.main-header,.tag-head.main-header{height:30vh}.no-cover.post-head.main-header{height:55px;padding:0}.no-cover.author-head.main-header{padding:0}}@media only screen and (max-width:500px){.main-header{margin-bottom:15px;height:40vh}.no-cover.main-header{height:30vh}.archive-template .main-header{max-height:20vh;min-height:160px;padding:10% 0}.main-nav{margin-bottom:2rem}.blog-logo,.main-nav{padding:5px}.blog-logo img{height:30px}.menu-button{padding:0 5px;border-radius:0;border-color:transparent;color:#2e2e2e;background:transparent}.menu-button:hover{color:#2e2e2e;border-color:transparent;background:none}body.nav-opened .menu-button{background:none;border:transparent}.main-nav.overlay a:hover{color:#fff;border-color:transparent;background:transparent}.no-cover .main-nav.overlay{background:none}.no-cover .main-nav.overlay .menu-button{border:none}.main-nav.overlay .menu-button{border-color:transparent}.nav-title{top:25px}.nav-close{position:absolute;top:18px}.nav ul{padding:60px 9% 5%}.inner,.pagination{width:auto;margin:2rem auto}.post{width:auto;margin:2rem 16px;padding-bottom:2rem;line-height:1.65em}.post-template .post-header{margin-bottom:2rem}.post-template .post-date{display:inline-block}hr{margin:1.75em 0}dl,ol,p,ul{font-size:.95em;margin:0 0 2.5rem}.page-title{font-size:3rem}.post-excerpt p{font-size:.85em}.page-description{font-size:1.6rem}h1,h2,h3,h4,h5,h6{margin:0 0 .3em}h1{font-size:2.8rem;letter-spacing:-1px}h2{font-size:2.4rem;letter-spacing:0}h3{font-size:2.1rem}h4{font-size:1.9rem}h5,h6{font-size:1.8rem}body:not(.post-template) .post-title{font-size:2.5rem}.post-template .post{padding-bottom:0;margin-bottom:0}.post-template .site-footer{margin-top:0}.post-meta{font-size:1.3rem;margin-top:1rem}.post-footer{padding:5rem 0 3rem;text-align:center}.post-footer .author{margin:0 0 2rem;padding:0 0 1.6rem;border-bottom:1px dashed #ebf2f6}.post-footer .share{position:static;width:auto}.post-footer .share a{margin:1.4rem .8rem 0}.author-meta li{float:none;margin:0;line-height:1.75em}.author-meta li:before{display:none}.newer-posts,.older-posts{position:static;margin:10px 0}.page-number{display:block}.site-footer{margin-top:3rem}.author-profile{padding-bottom:2rem}.post-head.main-header{height:30vh}.author-head.main-header,.tag-head.main-header{height:20vh}.author-profile .author-image{margin-top:-70px}.author-profile .author-meta span{font-size:1.4rem}.archive-template .main-header .page-description{display:none}}header.post-header{line-height:1.1em}.post-content amp-img{max-width:100%;height:auto;border:1px solid #777;-webkit-box-shadow:5px 5px 2px rgba(0,0,0,.4);box-shadow:5px 5px 2px rgba(0,0,0,.4);margin-bottom:20px}.social-link a{color:#dfdfdf}pre.chroma{text-align:left}.badge-primary{color:#fff;background-color:#007bff}.badge{display:inline-block;padding:.25em .4em;font-size:80%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:middle;border-radius:.25rem}
    

</style>

        <link rel="canonical" href="https://www.simoahava.com/analytics/join-ga4-google-ads-data-in-google-bigquery/">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

        

        <link href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,700,700i|Open+Sans:400,700|Kaushan+Script" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

        <meta name="theme-color" content="#ffffff" />

        
        <title>Join Google Ads and GA4 Data in Google BigQuery | Simo Ahava's blog</title>
        



  

<meta property="og:title" content="Join Google Ads and GA4 Data in Google BigQuery" />
<meta name="description" content="In this article, you&#39;ll learn how to combine data from Google Analytics 4 and Google Ads using an automated data pipeline that feeds the results into a Google BigQuery data warehouse." />
<meta property="og:description" content="In this article, you&#39;ll learn how to combine data from Google Analytics 4 and Google Ads using an automated data pipeline that feeds the results into a Google BigQuery data warehouse." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.simoahava.com/amp/analytics/join-ga4-google-ads-data-in-google-bigquery/" />

	  <meta property="og:image" content="https://www.simoahava.com/images/2023/11/join-ga4-google-ads-data-in-google-bigquery.jpg">
      <meta name="twitter:image" content="https://www.simoahava.com/images/2023/11/join-ga4-google-ads-data-in-google-bigquery.jpg">
    


    
        <meta property="article:published_time" content="2023-11-30T05:00:00Z"/>
    
    
        <meta property="article:modified_time" content="2023-11-30T05:00:00Z"/>
    




    


    <meta property="og:site_name" content="Simo Ahava&#39;s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development." />









    
        
        
            
        
        
        
    
    
    
        
            <meta property="article:section" content="Analytics" />
        
    
    
        
            <meta property="article:tag" content="google cloud platform" />
        
            <meta property="article:tag" content="r" />
        
            <meta property="article:tag" content="data engineering" />
        
            <meta property="article:tag" content="google analytics 4" />
        
    







    
        <meta name="twitter:card" content="summary"/>
    

    
        
        
            
        
        
        
    



<meta itemprop="name" content="Join Google Ads And GA4 Data In Google BigQuery">
<meta itemprop="description" content="In this article, you&#39;ll learn how to combine data from Google Analytics 4 and Google Ads using an automated data pipeline that feeds the results into a Google BigQuery data warehouse.">
<meta itemprop="datePublished" content="2023-11-30T07:00:00&#43;02:00" />
<meta itemprop="dateModified" content="2023-11-30T07:00:00&#43;02:00" />
<meta itemprop="wordCount" content="7248">



<meta itemprop="keywords" content="google cloud platform,r,data engineering,google analytics 4," />
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Simo Ahava\u0027s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.",
    
    "url": "https:\/\/www.simoahava.com\/amp\/"
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Join Google Ads And GA4 Data In Google BigQuery | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2023\/11\/Article-mage-digital-analytics.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/amp\/analytics\/join-ga4-google-ads-data-in-google-bigquery\/",
  "datePublished": "2023-11-30T07:00:00\u002b02:00",
  "dateModified": "2023-11-30T07:00:00\u002b02:00",
  "description": "In this article, you\u0027ll learn how to combine data from Google Analytics 4 and Google Ads using an automated data pipeline that feeds the results into a Google BigQuery data warehouse.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>












    </head>
<body>

<amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-5BH2HM&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics>
  <amp-sidebar id="sidebar" layout="nodisplay" side="right">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close" on="tap:sidebar.close" role="button" tabindex="1">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/categories/gtm-tips/">GTM Tips</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/about-simo-ahava/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/tools/">Tools</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/blog-statistics/">Blog Statistics</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/upcoming-talks/">Upcoming Talks</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/custom-templates/">Templates</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/newsletter/">Newsletter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/">Full (non-AMP) site</a>
            </li>
        
        <amp-accordion>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Categories
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/gtm-tips/">gtm-tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-development/">web-development</a></li>
                
                </div>
            </section>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Tags
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ab-testing/">ab-testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/accelerated-mobile-pages/">accelerated-mobile-pages</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ad-blocker/">ad-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adblocker/">adblocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/add-on/">add-on</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adwords/">adwords</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/agile/">agile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amazon/">amazon</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amp/">amp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/android/">android</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/api/">api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app/">app</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app&#43;web/">app&#43;web</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app-engine/">app-engine</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/approval/">approval</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps/">apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps-script/">apps-script</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/array/">array</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/attribution/">attribution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audience-design/">audience-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audit/">audit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-event-tracking/">auto-event-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-link-domains/">auto-link-domains</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/aws/">aws</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/azure/">azure</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/basketball/">basketball</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/beforeunload/">beforeunload</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/best-practices/">best-practices</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/big-data/">big-data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bigquery/">bigquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/blogger/">blogger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bounce-rate/">bounce-rate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/built-in-variables/">built-in-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/calculated-metrics/">calculated-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/callback/">callback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/campaign-tracking/">campaign-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/celebration/">celebration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/change-history/">change-history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome/">chrome</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome-extension/">chrome-extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-tracking/">click-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-variables/">click-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clickstream/">clickstream</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-id/">client-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-template/">client-template</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clientid/">clientid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-functions/">cloud-functions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-run/">cloud-run</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cms/">cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cname/">cname</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conferences/">conferences</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent/">consent</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent-mode/">consent-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container/">container</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-export/">container-export</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-snippet/">container-snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content/">content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-analysis/">content-analysis</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-blocker/">content-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-engagement/">content-engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-grouping/">content-grouping</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management-system/">content-management-system</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-security-policy/">content-security-policy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-strategy/">content-strategy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/context/">context</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversion/">conversion</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversions-api/">conversions-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookie/">cookie</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookiedomain/">cookiedomain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookies/">cookies</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/core-web-vitals/">core-web-vitals</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/creative/">creative</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain/">cross-domain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain-tracking/">cross-domain-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/csp/">csp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css/">css</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css-selectors/">css-selectors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom/">custom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimension/">custom-dimension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimensions/">custom-dimensions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html/">custom-html</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tag/">custom-html-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tags/">custom-html-tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-javascript/">custom-javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-metrics/">custom-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-templates/">custom-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/customtask/">customtask</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dan-wilkerson/">dan-wilkerson</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dashboard/">dashboard</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data/">data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-collection/">data-collection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-engineering/">data-engineering</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer/">data-layer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer-variable/">data-layer-variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-model/">data-model</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-quality/">data-quality</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/datalayer/">datalayer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debug/">debug</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debugging/">debugging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/definition-of-success/">definition-of-success</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer/">developer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer-tools/">developer-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/development/">development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/document.write/">document.write</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dom/">dom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/duplicate/">duplicate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dynamic-content/">dynamic-content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/easter-egg/">easter-egg</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecomemrce/">ecomemrce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecommerce/">ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/education/">education</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/element-visibility/">element-visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/engagement/">engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/enhanced-ecommerce/">enhanced-ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/enrichment/">enrichment</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/environments/">environments</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/errors/">errors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event/">event</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listener/">event-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listeners/">event-listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/eventcallback/">eventcallback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/events/">events</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/excel/">excel</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exceptions/">exceptions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/experimentation/">experimentation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exploit/">exploit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/extension/">extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/facebook/">facebook</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/false/">false</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/family/">family</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fields-to-set/">fields-to-set</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firebase/">firebase</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firestore/">firestore</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firing-rules/">firing-rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/folders/">folders</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form/">form</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form-tracking/">form-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/format-value/">format-value</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/forms/">forms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fpid/">fpid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga-spy/">ga-spy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga4/">ga4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gcp/">gcp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gdpr/">gdpr</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google/">google</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-ads/">google-ads</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics/">google-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-4/">google-analytics-4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-settings/">google-analytics-settings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-bigquery/">google-bigquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud-platform/">google-cloud-platform</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-optimize/">google-optimize</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-sheets/">google-sheets</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag/">google-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag-manager/">google-tag-manager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-trends/">google-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/googletagmanager/">googletagmanager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/governance/">governance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag/">gtag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag.js/">gtag.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-sonar/">gtm-sonar</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-tools/">gtm-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm360/">gtm360</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtmtips/">gtmtips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guest-post/">guest-post</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guide/">guide</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hack/">hack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history/">history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-change-trigger/">history-change-trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-listener/">history-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hugo/">hugo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/iframe/">iframe</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/intelligent-tracking-prevention/">intelligent-tracking-prevention</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/internal-traffic/">internal-traffic</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ios/">ios</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ip/">ip</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/it-department/">it-department</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/itp/">itp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/javascript/">javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/jquery/">jquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/klipfolio/">klipfolio</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/learning/">learning</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lighthouse/">lighthouse</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/links/">links</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/listeners/">listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/local/">local</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/localstorage/">localstorage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lookup-table/">lookup-table</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/macros/">macros</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketer/">marketer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketing/">marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/measurement-protocol/">measurement-protocol</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/meta-description/">meta-description</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/metrics/">metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/migration/">migration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mixcloud/">mixcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mobile/">mobile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modern-cms/">modern-cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modular-architecture/">modular-architecture</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/monitor/">monitor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/navigation/">navigation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/netbooster/">netbooster</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/new-ui/">new-ui</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/node.js/">node.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/nodejs/">nodejs</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/non-technical/">non-technical</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/open-source/">open-source</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/opt-out/">opt-out</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/owasp/">owasp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-load-time/">page-load-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-timings/">page-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/parameter-reporting/">parameter-reporting</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/penguin/">penguin</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/performance/">performance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/permissions/">permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/persistence/">persistence</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal-experience/">personal-experience</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/php/">php</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pii/">pii</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pitch/">pitch</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/piwik-pro/">piwik-pro</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/plugins/">plugins</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/poetry/">poetry</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/postmessage/">postmessage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ppc/">ppc</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview/">preview</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview-mode/">preview-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/process/">process</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/proxy/">proxy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/public-speaking/">public-speaking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/query-string/">query-string</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/queue-time/">queue-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/r/">r</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/race-condition/">race-condition</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/reaktor/">reaktor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/recaptcha/">recaptcha</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/referral/">referral</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/regular-expression/">regular-expression</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/release/">release</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/resources/">resources</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/rules/">rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/safari/">safari</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sales/">sales</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/samesite/">samesite</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/schema/">schema</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/score-card/">score-card</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/scroll-depth/">scroll-depth</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search/">search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-api/">search-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-engine-optimization/">search-engine-optimization</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-trends/">search-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/security/">security</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/selection/">selection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo-report/">seo-report</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/serp/">serp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/server-side/">server-side</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/server-side-tagging/">server-side-tagging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/session/">session</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sessions/">sessions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sgtm/">sgtm</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/shopify/">shopify</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/simmer/">simmer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/single-page-apps/">single-page-apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-search/">site-search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-speed/">site-speed</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/slack/">slack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snippet/">snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snowplow/">snowplow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/social-interactions/">social-interactions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/soundcloud/">soundcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/spa/">spa</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/splash-page/">splash-page</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/static-site/">static-site</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/still-running/">still-running</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/storage/">storage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/support/">support</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/swift/">swift</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/syntax-highlight/">syntax-highlight</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solution/">tag-management-solution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solutions/">tag-management-solutions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-sequencing/">tag-sequencing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-templates/">tag-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tags/">tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tasks/">tasks</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/technical-marketing/">technical-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/technique/">technique</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/test/">test</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/testing/">testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timer/">timer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timings/">timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tips/">tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tools/">tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker/">tracker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker-object/">tracker-object</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracking-protections/">tracking-protections</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/training/">training</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/transformations/">transformations</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger/">trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger-groups/">trigger-groups</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/triggers/">triggers</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/troubleshoot/">troubleshoot</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/undefined/">undefined</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/universal-analytics/">universal-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-id/">user-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-interface/">user-interface</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-permissions/">user-permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-timings/">user-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/v2/">v2</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable/">variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable-templates/">variable-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variables/">variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/videos/">videos</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/visibility/">visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/wcag/">wcag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/weather/">weather</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-development/">web-development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/webkit/">webkit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/website-redesign/">website-redesign</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workflow/">workflow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workspaces/">workspaces</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/youtube/">youtube</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/zones/">zones</a></li>
                
                </div>
            </section>
        
        </amp-accordion>
    </ul>
</amp-sidebar>

<div class="site-wrapper">



    <header class="main-header post-head no-cover">
    <nav class="main-nav clearfix">


    <a class="menu-button" on="tap:sidebar.toggle" role="button"><i class="fa fa-bars" aria-hidden="true"></i><span class="menu-button-label">Menu</span></a>


  </nav>
</header>



<main class="content" role="main">

  <article class="post type-post">

    <header class="post-header">
        <h1 class="post-title">Join Google Ads and GA4 Data in Google BigQuery</h1>
        <small>In this article, you&#39;ll learn how to combine data from Google Analytics 4 and Google Ads using an automated data pipeline that feeds the results into a Google BigQuery data warehouse.</small>

        <section class="post-meta">
            


    




    <amp-img class="author-thumb" src="https://www.simoahava.com/images/simo.png" layout="fixed" width="24" height="24" alt="Author image"></amp-img>

Simo Ahava

in
    
        <a href="https://www.simoahava.com/amp/categories/analytics">Analytics</a>
    


on
    
        <a href="https://www.simoahava.com/amp/tags/google-cloud-platform">#google cloud platform</a>
    
        , <a href="https://www.simoahava.com/amp/tags/r">#r</a>
    
        , <a href="https://www.simoahava.com/amp/tags/data-engineering">#data engineering</a>
    
        , <a href="https://www.simoahava.com/amp/tags/google-analytics-4">#google analytics 4</a>
    


<time class="post-date" datetime="2023-11-30T07:00:00&#43;02:00">
    30 November 2023
</time>


<span class="post-date"><a href="https://www.simoahava.com/analytics/join-ga4-google-ads-data-in-google-bigquery/">Non-AMP version</a></span>


        </section>
    </header>

    <section class="post-content">
      
        
        
          <p>I am fortunate to share another <strong>guest post</strong> by <a href="https://www.linkedin.com/in/arben-kqiku-301457117/">Arben Kqiku</a>, Digital Analyst at <a href="https://www.linkedin.com/company/assura-ch/">Assura</a>.</p>
<p>Last time, Arben graced this blog with a <a href="https://www.simoahava.com/amp/analytics/content-analysis-using-ga4-bigquery-r-google-sheets-data-studio/">comprehensive love letter to R</a> as an example of the power of this programming language.</p>
<p>This time, he&rsquo;ll add even more fancy tools to the toolkit to help you build a <strong>data pipeline</strong> in the Google Cloud Platform to join your Google Ads and Google Analytics 4 data together.</p>
<!-- raw HTML omitted -->

        
        <article class="post type-simmer">
    <header class="post-header">
        <h2 class="post-title"><a href="https://www.simoahava.com/amp/newsletter/">The Simmer Newsletter</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
	Follow <a href="https://www.teamsimmer.com/newsletter/">this link</a> to subscribe to the <strong>Simmer Newsletter</strong>! Stay up-to-date with the latest content from Simo Ahava and the <a href="https://www.teamsimmer.com/">Simmer online course platform</a>.
      </p>
      </section>
</article>

        
          <h2 id="goal-of-this-article">Goal of this article</h2>
<p>My goal for this article is twofold; first, I want to show my fellow R users that it is possible and fun to use R in a production environment! R is sometimes seen as a second-class citizen compared to Python, but in my experience, R has consistently proven effective in addressing all my data challenges at work.</p>
<p>Second, I want to show my fellow digital analysts the power of complementing GTM and GA4 with additional tools.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/Article-mage-digital-analytics.jpg" title="Architecture diagram of what we&#39;ll build">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/Article-mage-digital-analytics.jpg" layout="responsive" alt="Architecture diagram of what we&#39;ll build" height="775" width="1288"></amp-img>
  
    </a>
  

<p>Above you can see an architectural overview of what we&rsquo;ll build today.</p>

        
          <h2 id="what-am-i-trying-to-solve">What am I trying to solve?</h2>
<p>As a digital analyst, I often need to combine data from different sources and display it in a dashboard.</p>
<p>For instance, clients run campaigns on platforms like <strong>Google Ads</strong> and <strong>Meta Ads</strong>, and they want to understand the impact of each channel or even individual campaigns.</p>
<p>The challenge is that each channel tends to attribute conversions mostly to itself. This isn&rsquo;t intentional; it&rsquo;s just that each channel operates independently and can&rsquo;t see the contributions of others.</p>
<p>To address this, we usually use conversion data from a third-party source, like <strong>Google Analytics</strong>, and combine it with other data such as impressions, clicks, and cost from the advertising channels. This helps us calculate the cost per conversion for each channel more accurately.</p>
<p>I know <em>multi-touch attribution</em> isn&rsquo;t perfect because it often doesn&rsquo;t consider view-through conversions. However, it&rsquo;s the best method we have for day-to-day operations. While <strong>Marketing Mix Modeling</strong> is an option, it requires a lot of data over a long period. So, for practical purposes, multi-touch attribution remains our best tool. As the saying goes, <code>all models are wrong, but some models are useful</code>.</p>

        
          <h2 id="what-are-the-requirements-of-the-solution-well-build">What are the requirements of the solution we&rsquo;ll build?</h2>
<p>The pipeline we&rsquo;ll build today needs to address the following things:</p>
<p><strong>Accessibility</strong>: Make sure we can easily get data from different sources, such as Google Ads, Meta Ads, and GA4.</p>
<p><strong>Data integration</strong>: Combine data from different sources accurately.</p>
<p><strong>Storage</strong>: Create a data warehouse in <strong>Google BigQuery</strong> for the joined data and make it accessible to data visualization tools.</p>
<p><strong>Maintenance</strong>: Find a way to automate these steps without needing manual intervention. That way stakeholders will have access to almost real-time data.</p>

        
          <h2 id="the-awesome-things-youll-learn">The awesome things you&rsquo;ll learn</h2>
<ol>
<li>How to create a Google Cloud project.</li>
<li>How to set up a virtual machine.</li>
<li>How to access your virtual machine remotely.</li>
<li>How to install <a href="https://mage.ai">Mage.ai</a> on the virtual machine to handle the automation.</li>
<li>How to retrieve data from the GA4 API in a production environment.</li>
<li>How to retrieve data from the Google Ads API in a production environment.</li>
<li>How to export data to Google BigQuery in a production environment.</li>
<li>How to schedule a data pipeline that automatically updates every 5 minutes.</li>
</ol>

        
          <h2 id="tools">Tools</h2>
<h3 id="mageai-and-r">Mage.ai and R</h3>
<p>In my previous company, <a href="https://www.comtogether.com">comtogether</a>, <a href="https://www.linkedin.com/in/casper-crause/">Casper Crause</a> took care of our data engineering needs, and he often did so with Python.</p>
<p>Recently, I needed to automate multiple data pipelines and I had no idea how to do that in R. I thought, well, might as well learn Python. But then, before giving up, I googled one last time <code>Data Engineering in R</code>, and that&rsquo;s when I stumbled on <a href="https://mage.ai">Mage.ai</a>!</p>
<p>The screenshot below comes from Mage. Mage is a data engineering tool that allows you to build your <em>ETL</em> (extract, transform, and load) pipelines. What I love about Mage is that it is easy to use, you can visualize your data pipelines and it supports multiple programming languages: SQL, Python.. and R!</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-ai-example.jpg" title="mage-ai-example.jpg">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-ai-example.jpg" layout="responsive" alt="mage-ai-example.jpg" height="1156" width="1804"></amp-img>
  
    </a>
  

<p>I love R and I am so thankful that <a href="https://www.linkedin.com/in/dangtommy/">Tommy Dang</a> and his team included it in Mage.</p>
<p>Many tools prefer Python since it is more widely adopted for data engineering tasks. Moreover, in a recent workshop on <a href="https://www.youtube.com/watch?v=C0fNc8ZOpSI&amp;t=1324s&amp;ab_channel=DataSlinger">Andreas Kretz&rsquo;s YouTube channel</a>, Tommy mentioned that they are going to include even more programming languages!</p>
<p>In addition to building our pipeline, we&rsquo;ll use Mage to schedule it, as you can see in the example below.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-schedule.jpg" title="Mage scheduler">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-schedule.jpg" layout="responsive" alt="Mage scheduler" height="233" width="1151"></amp-img>
  
    </a>
  

<h3 id="google-cloud-platform-gcp-and-visual-studio-code">Google Cloud Platform (GCP) and Visual Studio Code</h3>
<p>You can run Mage on your local machine or in the cloud.</p>
<p>Obviously, if you run it locally, your computer needs to be on all the time, which is not ideal. Therefore, we&rsquo;ll create a virtual machine (VM) on the <a href="https://cloud.google.com/">Google Cloud Platform</a> and run Mage from there.</p>
<p>A virtual machine (VM) on GCP is like a computer in the cloud. It&rsquo;s not a physical machine you can touch; instead, it&rsquo;s a powerful, remote computer that you can use to run your software and store your data.</p>
<p>To access the virtual machine from our computer, we&rsquo;ll use <a href="https://code.visualstudio.com/download">Visual Studio Code</a>, which is a lovely, <strong>free</strong> code editor that supports many programming languages.</p>

        
          <h2 id="walkthrough">Walkthrough</h2>
<h3 id="configure-the-google-cloud-platform">Configure the Google Cloud Platform</h3>
<h4 id="billing-and-costs">Billing and costs</h4>
<p>To use GCP, you need a payment method. But worry not, as of today, If you have never used GCP, you get a credit of $300. So, go to the Google Cloud Console and create an account: <a href="https://console.cloud.google.com/welcome">https://console.cloud.google.com/welcome</a>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/google-cloud-credits.jpg" title="Google Cloud Credits">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/google-cloud-credits.jpg" layout="responsive" alt="Google Cloud Credits" height="530" width="908"></amp-img>
  
    </a>
  

<p>Once you have used your free credits, you need to add a credit card to your account, by going under &ldquo;BILLING&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/google-cloud-billing.jpg" title="Google Cloud billing">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/google-cloud-billing.jpg" layout="responsive" alt="Google Cloud billing" height="1004" width="1396"></amp-img>
  
    </a>
  

<h4 id="create-a-google-cloud-project">Create a Google Cloud Project</h4>
<p>In order to use GCP, we need a project. Later, everything that we&rsquo;ll do will be within this project. So, go back to <a href="https://console.cloud.google.com/welcome">https://console.cloud.google.com/welcome</a> and create a new project by first clicking on the project selector in the top left.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/project-selector.jpg" title="Project selector">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/project-selector.jpg" layout="responsive" alt="Project selector" height="238" width="1070"></amp-img>
  
    </a>
  

<p>Then, click on &ldquo;NEW PROJECT&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/new-project.jpg" title="New project">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/new-project.jpg" layout="responsive" alt="New project" height="152" width="748"></amp-img>
  
    </a>
  

<p>Next, name your project. I called my project <code>mage-ai-test</code>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/new-cloud-project.jpg" title="New cloud project">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/new-cloud-project.jpg" layout="responsive" alt="New cloud project" height="840" width="1118"></amp-img>
  
    </a>
  

<p>Then simply wait until your project is created. Once you have selected your project, type &ldquo;vm instances&rdquo; in the search bar, and select &ldquo;VM instances&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/vm-instances.jpg" title="VM instances">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/vm-instances.jpg" layout="responsive" alt="VM instances" height="196" width="721"></amp-img>
  
    </a>
  

<p>This will lead to the following screen:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/compute-engine-api.jpg" title="Compute engine API">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/compute-engine-api.jpg" layout="responsive" alt="Compute engine API" height="826" width="1208"></amp-img>
  
    </a>
  

<p>On GCP, to use specific features, you must activate the corresponding APIs. For example, we&rsquo;ll enable the Google Analytics API later to get data from GA4. To make a virtual machine, we need to enable the Compute Engine API. Afterward, you&rsquo;ll see this screen, but we won&rsquo;t create a VM instance just yetâ€¦</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-vm-instance.jpg" title="Create VM instances">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-vm-instance.jpg" layout="responsive" alt="Create VM instances" height="664" width="1310"></amp-img>
  
    </a>
  

<p>First, we need to create <strong>SSH keys</strong> that will allow us to access our virtual machine from our computer.</p>
<p>SSH keys are like special keys that help your computer talk securely to another computer, such as a virtual machine.</p>
<p>It&rsquo;s a way for your computer to prove it&rsquo;s really you when connecting to the virtual machine. It&rsquo;s like having a secret handshake between your computer and the virtual machine, making sure they can trust each other without needing to type in a password every time.</p>
<h3 id="create-ssh-and-public-keys">Create SSH and public keys</h3>
<p>We need to create two SSH keys, a private and a public key. Think of SSH keys like a pair of magic keys for your online accounts. You have one key that you keep secret (the private key) and another key that you share with others (the public key).</p>
<ol>
<li><strong>Private Key (Secret Key):</strong> This is like the key to your front door that only you have. You keep it safe on your computer, and it&rsquo;s a secret. It&rsquo;s used to unlock and access your accounts securely.</li>
<li><strong>Public Key (Shared Key):</strong> This is like a lock that matches your private key.</li>
</ol>
<p>When you connect to a server or service, you use your private key to prove you are who you say you are. The server then checks this with your public key to make sure it&rsquo;s really you. This way, even if someone gets your public key, they can&rsquo;t do anything without the private key, which stays safe on your computer. It&rsquo;s a bit like having a special lock and key where only your key can open it.</p>
<p>To create your keys, hop to the terminal in your local machine and type the following code:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ssh-keygen -t rsa -f ~/.ssh/mage-ai-test -C arbenkqiku</code></pre></div>
<p>The end of the code should be your username, in my case <code>arbenkqiku</code>. If you don&rsquo;t know your user name, type <code>whoami</code> in the terminal and press enter. This will output your username.</p>
<p>Once you enter the code mentioned above, you&rsquo;ll be prompted to insert your computer&rsquo;s password, if you have any. Once you add your password, your SSH keys will be created.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-ssh-key.jpg" title="Create SSH key">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-ssh-key.jpg" layout="responsive" alt="Create SSH key" height="536" width="1036"></amp-img>
  
    </a>
  

<p>Now, go to the directory where your SSH keys can be found. <code>cd</code> stands for &ldquo;change directory&rdquo;:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/.ssh/</code></pre></div>
<p>This is where your public private and public SSH keys are located.</p>
<p>Now, type the following code to display the content of your public SSH key in the terminal.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">cat mage-ai-test.pub</code></pre></div>
<p>This will show the content of your public SSH key that we will later paste into our VM.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/public-key.jpg" title="Public key">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/public-key.jpg" layout="responsive" alt="Public key" height="260" width="1132"></amp-img>
  
    </a>
  

<h3 id="create-a-vm-instance-and-connect-to-it-by-using-our-ssh-keys">Create a VM instance and connect to it by using our SSH keys</h3>
<p>Now, let&rsquo;s go back to Google Cloud Platform and click on &ldquo;CREATE INSTANCE&rdquo; in the VM instances overview.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-new-vm-instance.jpg" title="Create new VM instance">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-new-vm-instance.jpg" layout="responsive" alt="Create new VM instance" height="664" width="1310"></amp-img>
  
    </a>
  

<p>Give a name to the VM instance and select the region closest to you:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/name-and-region-of-vm-instance.jpg" title="Name and region for VM instance">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/name-and-region-of-vm-instance.jpg" layout="responsive" alt="Name and region for VM instance" height="392" width="1414"></amp-img>
  
    </a>
  

<p>Go to the &ldquo;Boot disk&rdquo; section and click on &ldquo;CHANGE&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/change-boot-disk.jpg" title="Change boot disk">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/change-boot-disk.jpg" layout="responsive" alt="Change boot disk" height="478" width="1398"></amp-img>
  
    </a>
  

<p>Select the following options.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/advanced-boot-disk-options.jpg" title="Advanced boot disk options">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/advanced-boot-disk-options.jpg" layout="responsive" alt="Advanced boot disk options" height="1088" width="1120"></amp-img>
  
    </a>
  

<p>Under Firewall, select the following options:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/firewall-options.jpg" title="Firewall options">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/firewall-options.jpg" layout="responsive" alt="Firewall options" height="306" width="934"></amp-img>
  
    </a>
  

<p>This is important, as otherwise we won&rsquo;t be able to access Mage by using the IP address of our VM, you&rsquo;ll understand later what I mean by this.</p>
<p>Under Advanced Options &gt; Security, click on &ldquo;ADD ITEM&rdquo;. Here is where we&rsquo;ll add our <strong>public SSH key</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/add-public-key-to-vm.jpg" title="Add public key to VM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/add-public-key-to-vm.jpg" layout="responsive" alt="Add public key to VM" height="1032" width="1098"></amp-img>
  
    </a>
  

<p>Copy the entire SSH public key and paste it.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/paste-ssh-key.jpg" title="Paste SSH key">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/paste-ssh-key.jpg" layout="responsive" alt="Paste SSH key" height="418" width="1052"></amp-img>
  
    </a>
  

<p>Finally, click on &ldquo;CREATE&rdquo;. It may take some time to create the VM.</p>
<p>Once done, your new VM will appear here. Also, you&rsquo;ll see that your VM will have an &ldquo;External IP&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/vm-external-ip.jpg" title="VM with external IP">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/vm-external-ip.jpg" layout="responsive" alt="VM with external IP" height="257" width="1089"></amp-img>
  
    </a>
  

<p>You can use this &ldquo;External IP&rdquo; and your SSH private key to connect to this VM. Let&rsquo;s do this!</p>
<p>Go back to the terminal in your local machine and go to the directory where the SSH keys are located:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> ~/.ssh/</code></pre></div>
<p>Next, type this command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ssh -i mage-ai-test arbenkqiku@34.65.231.180</code></pre></div>
<p>I&rsquo;ll break it down to you so you know what to replace:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ssh -i name_of_private_key user_name@gcp_vm_instance_external_ip</code></pre></div>
<p>You&rsquo;ll likely will be prompted to enter your password again, and also to add the &ldquo;External IP&rdquo; as a host. Just follow the instructions and you should be able to connect to your VM.</p>
<p>As you can see from the image below, we connected to the VM named <code>mage-demo-test</code>. And if you recall, in &ldquo;Boot disk&rdquo; options, we selected Ubuntu as our operating system!</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ubuntu-vm-remote.jpg" title="Remote connection to VM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ubuntu-vm-remote.jpg" layout="responsive" alt="Remote connection to VM" height="764" width="944"></amp-img>
  
    </a>
  

<h3 id="install-visual-studio-code-and-access-the-vm">Install Visual Studio Code and access the VM</h3>
<p>We could do this whole process through the terminal, but it is much more user-friendly to do it through Visual Studio Code. Visual Studio Code is a very powerful code editor. Go to this link: <a href="https://code.visualstudio.com/download,">https://code.visualstudio.com/download,</a> and download Visual Studio Code.</p>
<p>Once you have installed it, go to &ldquo;Extensions&rdquo; and install &ldquo;Remote - SSH&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/remote-ssh-code-extension.jpg" title="Remote SSH code extension">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/remote-ssh-code-extension.jpg" layout="responsive" alt="Remote SSH code extension" height="303" width="1025"></amp-img>
  
    </a>
  

<p>In Visual Studio Code, go the the search bar and type <code>&gt;</code>, and then select the following option:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/open-ssh-config.jpg" title="Open SSH configuration file">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/open-ssh-config.jpg" layout="responsive" alt="Open SSH configuration file" height="200" width="1228"></amp-img>
  
    </a>
  

<p>In the configuration file that will open, you need to enter your details. Essentially, we&rsquo;re providing the details to connect to our VM.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">Host mage-demo-test <span class="c1"># Give a name to your host</span>
  HostName 34.65.231.180 <span class="c1"># Replace with the External IP address in GCP</span>
  User arbenkqiku <span class="c1"># Replace this with your user name</span>
  IdentityFile /Users/arbenkqiku/.ssh/mage-ai-test <span class="c1"># Path to private SSH key</span></code></pre></div>
<p>Now, we still have to go back to the terminal one last time and type this:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">eval</span> <span class="k">$(</span>ssh-agent<span class="k">)</span>
ssh-add /Users/arbenkqiku/.ssh/mage-ai-test <span class="c1"># Path to private SSH key</span></code></pre></div>
<p>Then, type your password when prompted. This basically means that you can use your password when you try to access the VM through Visual Studio Code.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ssh-add-command.jpg" title="The ssh-add command">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ssh-add-command.jpg" layout="responsive" alt="The ssh-add command" height="156" width="1108"></amp-img>
  
    </a>
  

<p>Now, go back to the search bar of Visual Studio Code, type <code>&gt;</code> and select the following option:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/code-connect-to-ssh-host.jpg" title="Connect to SSH host">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/code-connect-to-ssh-host.jpg" layout="responsive" alt="Connect to SSH host" height="182" width="1210"></amp-img>
  
    </a>
  

<p>Among others, it should suggest the host that you just created, click on that host:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/choose-ssh-host.jpg" title="Choose SSH host">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/choose-ssh-host.jpg" layout="responsive" alt="Choose SSH host" height="174" width="1208"></amp-img>
  
    </a>
  

<p>A new window will open. In the search bar, type your password:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ssh-passphrase.jpg" title="Enter passphrase for SSH">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ssh-passphrase.jpg" layout="responsive" alt="Enter passphrase for SSH" height="148" width="1226"></amp-img>
  
    </a>
  

<p>Now, click on the &ldquo;Remote Explorer&rdquo; icon, and it should show that you connected to your VM:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/remote-explorer-vm.jpg" title="Remote explorer with the VM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/remote-explorer-vm.jpg" layout="responsive" alt="Remote explorer with the VM" height="966" width="894"></amp-img>
  
    </a>
  

<p>On the top right, click this icon to display the terminal below:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/display-terminal-icon.jpg" title="Display terminal icon">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/display-terminal-icon.jpg" layout="responsive" alt="Display terminal icon" height="344" width="820"></amp-img>
  
    </a>
  

<p>Now click on &ldquo;TERMINAL&rdquo;. Congratulations, you have accessed your VM through Visual Studio Code!</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/access-terminal-success.jpg" title="access VM through code terminal">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/access-terminal-success.jpg" layout="responsive" alt="access VM through code terminal" height="508" width="1010"></amp-img>
  
    </a>
  

<h3 id="install-mage">Install Mage</h3>
<p>To install mage on GCP, I largely followed <a href="https://www.youtube.com/watch?v=C0fNc8ZOpSI&amp;t=696s&amp;ab_channel=DataSlinger">this tutorial</a>, but I will also explain every step here. First of all, let&rsquo;s create a directory <strong>in our VM</strong> for mage:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">mkdir mage-demo</code></pre></div>
<p>Now, if you type the following code, you should be able to see the newly created folder:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ls</code></pre></div>
<p>Then, let&rsquo;s access the folder:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> mage-demo</code></pre></div>
<p>Now, to install mage, we need to first install <strong>Docker</strong>.</p>
<p>Docker is a platform for developing, shipping, and running applications. It uses containerization technology to package an application and its dependencies together into a single unit called a &ldquo;container&rdquo;.</p>
<p>In the <code>mage-demo</code> folder, let&rsquo;s download a GitHub repo that contains the installation for Docker:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">git clone https://github.com/MichaelShoemaker/DockerComposeInstall.git</code></pre></div>
<p>Let&rsquo;s access the folder that contains the Docker installation:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> DockerComposeInstall</code></pre></div>
<p>Let&rsquo;s modify the file to make it executable:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">chmod +x InstallDocker</code></pre></div>
<p>Then, let&rsquo;s run it:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">./InstallDocker</code></pre></div>
<p>Type this to verify that Docker has been installed correctly:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">docker run hello-world</code></pre></div>
<p>This should show the following message:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/hello-docker.jpg" title="Hello from Docker">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/hello-docker.jpg" layout="responsive" alt="Hello from Docker" height="278" width="1184"></amp-img>
  
    </a>
  

<p>Now, let&rsquo;s go back to the initial directory:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> mage-demo</code></pre></div>
<p>Now, we can finally install mage with this command:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">docker run -it -p 6789:6789 -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/home/src --restart always mageai/mageai /app/run_app.sh mage start mage-ai-test</code></pre></div>
<p>with the command <code>--restart always</code>, we&rsquo;re asking the VM to always restart mage whenever the VM is shut down and later restarted.</p>
<p>At the end, <code>mage-ai-test</code> represents the name of our project.</p>
<p>Now, to access mage through our External IP from GCP, we need to hop back on GCP first, as we need to create a <strong>firewall rule</strong>.</p>
<p>This is necessary to control and regulate incoming and outgoing traffic to and from your VM on Google Cloud Platform. When you want to access mage through your External IP from GCP, a firewall rule is needed to explicitly allow the traffic to reach your VM.</p>
<p>Browse to <a href="https://console.cloud.google.com/net-security/firewall-manager/firewall-policies/list">Firewall</a> in the Google Cloud Platform.</p>
<p>Click on &ldquo;CREATE FIREWALL RULE&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-firewall-rule.jpg" title="Create firewall rule">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-firewall-rule.jpg" layout="responsive" alt="Create firewall rule" height="316" width="1066"></amp-img>
  
    </a>
  

<p>Select the following options and click on &ldquo;CREATE&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/firewall-options.jpg" title="Firewall options">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/firewall-options.jpg" layout="responsive" alt="Firewall options" height="962" width="1112"></amp-img>
  
    </a>
  

<p>Basically, with this firewall rule in place, it means we can access mage via the external IP address by using port number 6789.</p>
<p>Now, if you type <strong>your VM external IP</strong> followed by <code>:6789</code> in your web browser you should be able to access mage.</p>
<p>For example, this is the URL I would use with my configuration: <code>http://34.65.231.180:6789</code>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-test.jpg" title="Test mage">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-test.jpg" layout="responsive" alt="Test mage" height="666" width="1084"></amp-img>
  
    </a>
  

<p>As you can see, <code>mage-ai-test</code> was the name of our project in a previous command.</p>
<p>Congrats, now you can create data pipelines that will run in the cloud!</p>
<h3 id="create-the-data-pipeline">Create the data pipeline</h3>
<p>Now, we can finally create the pipeline. Here are the four parts that will compose our data pipeline:</p>
<ul>
<li>Retrieve data from GA4</li>
<li>Retrieve data from Google Ads</li>
<li>Join the data</li>
<li>Export the data to BigQuery</li>
</ul>
<h4 id="load-data-from-the-ga4-api">Load data from the GA4 API</h4>
<p>To start, click on <strong>New pipeline</strong> &gt; <strong>Standard (batch)</strong>:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/new-batch-pipeline.jpg" title="New batch pipeline">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/new-batch-pipeline.jpg" layout="responsive" alt="New batch pipeline" height="718" width="1614"></amp-img>
  
    </a>
  

<p>On the left side, you can see all your files, even the pipeline that we have just created.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/files-in-pipeline.jpg" title="Files in pipeline">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/files-in-pipeline.jpg" layout="responsive" alt="Files in pipeline" height="756" width="1303"></amp-img>
  
    </a>
  

<p>In the middle, you can see the blocks that you can use to build your pipelines. In this guide, we&rsquo;ll use <strong>Data loader</strong>, <strong>Transformer</strong>, and <strong>Data exporter</strong> blocks:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-blocks.jpg" title="Mage blocks">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-blocks.jpg" layout="responsive" alt="Mage blocks" height="334" width="1106"></amp-img>
  
    </a>
  

<p>As mentioned previously, you can use Python, SQL, and R in each block. In our case, we&rsquo;ll use <strong>R</strong>. So, click on <strong>Data Loader</strong> and select R:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/use-r.jpg" title="Use R">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/use-r.jpg" layout="responsive" alt="Use R" height="428" width="1094"></amp-img>
  
    </a>
  

<p>Name the block <code>ga4</code>, then click <strong>Save and add block</strong>.</p>
<p>You should now see the block on the right, together with a sample R code.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/sample-r-code.jpg" title="Block with sample R">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/sample-r-code.jpg" layout="responsive" alt="Block with sample R" height="455" width="1074"></amp-img>
  
    </a>
  

<p>To install and load packages, mage uses the <code>pacman</code> package. Once you load <code>pacman</code>, you can install packages by using:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="n">pacman</span><span class="o">::</span><span class="nf">p_load</span><span class="p">(</span><span class="n">package1</span><span class="p">,</span> <span class="n">package2</span><span class="p">,</span> <span class="n">package3</span><span class="p">)</span></code></pre></div>
â€‹
The first time you run the <code>p_load()</code> function, it will install a package, and then it will simply load it. For this block, we&rsquo;ll install three packages:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="n">pacman</span><span class="o">::</span><span class="nf">p_load</span><span class="p">(</span><span class="n">dplyr</span><span class="p">,</span> <span class="n">purrr</span><span class="p">,</span> <span class="n">googleAnalyticsR</span><span class="p">)</span>

<span class="n">load_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span></code></pre></div>
â€‹
In order to access GA4 data by using the <code>googleAnalyticsR</code> package, developed by <a href="https://code.markedmondson.me/">Mark Edmondson</a>, you need an access token.</p>
<p>An access token is like your digital ID card; it confirms your identity and verifies that you truly have permission to access the GA4 properties you&rsquo;re attempting to retrieve data from.</p>
<p>To get an access token, you can run the following function in the <strong>RStudio console</strong> in your local machine: <code>ga_auth()</code>.</p>
<p>Once you run this function, you&rsquo;ll be redirected to a browser window where you&rsquo;ll select your account:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/select-google-account.jpg" title="select google account">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/select-google-account.jpg" layout="responsive" alt="select google account" height="606" width="938"></amp-img>
  
    </a>
  

<p>With this, you are basically giving permission to the <code>googleAnalyticsR</code> package to access your GA4 properties.</p>
<p>However, the problem is that we&rsquo;ll run our data pipeline in a production environment where you cannot interact with the browser.</p>
<p>So, we need to find another way to solve this problem.</p>
<p>In fact, if I try to run the function <code>ga_auth()</code> on Mage, it throws an error:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ga-auth-error.jpg" title="GA auth error">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ga-auth-error.jpg" layout="responsive" alt="GA auth error" height="1096" width="1130"></amp-img>
  
    </a>
  

<p>So, we need to generate a Google Analytics token that we can use in a production environment.</p>
<p>First, let&rsquo;s go back to GCP and browse to <a href="https://console.cloud.google.com/apis/dashboard">Enabled APIs &amp; services</a>.</p>
<p>Click on &ldquo;ENABLE APIS AND SERVICES&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/enable-apis-services.jpg" title="Enable APIs services">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/enable-apis-services.jpg" layout="responsive" alt="Enable APIs services" height="634" width="1018"></amp-img>
  
    </a>
  

<p>Search for <code>Google Analytics</code>, click the <strong>Google Analytics Reporting API</strong> result, and then choose <strong>ENABLE</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/enable-ga-api.jpg" title="Enable GA API">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/enable-ga-api.jpg" layout="responsive" alt="Enable GA API" height="484" width="1014"></amp-img>
  
    </a>
  

<p>This means that our project is now eligible to use the <strong>Google Analytics Reporting API</strong>.</p>
<p>Next, repeat these API-enabling steps for the <strong>Google Analytics Data API</strong>.</p>
<p>Once done, we have the APIs enabled but we still haven&rsquo;t created the required <strong>token</strong>.</p>
<p>Browse to <a href="https://console.cloud.google.com/apis/credentials">Credentials</a> in the Google Cloud console.</p>
<p>Hover over &ldquo;CREATE CREDENTIALS&rdquo; and click on <strong>Service account</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-service-account.jpg" title="Create service account">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-service-account.jpg" layout="responsive" alt="Create service account" height="604" width="1138"></amp-img>
  
    </a>
  

<p>Give the service account a name and then click <strong>CREATE AND CONTINUE</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-and-continue-service-account.jpg" title="Continue with service account">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-and-continue-service-account.jpg" layout="responsive" alt="Continue with service account" height="706" width="1106"></amp-img>
  
    </a>
  

<p>Give the service account the <strong>Editor</strong> role and then click on <strong>Continue</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/set-editor-role.jpg" title="Set editor role">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/set-editor-role.jpg" layout="responsive" alt="Set editor role" height="1018" width="922"></amp-img>
  
    </a>
  

<p>Finally, click on <strong>DONE</strong>.</p>
<p>Now that the service account has been created, go back to the Credentials view and you&rsquo;ll see the account that you just created. Click on it.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/click-service-account-edit.jpg" title="Click to edit service account">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/click-service-account-edit.jpg" layout="responsive" alt="Click to edit service account" height="1152" width="1428"></amp-img>
  
    </a>
  

<p>Then, click the <strong>KEYS</strong> tab and choose to <strong>Create new key</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-new-key.jpg" title="Create new key">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-new-key.jpg" layout="responsive" alt="Create new key" height="870" width="994"></amp-img>
  
    </a>
  

<p>Select <strong>JSON</strong> as the key type and click <strong>Create</strong>.</p>
<p>This should download your key as a JSON file.</p>
<p>Store it in a safe place. Basically, the service account is like an account that has permission to act on your behalf. When you want your application or service to communicate with the GA4 API, it needs to prove its identity. Instead of using a user&rsquo;s personal Google account, which may not be appropriate for server-to-server communication, you can use a service account.</p>
<p>Now, as if it were a real user, we need to go to the GA4 property and add our service account email. So, go back to <a href="https://console.cloud.google.com/apis/credentials">Credentials</a> and copy your service account&rsquo;s <strong>email address</strong>:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/copy-service-account-email.jpg" title="Copy service account email">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/copy-service-account-email.jpg" layout="responsive" alt="Copy service account email" height="312" width="1016"></amp-img>
  
    </a>
  

<p>Next, open Google Analytics 4, go to your property, and click on <strong>Property access management</strong> in Admin:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/property-access-management.jpg" title="Property access management">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/property-access-management.jpg" layout="responsive" alt="Property access management" height="702" width="892"></amp-img>
  
    </a>
  

<p>Add your service account email address to the list of users, give it <strong>Viewer</strong> permissions, and click on <strong>Add</strong> to add the service account as a user to the GA4 property.</p>
<p>Now, before adding code to Mage, I like to test it on my local machine to make sure that everything works properly.</p>
<p>So, on your local machine, open a new <strong>R script</strong> and try the following code:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Packages ----</span>
<span class="nf">library</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">googleAnalyticsR</span><span class="p">)</span>

<span class="c1"># Authenticate ----  </span>

<span class="c1"># path to your JSON service account that we saved earlier</span>
<span class="nf">ga_auth</span><span class="p">(</span><span class="n">json_file</span> <span class="o">=</span> <span class="s">&#34;/Users/arbenkqiku/Desktop/mage-ai/mage-ai-test-405614-2e1e1c865c18.json&#34;</span><span class="p">)</span>  </code></pre></div>
â€‹
If everything works correctly, you should see the following message:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ga-auth-test-worked.jpg" title="GA auth test worked">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ga-auth-test-worked.jpg" layout="responsive" alt="GA auth test worked" height="44" width="880"></amp-img>
  
    </a>
  

<p>That means that your pipeline can now communicate with the GA4 Reporting API without any extra authentication flows.</p>
<p>Now, what I want to retrieve from GA4 are the sessions where a lead generation conversion event happened.</p>
<p>In the case of this client of mine, either someone submitted a form, clicked on the WhatsApp icon to talk to them privately, or clicked on the phone icon to call them.</p>
<p>So, in the the next piece of code I want to create a filter with all the event names I am interested in, namely the event names equal to <code>form_submit_lead</code> or <code>whatsapp_click</code> or <code>phone_click</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># GA4 property ID</span>
<span class="n">property_id</span> <span class="o">=</span> <span class="s">&#34;1234567&#34;</span>

<span class="c1"># Create filter</span>
<span class="n">goals_filter</span> <span class="o">=</span> <span class="nf">ga_data_filter</span><span class="p">(</span><span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;form_submit_lead&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;whatsapp_click&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;phone_click&#34;</span><span class="p">)</span></code></pre></div>
<p>In the next piece of code, we have the actual query to GA4:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Get conversions from GA4</span>
<span class="n">goals_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span>         
                     <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>        
                     <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>        
                     <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">),</span>        
                     <span class="n">dim_filter</span> <span class="o">=</span> <span class="n">goals_filter</span><span class="p">)</span> <span class="o">%&gt;%</span>     

<span class="c1"># rename sessions to goals</span>
<span class="nf">set_names</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">,</span> <span class="s">&#34;goals&#34;</span><span class="p">))</span></code></pre></div>
<p>Basically, we&rsquo;re getting the sessions from 1st October 2023 until 8th November 2023, segmented by date, and only when one of the events mentioned earlier occurred. This is what the final table looks like in my case:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ga-table-results.jpg" title="GA table results">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ga-table-results.jpg" layout="responsive" alt="GA table results" height="800" width="732"></amp-img>
  
    </a>
  

<p>It is not always easy to know what certain fields are called in the GA4 API. You can go to <a href="https://ga-dev-tools.google/ga4/dimensions-metrics-explorer/">this website</a> and look for a specific field. For example, if we look for &ldquo;channel&rdquo;, you can see all the different fields that contain &ldquo;channel&rdquo; and what they are called in the GA4 API.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ga-explorer-dims.jpg" title="GA explorer">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ga-explorer-dims.jpg" layout="responsive" alt="GA explorer" height="765" width="883"></amp-img>
  
    </a>
  

<p>Now, in addition to retrieving the sessions where a conversion event occurred, I also want to retrieve the sessions segmented by day, so I&rsquo;ll use this query:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Get sessions from GA4</span>
<span class="n">sessions_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span>                      
                        <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>        
                        <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>                     
                        <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">))</span></code></pre></div>
<p>This returns a table of sessions segmented by date.</p>
<p>Now, to join the sessions with the conversions:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Merge GA4 goals and sessions</span>
<span class="n">sessions_goals_ga4</span> <span class="o">=</span> <span class="n">sessions_data</span> <span class="o">%&gt;%</span>   
	<span class="c1"># join sessions with goals  </span>
<span class="nf">full_join</span><span class="p">(</span><span class="n">goals_data</span><span class="p">)</span> <span class="o">%&gt;%</span>   
	<span class="c1"># replace all NAs with 0  </span>
<span class="nf">replace</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.)</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span></code></pre></div>
<p>This is the final result:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/sessions-by-goals.jpg" title="Sessions by goals">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/sessions-by-goals.jpg" layout="responsive" alt="Sessions by goals" height="813" width="855"></amp-img>
  
    </a>
  

<p>Here is the <strong>complete code</strong>.</p>
<p>At the end of the script, I added the <code>sessions_goals_ga4</code> dataframe. This is because in Mage, we&rsquo;re using this code within a <strong>Data Loader</strong> block. We need to return a dataframe for the next block, otherwise the next block doesn&rsquo;t have any data to play with.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Packages ----</span>
<span class="nf">library</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">googleAnalyticsR</span><span class="p">)</span>

<span class="c1"># Authenticate ----  </span>
	<span class="c1"># path to your JSON service account that we save earlier</span>
<span class="nf">ga_auth</span><span class="p">(</span><span class="n">json_file</span> <span class="o">=</span> <span class="s">&#34;/Users/arbenkqiku/Desktop/mage-ai/mage-ai-test-405614-2e1e1c865c18.json&#34;</span><span class="p">)</span>  

<span class="c1"># GA4 property ID</span>
<span class="n">property_id</span> <span class="o">=</span> <span class="s">&#34;1234567&#34;</span>

<span class="c1">#Â Create filter</span>
<span class="n">goals_filter</span> <span class="o">=</span> <span class="nf">ga_data_filter</span><span class="p">(</span><span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;form_submit_lead&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;whatsapp_click&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;phone_click&#34;</span><span class="p">)</span>

<span class="c1"># Get conversions from GA4</span>
<span class="n">goals_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span>         
                     <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>        
                     <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>        
                     <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">),</span>        
                     <span class="n">dim_filter</span> <span class="o">=</span> <span class="n">goals_filter</span><span class="p">)</span> <span class="o">%&gt;%</span>     

	<span class="c1"># rename sessions to goals</span>
<span class="nf">set_names</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">,</span> <span class="s">&#34;goals&#34;</span><span class="p">))</span>

<span class="c1"># Get sessions from GA4</span>
<span class="n">sessions_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span>                      
                        <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>        
                        <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>                     
                        <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">))</span>

<span class="c1"># Merge GA4 goals and sessions</span>
<span class="n">sessions_goals_ga4</span> <span class="o">=</span> <span class="n">sessions_data</span> <span class="o">%&gt;%</span>   
	<span class="c1"># join sessions with goals  </span>
<span class="nf">full_join</span><span class="p">(</span><span class="n">goals_data</span><span class="p">)</span> <span class="o">%&gt;%</span>   
	<span class="c1"># replace all NAs with 0  </span>
<span class="nf">replace</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.)</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>

<span class="c1"># Final data frame for next block in mage.ai</span>
<span class="n">sessions_goals_ga4</span></code></pre></div>
<p>Now, before we copy this code to Mage, we need to make our <strong>JSON service account</strong> key accessible to Mage, as for now it is only available on our local machine.</p>
<p>Remember, Mage is installed on our <strong>virtual machine</strong>. We need to paste the JSON service account key there.</p>
<p>Open <strong>Visual Studio Code</strong> and click on &ldquo;Open&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/visual-studio-code-open.jpg" title="Visual studio code open">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/visual-studio-code-open.jpg" layout="responsive" alt="Visual studio code open" height="954" width="830"></amp-img>
  
    </a>
  

<p>Go to the path where your JSON service account key is located in your local machine. You should be able to see your service account key in the left panel.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/vs-code-json-path.jpg" title="VS code JSON path">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/vs-code-json-path.jpg" layout="responsive" alt="VS code JSON path" height="790" width="722"></amp-img>
  
    </a>
  

<p>Right-click and <strong>copy</strong> it.</p>
<p>Next, go to the search bar, type <code>&gt;</code> and connect to your virtual machine.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/connect-to-vm.jpg" title="Connect to VM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/connect-to-vm.jpg" layout="responsive" alt="Connect to VM" height="310" width="1300"></amp-img>
  
    </a>
  

<p>Once you are in the VM, click on &ldquo;Open&hellip;&rdquo; and access the folder where Mage is installed. Click on &ldquo;OK&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/open-file-folder.jpg" title="Open file or folder">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/open-file-folder.jpg" layout="responsive" alt="Open file or folder" height="736" width="1686"></amp-img>
  
    </a>
  

<p>On the left side you should now see the files contained in that folder.</p>
<p>Right-click in that area and choose <strong>Paste</strong> to paste your service account JSON file into the project.</p>
<p>You should see your service account file now successfully added to the files in your VM.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/service-account-in-vm.jpg" title="service account in VM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/service-account-in-vm.jpg" layout="responsive" alt="service account in VM" height="615" width="780"></amp-img>
  
    </a>
  

<p>In Mage, you can use the function <code>list.files()</code> to see that the service account key is available.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/service-account-key-available.jpg" title="Service account key available">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/service-account-key-available.jpg" layout="responsive" alt="Service account key available" height="1232" width="1158"></amp-img>
  
    </a>
  

<p>Now, take the code that we previously played with in RStudio and paste it into Mage. You need to make some adjustments, though.</p>
<p>The main change is that the bulk of the code is now within the <code>load_data()</code> function. The only code that&rsquo;s run outside that function are the library loads.</p>
<p>Another thing that changes is the path to the service account key. This now needs to reference the path to the file in your VM. As it should be in the root of your project, you just need to add the filename.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="n">pacman</span><span class="o">::</span><span class="nf">p_load</span><span class="p">(</span><span class="n">dplyr</span><span class="p">,</span> <span class="n">purrr</span><span class="p">,</span> <span class="n">googleAnalyticsR</span><span class="p">)</span>

<span class="n">load_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1"># Specify your data loading logic here</span>
    <span class="c1"># Return value: loaded dataframe</span>

    <span class="c1"># Retrieve data ----</span>
    <span class="c1"># path to your JSON service account</span>
    <span class="nf">ga_auth</span><span class="p">(</span><span class="n">json_file</span> <span class="o">=</span> <span class="s">&#34;mage-ai-test-405614-2e1e1c865c18.json&#34;</span><span class="p">)</span>

    <span class="c1"># GA4 property ID</span>
    <span class="n">property_id</span> <span class="o">=</span> <span class="s">&#34;1234567&#34;</span>

    <span class="c1"># Create filter</span>
    <span class="n">goals_filter</span> <span class="o">=</span> <span class="nf">ga_data_filter</span><span class="p">(</span><span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;form_submit_lead&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;whatsapp_click&#34;</span> <span class="o">|</span> <span class="s">&#34;eventName&#34;</span> <span class="o">==</span> <span class="s">&#34;phone_click&#34;</span><span class="p">)</span>

    <span class="c1"># Get conversions from GA4</span>
    <span class="n">goals_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span> 
                         <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>
                         <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>
                         <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">),</span>
                         <span class="n">dim_filter</span> <span class="o">=</span> <span class="n">goals_filter</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">%&gt;%</span> 
    
    <span class="nf">set_names</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">,</span> <span class="s">&#34;goals&#34;</span><span class="p">))</span>

    <span class="c1"># Get sessions from GA4</span>
    <span class="n">sessions_data</span> <span class="o">=</span> <span class="nf">ga_data</span><span class="p">(</span><span class="n">propertyId</span> <span class="o">=</span> <span class="n">property_id</span><span class="p">,</span> 
                            <span class="n">date_range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;2023-10-01&#34;</span><span class="p">,</span> <span class="s">&#34;2023-11-08&#34;</span><span class="p">),</span>
                            <span class="n">dimensions</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span><span class="p">),</span>
                            <span class="n">metrics</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sessions&#34;</span><span class="p">))</span>

    <span class="c1"># Merge GA4 goals and sessions</span>
    <span class="n">sessions_goals_ga4</span> <span class="o">=</span> <span class="n">sessions_data</span> <span class="o">%&gt;%</span> 
    <span class="c1"># join sessions with goals</span>
    <span class="nf">full_join</span><span class="p">(</span><span class="n">goals_data</span><span class="p">)</span> <span class="o">%&gt;%</span> 
    <span class="c1"># replace all NAs with 0</span>
    <span class="nf">replace</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.)</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>

    <span class="c1"># Final data frame</span>
    <span class="n">sessions_goals_ga4</span>
<span class="p">}</span></code></pre></div>
<p>If everything worked properly, Mage will provide a preview of the data retrieved:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-preview.jpg" title="Mage preview">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-preview.jpg" layout="responsive" alt="Mage preview" height="571" width="779"></amp-img>
  
    </a>
  

<p>As you can see, our Data loader block has a green tick next to it, which means that it was able to run successfully.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/data-loader-worked.jpg" title="Data loader worked">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/data-loader-worked.jpg" layout="responsive" alt="Data loader worked" height="369" width="941"></amp-img>
  
    </a>
  

<p>Later, we can use this data that we retrieved from GA4 for whatever purpose we want. However, before playing around with it, let&rsquo;s download some data from Google Ads!</p>
<h4 id="load-data-from-the-google-ads-api">Load data from the Google Ads API</h4>
<p>To retrieve data from the Google Ads API, we&rsquo;ll use the R package <a href="https://selesnow.github.io/rgoogleads/"><code>rgoogleads</code></a>, developed by <a href="https://github.com/selesnow/rgoogleads#author">Alexey Seleznev</a>. Unfortunately, with this package it is not possible to use a service account key. Instead, we&rsquo;ll have to generate an access token by using the <a href="https://gargle.r-lib.org/"><code>gargle</code></a> package. The goal of <code>gargle</code>, as explained on their website, is to &ldquo;take some of the agonizing pain out of working with Google APIs&rdquo;.</p>
<p>First of all, you need to browse to the <a href="https://console.cloud.google.com/marketplace/product/google/googleads.googleapis.com">Google Ads API</a> in Google Cloud Platform and click to <strong>Enable</strong> it.</p>
<p>To access Google Ads data, we need to create the credentials for an application, because when we use the <code>rgoogleads</code> package to get data, Google sees it as an external app trying to access our ads info.</p>
<p>So, when we attempt to fetch our Google Ads data, Google asks for our permission to let this app access our ads data. If we say yes, Google gives us an access token. This token then lets our computer talk to the Google Ads API without having to interact each time.</p>
<p>Before doing anything, GCP will ask you to set up a &ldquo;consent screen&rdquo;. This screen is like a friendly message to users, letting them know that our app wants to look at their Google Ads data.</p>
<p>It&rsquo;s a way to make sure users are aware and agree to let our app access their information. To get started, browse to the <a href="https://console.cloud.google.com/apis/credentials/consent">OAuth consent screen</a> section of your GCP project.</p>
<p>Here, click on &ldquo;CONFIGURE CONSENT SCREEN&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/configure-consent-screen.jpg" title="Configure consent screen">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/configure-consent-screen.jpg" layout="responsive" alt="Configure consent screen" height="209" width="1366"></amp-img>
  
    </a>
  

<p>Select <strong>External</strong> as the User Type and then click &ldquo;CREATE&rdquo;.</p>
<p>Give your app a name and add your email address.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/name-and-email-consent.jpg" title="Name and email for consent">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/name-and-email-consent.jpg" layout="responsive" alt="Name and email for consent" height="546" width="1100"></amp-img>
  
    </a>
  

<p>Add your email to the <strong>Developer email address</strong>, too, and then click &ldquo;SAVE AND CONTINUE&rdquo;.</p>
<p>In the next screen, click on &ldquo;ADD OR REMOVE SCOPES&rdquo;. Scopes govern what your app is allowed to do with the APIs.</p>
<p>Search for <code>google ads</code> and select the <strong>Google Ads API</strong>. Click UPDATE when done.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/add-google-ads-scope.jpg" title="Add google ads scope">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/add-google-ads-scope.jpg" layout="responsive" alt="Add google ads scope" height="1190" width="1470"></amp-img>
  
    </a>
  

<p>Then, click &ldquo;SAVE AND CONTINUE&rdquo; to proceed to the &ldquo;Test users&rdquo; step.</p>
<p>Here, click &ldquo;ADD USERS&rdquo;. Add <strong>your email address</strong> and click &ldquo;ADD&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/add-test-user.jpg" title="Add test user">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/add-test-user.jpg" layout="responsive" alt="Add test user" height="280" width="1108"></amp-img>
  
    </a>
  

<p>Make sure to include your email because our app is currently in the &ldquo;Testing&rdquo; phase. During this phase, only the emails that are added can be used by the app. So, adding your email is crucial to get your Google Ads data.</p>
<p>Click on &ldquo;SAVE AND CONTINUE&rdquo; to proceed to the Summary step, and then &ldquo;BACK TO DASHBOARD&rdquo; when done with configuring the consent screen.</p>
<p>Now that the consent screen has been configured, you can browse to <a href="https://console.cloud.google.com/apis/credentials">Credentials</a> again.</p>
<p>Here, click on &ldquo;CREATE CREDENTIALS&rdquo; and this time choose <strong>OAuth client ID</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/oauth-client-id.jpg" title="oauth client id">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/oauth-client-id.jpg" layout="responsive" alt="oauth client id" height="702" width="1218"></amp-img>
  
    </a>
  

<p>Under <strong>Application type</strong>, select <strong>Desktop app</strong>, give a name to your OAuth client ID, and click on &ldquo;CREATE&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-oauth-id.jpg" title="Create the oauth id">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-oauth-id.jpg" layout="responsive" alt="Create the oauth id" height="818" width="1090"></amp-img>
  
    </a>
  

<p>Download your client ID as a JSON file and click on OK.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/download-oauth-json.jpg" title="Download JSON">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/download-oauth-json.jpg" layout="responsive" alt="Download JSON" height="1132" width="1050"></amp-img>
  
    </a>
  

<p>Save it in a secure location. Now, let&rsquo;s go back to <strong>RStudio</strong> on our local machine. Open a new script and load these packages:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Packages</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gargle</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rgoogleads</span><span class="p">)</span></code></pre></div>â€‹</p>
<p>Then, we&rsquo;ll import the OAuth Client ID credentials that we just created by using the function <code>gargle_oauth_client_from_json()</code>. The name of your client can be whatever you prefer:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Create gargle client</span>
<span class="n">my_client</span> <span class="o">=</span> <span class="nf">gargle_oauth_client_from_json</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/Users/arbenkqiku/Desktop/mage-ai/mage-demo-client-id.json&#34;</span><span class="p">,</span>
                                          <span class="n">name</span> <span class="o">=</span> <span class="s">&#34;Google Ads App&#34;</span><span class="p">)</span></code></pre></div>â€‹</p>
<p>Then, we can add the following scope and email to our token request:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="n">scopes</span> <span class="o">=</span> <span class="s">&#34;https://www.googleapis.com/auth/adwords&#34;</span>
<span class="n">email</span> <span class="o">=</span> <span class="s">&#34;arben.kqiku@gmail.com&#34;</span></code></pre></div>
â€‹
Finally, we can go through the process of acquiring a token by running this function:</p>
<p><div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Create a token by using Gargle</span>
<span class="n">my_token</span> <span class="o">=</span> <span class="nf">gargle2.0_token</span><span class="p">(</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">,</span>  
                           <span class="n">package</span> <span class="o">=</span> <span class="s">&#34;rgoogleads&#34;</span><span class="p">,</span>  
                           <span class="n">scope</span> <span class="o">=</span> <span class="n">scopes</span><span class="p">,</span>  
                           <span class="n">client</span> <span class="o">=</span> <span class="n">my_client</span><span class="p">)</span></code></pre></div>â€‹</p>
<p>This will open a browser window.</p>
<p>Do you recognize the name of the App? That&rsquo;s the name of our application! We&rsquo;re now going through the process of authorizing our app to access our Google Ads data. Now, select your email.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/authorize-app.jpg" title="Authorize app">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/authorize-app.jpg" layout="responsive" alt="Authorize app" height="638" width="926"></amp-img>
  
    </a>
  

<p>Google will tell you that this app isn&rsquo;t verified, as its status is still &ldquo;testing&rdquo;.</p>
<p>However, it is our own app, so we can safely click on &ldquo;Continue&rdquo;.</p>
<p>Authorize the app to &ldquo;See, edit, create and delete your Google Ads accounts and data&hellip;&rdquo; and click on &ldquo;Continue&rdquo;.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/authorize-google-ads-access.jpg" title="Authorize google ads access">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/authorize-google-ads-access.jpg" layout="responsive" alt="Authorize google ads access" height="1492" width="838"></amp-img>
  
    </a>
  

<p>If everything worked correctly, you should see a message saying that <code>Authentication complete. Please close this page and return to R</code>.</p>
<p>Now, if we review the content of the variable <code>my_token</code>, which contains our access token, we can review the information again, for example the email associated with the token, the scopes, and so forth.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/review-token.jpg" title="Review token">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/review-token.jpg" layout="responsive" alt="Review token" height="366" width="1560"></amp-img>
  
    </a>
  

<p>We can now test if the token works properly by running the <code>gads_auth()</code> function. Nothing should really happen here, as with the token we can authenticate non-interactively.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Authenticate by using the previously created token</span>
<span class="nf">gads_auth</span><span class="p">(</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_token</span><span class="p">)</span></code></pre></div>
<p>Let&rsquo;s run a simple function of the <code>rgoogleads</code> package to see if we can access our data:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># get list of accessible accounts</span>
<span class="nf">gads_get_accessible_customers</span><span class="p">()</span></code></pre></div>
<p>Yes, I am able to retrieve the accounts that I have access to!</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ads-accounts-listed.jpg" title="Ads accounts listed">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ads-accounts-listed.jpg" layout="responsive" alt="Ads accounts listed" height="597" width="861"></amp-img>
  
    </a>
  

<p>However, we are not ready for production yet. In fact, if we type this code:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># where is the cache of the token located</span>
<span class="n">my_token</span><span class="o">$</span><span class="n">cache_path</span></code></pre></div>
<p>We&rsquo;ll get the result that the token is cached in a local directory, such as <code>~/Library/Caches/gargle</code>.</p>
<p>This means that when we try to load <code>my_token</code> in production, it will look for the local path instead of a path on the VM.</p>
<p>So, we need to change the cache path to our Mage directory on the VM. This is how you&rsquo;d do it:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># change path of cache to mage main directory</span>
<span class="n">my_token</span><span class="o">$</span><span class="n">cache_path</span> <span class="o">=</span> <span class="s">&#34;/home/src&#34;</span>

<span class="c1"># save token again with changed directory</span>
<span class="nf">saveRDS</span><span class="p">(</span><span class="n">my_token</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;google_ads_token_mage_demo.RDS&#34;</span><span class="p">)</span></code></pre></div>
<p>Here is the full code to generate, test, and save the token:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Packages</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gargle</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">rgoogleads</span><span class="p">)</span>

<span class="c1"># Create gargle client</span>
<span class="n">my_client</span> <span class="o">=</span> <span class="nf">gargle_oauth_client_from_json</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;/Users/arbenkqiku/Desktop/mage-ai/mage-demo-client-id.json&#34;</span><span class="p">,</span>
                                          <span class="n">name</span> <span class="o">=</span> <span class="s">&#34;Google Ads App&#34;</span><span class="p">)</span>

<span class="c1"># Define scope and email</span>
<span class="n">scopes</span> <span class="o">=</span> <span class="s">&#34;https://www.googleapis.com/auth/adwords&#34;</span>
<span class="n">email</span> <span class="o">=</span> <span class="s">&#34;arben.kqiku@gmail.com&#34;</span>

<span class="c1"># Create a token by using Gargle</span>
<span class="n">my_token</span> <span class="o">=</span> <span class="nf">gargle2.0_token</span><span class="p">(</span><span class="n">email</span> <span class="o">=</span> <span class="n">email</span><span class="p">,</span>  
                           <span class="n">package</span> <span class="o">=</span> <span class="s">&#34;rgoogleads&#34;</span><span class="p">,</span>  
                           <span class="n">scope</span> <span class="o">=</span> <span class="n">scopes</span><span class="p">,</span>  
                           <span class="n">client</span> <span class="o">=</span> <span class="n">my_client</span><span class="p">)</span>

<span class="c1"># Authenticate by using the previously created token</span>
<span class="nf">gads_auth</span><span class="p">(</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_token</span><span class="p">)</span>

<span class="c1"># Test token by getting the list of accessible accounts</span>
<span class="nf">gads_get_accessible_customers</span><span class="p">()</span>

<span class="c1"># Change path of cache to mage main directory, so you can use the token in production</span>
<span class="n">my_token</span><span class="o">$</span><span class="n">cache_path</span> <span class="o">=</span> <span class="s">&#34;/home/src&#34;</span>

<span class="c1"># Save token with changed directory</span>
<span class="nf">saveRDS</span><span class="p">(</span><span class="n">my_token</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;google_ads_token_mage_demo.RDS&#34;</span><span class="p">)</span></code></pre></div>
<p>Now that we have generated the access token, you can copy-paste the JSON file from your local machine to the VM directory by using Visual Studio Code. Follow the exact steps you took to copy-paste the service account JSON file before.</p>
<p>Next, we can go back to Mage, add a Data loader block, and select R as the programming language.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/new-data-loader-with-r.jpg" title="New data loader with R">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/new-data-loader-with-r.jpg" layout="responsive" alt="New data loader with R" height="227" width="967"></amp-img>
  
    </a>
  

<p>Name the block <code>google_ads</code> and click on &ldquo;Save and add block&rdquo;.</p>
<p>In the block code, we need to first load the necessary packages.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">rgoogleads</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>

<span class="n">load_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">()</span> <span class="p">{</span>

<span class="p">}</span></code></pre></div>
<p>Then, we need to load our access token, authenticate with it, and set the Google Ads account ID we want to get the data from.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># load Google Ads access token</span>
<span class="n">my_token</span> <span class="o">=</span> <span class="nf">readRDS</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#34;google_ads_token_mage_demo.RDS&#34;</span><span class="p">)</span>
    
<span class="c1"># Authenticate with the token</span>
<span class="nf">gads_auth</span><span class="p">(</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_token</span><span class="p">)</span>

<span class="c1"># Set the Google Ads account id you want to get data from</span>
<span class="nf">gads_set_customer_id</span><span class="p">(</span><span class="s">&#39;123-123-1234&#39;</span><span class="p">)</span></code></pre></div>
<p>Here is the query that we&rsquo;re using to retrieve our data. We&rsquo;ll retrieve impressions, clicks, and cost segmented by date, from &ldquo;2023-10-19&rdquo; until &ldquo;2023-11-01&rdquo;.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># run query</span>
<span class="n">google_ads_account_data</span> <span class="o">=</span> <span class="nf">gads_get_report</span><span class="p">(</span>
  <span class="n">resource</span>    <span class="o">=</span> <span class="s">&#34;customer&#34;</span><span class="p">,</span>
  <span class="n">fields</span>      <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;segments.date&#34;</span><span class="p">,</span>
                  <span class="s">&#34;metrics.impressions&#34;</span><span class="p">,</span>
                  <span class="s">&#34;metrics.clicks&#34;</span><span class="p">,</span>
                  <span class="s">&#34;metrics.cost_micros&#34;</span><span class="p">),</span>
  <span class="n">date_from</span>   <span class="o">=</span> <span class="s">&#34;2023-10-19&#34;</span><span class="p">,</span>
  <span class="n">date_to</span>     <span class="o">=</span> <span class="s">&#34;2023-11-01&#34;</span>
<span class="p">)</span></code></pre></div>
<p>The first argument you need to define is the <strong>resource</strong> you are getting the data from, in our case <code>customer</code>.</p>
<p>You can find <a href="https://developers.google.com/google-ads/api/fields/v13/overview#list-of-all-resources">here</a> the list of all available resources.</p>
<p>For example, if you would like to retrieve data at the ad group level, you should define the resource as <a href="https://developers.google.com/google-ads/api/fields/v13/ad_group"><code>ad_group</code></a>.</p>
<p>To build our query, we can use the <a href="https://developers.google.com/google-ads/api/fields/v13/customer_query_builder">Google Ads query builder</a>, which can be used for any resource, in our case <code>customer</code>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/build-customer-query.jpg" title="Build customer query">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/build-customer-query.jpg" layout="responsive" alt="Build customer query" height="390" width="890"></amp-img>
  
    </a>
  

<p>Below you can select attributes, segments, or metrics:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/select-attributes-segments-metrics.jpg" title="Select attributes, segments, metrics">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/select-attributes-segments-metrics.jpg" layout="responsive" alt="Select attributes, segments, metrics" height="409" width="885"></amp-img>
  
    </a>
  

<p>When you select fields, it will start populating the query in the user interface of the builder.</p>
<p>This is very useful to know what the metrics and dimensions are called in the Google Ads API.</p>
<p>Here is the final part of our Data loader block, which should always be a variable containing data, as we have to pass something to the next block.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># return data</span>
<span class="n">google_ads_account_data</span></code></pre></div>
<p>Here is the complete code block we&rsquo;re working with:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">rgoogleads</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">purrr</span><span class="p">)</span>

<span class="n">load_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1"># Specify your data loading logic here</span>
    <span class="c1"># Return value: loaded dataframe</span>
    
    <span class="c1"># load Google Ads access token</span>
    <span class="n">my_token</span> <span class="o">=</span> <span class="nf">readRDS</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#34;google_ads_token_mage_demo.RDS&#34;</span><span class="p">)</span>
    
    <span class="c1"># Authenticate with the token</span>
    <span class="nf">gads_auth</span><span class="p">(</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_token</span><span class="p">)</span>
    
    <span class="c1"># Set the Google Ads account id you want to get data from</span>
    <span class="nf">gads_set_customer_id</span><span class="p">(</span><span class="s">&#39;123-123-1234&#39;</span><span class="p">)</span>

    <span class="c1"># run query</span>
    <span class="n">google_ads_account_data</span> <span class="o">=</span> <span class="nf">gads_get_report</span><span class="p">(</span>
      <span class="n">resource</span>    <span class="o">=</span> <span class="s">&#34;customer&#34;</span><span class="p">,</span>
      <span class="n">fields</span>      <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;segments.date&#34;</span><span class="p">,</span>
                      <span class="s">&#34;metrics.impressions&#34;</span><span class="p">,</span>
                      <span class="s">&#34;metrics.clicks&#34;</span><span class="p">,</span>
                      <span class="s">&#34;metrics.cost_micros&#34;</span><span class="p">),</span>
      <span class="n">date_from</span>   <span class="o">=</span> <span class="s">&#34;2023-10-19&#34;</span><span class="p">,</span>
      <span class="n">date_to</span>     <span class="o">=</span> <span class="s">&#34;2023-11-01&#34;</span>
    <span class="p">)</span>

<span class="c1"># return data for next block</span>
<span class="n">google_ads_account_data</span>
<span class="p">}</span></code></pre></div>
<p>If you run this code, you should be able to see clicks, cost, and impressions segmented by date.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/ads-data-table.jpg" title="Ads data in a table">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/ads-data-table.jpg" layout="responsive" alt="Ads data in a table" height="828" width="1410"></amp-img>
  
    </a>
  

<p>We&rsquo;re now done with this Data Loader block. Next, let&rsquo;s move on to <strong>transformers</strong>.</p>
<h4 id="join-ga4-and-google-ads-data">Join GA4 and Google Ads data</h4>
<p>In Mage, add a new <strong>Transformer</strong> block and select <strong>R</strong> as the programming language.</p>
<p>Give the block a name like <code>join_ga4_google_ads</code> and click on &ldquo;Save and add block&rdquo;.</p>
<p>In the Tree, we can now see that the Transformer block named <code>join_ga4_google_ads</code> only receives data from the Data Loader block <code>google_ads</code>. We need to also link the Data Loader <code>ga4</code> with the Transformer.</p>
<p>To do this, you simply need to drag and drop the arrow from the <code>ga4</code> block to the <code>join_ga4_google_ads</code> Transformer.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/join-ga4-transformer.jpg" title="Join ga4 with transformer">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/join-ga4-transformer.jpg" layout="responsive" alt="Join ga4 with transformer" height="782" width="1148"></amp-img>
  
    </a>
  

<p>The first thing that we&rsquo;ll do in the Transformer block is to add the final variables from the previous Data loader blocks to the <code>transform()</code> function.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/transform-data-loader-functions.jpg" title="Transform data loader functions">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/transform-data-loader-functions.jpg" layout="responsive" alt="Transform data loader functions" height="774" width="1460"></amp-img>
  
    </a>
  

<p>Next, we can add the following packages on top of the <code>transform()</code> function:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">tibble</span><span class="p">,</span> <span class="n">dplyr</span><span class="p">,</span> <span class="n">purrr</span><span class="p">,</span> <span class="n">stringr</span><span class="p">,</span> <span class="n">lubridate</span><span class="p">)</span></code></pre></div>
<p>The first piece of code that we&rsquo;re adding is this:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Build a row with the exact time</span>
<span class="n">check_time</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">Date</span> <span class="o">=</span> <span class="nf">Sys.time</span><span class="p">(),</span>
                    <span class="n">Impressions</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
                    <span class="n">Sessions</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
                    <span class="n">Clicks</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
                    <span class="n">Cost</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span>
                    <span class="n">Goals</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span></code></pre></div>
<p>I am creating this tibble called <code>check_time</code> only so that later in BigQuery we can verify whether our schedule from Mage is working correctly.</p>
<p>Then, we can finally join the Google Ads data with the GA4 data, and also return the <code>merged_data</code> variable for the next block:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Merge Google Ads with GA4 Data</span>
<span class="n">merged_data</span> <span class="o">=</span> <span class="n">google_ads_account_data</span> <span class="o">%&gt;%</span>
  
  <span class="nf">left_join</span><span class="p">(</span><span class="n">sessions_goals_ga4</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;date&#34;</span> <span class="o">=</span> <span class="s">&#34;date&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  
  <span class="c1"># reorder and capitalise columns</span>
  <span class="nf">select</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">impressions</span><span class="p">,</span> <span class="n">sessions</span><span class="p">,</span> <span class="n">clicks</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">goals</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="nf">set_names</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">.)</span> <span class="o">%&gt;%</span> <span class="nf">str_to_title</span><span class="p">())</span> <span class="o">%&gt;%</span>
  
  <span class="c1"># add check_time variable to verify schedule</span>
  <span class="nf">mutate</span><span class="p">(</span><span class="n">Date</span> <span class="o">=</span> <span class="n">Date</span> <span class="o">%&gt;%</span> <span class="nf">as_datetime</span><span class="p">())</span> <span class="o">%&gt;%</span>
  <span class="nf">bind_rows</span><span class="p">(</span><span class="n">check_time</span><span class="p">)</span> <span class="o">%&gt;%</span>

  <span class="c1"># replace NAs with 0</span>
  <span class="nf">replace</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">.)</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="o">%&gt;%</span>
  
  <span class="nf">arrange</span><span class="p">(</span><span class="nf">desc</span><span class="p">(</span><span class="n">Date</span><span class="p">))</span>

<span class="c1"># Return merged_data variable for next block</span>
<span class="n">merged_data</span></code></pre></div>
<p>If everything worked properly, you should get something similar to this:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/joined-data-after-transformation.jpg" title="Joined data after transformation">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/joined-data-after-transformation.jpg" layout="responsive" alt="Joined data after transformation" height="398" width="987"></amp-img>
  
    </a>
  

<p>I am aware that we&rsquo;re joining Google Ads data with GA4 data from all sources, and we should actually only join GA4 data coming from Google Ads. However, the goal of this guide is simply to show how to perform data engineering tasks with digital data.</p>
<h4 id="export-data-to-bigquery">Export data to BigQuery</h4>
<p>Now that we joined data successfully from Google Ads and GA4, we&rsquo;re ready to export the data to BigQuery.</p>
<p>Browse to the <a href="https://console.cloud.google.com/bigquery/">BigQuery console</a> in your Google Cloud Platform project.</p>
<p>BigQuery has the following data hierarchy: <strong>project</strong> -&gt; <strong>dataset</strong> -&gt; <strong>table</strong>.</p>
<p>We already have a project, so now we need to create a dataset where our tables will reside. Click on the three dots on the right of your project, and then on &ldquo;Create data set&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/create-bq-dataset.jpg" title="Create BQ dataset">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/create-bq-dataset.jpg" layout="responsive" alt="Create BQ dataset" height="450" width="1024"></amp-img>
  
    </a>
  

<p>Give a name to your data set, select a region, and click on &ldquo;CREATE DATA SET&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/configure-bq-dataset.jpg" title="Configure BQ dataset">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/configure-bq-dataset.jpg" layout="responsive" alt="Configure BQ dataset" height="1294" width="1120"></amp-img>
  
    </a>
  

<p>Back in Mage, add a <strong>Data Exporter</strong> block and choose <strong>R</strong> as the programming language again.</p>
<p>Name the block <code>biq_query_export</code> and click on &ldquo;Save and add block&rdquo;.</p>
<p>This is what your data tree should look like.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-data-tree.jpg" title="Mage data tree">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-data-tree.jpg" layout="responsive" alt="Mage data tree" height="1000" width="1082"></amp-img>
  
    </a>
  

<p>Go the the <code>big_query_export</code> block, and add <code>merged_data</code> as the argument of the function <code>export_data()</code>. Also, let&rsquo;s load the <code>bigrquery</code> package.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">bigrquery</span><span class="p">)</span>

<span class="n">export_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1"># Specify your data exporting logic here</span>
    <span class="c1"># Return value: exported dataframe</span>
    
<span class="p">}</span></code></pre></div>
<p>To authenticate with BigQuery, we can actually use the service account key that we previously created for GA4.</p>
<p>The only thing that changes is the function <code>bq_auth()</code> instead of <code>ga_auth()</code>.</p>
<p>This is great news as it means we don&rsquo;t have to go through yet another cumbersome authentication process:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Authenticate</span>
<span class="nf">bq_auth</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;mage-ai-test-405614-2e1e1c865c18.json&#34;</span><span class="p">)</span></code></pre></div>
<p>In fact, you can use the same service account key to authenticate with multiple Google services such as Google Drive or Google Sheets.</p>
<p>There are different R packages for these services, such as <a href="https://googledrive.tidyverse.org/reference/drive_auth.html"><code>googledrive</code></a> and <a href="https://www.rdocumentation.org/packages/googlesheets4/versions/0.1.0/topics/sheets_auth"><code>googlesheets4</code></a>.</p>
<p>Granted, you need to authorize the respective APIs in the Google Cloud Platform as shown previously, but this is a great time saver!</p>
<p>The next thing to do is to create a table reference for BigQuery.</p>
<p>As you may remember, we previously created only a data set, so we now need to create a placeholder for our table.</p>
<p>To do so, we need to define our project name, data set, and table. The project name and data set are already defined and we can retrieve these from BigQuery. The table name is up to you.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># Define Big Query Project data</span>
<span class="n">project</span> <span class="o">=</span> <span class="s">&#34;mage-ai-test-405614&#34;</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="s">&#34;mage_demo&#34;</span>
<span class="n">table</span> <span class="o">=</span> <span class="s">&#34;merged_data&#34;</span>

<span class="c1"># Define table</span>
<span class="n">table</span> <span class="o">=</span> <span class="nf">bq_table</span><span class="p">(</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span></code></pre></div>
<p>To find the right project and data set name, go to BigQuery and click on the data set you created.</p>
<p>To the right, you should see the <strong>Data set ID</strong>, which comprises <code>project_name.data_set_name</code>. You can separate and copy those values to insert them into the code above.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/dataset-info.jpg" title="data set info">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/dataset-info.jpg" layout="responsive" alt="data set info" height="536" width="1390"></amp-img>
  
    </a>
  

<p>In the following code, if the table exists, we delete and recreate it before uploading data.</p>
<p>I&rsquo;m doing this every 5 minutes for demonstration, but in real production, I&rsquo;d likely run it less frequently, adding only the new data instead of recreating the whole table.</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">if</span><span class="p">(</span><span class="nf">bq_table_exists</span><span class="p">(</span><span class="n">table</span><span class="p">)){</span>
  <span class="c1"># if table already exists, delete it</span>
  <span class="nf">bq_table_delete</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
	
	<span class="c1"># recreate table so that we can fill it out</span>
  <span class="nf">bq_table_create</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
	
	<span class="c1"># fill out table</span>
  <span class="nf">bq_table_upload</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
<span class="p">}</span><span class="n">else</span><span class="p">{</span>
  <span class="nf">bq_table_create</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
  <span class="nf">bq_table_upload</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<p>Here is the final code:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="nf">library</span><span class="p">(</span><span class="s">&#34;pacman&#34;</span><span class="p">)</span>
<span class="nf">p_load</span><span class="p">(</span><span class="n">bigrquery</span><span class="p">)</span>

<span class="n">export_data</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1"># Specify your data exporting logic here</span>
    <span class="c1"># Return value: exported dataframe</span>

    <span class="c1"># Authenticate</span>
    <span class="nf">bq_auth</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">&#34;mage-ai-test-405614-2e1e1c865c18.json&#34;</span><span class="p">)</span>

    <span class="c1"># Define Big Query Project data</span>
    <span class="n">project</span> <span class="o">=</span> <span class="s">&#34;mage-ai-test-405614&#34;</span>
    <span class="n">data_set</span> <span class="o">=</span> <span class="s">&#34;mage_demo&#34;</span>
    <span class="n">table</span> <span class="o">=</span> <span class="s">&#34;merged_data&#34;</span>

    <span class="c1"># Create table reference</span>
    <span class="n">table</span> <span class="o">=</span> <span class="nf">bq_table</span><span class="p">(</span><span class="n">project</span> <span class="o">=</span> <span class="n">project</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="p">)</span>

    <span class="nf">if</span><span class="p">(</span><span class="nf">bq_table_exists</span><span class="p">(</span><span class="n">table</span><span class="p">)){</span>
      <span class="c1"># if table already exists, delete it</span>
      <span class="nf">bq_table_delete</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
	
	    <span class="c1"># recreate table so that we can fill it out</span>
      <span class="nf">bq_table_create</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
	
	    <span class="c1"># fill out table</span>
      <span class="nf">bq_table_upload</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
    <span class="p">}</span><span class="n">else</span><span class="p">{</span>
      <span class="nf">bq_table_create</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
      <span class="nf">bq_table_upload</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>If you run the code, you should have a new table called <code>merged_data</code> in BigQuery. If you click PREVIEW, you should be able to see data within.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/bigquery-preview.jpg" title="BQ preview">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/bigquery-preview.jpg" layout="responsive" alt="BQ preview" height="231" width="1113"></amp-img>
  
    </a>
  

<p>Our pipeline is complete, as you can see all the blocks have a green tick:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-pipeline-complete.jpg" title="Mage pipeline complete">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-pipeline-complete.jpg" layout="responsive" alt="Mage pipeline complete" height="1036" width="1134"></amp-img>
  
    </a>
  

<h3 id="test-the-entire-pipeline">Test the entire pipeline</h3>
<p>Only because each block ran successfully, there is no guarantee that the entire pipeline will run smoothly. So, we have to run the entire pipeline before creating a schedule.</p>
<p>In Mage, click on &ldquo;Triggers&rdquo;:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-triggers.jpg" title="Mage triggers">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-triggers.jpg" layout="responsive" alt="Mage triggers" height="280" width="1208"></amp-img>
  
    </a>
  

<p>At the top, click on <strong>Run @once</strong>.</p>
<p>This will produce a trigger, and you&rsquo;ll see that its status will change to <code>running</code>:</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/trigger-running.jpg" title="Trigger running">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/trigger-running.jpg" layout="responsive" alt="Trigger running" height="94" width="908"></amp-img>
  
    </a>
  

<p>When done, it should say <code>completed</code> and switch to inactive state.</p>
<p>If we now refresh the BigQuery table, we can see that it has an updated date/time for the rows. This means that our pipeline ran successfully!</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/date-time-bigquery-updated.jpg" title="Date time updated in BQ">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/date-time-bigquery-updated.jpg" layout="responsive" alt="Date time updated in BQ" height="237" width="1090"></amp-img>
  
    </a>
  

<h3 id="create-a-schedule">Create a schedule</h3>
<p>Now that we know that our pipeline works properly, let&rsquo;s create a trigger that runs every 5 minutes.</p>
<p>In Mage&rsquo;s Triggers view, click on <strong>New trigger</strong>.</p>
<p>Select <strong>Schedule</strong> as the trigger type.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/mage-new-schedule-trigger.jpg" title="New schedule trigger">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/mage-new-schedule-trigger.jpg" layout="responsive" alt="New schedule trigger" height="218" width="978"></amp-img>
  
    </a>
  

<p>Given that the trigger will run every 5 minutes, let&rsquo;s name it <code>every_5_minutes</code>.</p>
<p>Select <strong>custom</strong> as frequency and give the following <em>cron</em> expression: <code>*/5 * * * *</code></p>


    <a href="https://www.simoahava.com/amp/images/2023/11/every-five-minutes.jpg" title="Every five minutes">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/every-five-minutes.jpg" layout="responsive" alt="Every five minutes" height="581" width="950"></amp-img>
  
    </a>
  

<p>A <em>cron</em> expression is like a schedule for your computer tasks.</p>
<p>It&rsquo;s a simple set of instructions that tells your system when to run a specific job.</p>
<p>The expression consists of five parts, representing minutes, hours, days, months, and days of the week. For example, <code>*/15 * * * *</code> means &ldquo;every 15 minutes, every hour, every day, every month, every day of the week&rdquo;.</p>
<p>When ready with the trigger, click on <strong>Save changes</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/save-schedule-trigger.jpg" title="Save schedule trigger">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/save-schedule-trigger.jpg" layout="responsive" alt="Save schedule trigger" height="556" width="965"></amp-img>
  
    </a>
  

<p>Now you have created your trigger, but as you can see its status is <code>inactive</code>. To start it, click on <strong>Start trigger</strong>.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/start-schedule-trigger.jpg" title="Start schedule trigger">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/start-schedule-trigger.jpg" layout="responsive" alt="Start schedule trigger" height="826" width="1398"></amp-img>
  
    </a>
  

<p>The status switches to <code>active</code>. If you browse back to the Triggers view, it will show you when it&rsquo;s set to trigger next.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/trigger-next-run-date.jpg" title="Next run date">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/trigger-next-run-date.jpg" layout="responsive" alt="Next run date" height="211" width="934"></amp-img>
  
    </a>
  

<p>Be mindful of the fact that the time zone in Mage is in UTC.</p>
<p>Once the timer is set to go off, its status should change to <code>running</code>.</p>
<p>After it&rsquo;s run, you can now refresh the BigQuery table and see that the data has now been updated again.</p>


    <a href="https://www.simoahava.com/amp/images/2023/11/bigquery-schedule-updated.jpg" title="BigQuery schedule updated">
  
    <amp-img src="https://www.simoahava.com/amp/images/2023/11/bigquery-schedule-updated.jpg" layout="responsive" alt="BigQuery schedule updated" height="281" width="1102"></amp-img>
  
    </a>
  

<p>Congratulations! Our journey is complete. I hope you had fun and learned something useful.</p>
<p>If you have any comments, please post them below. If you want to connect with me, Arben, here is my <a href="https://www.linkedin.com/in/arben-kqiku-301457117/">LinkedIn</a>!</p>

        
          <h2 id="summary-by-simo">Summary (by Simo)</h2>
<p>Thank you so much, Arben!</p>
<p>There&rsquo;s something just <em>magical</em> about automation platforms like Mage.ai.</p>
<p>Being able to plug different components and services into a directed graph is such a powerful asset in today&rsquo;s data engineering world.</p>
<p>Even though this guide was long and comprehensive, hopefully you got the idea that data engineering on this level is not beyond the reach of anyone.</p>
<p>Arben was using some very basic building blocks: API connectors, service accounts, and queries, all wrapped up with the R programming language.</p>
<p>Even if you didn&rsquo;t understand all the individual parts of this machine, hopefully you can appreciate how they all work together to generate the joined data export in your data warehouse (BigQuery in this case) as a result.</p>
<p>As always, please share your thoughts in the comments below. Don&rsquo;t hesitate to contact <a href="https://www.linkedin.com/in/arben-kqiku-301457117/">Arben</a> if you want to shower him with praise for this excellent guide!</p>

        
      
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://www.simoahava.com/amp/"></a>
    </figure>
    

    
    
    
        
    
    

    <section class="author">
      <h4>Simo Ahava</h4>
      
        <p>Husband | Father | Analytics developer</p>
      
      <div class="author-meta">
        <span class="author-location icon-location">Espoo, Finland</span>
        <span class="author-link icon-link"><a href="https://www.simoahava.com/">https://www.simoahava.com/</a></span>
      </div>
    </section>


    
    <div class="social">

<amp-social-share type="twitter"
  width="60"
  height="44"> </amp-social-share>





<amp-social-share type="linkedin"
                  width="60"
                  height="44"></amp-social-share>


    <amp-social-share type="facebook"
                      width="60"
                      height="44"></amp-social-share>

</div>


    
  </footer>
</article>

</main>
</div>

</body>
</html>

