

  
    
  


  

<!doctype html>



<html âš¡ lang="en-us" class="no-js">
    <head>

      <meta charset="utf-8">
        <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script><script async custom-element="amp-accordion" src="https://cdn.ampproject.org/v0/amp-accordion-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

<script async src="https://cdn.ampproject.org/v0.js"></script>


<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<style amp-custom>
  .type-simmer {
      padding: 8px;
      background: rgba(179,138,197,0.2);
      box-shadow: 2px 2px 1px #ccc;
      border-radius: 5px;
  }
    /*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.hidden{text-indent:-9999px;visibility:hidden;display:none}.inner{position:relative;width:80%;max-width:710px;margin:0 auto}.vertical{display:table-cell;vertical-align:middle}.site-wrapper{position:relative;z-index:10;min-height:100%;background:#fff;-webkit-transition:-webkit-transform .5s ease;transition:-webkit-transform .5s ease;transition:transform .5s ease;transition:transform .5s ease,-webkit-transform .5s ease}html{font-size:62.5%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body,html{height:100%;max-height:100%}body{font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.8rem;line-height:1.75em;color:#3a4145;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1;text-rendering:geometricPrecision}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{-webkit-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-moz-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;-o-font-feature-settings:"dlig" 1,"liga" 1,"lnum" 1,"kern" 1;color:#2e2e2e;line-height:1.15em;margin:0 0 .4em;font-family:Open Sans,sans-serif;text-rendering:geometricPrecision}h1{font-size:5rem;letter-spacing:-2px;text-indent:-3px}h2{font-size:3.6rem;letter-spacing:-1px}h3{font-size:3rem}h4{font-size:2.5rem}h5,h6{font-size:2rem}a,a:active,a:hover,a:visited{color:#4a4a4a;-webkit-transition:color .3s ease;transition:color .3s ease}a:active,a:hover{color:#111}dl,ol,p,ul{-webkit-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-moz-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;-o-font-feature-settings:"liga" 1,"onum" 1,"kern" 1;margin:0 0 1.75em;text-rendering:geometricPrecision}ol,ul{padding-left:3rem}ol ol,ol ul,ul ol,ul ul{margin:0 0 .4em;padding-left:2em}dl dt{float:left;width:180px;overflow:hidden;clear:left;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd,dl dt{margin-bottom:1em}dl dd{margin-left:200px}li{margin:.4em 0}li li{margin:0}hr{display:block;height:1px;border:0;border-top:1px solid #efefef;margin:3.2em 0;padding:0}blockquote{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0 1.75em -2.2em;padding:0 0 0 1.75em;border-left:.4em solid #4a4a4a}blockquote p{margin:.8em 0;font-style:italic}blockquote small{display:inline-block;margin:.8em 0 .8em 1.5em;font-size:.9em;color:#ccc}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:400}mark{background-color:#ffc336}code,tt{padding:1px 3px;font-size:.85em;white-space:pre-wrap;border:1px solid #e3edf3;border-radius:2px}code,pre,tt{font-family:Inconsolata,monospace,sans-serif;background:#f7fafb}pre{-webkit-box-sizing:border-box;box-sizing:border-box;margin:0 0 1.75em;border:1px solid #e3edf3;width:100%;padding:10px;font-size:.9em;white-space:pre;overflow:auto;border-radius:3px}pre code,pre tt{font-size:inherit;white-space:pre-wrap;background:transparent;border:none;padding:0}kbd{display:inline-block;margin-bottom:.4em;padding:1px 8px;border:1px solid #ccc;color:#666;text-shadow:#fff 0 1px 0;font-size:.9em;font-weight:700;background:#f4f4f4;border-radius:4px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 1px 0 0 #fff inset;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 1px 0 0 #fff}table{-webkit-box-sizing:border-box;box-sizing:border-box;margin:1.75em 0;width:100%;max-width:100%;background-color:transparent}table td,table th{padding:8px;line-height:20px;text-align:left;vertical-align:top;border-top:1px solid #efefef}table th{color:#000}table caption+thead tr:first-child td,table caption+thead tr:first-child th,table colgroup+thead tr:first-child td,table colgroup+thead tr:first-child th,table thead:first-child tr:first-child td,table thead:first-child tr:first-child th{border-top:0}table tbody+tbody{border-top:2px solid #efefef}table table table{background-color:#fff}table tbody>tr:nth-child(odd)>td,table tbody>tr:nth-child(odd)>th{background-color:#f6f6f6}table.plain tbody>tr:nth-child(odd)>td,table.plain tbody>tr:nth-child(odd)>th{background:transparent}.fluid-width-video-wrapper,iframe{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe{margin:0}.main-header{position:relative;display:table;width:100%;height:100vh;margin-bottom:5rem;text-align:center;background:#222 no-repeat 50%;background-size:cover;overflow:hidden}.main-header.cover{background-image:url("https://www.simoahava.com/images/maisema.jpg")}.main-header.list-cover{background-image:url("/")}.main-header .inner{width:80%}.main-header a.bloglogo{text-decoration:none}.main-header a.bloglogo .icon-facebook,.main-header a.bloglogo .icon-github,.main-header a.bloglogo .icon-google-plus,.main-header a.bloglogo .icon-instagram,.main-header a.bloglogo .icon-linkedin,.main-header a.bloglogo .icon-pinterest,.main-header a.bloglogo .icon-twitter{color:#fff;font-size:2em}.main-nav{position:relative;padding:35px 40px;margin:0 0 30px}.main-nav a{text-decoration:none;font-family:Open Sans,sans-serif}.scroll-down{display:block;position:absolute;z-index:100;bottom:45px;left:50%;font-size:1.5em;text-align:center;-webkit-animation:bounce 4s 2s infinite;animation:bounce 4s 2s infinite}.scroll-down:hover{color:#fff;-webkit-animation:none;animation:none}.home-template .main-header:after{display:block;content:" ";width:150px;height:130px;border-radius:100%;position:absolute;bottom:0;left:50%;margin-left:-75px;background:radial-gradient(ellipse at center,rgba(0,0,0,.15) 0,transparent 70%,transparent 100%)}.archive-template .main-header:after,.archive-template .scroll-down,.no-cover.main-header:after,.no-cover .scroll-down{display:none}.blog-logo{display:block;float:left}.blog-logo img{display:block;padding:1px 0 5px;width:auto}.blog-logo img,.menu-button{-webkit-box-sizing:border-box;box-sizing:border-box;height:38px}.menu-button{display:inline-block;float:right;padding:0 15px;border:1px solid #bfc8cd;opacity:1;color:#9eabb3;text-align:center;font-size:12px;text-transform:uppercase;line-height:35px;white-space:nowrap;border-radius:3px;background:rgba(0,0,0,.1);-webkit-transition:all .5s ease;transition:all .5s ease}.menu-button:focus{outline:0}.menu-button .fa-bars{font-size:12px;margin-right:6px}.main-nav.overlay{position:absolute;top:0;left:0;right:0;height:70px;border:none;background:-webkit-gradient(linear,left top,left bottom,from(rgba(0,0,0,.2)),to(transparent));background:linear-gradient(180deg,rgba(0,0,0,.2) 0,transparent)}.no-cover .main-nav.overlay,.no-cover .menu-button{background:none}.main-nav.overlay a{color:#fff}.main-nav.overlay .menu-button{border-color:hsla(0,0%,100%,.6)}.cover .main-nav.overlay a.menu-button:hover{color:#222;border-color:#fff;background:#fff}.menu-button:hover,.no-cover .main-nav.overlay .menu-button:hover{border-color:#555;color:#555}.page-title{margin:10px 0;font-size:5rem;letter-spacing:-1px;font-weight:700;font-family:Open Sans,sans-serif;color:#fff}.page-description{margin:0;font-size:2rem;line-height:1.5em;font-weight:400;font-family:Merriweather,serif;letter-spacing:.01rem;color:hsla(0,0%,100%,.8)}.no-cover.main-header{min-height:160px;max-height:40vh;background:#f5f8fa}.no-cover .page-title{color:rgba(0,0,0,.8)}.no-cover .page-description{color:rgba(0,0,0,.5)}.no-cover .main-nav.overlay .menu-button{color:rgba(0,0,0,.4);border-color:rgba(0,0,0,.3)}.main-header-content .page-title{-webkit-animation:fade-in-down .6s;animation:fade-in-down .6s;-webkit-animation-delay:.2s;animation-delay:.2s}.main-header-content .page-description{-webkit-animation:fade-in-down .9s;animation:fade-in-down .9s;-webkit-animation-delay:.1s;animation-delay:.1s}.post{position:relative;width:80%;max-width:710px;margin:4rem auto;padding-bottom:4rem;border-bottom:1px solid #ebf2f6;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto}.post-header{padding-bottom:10px}.post:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}body:not(.post-template) .post-title{font-size:3.6rem}.post-title a{text-decoration:none}.post-excerpt p{margin:0;font-size:.9em;line-height:1.7em}.read-more{font-size:.8em;text-decoration:none;font-style:italic}.post-meta{display:block;margin:1.75rem 0 0;font-family:Open Sans,sans-serif;font-size:1.5rem;line-height:2.2rem;color:#9eabb3}.author-thumb{width:24px;height:24px;float:left;margin-right:9px;border-radius:100%}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.user-meta{position:relative;padding:.3rem 40px 0 100px;min-height:77px}.post-date{display:inline-block;margin-left:8px;padding-left:12px;border-left:1px solid #d5dbde;text-transform:uppercase;font-size:1.3rem;white-space:nowrap}.user-image{position:absolute;top:0;left:0}.user-name{display:block;font-weight:700}.user-bio{display:block;max-width:440px;font-size:1.4rem;line-height:1.5em}.publish-meta{position:absolute;top:0;right:0;padding:4.3rem 0 4rem;text-align:right}.publish-heading{display:block;font-weight:700}.publish-date{display:block;font-size:1.4rem;line-height:1.5em}figure.no-margin{margin:0}figure.center{margin-left:auto;margin-right:auto}.amp-image-lightbox-caption{text-align:center;font-size:.8em}@media only screen and (min-width:501px){figure.polaroid:after,figure.polaroid:before{content:"";position:absolute;z-index:-2;bottom:10px;width:50%;height:20%;max-width:480px;-webkit-box-shadow:0 15px 10px rgba(0,0,0,.7);box-shadow:0 15px 10px rgba(0,0,0,.7)}figure.polaroid:after{right:10px;left:auto;-webkit-transform:rotate(3deg);transform:rotate(3deg)}figure.polaroid:before{left:10px;right:auto;-webkit-transform:rotate(-3deg);transform:rotate(-3deg)}figure.polaroid{width:450px;position:relative;padding:15px;border:none;background:#fff;-webkit-box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset;box-shadow:0 1px 4px rgba(0,0,0,.3),inset 0 0 40px rgba(0,0,0,.1);border-radius:4px;margin-bottom:1.5em;max-width:100%}figure.polaroid div[fallback]{border:none;margin:0;padding:0}figure.polaroid amp-img{display:block;outline:1px solid #ccc;padding:0;margin:0}figure.polaroid figcaption{font-size:1.3em;font-weight:400;font-family:Kaushan Script,cursive;text-align:right;padding:.8em .5em .4em}}@media only screen and (max-width:501px){figure.polaroid{background:#fff;border-radius:1px;margin-bottom:1em}figure.polaroid figcaption{font-size:.8em;font-style:italic;text-align:center;border-top:1px solid #d3d3d3;border-bottom:1px solid #d3d3d3;margin-top:.5em;padding:.2em}}.main-header.cover .main-header-content .social-link a,.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.main-header.cover .main-header-content .social-link a:visited,.scroll-down a,.scroll-down a:active,.scroll-down a:hover,.scroll-down a:visited{text-decoration:none;font-size:2em}.main-header.cover .main-header-content .social-link a:active,.main-header.cover .main-header-content .social-link a:hover,.scroll-down a:active,.scroll-down a:hover{color:#fff}.main-header.no-cover .main-header-content .social-link a,.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover,.main-header.no-cover .main-header-content .social-link a:visited{text-decoration:none;font-size:2em;color:#a2a2a2}.main-header.no-cover .main-header-content .social-link a:active,.main-header.no-cover .main-header-content .social-link a:hover{color:#000}.post-template .post-header{margin-bottom:3.4rem}.post-template .post-title{margin-bottom:0}.post-template .post-meta{margin:0}.post-template .post-date{padding:0;margin:0;border:none}.post-template .content{overflow:hidden}.post-template .post{margin-top:0;border-bottom:none;padding-bottom:0}.post-template .post:after{display:none}.post-content{text-align:justify}.post-footer{position:relative;margin:6rem 0 0;padding:6rem 0 0;border-top:1px solid #ebf2f6}.post-footer h4{font-size:1.8rem;margin:0}.post-footer p{margin:1rem 0;font-size:1.4rem;line-height:1.75em}.author-meta{padding:0;margin:0;list-style:none;font-size:1.4rem;line-height:1;font-style:italic}.author-meta,.author-meta a{color:#9eabb3}.author-meta a:hover{color:#111}.post-footer .author{margin-right:180px}.post-footer h4 a{color:#2e2e2e;text-decoration:none}.post-footer h4 a:hover{text-decoration:underline}.post-footer .share{position:absolute;top:6rem;right:0;width:180px}.post-footer .share a{font-size:1.8rem;display:inline-block;margin:1rem 1.6rem 1.6rem 0;color:#bbc7cc;text-decoration:none}.post-footer .share a:hover{color:#50585d}.post-head.main-header{height:65vh;min-height:180px}.no-cover.post-head.main-header{height:85px;min-height:0;margin-bottom:0;background:transparent}.author-head.main-header,.tag-head.main-header{height:40vh;min-height:180px}.no-cover.author-head.main-header{height:10vh;min-height:100px;background:transparent}.author-profile{padding:0 15px 5rem;border-bottom:1px solid #ebf2f6;text-align:center}.author-profile:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.author-image{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;top:-56px;left:50%;margin-left:-40px;width:80px;height:80px;border-radius:100%;overflow:hidden;padding:6px;background:#fff;z-index:2;-webkit-box-shadow:#e7eef2 0 0 0 1px;box-shadow:0 0 0 1px #e7eef2}.author-image .img{position:relative;display:block;width:100%;height:100%;background-size:cover;background-position:50%;border-radius:100%;background-image:url("https://www.simoahava.com/images/simo.png")}.author-profile .author-image{position:relative;left:auto;top:auto;width:120px;height:120px;padding:3px;margin:-100px auto 0;-webkit-box-shadow:none;box-shadow:none}.author-title{margin:1.5rem 0 1rem}.author-bio{font-size:1.8rem;line-height:1.5em;font-weight:200;color:#50585d;letter-spacing:0;text-indent:0}.author-meta{margin:1.6rem 0}.author-profile .author-meta{margin:2rem 0;font-family:Merriweather,serif;letter-spacing:.01rem;font-size:1.7rem}.author-meta span{display:inline-block;margin:0 2rem 1rem 0;word-wrap:break-word}.author-meta a{text-decoration:none}.archive-template .author-profile .author-meta{display:none}@-webkit-keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@keyframes fade-in-down{0%{opacity:0;transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}to{opacity:1;transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}}@-webkit-keyframes bounce{0%,10%,25%,40%,50%{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}20%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}30%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0);-webkit-transform:translateY(0);-ms-transform:translateY(0)}40%{transform:translateY(-10px);-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px)}60%{transform:translateY(-5px);-webkit-transform:translateY(-5px);-ms-transform:translateY(-5px)}}#sidebar{background:rgba(0,0,0,.7);text-align:left;overflow-y:auto;font-family:Open Sans,Verdana,sans-serif;font-weight:700;font-size:11px;color:#909090;width:400px}#sidebar .nav-title{position:absolute;top:45px;left:30px;font-size:1.5em;font-weight:100;text-transform:uppercase;color:#fff}#sidebar .nav-section{color:#d8d8d8}#sidebar .nav-close{position:absolute;top:38px;right:25px;width:20px;height:20px;padding:0;font-size:10px}#sidebar .nav-close:focus{outline:0}#sidebar .nav-close:after,#sidebar .nav-close:before{content:"";position:absolute;top:0;width:20px;height:1px;background:#969696;top:15px;-webkit-transition:background .15s ease;transition:background .15s ease}#sidebar .nav-close:before{-webkit-transform:rotate(45deg);transform:rotate(45deg)}#sidebar .nav-close:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}#sidebar .nav-close:hover:after,#sidebar .nav-close:hover:before{background:#fff}#sidebar amp-accordion .nav-section{margin:.4em 0 .2em;background:none;border:none;font-size:2rem}#sidebar amp-accordion section[expanded] .nav-section .fa{width:1ch}#sidebar amp-accordion section[expanded] .nav-section .section-open{display:inline-block}#sidebar amp-accordion section[expanded] .nav-section .section-close{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-open{display:none}#sidebar amp-accordion section:not([expanded]) .nav-section .section-close{display:inline-block}#sidebar ul{padding:90px 9% 5%;list-style:none;counter-reset:item}#sidebar li:before{display:block;float:right;padding-right:4%;padding-left:5px;text-align:right;font-size:1.2rem;vertical-align:bottom;color:#b8b8b8;content:counter(item,lower-roman);counter-increment:item}#sidebar li{margin:0}#sidebar li a{text-decoration:none;line-height:1.4;font-size:1.4rem;display:block;padding:.6rem 4%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#sidebar li a:after{display:inline-block;content:" ...............................................................";color:hsla(0,0%,100%,.2);margin-left:5px}#sidebar .nav-current:before{color:#fff}#sidebar .nav-current a:after{content:" ";border-bottom:1px solid hsla(0,0%,100%,.5);width:100%;height:1px}#sidebar a,#sidebar a:active,#sidebar a:hover,#sidebar a:visited{color:#b8b8b8}#sidebar a:active,#sidebar a:hover,#sidebar li.nav-current a{color:#fff}.subscribe-button{-webkit-box-sizing:border-box;box-sizing:border-box;display:block;position:absolute;bottom:30px;left:30px;right:30px;height:38px;padding:0 20px;text-align:center;font-size:12px;font-family:Open Sans,sans-serif;text-transform:uppercase;text-decoration:none;line-height:35px;border-radius:3px;background:#fff;-webkit-transition:all .3s ease;transition:all .3s ease}.subscribe-button:before{font-size:9px;margin-right:6px}.pagination{position:relative;width:80%;max-width:710px;margin:4rem auto;font-family:Open Sans,sans-serif;font-size:1.3rem;color:#9eabb3;text-align:center}.pagination a{color:#9eabb3;-webkit-transition:all .2s ease;transition:all .2s ease}.newer-posts,.older-posts{position:absolute;display:inline-block;padding:0 15px;border:1px solid #bfc8cd;text-decoration:none;border-radius:4px;-webkit-transition:border .3s ease;transition:border .3s ease}.older-posts{right:0}.page-number{display:inline-block;padding:2px 0;min-width:100px}.newer-posts{left:0}.newer-posts:hover,.older-posts:hover{color:#889093;border-color:#98a0a4}.extra-pagination{display:none;border-bottom:1px solid #ebf2f6}.extra-pagination:after{display:block;content:"";width:7px;height:7px;border:1px solid #e7eef2;position:absolute;bottom:-5px;left:50%;margin-left:-5px;background:#fff;border-radius:100%;-webkit-box-shadow:#fff 0 0 0 5px;box-shadow:0 0 0 5px #fff}.extra-pagination .pagination{width:auto}.archive-template .main-header{max-height:30vh}.archive-template .extra-pagination{display:block}.site-footer{position:relative;margin:8rem 0 0;padding:.5rem 15px;font-family:Open Sans,sans-serif;font-size:1rem;line-height:1.75em;color:#bbc7cc}.site-footer a{color:#bbc7cc;text-decoration:none;font-weight:700}.site-footer a:hover{color:#50585d}.poweredby{float:right;text-align:right}.copyright,.poweredby{display:block;width:45%}.copyright{float:left}@media only screen and (max-width:900px){blockquote{margin-left:0}.main-header{-webkit-box-sizing:border-box;box-sizing:border-box;height:auto;min-height:240px;height:60vh;padding:15% 0}.home-template .main-header:after,.scroll-down{display:none}.archive-template .main-header{min-height:180px;padding:10% 0}.blog-logo img{padding:4px 0}.page-title{font-size:4rem;letter-spacing:-1px}.page-description{font-size:1.8rem;line-height:1.5em}.post{font-size:.95em}body:not(.post-template) .post-title{font-size:3.2rem}hr{margin:2.4em 0}ol,ul{padding-left:2em}h1{font-size:4.5rem;text-indent:-2px}h2{font-size:3.6rem}h3{font-size:3.1rem}h4{font-size:2.5rem}h5{font-size:2.2rem}h6{font-size:1.8rem}.author-profile{padding-bottom:4rem}.author-profile .author-bio{font-size:1.6rem}.author-meta span{display:block;margin:1.5rem 0}.author-profile .author-meta span{font-size:1.6rem}.post-head.main-header{height:45vh}.author-head.main-header,.tag-head.main-header{height:30vh}.no-cover.post-head.main-header{height:55px;padding:0}.no-cover.author-head.main-header{padding:0}}@media only screen and (max-width:500px){.main-header{margin-bottom:15px;height:40vh}.no-cover.main-header{height:30vh}.archive-template .main-header{max-height:20vh;min-height:160px;padding:10% 0}.main-nav{margin-bottom:2rem}.blog-logo,.main-nav{padding:5px}.blog-logo img{height:30px}.menu-button{padding:0 5px;border-radius:0;border-color:transparent;color:#2e2e2e;background:transparent}.menu-button:hover{color:#2e2e2e;border-color:transparent;background:none}body.nav-opened .menu-button{background:none;border:transparent}.main-nav.overlay a:hover{color:#fff;border-color:transparent;background:transparent}.no-cover .main-nav.overlay{background:none}.no-cover .main-nav.overlay .menu-button{border:none}.main-nav.overlay .menu-button{border-color:transparent}.nav-title{top:25px}.nav-close{position:absolute;top:18px}.nav ul{padding:60px 9% 5%}.inner,.pagination{width:auto;margin:2rem auto}.post{width:auto;margin:2rem 16px;padding-bottom:2rem;line-height:1.65em}.post-template .post-header{margin-bottom:2rem}.post-template .post-date{display:inline-block}hr{margin:1.75em 0}dl,ol,p,ul{font-size:.95em;margin:0 0 2.5rem}.page-title{font-size:3rem}.post-excerpt p{font-size:.85em}.page-description{font-size:1.6rem}h1,h2,h3,h4,h5,h6{margin:0 0 .3em}h1{font-size:2.8rem;letter-spacing:-1px}h2{font-size:2.4rem;letter-spacing:0}h3{font-size:2.1rem}h4{font-size:1.9rem}h5,h6{font-size:1.8rem}body:not(.post-template) .post-title{font-size:2.5rem}.post-template .post{padding-bottom:0;margin-bottom:0}.post-template .site-footer{margin-top:0}.post-meta{font-size:1.3rem;margin-top:1rem}.post-footer{padding:5rem 0 3rem;text-align:center}.post-footer .author{margin:0 0 2rem;padding:0 0 1.6rem;border-bottom:1px dashed #ebf2f6}.post-footer .share{position:static;width:auto}.post-footer .share a{margin:1.4rem .8rem 0}.author-meta li{float:none;margin:0;line-height:1.75em}.author-meta li:before{display:none}.newer-posts,.older-posts{position:static;margin:10px 0}.page-number{display:block}.site-footer{margin-top:3rem}.author-profile{padding-bottom:2rem}.post-head.main-header{height:30vh}.author-head.main-header,.tag-head.main-header{height:20vh}.author-profile .author-image{margin-top:-70px}.author-profile .author-meta span{font-size:1.4rem}.archive-template .main-header .page-description{display:none}}header.post-header{line-height:1.1em}.post-content amp-img{max-width:100%;height:auto;border:1px solid #777;-webkit-box-shadow:5px 5px 2px rgba(0,0,0,.4);box-shadow:5px 5px 2px rgba(0,0,0,.4);margin-bottom:20px}.social-link a{color:#dfdfdf}pre.chroma{text-align:left}.badge-primary{color:#fff;background-color:#007bff}.badge{display:inline-block;padding:.25em .4em;font-size:80%;font-weight:700;line-height:1;text-align:center;white-space:nowrap;vertical-align:middle;border-radius:.25rem}
    

</style>

        <link rel="canonical" href="https://www.simoahava.com/analytics/10-javascript-concepts-for-web-analytics-implementation/">
        <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

        

        <link href="https://fonts.googleapis.com/css?family=Merriweather:300,300i,700,700i|Open+Sans:400,700|Kaushan+Script" rel="stylesheet">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

        <meta name="theme-color" content="#ffffff" />

        
        <title>10 JavaScript Concepts for Web Analytics Implementation | Simo Ahava's blog</title>
        



  

<meta property="og:title" content="10 JavaScript Concepts for Web Analytics Implementation" />
<meta name="description" content="Ten JavaScript concepts that are important to understand when working with web analytics implementations." />
<meta property="og:description" content="Ten JavaScript concepts that are important to understand when working with web analytics implementations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.simoahava.com/amp/analytics/10-javascript-concepts-for-web-analytics-implementation/" />

      <meta name="twitter:image" content="https://www.simoahava.com/images/2016/09/10-javascript-concepts.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2016/09/10-javascript-concepts.jpg">
    


    
        <meta property="article:published_time" content="2016-09-21T15:17:54Z"/>
    
    
        <meta property="article:modified_time" content="2016-09-21T15:17:54Z"/>
    




    


    <meta property="og:site_name" content="Simo Ahava&#39;s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development." />









    
        
        
            
        
        
        
    
    
    
        
            <meta property="article:section" content="Analytics" />
        
    
    
        
            <meta property="article:tag" content="education" />
        
            <meta property="article:tag" content="google analytics" />
        
            <meta property="article:tag" content="Google Tag Manager" />
        
            <meta property="article:tag" content="JavaScript" />
        
    







    
        <meta name="twitter:card" content="summary"/>
    

    
        
        
            
        
        
        
    



<meta itemprop="name" content="10 JavaScript Concepts For Web Analytics Implementation">
<meta itemprop="description" content="Ten JavaScript concepts that are important to understand when working with web analytics implementations.">
<meta itemprop="datePublished" content="2016-09-21T15:17:54&#43;00:00" />
<meta itemprop="dateModified" content="2016-09-21T15:17:54&#43;00:00" />
<meta itemprop="wordCount" content="5662">



<meta itemprop="keywords" content="education,google analytics,Google Tag Manager,JavaScript," />
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Simo Ahava\u0027s blog :: Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.",
    
    "url": "https:\/\/www.simoahava.com\/amp\/"
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "10 JavaScript Concepts For Web Analytics Implementation | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2016\/09\/10-javascript-concepts.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/amp\/analytics\/10-javascript-concepts-for-web-analytics-implementation\/",
  "datePublished": "2016-09-21T15:17:54\u002b00:00",
  "dateModified": "2016-09-21T15:17:54\u002b00:00",
  "description": "Ten JavaScript concepts that are important to understand when working with web analytics implementations.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>












    </head>
<body>

<amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-5BH2HM&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics>
  <amp-sidebar id="sidebar" layout="nodisplay" side="right">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close" on="tap:sidebar.close" role="button" tabindex="1">
        <span class="hidden">Close</span>
    </a>
    <ul>
        

        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/categories/gtm-tips/">GTM Tips</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/about-simo-ahava/">About</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/tools/">Tools</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/blog-statistics/">Blog Statistics</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/upcoming-talks/">Upcoming Talks</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/custom-templates/">Templates</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/amp/newsletter/">Newsletter</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
                <a href="https://www.simoahava.com/">Full (non-AMP) site</a>
            </li>
        
        <amp-accordion>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Categories
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/gtm-tips/">gtm-tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/categories/web-development/">web-development</a></li>
                
                </div>
            </section>
        
            <section>
                <h3 class="nav-section">
                    <i class="fa fa-caret-down section-open" aria-hidden="true"></i>
                    <i class="fa fa-caret-right section-close" aria-hidden="true"></i>
                    Tags
                </h3>
                <div>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ab-testing/">ab-testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/accelerated-mobile-pages/">accelerated-mobile-pages</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ad-blocker/">ad-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adblocker/">adblocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/add-on/">add-on</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/adwords/">adwords</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/agile/">agile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amazon/">amazon</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/amp/">amp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/analytics/">analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/android/">android</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/api/">api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app/">app</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app&#43;web/">app&#43;web</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/app-engine/">app-engine</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/approval/">approval</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps/">apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/apps-script/">apps-script</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/array/">array</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/attribution/">attribution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audience-design/">audience-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/audit/">audit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-event-tracking/">auto-event-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/auto-link-domains/">auto-link-domains</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/aws/">aws</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/azure/">azure</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/basketball/">basketball</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/beforeunload/">beforeunload</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/best-practices/">best-practices</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/big-data/">big-data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bigquery/">bigquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/blogger/">blogger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/bounce-rate/">bounce-rate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/built-in-variables/">built-in-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/calculated-metrics/">calculated-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/callback/">callback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/campaign-tracking/">campaign-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/celebration/">celebration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/change-history/">change-history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome/">chrome</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/chrome-extension/">chrome-extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-tracking/">click-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/click-variables/">click-variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clickstream/">clickstream</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-id/">client-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/client-template/">client-template</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/clientid/">clientid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-functions/">cloud-functions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cloud-run/">cloud-run</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cms/">cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cname/">cname</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conferences/">conferences</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent/">consent</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/consent-mode/">consent-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container/">container</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-export/">container-export</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/container-snippet/">container-snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content/">content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-blocker/">content-blocker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-engagement/">content-engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-grouping/">content-grouping</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management/">content-management</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-management-system/">content-management-system</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-security-policy/">content-security-policy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/content-strategy/">content-strategy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/context/">context</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversion/">conversion</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/conversions-api/">conversions-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookie/">cookie</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookiedomain/">cookiedomain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cookies/">cookies</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/core-web-vitals/">core-web-vitals</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/creative/">creative</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain/">cross-domain</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/cross-domain-tracking/">cross-domain-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/csp/">csp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css/">css</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/css-selectors/">css-selectors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom/">custom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimension/">custom-dimension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-dimensions/">custom-dimensions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html/">custom-html</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tag/">custom-html-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-html-tags/">custom-html-tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-javascript/">custom-javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-metrics/">custom-metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/custom-templates/">custom-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/customtask/">customtask</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dan-wilkerson/">dan-wilkerson</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dashboard/">dashboard</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data/">data</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-collection/">data-collection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer/">data-layer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-layer-variable/">data-layer-variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-model/">data-model</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/data-quality/">data-quality</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/datalayer/">datalayer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debug/">debug</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/debugging/">debugging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/definition-of-success/">definition-of-success</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer/">developer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/developer-tools/">developer-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/development/">development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/digital-marketing/">digital-marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/document.write/">document.write</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dom/">dom</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/duplicate/">duplicate</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/dynamic-content/">dynamic-content</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/easter-egg/">easter-egg</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecomemrce/">ecomemrce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ecommerce/">ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/education/">education</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/element-visibility/">element-visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/engagement/">engagement</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/enhanced-ecommerce/">enhanced-ecommerce</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/environments/">environments</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/errors/">errors</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event/">event</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listener/">event-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/event-listeners/">event-listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/eventcallback/">eventcallback</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/events/">events</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/excel/">excel</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exceptions/">exceptions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/experimentation/">experimentation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/exploit/">exploit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/extension/">extension</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/facebook/">facebook</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/false/">false</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fields-to-set/">fields-to-set</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firebase/">firebase</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firestore/">firestore</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/firing-rules/">firing-rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/folders/">folders</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form/">form</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/form-tracking/">form-tracking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/format-value/">format-value</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/forms/">forms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/fpid/">fpid</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga-spy/">ga-spy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ga4/">ga4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gcp/">gcp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gdpr/">gdpr</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google/">google</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-ads/">google-ads</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics/">google-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-4/">google-analytics-4</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-analytics-settings/">google-analytics-settings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud/">google-cloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-cloud-platform/">google-cloud-platform</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-optimize/">google-optimize</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-sheets/">google-sheets</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag/">google-tag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-tag-manager/">google-tag-manager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/google-trends/">google-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/googletagmanager/">googletagmanager</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/governance/">governance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag/">gtag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtag.js/">gtag.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-sonar/">gtm-sonar</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm-tools/">gtm-tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtm360/">gtm360</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/gtmtips/">gtmtips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guest-post/">guest-post</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/guide/">guide</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hack/">hack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history/">history</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-change-trigger/">history-change-trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/history-listener/">history-listener</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/hugo/">hugo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/iframe/">iframe</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/intelligent-tracking-prevention/">intelligent-tracking-prevention</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/internal-traffic/">internal-traffic</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ios/">ios</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ip/">ip</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/it-department/">it-department</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/itp/">itp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/javascript/">javascript</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/jquery/">jquery</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/klipfolio/">klipfolio</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/learning/">learning</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lighthouse/">lighthouse</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/links/">links</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/listeners/">listeners</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/local/">local</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/localstorage/">localstorage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/lookup-table/">lookup-table</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/macros/">macros</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketer/">marketer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/marketing/">marketing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/measurement-protocol/">measurement-protocol</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/meta-description/">meta-description</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/metrics/">metrics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/migration/">migration</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mixcloud/">mixcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/mobile/">mobile</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modern-cms/">modern-cms</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/modular-architecture/">modular-architecture</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/monitor/">monitor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/navigation/">navigation</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/netbooster/">netbooster</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/new-ui/">new-ui</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/node.js/">node.js</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/nodejs/">nodejs</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/non-technical/">non-technical</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/open-source/">open-source</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/opt-out/">opt-out</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/owasp/">owasp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-load-time/">page-load-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/page-timings/">page-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/parameter-reporting/">parameter-reporting</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/penguin/">penguin</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/performance/">performance</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/permissions/">permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/persistence/">persistence</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal/">personal</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/personal-experience/">personal-experience</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/php/">php</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pii/">pii</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/pitch/">pitch</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/plugins/">plugins</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/poetry/">poetry</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/postmessage/">postmessage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/ppc/">ppc</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview/">preview</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/preview-mode/">preview-mode</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/privacy/">privacy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/process/">process</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/proxy/">proxy</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/public-speaking/">public-speaking</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/query-string/">query-string</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/queue-time/">queue-time</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/r/">r</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/race-condition/">race-condition</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/reaktor/">reaktor</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/recaptcha/">recaptcha</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/referral/">referral</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/regular-expression/">regular-expression</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/release/">release</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/resources/">resources</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/rules/">rules</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/safari/">safari</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sales/">sales</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/samesite/">samesite</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/schema/">schema</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/score-card/">score-card</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/scroll-depth/">scroll-depth</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search/">search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-api/">search-api</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-engine-optimization/">search-engine-optimization</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/search-trends/">search-trends</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/security/">security</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/selection/">selection</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo/">seo</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/seo-report/">seo-report</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/serp/">serp</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/server-side-tagging/">server-side-tagging</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/session/">session</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/sessions/">sessions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/simmer/">simmer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/single-page-apps/">single-page-apps</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-search/">site-search</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/site-speed/">site-speed</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/slack/">slack</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snippet/">snippet</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/snowplow/">snowplow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/social-interactions/">social-interactions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/soundcloud/">soundcloud</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/spa/">spa</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/splash-page/">splash-page</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/static-site/">static-site</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/still-running/">still-running</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/storage/">storage</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/support/">support</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/swift/">swift</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/syntax-highlight/">syntax-highlight</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solution/">tag-management-solution</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-management-solutions/">tag-management-solutions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-sequencing/">tag-sequencing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tag-templates/">tag-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tags/">tags</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tasks/">tasks</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/technique/">technique</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/test/">test</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/testing/">testing</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timer/">timer</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/timings/">timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tips/">tips</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tools/">tools</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker/">tracker</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/tracker-object/">tracker-object</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/training/">training</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger/">trigger</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/trigger-groups/">trigger-groups</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/triggers/">triggers</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/troubleshoot/">troubleshoot</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/undefined/">undefined</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/universal-analytics/">universal-analytics</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-id/">user-id</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-interface/">user-interface</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-permissions/">user-permissions</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/user-timings/">user-timings</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/v2/">v2</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable/">variable</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variable-templates/">variable-templates</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/variables/">variables</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/videos/">videos</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/visibility/">visibility</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/wcag/">wcag</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/weather/">weather</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-design/">web-design</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/web-development/">web-development</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/webkit/">webkit</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/website-redesign/">website-redesign</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workflow/">workflow</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/workspaces/">workspaces</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/youtube/">youtube</a></li>
                
                    <li class="nav-opened" role="presentation"><a href="https://www.simoahava.com/amp/tags/zones/">zones</a></li>
                
                </div>
            </section>
        
        </amp-accordion>
    </ul>
</amp-sidebar>

<div class="site-wrapper">



    <header class="main-header post-head no-cover">
    <nav class="main-nav clearfix">


    <a class="menu-button" on="tap:sidebar.toggle" role="button"><i class="fa fa-bars" aria-hidden="true"></i><span class="menu-button-label">Menu</span></a>


  </nav>
</header>



<main class="content" role="main">

  <article class="post type-post">

    <header class="post-header">
        <h1 class="post-title">10 JavaScript Concepts for Web Analytics Implementation</h1>
        <small>Ten JavaScript concepts that are important to understand when working with web analytics implementations.</small>

        <section class="post-meta">
            


    




    <amp-img class="author-thumb" src="https://www.simoahava.com/images/simo.png" layout="fixed" width="24" height="24" alt="Author image"></amp-img>

Simo Ahava

in
    
        <a href="https://www.simoahava.com/amp/categories/analytics">Analytics</a>
    


on
    
        <a href="https://www.simoahava.com/amp/tags/education">#education</a>
    
        , <a href="https://www.simoahava.com/amp/tags/google-analytics">#google analytics</a>
    
        , <a href="https://www.simoahava.com/amp/tags/google-tag-manager">#Google Tag Manager</a>
    
        , <a href="https://www.simoahava.com/amp/tags/javascript">#JavaScript</a>
    


<time class="post-date" datetime="2016-09-21T15:17:54Z">
    21 September 2016
</time>


<span class="post-date"><a href="https://www.simoahava.com/analytics/10-javascript-concepts-for-web-analytics-implementation/">Non-AMP version</a></span>


        </section>
    </header>

    <section class="post-content">
      
        
        
          <p>I&rsquo;ve already written <a href="https://www.simoahava.com/amp/analytics/javascript-101-gtm-part-1/">extensively</a> about JavaScript in web analytics implementation. Suffice to say, understanding at least <em>the basics</em> is absolutely necessary to survive in the technical medium of the web browser.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/10-javascript-concepts.jpg" title="10 JavaScript Concepts for web analytics">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/10-javascript-concepts.jpg" layout="responsive" alt="10 JavaScript Concepts for web analytics" height="1142" width="2048"></amp-img>
  
    </a>
  

<p>This article expands on a conference talk I gave at <a href="http://london.measurecamp.org/">MeasureCamp IX, London</a> a short while ago. I&rsquo;ve always been quite single-minded about the importance of JavaScript in web analytics development, and it was a pleasure for me to get some of that off my chest. So I want to go over the ten concepts introduced in my conference talk with a little more detail, especially in the context of <a href="https://tagmanager.google.com/">Google Tag Manager</a>.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/title.jpg" title="table of contents">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/title.jpg" layout="responsive" alt="table of contents" height="838" width="2334"></amp-img>
  
    </a>
  


        
        <article class="post type-simmer">
    <header class="post-header">
        <h2 class="post-title"><a href="https://www.simoahava.com/amp/newsletter/">The Simmer Newsletter</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
	Follow <a href="https://www.teamsimmer.com/newsletter/">this link</a> to subscribe to the <strong>Simmer Newsletter</strong>! Stay up-to-date with the latest content from Simo Ahava and the <a href="https://www.teamsimmer.com/">Simmer online course platform</a>.
      </p>
      </section>
</article>

        
          <h2 id="get-the-basics-right">Get the basics right</h2>
<p>JavaScript is not the quirky animation tool from two decades ago anymore - it&rsquo;s a programming language if there ever was one. It hides a lot of complexity under its seemingly simple syntax, though in the web browser much of this complexity is either abstracted or removed entirely thanks to how the client-server infrastructure of the web works.</p>
<p>To get up to speed with JavaScript, I typically recommend the following resources. <a href="https://www.codecademy.com/">Codecademy</a> especially is something you might want to devote time and effort to. It has lots of different tracks, and some that are extremely useful for web (analytics) developers.</p>
<h3 id="1-codecademy">1. Codecademy</h3>


    <a href="https://www.simoahava.com/amp/images/2016/09/codecademy.jpg" title="codecademy">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/codecademy.jpg" layout="responsive" alt="codecademy" height="1454" width="1750"></amp-img>
  
    </a>
  

<p>Codecademy is an <em>amazing</em> resource. The courses are free, fully interactive, and the service keeps track of your progress as you learn new skills along the way. Codecademy has lots of tracks for web developers, but I want to highlight the following as the <em>bare minimum</em> for web analytics:</p>
<ul>
<li>
<p><a href="https://www.codecademy.com/learn/javascript">JavaScript</a></p>
</li>
<li>
<p><a href="https://www.codecademy.com/learn/web">HTML &amp; CSS</a></p>
</li>
<li>
<p><a href="https://www.codecademy.com/learn/jquery">jQuery</a></p>
</li>
</ul>
<p>I recommend making it habitual to always have a course active in Codecademy. Programming is not a skill you develop in silos - each new language and discipline you learn helps you become a better developer overall.</p>
<h3 id="2-books">2. Books</h3>


    <a href="https://www.simoahava.com/amp/images/2016/09/books.jpg" title="Great books for learning JavaScript">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/books.jpg" layout="responsive" alt="Great books for learning JavaScript" height="812" width="1978"></amp-img>
  
    </a>
  

<p>You might argue that books are not the best way to keep up-to-date with web technologies, but the following volumes have stood the test of time (with the exception of the last one which is brand new) marvellously, and even if some of the code samples might be outdated, the ideas behind the solutions remain as topical as ever.</p>
<ul>
<li>
<p><a href="https://www.amazon.com/Professional-JavaScript-Developers-Nicholas-Zakas/dp/1118026691">Nicholas Zakas: Professional JavaScript for Web Developers (3rd Edition)</a></p>
</li>
<li>
<p><a href="https://www.amazon.com/DOM-Enlightenment-Cody-Lindley/dp/1449342841">Cody Lindley: DOM Enlightenment</a></p>
</li>
<li>
<p><a href="https://www.amazon.com/Practical-Google-Analytics-Manager-Developers/dp/148420266X">Jonathan Weber: Practical Google Analytics and Google Tag Manager for Developers</a></p>
</li>
</ul>
<p>Zakas&rsquo; volume is a great, if somewhat intimidating, foray into how JavaScript and the web browser interact. Needless to say, it is a goldmine for understanding the technical stack you&rsquo;re working with when implementing web analytics solution. It&rsquo;s the book I would most recommend you to read once you have the basics of JavaScript down.</p>
<h3 id="3-sandbox">3. Sandbox</h3>
<p>The only way you can really learn something is by doing it. All creative skills, programming included, need honing. The best way to learn programming is to actively practice it. So in addition to taking courses and learning by reading, remember to also <em>create</em> stuff! A great way to do it is to deploy Google Tag Manager on your own website. If you don&rsquo;t have one, you can now create one with your new-fangled skills!</p>
<p>Play around with the <a href="http://webmasters.stackexchange.com/a/77337/66450">JavaScript Console</a> of your web browser&rsquo;s developer tools. Implement scripts in Google Tag Manager, and see how they interact with your website. Use tools like <a href="http://www.jslint.com/">JS Lint</a> to understand what issues your code might have.</p>
<p>Whatever you do, just keep coding.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/functions-and-methods.jpg" title="1. Functions and Methods">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/functions-and-methods.jpg" layout="responsive" alt="1. Functions and Methods" height="212" width="2038"></amp-img>
  
    </a>
  

<p>In the context of Google Tag Manager, functions are arguably the most useful little things when customizing implementations. That&rsquo;s because the <a href="https://www.simoahava.com/amp/analytics/variable-guide-google-tag-manager/">Custom JavaScript Variable</a> is basically a function call that you use to resolve a value.</p>
<p>The Custom JavaScript Variable has a very deliberate syntax when using Google Tag Manager, and some of the restrictions might sound odd to you, so I want to go over them with some detail in this chapter.</p>
<h3 id="anonymous-function-with-a-return-statement">Anonymous function with a return statement</h3>
<p>The Custom JavaScript Variable requires an <strong>anonymous function</strong> with a <strong><code>return</code> statement</strong>. An anonymous function is exactly that: it&rsquo;s a function without a named identifier that you could use to refer to it. Now, you can argue that it does have a name since the Variable itself has a name, but that&rsquo;s GTM&rsquo;s proprietary way of resolving the Custom JavaScript Variable and has nothing to do with the underlying JavaScript syntax.</p>
<p>The Custom JavaScript Variable doesn&rsquo;t take any parameters, either. All values you want to process through it need to come from the internal data model of Google Tag Manager (GTM&rsquo;s &ldquo;Variables&rdquo;), need to be created on the spot (local scope), or need to be available in the global namespace (global scope).</p>
<p>Finally, all Custom JavaScript Variables need a <code>return</code> statement. They must always return some value, as they are invoked in situations where a value is required.</p>
<p>So this is the minimum viable Custom JavaScript Variable you could create.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>When invoked with the {{Variable}} syntax, this function would return <code>undefined</code>.</p>
<h3 id="avoid-side-effects">Avoid side effects</h3>
<p>Since the Custom JavaScript Variable is a value-returning function which does not accept parameters, it should only be used for input/output operations. Thus, the purpose of the Custom JavaScript Variable is to take some value, modify it, and then return the modified value.</p>
<p>A function has side effects if it does something else except the input/output operation described in the previous paragraph. Typical side effects occur when a function is used to modify something in the global scope, or it&rsquo;s used to set some value elsewhere, or, in the context of Google Tag Manager, it&rsquo;s used to manipulate the Data Layer.</p>
<p>You should avoid side effects because Google Tag Manager can&rsquo;t guarantee that the Custom JavaScript Variable is only resolved once per activation. In fact, in Preview mode, Custom JavaScript Variables can be resolved dozens of times per <code>dataLayer.push()</code>, which can lead to a confusing experience.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// AVOID THIS:
</span><span class="c1"></span>  <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="s1">&#39;event&#39;</span> <span class="o">:</span> <span class="s1">&#39;JavaScript executed&#39;</span><span class="p">});</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The main problem with side effects is that they&rsquo;re hard to trace if problems arise. Since the Custom JavaScript Variables are resolved at arbitrary times, having them modify the global scope can be hazardous and can easily lead to unwanted race conditions.</p>
<h3 id="understand-scope-utilize-closures">Understand scope, utilize closures</h3>
<p>JavaScript in the web has two types of scope: local and global.</p>
<p><strong>Local scope</strong>, also known as function scope, is what variables are restricted to when declared within a function. When you declare a variable in a function, it will only exist for the duration of the function call (though see the part about closures below), after which the garbage collector comes and whisks it away. Locally scoped variables cannot be referred to or invoked from outside the current function context.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// These variables all have local scope
</span><span class="c1"></span>  <span class="kd">var</span> <span class="nx">hello</span> <span class="o">=</span> <span class="s2">&#34;Hi, &#34;</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">myname</span> <span class="o">=</span> <span class="s2">&#34;Simo!&#34;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">hello</span> <span class="o">+</span> <span class="nx">myname</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Global scope</strong>, on the other hand, comprises variables that are declared as properties of the <code>window</code> object. If you don&rsquo;t use the <code>var</code> keyword when declaring a variable in a function, it is automatically elevated into global scope.</p>
<p>When a variable is in global scope, you can refer to it anywhere. For example, the ubiquitous <code>document</code> property of the browser&rsquo;s Document Object Model can be used anywhere since it&rsquo;s actually a global property of the <code>window</code> object:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nb">document</span> <span class="o">===</span> <span class="nb">document</span><span class="p">;</span> <span class="c1">// true
</span></code></pre></div>
<p><strong>Closures</strong> are an exception to how locally scoped variables are ephemeral and inaccessible from the outside. When you create a closure, you are actually creating a simple <em>interface</em> that lets you access the locally scoped variable from outside the function!</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">timeNow</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="c1">// Locally scoped
</span><span class="c1"></span>  <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&#34;Time then was: &#34;</span> <span class="o">+</span> <span class="nx">timeNow</span><span class="p">;</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<p>The closure is the <code>return function() {...}</code> statement. Because the function is declared within same context, it has access to the locally scoped <code>timeNow</code> variable. And because the function is the target of the <code>return</code> statement, you can actually call this returned function in code! In the example below, the Custom JavaScript Variable we just created above is named <strong>Time Then</strong>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">timeThen</span> <span class="o">=</span> <span class="p">{{</span><span class="nx">Time</span> <span class="nx">Then</span><span class="p">}}();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">timeThen</span><span class="p">);</span>
</code></pre></div>
<p>The parentheses at the end of the Custom JavaScript Variable are significant. If you simply had <code>{{Time Then}}</code>, the variable assignment would store the return value of the Custom JavaScript Variable (the closure) into the <code>timeThen</code> variable. The <code>console.log()</code> command would simply output the function description itself, and not the result. By adding the parentheses, you&rsquo;re telling the browser to actually <strong>invoke</strong> the function returned by the Custom JavaScript Variable. Since the <code>timeNow</code> is only created once (when the Custom JavaScript Variable is first resolved), the closure will always return the same date-time string.</p>
<h3 id="modify-state-when-you-are-in-control-of-resolution">Modify state when you are in control of resolution</h3>
<p>There is one exception to Custom JavaScript Variables having side effects. When you are in full control of when the function is resolved, it&rsquo;s fine to cause side effects, since you don&rsquo;t have to worry about the function resolving an unknown number of times or in unknown contexts.</p>
<p>One such example is when using a closure in a <em>callback</em>. Callbacks (more on these later) are execution milestones which take place after some other process has completed. So if you indicate the closure of a Custom JavaScript Variable as the value of a callback, you can rest assured that the function is only called once - when the main process has completed.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Return a function to be used by hitCallback
</span><span class="c1"></span>  <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// It&#39;s OK to modify state here!
</span><span class="c1"></span>    <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="s1">&#39;event&#39;</span> <span class="o">:</span> <span class="s1">&#39;tagHasFired&#39;</span><span class="p">});</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<p>This process is exemplified in the <a href="https://www.simoahava.com/amp/gtm-tips/hitcallback-eventcallback/">hitCallback</a> feature of the Google Analytics tracker. The hitCallback function is called after the request to Google Analytics has completed. Thus, you can use the closure of a Custom JavaScript Variable to perform some state-altering thing in the hitCallback field itself! This is very useful if you want to chain tags in a sequence, for example.</p>
<h3 id="further-reading">FURTHER READING</h3>
<p>Take a look at the following articles for more information on how functions work:</p>
<ul>
<li>
<p><a href="http://www.w3schools.com/js/js_function_closures.asp">w3schools: JavaScript Closures</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">MDN: Closures</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/variable-guide-google-tag-manager/">Custom JavaScript Variable</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/gtm-tips/hitcallback-eventcallback/">#GTMtips: hitCallback And eventCallback</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/data-types.jpg" title="2. Data Types">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/data-types.jpg" layout="responsive" alt="2. Data Types" height="228" width="2030"></amp-img>
  
    </a>
  

<p>In JavaScript, you have five value-carrying data types:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">// number
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="s2">&#34;five&#34;</span><span class="p">;</span> <span class="c1">// string
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="c1">// boolean
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="p">{</span><span class="nx">five</span><span class="o">:</span> <span class="mi">5</span><span class="p">};</span> <span class="c1">// object
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">5</span><span class="p">;</span> <span class="p">};</span> <span class="c1">// function
</span></code></pre></div>
<p>It gets slightly messier than this, since there are actually lots of different types of objects (all JavaScript data types are actually an extension of &ldquo;object&rdquo; in its fundamental sense):</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="p">{</span><span class="nx">five</span><span class="o">:</span> <span class="mi">5</span><span class="p">};</span> <span class="c1">// Object
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">];</span> <span class="c1">// Array
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span> <span class="c1">// Date
</span></code></pre></div>
<p>And finally we have some mystic pseudo-types which don&rsquo;t carry any value:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span> <span class="c1">// undefined
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// null
</span></code></pre></div>
<h3 id="dynamic-type">Dynamic type</h3>
<p>Unlike some other programming languages (e.g. Java), type is <em>dynamic</em> in JavaScript. That means that you can reassign a variable with a completely different type without having to worry about type conversion.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="nx">something</span> <span class="o">=</span> <span class="s2">&#34;five&#34;</span><span class="p">;</span>
</code></pre></div>
<p>The above is possible in JavaScript, because the variable assignment itself doesn&rsquo;t coerce the assigned value to any specific type. This can be a weakness in the code, because it requires you to test for type to avoid errors.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Works because something is a number
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">somethingMultiplied</span> <span class="o">=</span> <span class="nx">something</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>

<span class="c1">// Won&#39;t work because something is suddenly a string
</span><span class="c1"></span><span class="nx">something</span> <span class="o">=</span> <span class="s2">&#34;five&#34;</span><span class="p">;</span>
<span class="nx">somethingMultiplied</span> <span class="o">=</span> <span class="nx">something</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// NaN: Not a Number
</span><span class="c1"></span>
<span class="c1">// So you need to test
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">something</span> <span class="o">===</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">somethingMultiplied</span> <span class="o">=</span> <span class="nx">something</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The further apart your variables are from their execution context, the messier it can get with all the type checks. So try to avoid exploiting dynamic type, and do your best to maintain type when creating and reassigning variables.</p>
<h3 id="loose-type">Loose type</h3>
<p>JavaScript also does type conversion for you when needed. This means that the following is possible:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">something</span> <span class="o">=</span> <span class="s2">&#34;5&#34;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">somethingMultiplied</span> <span class="o">=</span> <span class="nx">something</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// 10
</span></code></pre></div>
<p>In the multiplication, JavaScript expects <code>something</code> to resolve to the number type. Even though <code>something</code> is a string, JavaScript detects the number within and automatically converts the variable to a number for the multiplication statement. The variable <code>something</code> itself is not modified, but the value held by it is converted automatically to make resolving <code>somethingMultiplied</code> possible.</p>
<p>Note that there are some embarrassing exceptions. The plus operator (+) is not only used for mathematical statements but also for concatenating strings. So if you try to add a number to a string, you&rsquo;ll end up with a concatenated string rather than a number!</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">&#34;5&#34;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="c1">// &#34;56&#34;!
</span><span class="c1"></span>
<span class="c1">// You need to use parseInt() to manually convert to number:
</span><span class="c1"></span><span class="nx">c</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span> <span class="c1">// 11
</span></code></pre></div>
<h3 id="weird-stuff">Weird stuff</h3>
<p>I&rsquo;ll just leave this list here. It&rsquo;s just a handful off the odd behavior you get when working with loose and dynamic type.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">typeof</span> <span class="kc">NaN</span><span class="p">;</span> <span class="c1">// number
</span><span class="c1"></span><span class="kc">NaN</span> <span class="o">===</span> <span class="kc">NaN</span><span class="p">;</span> <span class="c1">// false
</span><span class="c1"></span><span class="k">typeof</span> <span class="kc">NaN</span><span class="p">;</span> <span class="c1">// number
</span><span class="c1"></span><span class="nb">isNaN</span><span class="p">(</span><span class="kc">NaN</span><span class="p">);</span> <span class="c1">// true
</span><span class="c1"></span><span class="nb">isNaN</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span> <span class="c1">// false
</span><span class="c1"></span><span class="k">typeof</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// object
</span><span class="c1"></span><span class="kc">null</span> <span class="k">instanceof</span> <span class="nb">Object</span><span class="p">;</span> <span class="c1">// false
</span><span class="c1"></span><span class="k">typeof</span> <span class="kc">undefined</span><span class="p">;</span> <span class="c1">// undefined
</span><span class="c1"></span><span class="kc">undefined</span> <span class="o">===</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// false
</span><span class="c1"></span><span class="kc">undefined</span> <span class="o">==</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">// true
</span><span class="c1"></span><span class="p">{</span><span class="nx">simo</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span> <span class="o">===</span> <span class="p">{</span><span class="nx">simo</span><span class="o">:</span> <span class="kc">true</span><span class="p">};</span> <span class="c1">// false
</span></code></pre></div>
<h3 id="undefined-and-google-analytics">Undefined and Google Analytics</h3>
<p>Remember that the <code>undefined</code> type has a <a href="https://www.simoahava.com/amp/gtm-tips/undefined-dimensions-wont-get-sent/">special function</a> in Google Analytics (and Google Tag Manager). If you refer to a variable which returns <code>undefined</code>, that particular setting, field, or parameter is automatically dropped from the request to Google Analytics.</p>
<p>In Google Tag Manager, <code>undefined</code> can also be used to <a href="https://www.simoahava.com/amp/gtm-tips/remember-to-flush-unused-data-layer-variables/">purge values from the Data Layer</a>. This is extremely useful on single-page apps, where variables persist their values throughout the visit.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
  <span class="nx">event</span><span class="o">:</span> <span class="s1">&#39;GAEvent&#39;</span><span class="p">,</span>
  <span class="nx">eventData</span> <span class="o">:</span> <span class="p">{</span>
    <span class="nx">cat</span><span class="o">:</span> <span class="s1">&#39;Category value&#39;</span><span class="p">,</span>
    <span class="nx">act</span><span class="o">:</span> <span class="s1">&#39;Action value&#39;</span><span class="p">,</span>
    <span class="nx">lab</span><span class="o">:</span> <span class="kc">undefined</span><span class="p">,</span>
    <span class="nx">val</span><span class="o">:</span> <span class="kc">undefined</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<h3 id="further-reading-1">FURTHER READING</h3>
<p>The following articles shed more light on data types in JavaScript:</p>
<ul>
<li>
<p><a href="http://www.w3schools.com/js/js_datatypes.asp">w3schools: JavaScript Data Types</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures">MDN: JavaScript data types and data structures</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/gtm-tips/undefined-dimensions-wont-get-sent/">#GTMtips: Undefined dimensions won&rsquo;t get sent</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/http-requests.jpg" title="3. HTTP Requests">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/http-requests.jpg" layout="responsive" alt="3. HTTP Requests" height="200" width="2024"></amp-img>
  
    </a>
  

<p>When looking for things that can slow down the site, slow or poorly performing HTTP requests are usually the easy culprit to blame.</p>
<p>Thanks to asynchronous loading, most HTTP requests are done in such a way that they don&rsquo;t block the page from rendering, but async itself doesn&rsquo;t guarantee a smooth ride.</p>
<p>Let&rsquo;s take Google Tag Manager as an example. This is a typical container snippet:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span><span class="nx">d</span><span class="p">,</span><span class="nx">s</span><span class="p">,</span><span class="nx">l</span><span class="p">,</span><span class="nx">i</span><span class="p">){</span><span class="nx">w</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span><span class="o">=</span><span class="nx">w</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span><span class="o">||</span><span class="p">[];</span><span class="nx">w</span><span class="p">[</span><span class="nx">l</span><span class="p">].</span><span class="nx">push</span><span class="p">({</span><span class="s1">&#39;gtm.start&#39;</span><span class="o">:</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">(),</span><span class="nx">event</span><span class="o">:</span><span class="s1">&#39;gtm.js&#39;</span><span class="p">});</span><span class="kd">var</span> <span class="nx">f</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="nx">s</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="nx">j</span><span class="o">=</span><span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">s</span><span class="p">),</span><span class="nx">dl</span><span class="o">=</span><span class="nx">l</span><span class="o">!=</span><span class="s1">&#39;dataLayer&#39;</span><span class="o">?</span><span class="s1">&#39;&amp;l=&#39;</span><span class="o">+</span><span class="nx">l</span><span class="o">:</span><span class="s1">&#39;&#39;</span><span class="p">;</span><span class="nx">j</span><span class="p">.</span><span class="nx">async</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span><span class="nx">j</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s1">&#39;//www.googletagmanager.com/gtm.js?id=&#39;</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="nx">dl</span><span class="p">;</span><span class="nx">f</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">f</span><span class="p">);})(</span><span class="nb">window</span><span class="p">,</span><span class="nb">document</span><span class="p">,</span><span class="s1">&#39;script&#39;</span><span class="p">,</span><span class="s1">&#39;dataLayer&#39;</span><span class="p">,</span><span class="s1">&#39;GTM-W92WQQ&#39;</span><span class="p">);</span>
</code></pre></div>
<p>I&rsquo;ve gone over this code in an <a href="https://www.simoahava.com/amp/analytics/container-snippet-gtm-secrets-revealed/">earlier article</a>, but suffice to say that the end result of all this code is this:</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/gtm-element.jpg" title="gtm script element">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/gtm-element.jpg" layout="responsive" alt="gtm script element" height="258" width="1430"></amp-img>
  
    </a>
  

<p>In other words, the minified code creates a new <code>script</code> HTML element, which instructs the browser to request for a file in Google&rsquo;s servers, and the request is done asynchronously.</p>
<p>The <code>script</code> element, then, turns into an HTTP request, since the <code>src</code> attribute in the tag signals the browser to make an HTTP request to the URL value of the attribute.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/gtm-js-get.jpg" title="gtm.js GET request">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/gtm-js-get.jpg" layout="responsive" alt="gtm.js GET request" height="274" width="1096"></amp-img>
  
    </a>
  

<p>So just by creating the <code>script</code> tag, the browser automatically executed an HTTP request to the given endpoint, and the result of this request is the <strong>gtm.js</strong> retrieved in the browser for immediate execution.</p>
<p>There are lots of elements that can produce an HTTP request. All scripts, images, and HTML files need to be retrieved from the web server, and the main channel of data transfer is the HTTP request. The following HTML tags (with the given attributes) also invoke HTTP requests:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">input</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">input</span> <span class="na">usemap</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ins</span> <span class="na">cite</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">object</span> <span class="na">classid</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">object</span> <span class="na">codebase</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">object</span> <span class="na">data</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">object</span> <span class="na">usemap</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">q</span> <span class="na">cite</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">audio</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">formaction</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">command</span> <span class="na">icon</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">embed</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">manifest</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">input</span> <span class="na">formaction</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">source</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">video</span> <span class="na">poster</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">video</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">applet</span> <span class="na">codebase</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">area</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">base</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">blockquote</span> <span class="na">cite</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span> <span class="na">background</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">del</span> <span class="na">cite</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">frame</span> <span class="na">longdesc</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">frame</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span> <span class="na">profile</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">longdesc</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">longdesc</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">usemap</span><span class="o">=</span><span class="s">&#34;url&#34;</span><span class="p">&gt;</span></code></pre></div>
<p>Yeah. That&rsquo;s quite a bunch.</p>
<p>Note that HTTP requests can be created manually using e.g. <code>XMLHttpRequest</code> or <code>jQuery.ajax()</code>. In fact, when you send hits to Google Analytics, you&rsquo;re actually using HTTP requests created by the <strong>analytics.js</strong> library.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/collect-get-post.jpg" title="GET and POST in google analytics requests">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/collect-get-post.jpg" layout="responsive" alt="GET and POST in google analytics requests" height="534" width="752"></amp-img>
  
    </a>
  

<h3 id="further-reading-2">FURTHER READING</h3>
<p>Here&rsquo;s more information on HTTP requests:</p>
<ul>
<li>
<p><a href="https://www.w3schools.com/xml/ajax_xmlhttprequest_create.asp">w3schools: AJAX - Create an XMLHttpRequest Object</a></p>
</li>
<li>
<p><a href="http://www.w3schools.com/tags/ref_httpmethods.asp">w3schools: HTTP Methods: GET vs. POST</a></p>
</li>
<li>
<p><a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/reference#transport">Measurement Protocol Reference: Transport</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/race-conditions.jpg" title="4. Race Conditions">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/race-conditions.jpg" layout="responsive" alt="4. Race Conditions" height="218" width="2018"></amp-img>
  
    </a>
  

<p>The difference between <strong>asynchronous</strong> and <strong>synchronous</strong> loading is subtle but significant.</p>
<p>JavaScript in the web browser is <strong>single-threaded</strong>. That means that only one process can ever be running at a time, and thus every single line of JavaScript must be executed completely before the browser can proceed to the next line. If you make a <strong>synchronous</strong> HTTP request, it means that the browser will wait until the entire request (download, execution, render) is taken to completion before the browser proceeds to the next line of code in the page. It&rsquo;s said that synchronous operations are thus <strong>blocking</strong>.</p>
<p>To counter this potentially devastating blow to page render and user experience, asynchronous loading was introduced to make the &ldquo;expensive&rdquo; part of the process, the download, happen so that it doesn&rsquo;t block the browser.</p>
<p>So, when a request is made asynchronously, the browser initiates the download but then proceeds to the next line of code <em>while the download goes on in the background</em>. Only after the file is completely downloaded, does the browser return execution to this initial process, rendering the downloaded asset in the browser.</p>
<p>The problem with asynchronous execution is that even though you can pinpoint the exact moment when the request is initiated, as it&rsquo;s governed by the order of the lines of code in the page template, you&rsquo;ll never know the exact moment when it completes. And this can lead to something called a <strong>race condition</strong>.</p>
<p>So let&rsquo;s say I have the following two lines of code in the page template:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span><span class="o">=</span><span class="s">&#34;&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https//www.googletagmanager.com/gtm.js?id=GTM-XXXXX&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></code></pre></div>
<p>The browser starts loading the jQuery library before GTM, so I might expect jQuery to available to GTM as soon as the latter has finished downloading. But that&rsquo;s not necessarily the case! The actual download of jQuery can end long <em>after</em> GTM has completed, because the jQuery library is more often than not quite a bulky thing. Also, if the CDN providing the jQuery library has latency, it might affect when jQuery becomes available.</p>
<p>So, if in Google Tag Manager I try to use jQuery, there can be a <strong>race condition</strong> where GTM expects jQuery to be available but it isn&rsquo;t.</p>
<p>To combat the race condition, we can use tools like <strong>callbacks</strong>, <strong>promises</strong> or, in GTM, <a href="https://www.simoahava.com/amp/analytics/understanding-tag-sequencing-in-google-tag-manager/">Tag Sequencing</a>. You can always resort to synchronous downloading if you&rsquo;re really concerned about race conditions, but remember that this can have a detrimental impact on user experience.</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!-- Synchronous request --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">async</span><span class="o">=</span><span class="s">&#34;&#34;</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https//www.googletagmanager.com/gtm.js?id=GTM-XXXXX&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Callback --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js&#39;</span><span class="p">;</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">.</span><span class="nx">dataLayer</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">event</span><span class="o">:</span> <span class="s1">&#39;jQueryLoaded&#39;</span><span class="p">});</span>
    <span class="p">});</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
  <span class="p">})();</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Tag Sequencing --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s1">&#39;https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js&#39;</span><span class="p">;</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">async</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">el</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;load&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nb">window</span><span class="p">[</span><span class="s1">&#39;google_tag_maanger&#39;</span><span class="p">][{{</span><span class="nx">Container</span> <span class="nx">ID</span><span class="p">}}].</span><span class="nx">onHtmlSuccess</span><span class="p">({{</span><span class="nx">HTML</span> <span class="nx">ID</span><span class="p">}});</span>
    <span class="p">});</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
  <span class="p">})();</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></code></pre></div>
<p>It&rsquo;s better to be safe than sorry, so when working with potential race conditions, make sure to always check if the resources you are trying to use actually exist.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">jQuery</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Use jQuery
</span><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="c1">// Use something else
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div>
<h3 id="further-reading-3">FURTHER READING</h3>
<p>Here are some useful links on race conditions, callbacks, and such.</p>
<ul>
<li>
<p><a href="http://callbackhell.com/">Callback Hell</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">MDN: Promise</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/understanding-tag-sequencing-in-google-tag-manager/">Understanding Tag Sequencing in Google Tag Manager</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/history-manipulation.jpg" title="5. History Manipulation">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/history-manipulation.jpg" layout="responsive" alt="5. History Manipulation" height="206" width="1984"></amp-img>
  
    </a>
  

<p><a href="https://en.wikipedia.org/wiki/Single-page_application">Single-page web applications</a> (SPA) utilize something called the <a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API">History API</a> to provide a multi-page experience with only one initial page load in the web server. Subsequent transitions from page-to-page are commonly done using the History API, by withdrawing content from the server without initiating a page refresh, and manually creating history entries in the web browser. Common frameworks for SPAs are e.g. <a href="https://facebook.github.io/react/">React</a>, <a href="https://angularjs.org/">AngularJS</a>, and <a href="http://backbonejs.org/">Backbone.js</a>.</p>
<p>SPAs have significant implications for web analytics. For example, an SPA can suffer from the <a href="https://www.simoahava.com/amp/gtm-tips/be-careful-with-the-tracker-name-setting/">rogue referrer</a> problem, where URL query parameters that are used for campaign settings are overwritten by a subsequent page view hit. For Google Tag Manager, the problem of persistence rears its ugly head, where variables maintain the values you set earlier, leading to these values bleeding into subsequent tags.</p>
<p>Browser history is manipulated because when content is dynamically loaded, the site needs to tell the web browser that the user has entered a new page without the benefit of the page reload doing this automatically. Otherwise you wouldn&rsquo;t be able to link to dynamic content, nor would the Back and Forward buttons of the browser find your dynamic content.</p>
<p>The two interfaces you&rsquo;ll run into most often are <code>pushState</code> and <code>replaceState</code>. The former creates a new history entry in the web browser, and the latter replaces the current entry entirely. Here are examples of how to use them:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span>
  <span class="p">{</span><span class="nx">pageType</span><span class="o">:</span> <span class="s1">&#39;formThankYou&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Form Success&#39;</span><span class="p">,</span>
  <span class="s1">&#39;/thank-you/&#39;</span>
<span class="p">);</span>
</code></pre></div>
<p>When you run this command, the URL changes to /thank-you/ without a page reload. The first two parameters add additional information about the state. If you now click the Back button of the browser, you are taken to the URL where you called <code>pushState</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">(</span>
  <span class="p">{</span><span class="nx">pageType</span><span class="o">:</span> <span class="s1">&#39;formThankyou&#39;</span><span class="p">},</span>
  <span class="s1">&#39;Form Success&#39;</span><span class="p">,</span>
  <span class="s1">&#39;/thank-you/&#39;</span>
<span class="p">);</span>
</code></pre></div>
<p>When you execute this command, it actually <em>replaces</em> the current page in the browser history. In other words, when you click the browser&rsquo;s Back button, you are taken to the page you were on <em>before</em> you entered the page from where you called <code>replaceState</code>.</p>
<p>Note that if you simply add <strong>#someHash</strong> in the URL, it&rsquo;s the equivalent of calling <code>pushState</code> without the benefit of the other parameters in the interface (e.g. the state object).</p>
<p>In Google Tag Manager, you have a <strong>really</strong> useful Trigger type called the <a href="https://www.simoahava.com/amp/analytics/google-tag-manager-history-listener/">History Change</a> Trigger. It goes off whenever one of the following History events occur:</p>
<ul>
<li><strong>pushState</strong></li>
<li><strong>replaceState</strong></li>
<li><strong>hashchange</strong> (when the #someHash in the URL appears/changes)</li>
<li><strong>popstate</strong> (when the active history entry changes)</li>
</ul>
<p>For example, if you want to build pageviews around these history events, it&rsquo;s quite <a href="https://www.simoahava.com/amp/gtm-tips/track-url-fragments-as-pageviews/">simple to do</a> with the History Change Trigger!</p>
<h3 id="further-reading-4">FURTHER READING</h3>
<p>For more information on the Window History API, look no further than these articles:</p>
<ul>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/History_API">MDN: Manipulating the browser history</a></p>
</li>
<li>
<p><a href="http://www.w3schools.com/js/js_window_history.asp">w3schools: JavaScript Window History</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/google-tag-manager-history-listener/">Google Tag Manager History Listener</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/browser-storage.jpg" title="6. Browser Storage">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/browser-storage.jpg" layout="responsive" alt="6. Browser Storage" height="212" width="2016"></amp-img>
  
    </a>
  

<p>The web page is stateless. With every page load, the <em>entire</em> page is built from scratch. All the variables, JavaScript libraries, HTML templates, CSS files and other resources are loaded again.</p>
<p>In other words, if the web browser needs to know something, <em>anything</em>, about what happened at any time in the past, you need to manually persist this information.</p>
<p>You can persist the information in the web server, and this is often quite a robust way to do it. However, because of how the web is built, you still need a way of aligning any given web browser (and thus, user) with the requests that are sent to the web server.</p>
<p>The web browser provides a number of ways to persist this information. The most common methods are browser cookies, Web Storage, and <a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a>.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/webstorage.jpg" title="Browser storage">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/webstorage.jpg" layout="responsive" alt="Browser storage" height="450" width="392"></amp-img>
  
    </a>
  

<h3 id="browser-cookies">Browser cookies</h3>
<p>Browser cookies are useful for simple storage. The browser cookie is essentially a string stored by the web browser, and its accessible only by pages that share the same parent domain to which the cookie was written. So a cookie written on <strong><a href="http://www.simoahava.com">www.simoahava.com</a></strong> would, by default, only be available to pages on <strong><a href="http://www.simoahava.com">www.simoahava.com</a></strong>, but you could also write the cookie on <strong>simoahava.com</strong>, where it would be available to all subdomains.</p>
<p>A cookie written on <strong>simoahava.com</strong> would <em>not</em> be available for pages on <strong>derekahava.com</strong>, because they do not share the same domain.</p>
<p>Cookies also survive transitions from the http:// protocol to https://.</p>
<h3 id="web-storage">Web Storage</h3>
<p>Web Storage (or DOM Storage) encompasses both <code>localStorage</code> (no expiration) and <code>sessionStorage</code> (expires when the web browser is closed). Web Storage is much more flexible than using cookies, because the entries are stored as a hash table, and lookups can be done on a key-by-key basis. With cookies, you need to unravel the entire cookie string just to find the value want.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// TO SET
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">[</span><span class="s1">&#39;Storage&#39;</span><span class="p">])</span> <span class="p">{</span>
  <span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;subscribe&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span> 
  <span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;subscribe&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">setCookie</span><span class="p">(</span><span class="s1">&#39;subscribe&#39;</span><span class="p">,</span> <span class="s1">&#39;true&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// TO FETCH
</span><span class="c1"></span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;subscribe&#39;</span><span class="p">);</span>
<span class="nx">sessionStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;subscribe&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Note that Web Storage does <em>not</em> survive the transition from http:// to https://. Both protocols have their own storage.</p>
<h3 id="indexeddb">IndexedDB</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API">IndexedDB</a> is much more complex than the aforementioned methods, and is thus more suited for application logic on a much larger scale. For example, if you&rsquo;re using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">Service Workers</a> to maintain offline browsing capabilities, IndexedDB is an excellent utility to maintain state while waiting for the internet connection to come back up.</p>
<p>Checkout the link to my article on persisting data in Google Tag Manager for more information (and some tips) on how to setup cookie and Web Storage persistence in GTM!</p>
<h3 id="further-reading-5">FURTHER READING</h3>
<p>Check out the following links for more information:</p>
<ul>
<li>
<p><a href="http://www.w3schools.com/js/js_cookies.asp">w3schools: JavaScript Cookies</a></p>
</li>
<li>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API">MDN: Web Storage API</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/two-ways-to-persist-data-via-google-tag-manager/">Two Ways To Persist Data Via Google Tag Manager</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/dom-traversal-1.jpg" title="7. DOM traversal">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/dom-traversal-1.jpg" layout="responsive" alt="7. DOM traversal" height="252" width="2022"></amp-img>
  
    </a>
  

<p>Locating elements on the page is one of the more obvious use cases for web analytics. Most commonly we want to know if some specific element was the target of a user action such as a click or form submission.</p>
<p>In Google Tag Manager, identifying an element is easy enough with CSS selectors, but what if we actually want to <em>retrieve</em> some element other than what GTM initially gave us?</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/dom-traversal.jpg" title="DOM traversal example">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/dom-traversal.jpg" layout="responsive" alt="DOM traversal example" height="638" width="1914"></amp-img>
  
    </a>
  

<p>There are many ways to retrieve an element relative to some other with JavaScript. A very clumsy way to do it would be to build a complete element chain all between the two elements. So if you wanted to retrieve the element at the top of the DOM in the image above, you could do something like this in a Custom JavaScript Variable:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Please don&#39;t do this:
</span><span class="c1"></span>  <span class="k">return</span> <span class="p">{{</span><span class="nx">Click</span> <span class="nx">Element</span><span class="p">}}</span>
    <span class="p">.</span><span class="nx">parentElement</span>
    <span class="p">.</span><span class="nx">parentElement</span>
    <span class="p">.</span><span class="nx">parentElement</span>
    <span class="p">.</span><span class="nx">parentElement</span>
    <span class="p">.</span><span class="nx">parentElement</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>But please don&rsquo;t do this. It&rsquo;s clumsy and it has multiple points of failure. You&rsquo;re basically expecting the DOM to have a certain structure without providing any redundancies or fallbacks. The longer the chain, the more sensitive it is to even minor changes to the page markup.A better way is to disregard the actual number of elements, and just climb up the DOM until you reach the very top.</p>
<p>So a more robust way of retrieving the element would be something like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="p">{{</span><span class="nx">Click</span> <span class="nx">Element</span><span class="p">}};</span>
  
  <span class="k">while</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">className</span> <span class="o">!==</span> <span class="s1">&#39;content-sidebar-wrap&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="s1">&#39;BODY&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="s1">&#39;BODY&#39;</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>This little script simply climbs up the DOM until it either reaches the element you wanted (<code>.content-sidebar-wrap</code>) or the <code>&lt;body&gt;</code> tag. If it reaches <code>&lt;body&gt;</code>, the assumption is that the element you were looking for was not found, and <code>undefined</code> is returned instead.</p>
<p>Note that this script only works for direct ancestry. If you want to find sibling elements or elements which branch from the direct path between the original element and the root of the document, you might want to leverage frameworks like jQuery to make DOM traversal code more economic.</p>
<h3 id="further-reading-6">FURTHER READING</h3>
<p>Follow these links to find more information on DOM traversal:</p>
<ul>
<li>
<p><a href="http://www.w3schools.com/js/js_htmldom_navigation.asp">w3schools: JavaScript HTML DOM Navigation</a></p>
</li>
<li>
<p><a href="http://domenlightenment.com">DOM Enlightenment</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/node-relationships-gtm/">Node Relationships And GTM</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/css-selectors.jpg" title="8. CSS Selectors">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/css-selectors.jpg" layout="responsive" alt="8. CSS Selectors" height="220" width="2014"></amp-img>
  
    </a>
  

<p>When Google Tag Manager introduced the <a href="https://www.simoahava.com/amp/analytics/matches-css-selector-operator-in-gtm-triggers/">matches CSS selector</a> Trigger operator a while ago, it eliminated a lot of complexity from validating Triggers to only fire for certain HTML element interactions. In a similar manner, the <code>querySelector</code> and <code>querySelectorAll</code> JavaScript DOM methods were just as impactful when they were introduced some years ago into the web browser API.</p>
<p>If you&rsquo;ve built websites or worked with CSS (Cascading Style Sheets) styles before, you&rsquo;ll know what selectors do. They let you select any element or group of elements on the page, and then apply a style to them. For example, the following style declaration would remove the default <em>underline</em> from all links (<code>&lt;a&gt;</code>) with class <code>internal</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">a</span><span class="p">.</span><span class="nc">internal</span> <span class="p">{</span>
    <span class="k">text-decoration</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>
<p>Because it&rsquo;s such an effective way of selecting HTML elements, it&rsquo;s not a big surprise that JavaScript introduced methods for using CSS selectors to find and retrieve HTML elements on the page:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Select every link with attribute data-gtm on the page:
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">gtmLinks</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;a[data-gtm]&#39;</span><span class="p">);</span>

<span class="c1">// Select the first &#39;h2&#39; element on the page, which is the direct child of &#39;section&#39;
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">firstH2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;section &gt; h2&#39;</span><span class="p">);</span>

<span class="c1">// Select the &#39;span&#39; with class &#39;title&#39; that is a descendant of the aforementioned &#39;h2&#39;
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">spanTitle</span> <span class="o">=</span> <span class="nx">firstH2</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;span.title&#39;</span><span class="p">);</span>
</code></pre></div>
<p>Similarly, if you already <em>have</em> an HTML element, you can use the <code>matches</code> API to check if it matches a specific CSS selector:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">isElementLink</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The function above would return <code>true</code> or <code>false</code>, depending on whether the element passed as a parameter is a link or not. Note that <code>matches</code> isn&rsquo;t widely supported yet, but there&rsquo;s a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/matches#Polyfill">polyfill you can use</a> to make it work across all browsers.</p>
<p>In Google Tag Manager, the <a href="https://www.simoahava.com/amp/analytics/matches-css-selector-operator-in-gtm-triggers/">matches CSS selector</a> is ridiculously useful. You can use it to fire your Triggers only when a specific element is the target of the interaction. For example, I could configure a Click / All Elements Trigger like the following to make it only fire when the clicked element is a specific <code>&lt;span&gt;</code> (or any of its nested descendants) on the page!</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/gtm-css.jpg" title="matches CSS selector in GTM">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/gtm-css.jpg" layout="responsive" alt="matches CSS selector in GTM" height="446" width="1748"></amp-img>
  
    </a>
  

<p>CSS selectors shave a crazy amount of time off your JavaScript, as you don&rsquo;t have to write clumsy comparison queries using DOM traversal when trying to identify a specific element. Take a look at the further reading links below to learn more about CSS selectors!</p>
<h3 id="further-reading-7">FURTHER READING</h3>
<p>More stuff about CSS selectors:</p>
<ul>
<li>
<p><a href="http://www.w3schools.com/cssref/css_selectors.asp">w3schools: CSS Selectors Reference</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/matches-css-selector-operator-in-gtm-triggers/">Matches CSS Selector Operator In GTM Triggers</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/jquery.jpg" title="9. jQuery">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/jquery.jpg" layout="responsive" alt="9. jQuery" height="216" width="2016"></amp-img>
  
    </a>
  

<p><a href="http://jquery.com/">jQuery</a> is undoubtedly the most used JavaScript library in the world, and its contributions to standardizing the web experience across browsers and devices should not and do not go unnoticed. The framework provides such a wealth of utilities that trivialize and abstract many of the woes a web developer might have when developing their site to be as accessible across the splintered browser landscape as possible.</p>
<p>In short, jQuery is a library which provides a bunch of simple APIs to perform otherwise complex tasks. For example, let&rsquo;s take the DOM traversal example from chapter 7 and rewrite it with jQuery:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Vanilla JS
</span><span class="c1"></span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="p">{{</span><span class="nx">Click</span> <span class="nx">Element</span><span class="p">}};</span>
  
  <span class="k">while</span> <span class="p">(</span><span class="nx">el</span><span class="p">.</span><span class="nx">className</span> <span class="o">!==</span> <span class="s1">&#39;content-sidebar-wrap&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">el</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="s1">&#39;BODY&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">el</span> <span class="o">=</span> <span class="nx">el</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">el</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="s1">&#39;BODY&#39;</span> <span class="o">?</span> <span class="nx">el</span> <span class="o">:</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// jQuery
</span><span class="c1"></span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">jQuery</span><span class="p">({{</span><span class="nx">Click</span> <span class="nx">Element</span><span class="p">}}).</span><span class="nx">closest</span><span class="p">(</span><span class="s1">&#39;.content-sidebar-wrap&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>So a single line of jQuery abstracted the previous implementation.</p>
<p>Similarly, here&rsquo;s the difference between building a custom HTTP POST request using regular JavaScript versus using jQuery:</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Vanilla JS
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="s1">&#39;v=1&amp;tid=UA-12345-1&amp;t=pageview&amp;dl=https://www.simoahava.com/&amp;cid=12345.12345&#39;</span><span class="p">;</span>

<span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.google-analytics.com/collect&#39;</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">);</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Yay!&#39;</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">!==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Aww :(&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nb">encodeURI</span><span class="p">(</span><span class="nx">payload</span><span class="p">));</span>

<span class="c1">// jQuery
</span><span class="c1"></span><span class="nx">jQuery</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span>
  <span class="s1">&#39;https://www.google-analytics.com/collect&#39;</span><span class="p">,</span>
  <span class="s1">&#39;v=1&amp;tid=UA-12345-1&amp;t=pageview&amp;dl=https://www.simoahava.com/&amp;cid=12345.12345&#39;</span>
<span class="p">)</span>
  <span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Yay!&#39;</span><span class="p">);</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Aww :(&#39;</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div>
<p>I hope you see the trend here. jQuery really makes things more elegant for both the developer as well as for anyone who wants to look at the code and quickly understand what it tries to do.</p>
<p>jQuery isn&rsquo;t all-powerful, though, and relying too much on a framework can make your code weak. My suggestion is to always understand what a given jQuery method does before using it. That way you&rsquo;ll know what the background process is, and you&rsquo;ll learn to avoid nasty surprises such as how <a href="https://www.simoahava.com/amp/gtm-tips/fix-problems-with-gtm-listeners/">jQuery&rsquo;s <code>return false;</code> in event handlers can break GTM&rsquo;s listeners</a>!</p>
<p>Remember also to be wary of race conditions when loading jQuery.</p>


    <a href="https://www.simoahava.com/amp/images/2016/09/jquery-load.jpg" title="jQuery race conditions">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/jquery-load.jpg" layout="responsive" alt="jQuery race conditions" height="764" width="1876"></amp-img>
  
    </a>
  

<p>If you load the library asynchronously, it might not be ready by the time you refer to it in your GTM Tags.</p>
<h3 id="further-reading-8">FURTHER READING</h3>
<p>And here&rsquo;s the scoop on jQuery:</p>
<ul>
<li>
<p><a href="https://api.jquery.com/">jQuery API Documentation</a></p>
</li>
<li>
<p><a href="https://www.codecademy.com/learn/jquery">Codecademy: jQuery</a></p>
</li>
</ul>


    <a href="https://www.simoahava.com/amp/images/2016/09/data-layer.jpg" title="10. Data Layer">
  
    <amp-img src="https://www.simoahava.com/amp/images/2016/09/data-layer.jpg" layout="responsive" alt="10. Data Layer" height="210" width="2014"></amp-img>
  
    </a>
  

<p>Finally, the Data Layer. If you&rsquo;ve used GTM or any tag management solution, it&rsquo;s probably you&rsquo;ve had to really put some thought into understanding how tag management solutions leverage the Data Layer to communicate with the website or other digital property.</p>
<p>It&rsquo;s not purely a JavaScript concept, so it&rsquo;s kind of a black sheep in this mix. Nevertheless, the most typical implementation of a Data Layer, when it comes to tag management solutions, is an Array-type data structure in the global namespace.</p>
<p>I&rsquo;ve written about Data Layer quite a lot on this blog, so instead of repeating what I&rsquo;ve already written far more extensively, I want to direct you to the links below and I strongly suggest you read through them to get a better idea of how the Data Layer works.</p>
<h3 id="further-reading-9">FURTHER READING</h3>
<p>Be sure to check these links out for more information on the Data Layer:</p>
<ul>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/data-layer/">The Data Layer</a></p>
</li>
<li>
<p><a href="https://www.simoahava.com/amp/analytics/google-tag-manager-data-model/">Google Tag Manager&rsquo;s Data Model</a></p>
</li>
<li>
<p><a href="https://github.com/google/data-layer-helper">GitHub: google/data-layer-helper</a></p>
</li>
</ul>

        
          <h2 id="summary">Summary</h2>
<p>The ten JavaScript concepts introduced in this article are, what I consider, the most useful tools that any web analyst would need to know about. Heck, I consider these vital to anyone working with the web, not just analysts!</p>
<p>The thing is, we&rsquo;re working in an extremely technical medium. The web browser is tantalizingly complex in all its machinations, and it doesn&rsquo;t really help that all web browsers act slightly differently when it comes to producing the web document into our screens.</p>
<p>When working with web analytics, we are trying to decipher the abstract signals sent by users, web servers, the browser itself, and background processes, as we do our best to align these signals with their real-world counterparts.</p>
<p>It&rsquo;s not easy!</p>
<p>Trying to deconstruct the enormously difficult concepts of &ldquo;intent&rdquo;, &ldquo;engagement&rdquo;, and &ldquo;interaction&rdquo; using a handful of JavaScript handlers seems like a fool&rsquo;s errand, but it&rsquo;s the only thing we can do when creating an implementation framework for any given web application.</p>
<p>But the more we know about JavaScript and the numerous APIs that the web browser lets us tap into, the more we can uncover about our visitors and their actions on the site.</p>
<p>I hope you found these tips useful. Do you have other JavaScript concepts that you consider are absolutely essential for anyone working with the web to acquaint themselves with?</p>

        
      
    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://www.simoahava.com/amp/"></a>
    </figure>
    

    
    
    
        
    
    

    <section class="author">
      <h4>Simo Ahava</h4>
      
        <p>Husband | Father | Analytics developer</p>
      
      <div class="author-meta">
        <span class="author-location icon-location">Espoo, Finland</span>
        <span class="author-link icon-link"><a href="https://www.simoahava.com/">https://www.simoahava.com/</a></span>
      </div>
    </section>


    
    <div class="social">

<amp-social-share type="twitter"
  width="60"
  height="44"> </amp-social-share>





<amp-social-share type="linkedin"
                  width="60"
                  height="44"></amp-social-share>


    <amp-social-share type="facebook"
                      width="60"
                      height="44"></amp-social-share>

</div>


    
  </footer>
</article>

</main>
</div>

</body>
</html>

