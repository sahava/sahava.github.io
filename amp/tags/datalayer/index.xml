<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>DataLayer on Simo Ahava's blog</title><link>https://www.simoahava.com/amp/tags/datalayer/</link><description>Recent content in DataLayer on Simo Ahava's blog</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Mon, 19 Nov 2018 12:09:33 +0200</lastBuildDate><atom:link href="https://www.simoahava.com/amp/tags/datalayer/index.xml" rel="self" type="application/rss+xml"/><item><title>Persist Google Tag Manager's dataLayer Across Pages</title><link>https://www.simoahava.com/amp/analytics/persist-datalayer-across-pages/</link><pubDate>Mon, 19 Nov 2018 12:09:33 +0200</pubDate><guid>https://www.simoahava.com/amp/analytics/persist-datalayer-across-pages/</guid><description>&lt;blockquote>
&lt;p>&lt;strong>UPDATE 4 June 2020&lt;/strong>: Instead of copying the Custom HTML code from the article, please load it from the &lt;a href="https://gist.github.com/sahava/baee63650eed471a2d1eac5825037a05">GitHub Gist&lt;/a> instead.&lt;/p>
&lt;/blockquote>
&lt;p>Four years ago, I wrote an article on &lt;a href="https://www.simoahava.com/amp/analytics/persist-datalayer-google-tag-manager/">how to persist GTM&amp;rsquo;s &lt;code>dataLayer&lt;/code> from page to page&lt;/a>. Unfortunately, the solution was a bit clumsy, requiring you to give specific &lt;em>commands&lt;/em> for the interactions, which made it really unwieldy in the long run. &lt;a href="https://tagmanager.google.com/">Google Tag Manager&lt;/a> still doesn&amp;rsquo;t offer us a native way to persist the &lt;code>dataLayer&lt;/code> array or its &lt;a href="https://www.simoahava.com/amp/analytics/google-tag-manager-data-model/">internal data model&lt;/a> from one page to the other, so I thought it was about time I revisit this idea.&lt;/p></description></item><item><title>#GTMTips: Search dataLayer For A Key-Value Pair</title><link>https://www.simoahava.com/amp/analytics/search-datalayer-for-key-value-pair/</link><pubDate>Tue, 06 Nov 2018 10:05:27 +0200</pubDate><guid>https://www.simoahava.com/amp/analytics/search-datalayer-for-key-value-pair/</guid><description>&lt;p>One of the difficulties of working with &lt;a href="https://tagmanager.google.com/">Google Tag Manager&lt;/a> and the &lt;a href="https://www.simoahava.com/amp/analytics/data-layer/">&lt;code>dataLayer&lt;/code> structure&lt;/a> is that GTM doesn&amp;rsquo;t preserve &lt;strong>history&lt;/strong> of the items collected into its &lt;a href="https://www.simoahava.com/amp/analytics/google-tag-manager-data-model/">data model&lt;/a>. Or, at least, it doesn&amp;rsquo;t preserve it in a manner that would let us access it.&lt;/p>
&lt;p>This is typically a very niche problem, but it does surface every now and then. For example, say you wanted to query whether an &lt;code>event&lt;/code> with some specific value has already been pushed into &lt;code>dataLayer&lt;/code>. Well, this is impossible, since any &lt;code>event&lt;/code> you use to trigger this check would overwrite this previous &lt;code>event&lt;/code> value in the data model (since any given key can only have one value at a time).&lt;/p></description></item><item><title>#GTMTips: Fix Missing Page View Event And Broken Triggers</title><link>https://www.simoahava.com/amp/analytics/fix-missing-page-view-broken-triggers/</link><pubDate>Fri, 09 Feb 2018 09:18:42 +0200</pubDate><guid>https://www.simoahava.com/amp/analytics/fix-missing-page-view-broken-triggers/</guid><description>&lt;p>&lt;a href="https://tagmanager.google.com/">Google Tag Manager&lt;/a> should be relatively easy to implement. Just paste the &lt;a href="https://www.simoahava.com/amp/analytics/container-snippet-gtm-secrets-revealed/">container snippet&lt;/a> to the &lt;code>&amp;lt;head&amp;gt;&lt;/code> of the page and you&amp;rsquo;re good to go! However, at some point you&amp;rsquo;ll want to configure the &lt;code>dataLayer&lt;/code> structure, too (read more about &lt;code>dataLayer&lt;/code> &lt;a href="https://www.simoahava.com/amp/analytics/data-layer/">here&lt;/a>). There are two ways to do it: the &lt;a href="https://www.simoahava.com/amp/gtm-tips/datalayer-declaration-vs-push/">right way and the wrong way&lt;/a>.&lt;/p>
&lt;p>In this article, we&amp;rsquo;ll see what happens if you do it the wrong way, how to identify the issue, and how to fix it.&lt;/p></description></item><item><title>#GTMTips: Use eventTimeout With eventCallback</title><link>https://www.simoahava.com/amp/gtm-tips/use-eventtimeout-eventcallback/</link><pubDate>Wed, 27 Jul 2016 08:43:20 +0000</pubDate><guid>https://www.simoahava.com/amp/gtm-tips/use-eventtimeout-eventcallback/</guid><description>&lt;p>There are times when I&amp;rsquo;m disappointed with &lt;a href="https://developers.google.com/tag-manager/devguide">Google&amp;rsquo;s developer documentation&lt;/a>, especially for &lt;a href="https://tagmanager.google.com/">Google Tag Manager&lt;/a>. Most of the time they get it right, and I&amp;rsquo;d say around 80% of questions being thrown around the forums can be answered just by reading through the documentation. But there are some cases where the documentation is misleading or even downright dangerous. One of these cases is &lt;a href="https://developers.google.com/tag-manager/enhanced-ecommerce">Enhanced Ecommerce&lt;/a>.&lt;/p>
&lt;p>This isn&amp;rsquo;t going to be a thorough critique of said documentation, but the tip in this post has to do with one of the examples that the documentation gives for &lt;a href="https://developers.google.com/tag-manager/enhanced-ecommerce#product-clicks">measuring Product Clicks&lt;/a>. In the comment it says:&lt;/p></description></item><item><title>Measure Google Tag Manager Event Duration</title><link>https://www.simoahava.com/amp/analytics/measure-google-tag-manager-event-duration/</link><pubDate>Wed, 08 Jun 2016 16:09:45 +0000</pubDate><guid>https://www.simoahava.com/amp/analytics/measure-google-tag-manager-event-duration/</guid><description>&lt;p>&lt;a href="https://tagmanager.google.com/">Google Tag Manager&lt;/a> is a great tool. Yeah, you came all the way to this article to read that truism. It also performs really well, loading at a sweet, swift pace even on a slow connection, thanks to pretty decent response times from Google servers. On top of that, the library itself loads &lt;em>asynchronously&lt;/em>, meaning the container download doesn&amp;rsquo;t interrupt the browser as it tries to make sense of your messy HTML.&lt;/p></description></item><item><title>#GTMtips: dataLayer Declaration Vs. .push()</title><link>https://www.simoahava.com/amp/gtm-tips/datalayer-declaration-vs-push/</link><pubDate>Mon, 13 Oct 2014 06:43:21 +0000</pubDate><guid>https://www.simoahava.com/amp/gtm-tips/datalayer-declaration-vs-push/</guid><description>&lt;p>Here&amp;rsquo;s a tip on how to avoid a horrible, horrible mistake with &lt;a href="http://www.google.com/tagmanager/">Google Tag Manager&lt;/a>.&lt;/p>
&lt;h2 id="tip-7-always-use-push-with-datalayer">Tip 7: Always use .push() with dataLayer&lt;/h2>


 &lt;a href="https://www.simoahava.com/amp/images/2014/10/datalayer-declaration-push.jpg" title="dataLayer declaration vs. .push()">
 
 &lt;amp-img src="https://www.simoahava.com/amp/images/2014/10/datalayer-declaration-push.jpg" layout="responsive" alt="dataLayer declaration vs. .push()" height="848" width="1518">&lt;/amp-img>
 
 &lt;/a>
 

&lt;p>When you assign a value to a variable using the equals ( = ) sign, you are actually reallocating the variable to a new value, and the garbage collection system of the runtime environment sweeps the previous value to bit heaven.&lt;/p>
&lt;p>Let&amp;rsquo;s put it simply: if you redefine &lt;code>dataLayer&lt;/code> after the GTM container snippet, you will break GTM&amp;rsquo;s proprietary functions. No, I&amp;rsquo;m not trying to be dramatic, it&amp;rsquo;s the truth. You cause havoc because GTM &lt;a href="https://www.simoahava.com/amp/analytics/google-tag-manager-data-model/">modifies the native &lt;code>push()&lt;/code> method&lt;/a> that all Arrays have, adding stuff of little importance such as &lt;strong>a listener which fires tags when an &amp;rsquo;event&amp;rsquo; key is pushed!&lt;/strong>.&lt;/p></description></item><item><title>The Data Layer</title><link>https://www.simoahava.com/amp/analytics/data-layer/</link><pubDate>Mon, 15 Sep 2014 07:05:09 +0000</pubDate><guid>https://www.simoahava.com/amp/analytics/data-layer/</guid><description>&lt;p>Writing this article is dangerous. &lt;em>Data Layer&lt;/em> is two marketers short of becoming a buzz word. This occasion will be heralded by articles such as &amp;ldquo;Data Layer Is Dead&amp;rdquo;, &amp;ldquo;This Developer Implemented A Data Layer And You&amp;rsquo;ll Never Guess What Happened Next&amp;rdquo;, and other examples of the kind of content generation whose propagation should be prevented by military force. This is not one of those articles, I hope, but rather an honest look at what Data Layer is from a number of perspectives.&lt;/p></description></item><item><title>Persist dataLayer In Google Tag Manager</title><link>https://www.simoahava.com/amp/analytics/persist-datalayer-google-tag-manager/</link><pubDate>Mon, 01 Sep 2014 06:57:02 +0000</pubDate><guid>https://www.simoahava.com/amp/analytics/persist-datalayer-google-tag-manager/</guid><description>&lt;p>(Update 19 November 2018: See &lt;a href="https://www.simoahava.com/amp/analytics/persist-datalayer-across-pages/">this article&lt;/a> for a more elegant solution.)&lt;/p>
&lt;p>If you know your &lt;a href="https://www.simoahava.com/amp/analytics/javascript-101-gtm-part-1/">JavaScript&lt;/a>, you know that all variables, functions, objects, resources, and data in the document get rewritten with every page load. In other words, every single page refresh builds the page from scratch, and the state of the document before the page refresh is left drifting in the ocean of oblivion.&lt;/p>
&lt;p>&lt;a href="http://www.google.com/tagmanager">Google Tag Manager&lt;/a>&amp;rsquo;s dataLayer is also one such entity. It gets rewritten with every page load, so it&amp;rsquo;s not possible to have a dataLayer variable &lt;em>persist&lt;/em> from one page to the other without using cookies or, as I&amp;rsquo;m going to show in this guide, the &lt;a href="http://www.w3schools.com/html/html5_webstorage.asp">HTML5 Web Storage API&lt;/a>. For web analytics, this is a bit of a shame. It forces us to think of things in the scope of a single page, when rarely anything worth mentioning has a lifespan that short.&lt;/p></description></item></channel></rss>