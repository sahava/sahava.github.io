


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />



    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.31 with theme Tranquilpeak 0.4.3-BETA">
    <title>Google Tag Manager and Google Analytics | Simo Ahava's blog</title>
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZ7GMV9');</script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
      <link rel="alternate" type="application/rss+xml" title="RSS" href="https://www.simoahava.com/index.xml">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/">
    
    <meta name="description" content="Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.">
    <meta property="og:description" content="Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Google Tag Manager and Google Analytics">
    <meta property="og:url" content="/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Google Tag Manager and Google Analytics">
    <meta name="twitter:description" content="Simo Ahava is a Google Developer Expert for Google Analytics and Google Tag Manager. This is a blog all about web analytics development.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="1">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="1">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="1"
        class="
               hasCoverMetaIn
               ">
        <section class="postShorten-group main-content-wrap">
          

  <span class="talks"><span class="fa fa-md fa-bullhorn"></span><a title="Next conference talk" href="https://www.simoahava.com/upcoming-talks/">24 May 2018: NXT Nordic (Oslo)</a></span>


	  <form id="search" action="/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/analytics/new-tools-released/">
          New Tools Released
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2018-01-12T08:32:46&#43;02:00">
        
  January 12, 2018

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/new-tools-released/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      Over the past few weeks, I&rsquo;ve been coding like crazy. The three biggest outcomes of this frenzy have been this new blog design (switched finally away from WordPress and took the plunge back into the world static sites using Hugo), a new Google Sheets add-on for managing Google Tag Manager containers and assets, and a Slack integration in GTM Tools. In this article, I&rsquo;ll quickly introduce the last two, as I&rsquo;m writing a separate article about the site redesign.
      <p>
        <a href="https://www.simoahava.com/analytics/new-tools-released/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/analytics/new-tools-released/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2018/01/add-to-slack.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/gtm-tips/opt-out-of-google-analytics-tracking/">
          #GTMTips: Opt-out Of Google Analytics Tracking
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2018-01-09T16:17:18&#43;02:00">
        
  January 9, 2018

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM tips</a>
    
  


       | <a href="https://www.simoahava.com/gtm-tips/opt-out-of-google-analytics-tracking/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      A while ago I posted a #GTMTips post where I detailed the steps you can take to opt-out of all Google Analytics tracking and the DoubleClick redirects that often follow. It was a fun exercise, but because it relies on preventing requests on a tag-by-tag basis (using the ubiquituous customTask), it can be a chore to handle in large containers.
In this article, we&rsquo;ll continue with the theme of opting out from Google Analytics tracking by leveraging a solution provided by the tool itself.
      <p>
        <a href="https://www.simoahava.com/gtm-tips/opt-out-of-google-analytics-tracking/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/gtm-tips/opt-out-of-google-analytics-tracking/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2018/01/opt-out-google-analytics-tracking.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/gtm-tips/auto-link-domains-with-regex/">
          #GTMTips: Auto Link Domains With Regex
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-12-21T10:06:19&#43;02:00">
        
  December 21, 2017

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM tips</a>
    
  


       | <a href="https://www.simoahava.com/gtm-tips/auto-link-domains-with-regex/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      Google Tag Manager makes it fairly easy to do cross-domain tracking. Basically, you list the hostnames you want to automatically decorate with linker parameters in the Auto-Link Domains field of your Page View tag, and that takes care of decorating the URLs with the necessary parameter. It&rsquo;s dead easy, even if there are a bunch of traps you need to watch out for (see my post on troubleshooting cross-domain tracking issues).
      <p>
        <a href="https://www.simoahava.com/gtm-tips/auto-link-domains-with-regex/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/gtm-tips/auto-link-domains-with-regex/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2017/12/auto-link-domains-with-regex.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/analytics/add-clientid-to-custom-dimension-gtag-js/">
          Add Client ID To Custom Dimension With gtag.js
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-12-19T06:50:11&#43;02:00">
        
  December 19, 2017

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/add-clientid-to-custom-dimension-gtag-js/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      When Google released gtag.js, the new, global tracking library designed to (eventually) replace analytics.js, many Universal Analytics practitioners and users were confused (see e.g. Jeff&rsquo;s great overview here). It seemed like gtag.js wasn&rsquo;t really solving any immediate problem, since analytics.js had done a bang-up job with Universal Analytics tracking for all these years. However, gtag&rsquo;s modus operandi is the ability to leverage the same semantic information (distributed across dataLayer!) across a number of Google products, starting with GA and AdWords.
      <p>
        <a href="https://www.simoahava.com/analytics/add-clientid-to-custom-dimension-gtag-js/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/analytics/add-clientid-to-custom-dimension-gtag-js/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2017/12/add-clientid-custom-dimension-gtag.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/gtm-tips/add-load-listener-script-elements/">
          #GTMTips: Add A Load Listener To Script Elements
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-12-12T11:21:51&#43;02:00">
        
  December 12, 2017

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM tips</a>
    
  


       | <a href="https://www.simoahava.com/gtm-tips/add-load-listener-script-elements/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      One of the challenges in working with Google Tag Manager (or any JavaScript-based platform for that matter) is what to do with race conditions. A race condition emerges when you have two resources competing for execution in the browser, and there is a degree of unpredictability to which &ldquo;wins&rdquo; the race.
A prime example is working with jQuery. It&rsquo;s one of the most popular JavaScript libraries out there, and websites utilize it for a multitude of things, many useful for Google Tag Manager, too.
      <p>
        <a href="https://www.simoahava.com/gtm-tips/add-load-listener-script-elements/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/gtm-tips/add-load-listener-script-elements/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2017/12/add-load-listener-to-script-elements.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/analytics/send-event-custom-dimension-google-optimize-experiment-running/">
          Send Event And Custom Dimension If Google Optimize Experiment Is Running
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-11-16T14:52:07Z">
        
  November 16, 2017

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/send-event-custom-dimension-google-optimize-experiment-running/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      I really like Google Optimize. It has a fairly intuitive UI, setting up experiments is easy, and there&rsquo;s integrations for both Google Tag Manager and Google Analytics built into the system. It&rsquo;s still a JavaScript-based, client-side A/B-testing tool, so problems with flicker and asynchronous loading are ever-present (though this is somewhat mitigated by the page-hiding snippet).
One issue with the Google Analytics integration is the difficulty of creating segments for sessions where the users were actively participating in the experiment.
      <p>
        <a href="https://www.simoahava.com/analytics/send-event-custom-dimension-google-optimize-experiment-running/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/analytics/send-event-custom-dimension-google-optimize-experiment-running/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2017/11/custom-dim-exp-id.png"/>
      </div>
    </a>
  
</article>

          
            
  
    
  


  

<article class="postShorten postShorten--thumbnailimg-left">
  <div class="postShorten-wrap">
    
    <div class="postShorten-header">
      <h1 class="postShorten-title">
        <a class="link-unstyled" href="https://www.simoahava.com/gtm-tips/respect-opt-out-from-advertising-and-analytics/">
          #GTMTips: Respect Opt-Out From Advertising And Analytics
        </a>
      </h1>
      
  <div class="postShorten-meta post-meta">
    
      <time datetime="2017-11-03T08:09:09Z">
        
  November 3, 2017

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM tips</a>
    
  


       | <a href="https://www.simoahava.com/gtm-tips/respect-opt-out-from-advertising-and-analytics/#disqus_thread">Comments</a>
  </div>


    </div>
    <div class="postShorten-excerpt">
      With GDPR looming around the corner, it&rsquo;s time to explore the options you have at your disposal for respecting the new, stricter regulations for tracking users and for collecting data about their visits to your website.
 UPDATE: It looks like if you have the Advertising / Enable Display Advertising Features toggle set to True in the Google Analytics tag settings, setting the displayFeaturesTask null will not work in the solution outlined below.
      <p>
        <a href="https://www.simoahava.com/gtm-tips/respect-opt-out-from-advertising-and-analytics/" class="postShorten-excerpt_link link">Continue reading</a>
        
      </p>
    </div>
  </div>
  
    <a href="https://www.simoahava.com/gtm-tips/respect-opt-out-from-advertising-and-analytics/">
      <div class="postShorten-thumbnailimg">
        <img alt="" src="https://www.simoahava.com/images/2017/11/respect-opt-out-analytics-advertising.png"/>
      </div>
    </a>
  
</article>

          
          
  <div class="pagination-bar">
    <ul class="pagination">
      
        
          <li class="pagination-prev">
            <a class="btn btn--default btn--small" href="https://www.simoahava.com/page/3/">
              <i class="fa fa-angle-left text-base icon-mr"></i>
              <span>NEWER POSTS</span>
            </a>
          </li>
        
        
          <li class="pagination-next">
            <a class="btn btn--default btn--small" href="https://www.simoahava.com/page/5/">
              <span>OLDER POSTS</span>
              <i class="fa fa-angle-right text-base icon-ml"></i>
            </a>
          </li>
        
      
      <li class="pagination-number">page 4 of 33</li>
    </ul>
  </div>


        </section>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://www.simoahava.com/js/script.js"></script>






    
  </body>
</html>

