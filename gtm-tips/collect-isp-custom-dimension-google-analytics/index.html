

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "#GTMTips: Collect ISP As A Custom Dimension In Google Analytics | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2020\/02\/service-provider-custom-dimension.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/gtm-tips\/collect-isp-custom-dimension-google-analytics\/",
  "datePublished": "2020-02-10T09:34:32\u002b02:00",
  "dateModified": "2020-02-10T09:34:32\u002b02:00",
  "description": "Since Google Analytics has deprecated the Service Provider and Network Domain dimension, you will have to use a custom solution to bring this information back. In this article, I\u0027ll show you how to use a gallery template to return the Service PRovider dimension.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>#GTMTips: Collect ISP As A Custom Dimension In Google Analytics | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article', environment:  null });
    </script>
    

    
    
    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://sgtm.simoahava.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/gtm-tips/collect-isp-custom-dimension-google-analytics/">
    
    <meta name="description" content="Since Google Analytics has deprecated the Service Provider and Network Domain dimension, you will have to use a custom solution to bring this information back. In this article, I&#39;ll show you how to use a gallery template to return the Service PRovider dimension.">
    <meta property="og:description" content="Since Google Analytics has deprecated the Service Provider and Network Domain dimension, you will have to use a custom solution to bring this information back. In this article, I&#39;ll show you how to use a gallery template to return the Service PRovider dimension.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="#GTMTips: Collect ISP As A Custom Dimension In Google Analytics">
    <meta property="og:url" content="https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="#GTMTips: Collect ISP As A Custom Dimension In Google Analytics">
    <meta name="twitter:description" content="Since Google Analytics has deprecated the Service Provider and Network Domain dimension, you will have to use a custom solution to bring this information back. In this article, I&#39;ll show you how to use a gallery template to return the Service PRovider dimension.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2020/02/service-provider-custom-dimension.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2020/02/service-provider-custom-dimension.jpg">
    


    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    
    <div id="_progress"></div>
    
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/newsletter/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bell"></i>
      
      <span class="sidebar-button-desc">Newsletter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          <div class="post-header main-content-wrap text-left">
  
  

    <h1>
      #GTMTips: Collect ISP As A Custom Dimension In Google Analytics
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-02-10T09:34:32&#43;02:00">
        
  February 10, 2020

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM Tips</a>
    
  


      | <a href="https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/#commento">Comments</a>
      
  </div>


</div>

          <div class="post-content markdown">
            <div class="main-content-wrap">
	      
                
  	        <blockquote>
<p><strong>Update 6 April 2020</strong>: I updated the template in the gallery to the latest version of the <a href="https://ipgeolocation.io/documentation/ip-geolocation-api-jquery-sdk.html">IP Geolocation API SDK</a>, which no longer requires jQuery. Also, the SDK now handles API request caching to browser storage automatically, so the &ldquo;Enable Session Storage&rdquo; option was added to the template.</p>
</blockquote>
<p><a href="https://analytics.google.com/">Google Analytics</a> had been foreshadowing the deprecation of the <strong>Network Domain</strong> and <strong>Service Provider</strong> custom dimensions since late 2019. On <strong>February 4</strong>, the plug was finally pulled, and both these dimensions started flatlining to <code>(not set)</code> in Google Analytics reports. For more information about this, see these articles:</p>
<ul>
<li><a href="https://www.seerinteractive.com/blog/deprecating-network-domain-service-provider/">Google Analytics Deprecating &lsquo;Network Domain&rsquo; And &lsquo;Service Provider&rsquo;</a></li>
<li><a href="https://www.clickinsight.ca/blog/service-provider-not-set-google-analytics">Mourning the Death of &ldquo;Service Provider&rdquo; &amp; &ldquo;Network Domain&rdquo; in Google Analytics</a></li>
<li><a href="https://www.leadfeeder.com/blog/dear-google-why-oh-why-did-you-remove-service-provider-and-network-domain-from-analytics/">Dear Google, Why Oh Why Did You Remove Service Provider and Network Domain from Analytics?</a></li>
</ul>
<p>This article is not a post-mortem. I won&rsquo;t go into speculating why they made this change, nor will I anguish over the loss of these dimensions. Instead, I want to give you a practical way forward: a method with which you can reinstate <em>some</em> of the lost information as early as &hellip; today!</p>
<p>We&rsquo;ll be using <a href="https://tagmanager.google.com/">Google Tag Manager</a>, my <a href="https://tagmanager.google.com/gallery/#/owners/gtm-templates-simo-ahava/templates/ip-geolocation-api">IP Geolocation API</a> template in the template gallery, and you&rsquo;ll also need a (free) API key from <a href="https://ipgeolocation.io/signup.html">ipgeolocation.io</a>.</p>

                <span class="simmer">
  <span class="close">X</span>
  <p>
    <span class="fa fa-md fa-bell"></span>
    <strong>The Simmer Newsletter</strong>
  </p>
  <p>
    Subscribe to the <a href="https://www.simoahava.com/newsletter/">Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!
  </p>
  </span>

                
                  <h2 id="tip-109-get-your-service-provider-data-back">Tip 109: Get your Service Provider data back</h2>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/service-provider-custom-dimension.jpg" title="service provider custom dimension">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/service-provider-custom-dimension.jpg#ZgotmplZ" alt="service provider custom dimension" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 960 540'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<blockquote>
<p>As you can see, this solution only reinstates the ISP information - not the Network Domain. This should typically be enough for bot / spam removal, but in case you do want the qualified domain names of the IP addresses, you&rsquo;ll need to look at other IP APIs out there.</p>
</blockquote>
<h3 id="get-the-api-key">Get the API key</h3>
<p>First, you&rsquo;ll need to visit <a href="https://ipgeolocation.io/">ipgeolocation.io</a> and get an API key. The free key gives you 30K requests a month (1K maximum per day), which is not a lot, I know. You can upgrade to paid plans to increase the quotas, and you can add some client-side throttling (covered <a href="#throttling-the-api-requests">later</a> in this article) to reduce the number of API calls being made.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/get-api-key.jpg" title="Get API Key">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/get-api-key.jpg#ZgotmplZ" alt="Get API Key" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2590 492'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<h3 id="configure-the-template">Configure the template</h3>
<p>Once you have the API key, visit the template gallery and fetch the <a href="https://tagmanager.google.com/gallery/#/owners/gtm-templates-simo-ahava/templates/ip-geolocation-api">IP Geolocation API</a> custom template.</p>
<p>Then, in your workspace, create a new tag, and choose the IP Geolocation API template as the foundation.</p>
<p>Add your <strong>API Key</strong> to the respective field. You can leave the other settings at their defaults, but if you want, you can expand <strong>Other Settings</strong> and check the new <strong>Add Hashed IP</strong> configuration.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/hashed-ip.jpg" title="Hashed IP">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/hashed-ip.jpg#ZgotmplZ" alt="Hashed IP" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1798 1798'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>This setting hashes the user&rsquo;s IP address (using <strong>SHA256</strong>), and writes it into the <code>dataLayer</code> object with the key <code>geoData.hashedIp</code>. Since it&rsquo;s hashed and can&rsquo;t be decrypted, you can send this as a custom dimension to Google Analytics. As it can no longer be reversed to identify the machine the user is using, it won&rsquo;t be in violation of Google Analytics&rsquo; TOS. Naturally, it is still a potential user identifier, so you need to make sure sending it is in compliance with laws governing the passing and processing of such identifiers.</p>
<p>You can set the tag to fire on the <strong>All Pages</strong> trigger.</p>
<h3 id="create-the-custom-dimensions">Create the custom dimensions</h3>
<p>Once the tag is in place, you can create the custom dimensions in Google Analytics. Whether you use <strong>session scope</strong> or <strong>user scope</strong> is up to you. The first gives you some flexibility for tracking / blocking internal traffic, and the second might be more useful for identifying bots.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/custom-dimensions.jpg" title="Custom Dimensions">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/custom-dimensions.jpg#ZgotmplZ" alt="Custom Dimensions" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2316 336'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<h3 id="create-the-event-tag-trigger-and-variables">Create the Event tag, trigger, and variables</h3>
<p>Finally, you need to create the Event tag, the trigger to fire it with, and any Data Layer variables you want to send.</p>
<p>The IP information is written into a <code>dataLayer</code> object that looks roughly like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
  event: <span style="color:#a50">&#39;geolocate&#39;</span>,
  geoData: {
    ip: <span style="color:#a50">&#39;123.123.123.123&#39;</span>,
    hashedIp: <span style="color:#a50">&#39;9iCCGWzjVQPV74KJa3iiS9RKiof6m7y/8aSD9WyT0mw=&#39;</span>,
    isp: <span style="color:#a50">&#39;My ISP Org&#39;</span>,
    ...
  }
}
</code></pre></div>
<p>To fire your tag, create a new <strong>Custom Event trigger</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/custom-event.jpg" title="Custom Event trigger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/custom-event.jpg#ZgotmplZ" alt="Custom Event trigger" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 520 382'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can then create Data Layer variables for the <code>isp</code> and <code>hashedIp</code> fields (and <a href="https://ipgeolocation.io/documentation/ip-geolocation-api.html">any other fields</a> you might want to utilize from the API response object).</p>
<p>Here&rsquo;s an example of what the Data Layer variable for the ISP information looks like:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/dlv-isp.jpg" title="ISP Data Layer variable">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/dlv-isp.jpg#ZgotmplZ" alt="ISP Data Layer variable" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1846 910'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Finally, you need an <strong>Event</strong> tag to send the information to Google Analytics. It could look like this:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/isp-event-tag.jpg" title="ISP event tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/isp-event-tag.jpg#ZgotmplZ" alt="ISP event tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1838 1672'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Key things are naturally the custom dimensions, but also setting the <strong>Non-Interaction Hit</strong> field to <strong>True</strong>.</p>
<p>Make sure the tag fires on the Custom Event trigger you just created.</p>
<h3 id="testing-the-setup">Testing the setup</h3>
<p>To test the setup, use the <a href="https://chrome.google.com/webstore/detail/gtmga-debug/ilnpmccnfdjdjjikgkefkcegefikecdc?hl=en">GTM/GA Debug</a> extension.</p>
<p>Load the Preview container version in your browser, with the extension active, and then check that a hit is sent to Google Analytics with all the information you included in it.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/isp-event-ga-debug.jpg" title="ISP Event GA Debug">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/isp-event-ga-debug.jpg#ZgotmplZ" alt="ISP Event GA Debug" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 3770 968'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Remember to check your Google Analytics data in a few hours (you might need to wait even longer if it&rsquo;s a new custom dimension) to make sure the data is being populated correctly.</p>
<h3 id="throttling-the-api-requests">Throttling the API requests</h3>
<p>Remember that in the free version of the API you only have 1000 requests per day? That&rsquo;s definitely not a lot. So you can <strong>throttle</strong> the requests to make sure they only fire once per session, or even once per user.</p>
<p>For this, you need <strong>browser cookies</strong> or some other form of browser storage.</p>
<p>The <strong>session cookie</strong> is something you can manipulate with <a href="https://www.simoahava.com/analytics/customtask-the-guide/">customTask</a>. In fact, I&rsquo;ve written <a href="https://www.simoahava.com/analytics/create-and-update-google-analytics-session-timeout-cookie/">a solution for updating a session cookie</a> with every Google Analytics hit.</p>
<p>Once you have the <code>customTask</code> in place, you&rsquo;ll need to modify the trigger on the <strong>IP Geolocation API</strong> tag to only fire if the cookie does not exist (i.e. there&rsquo;s no active session). Instead of an <strong>All Pages</strong> trigger, you&rsquo;ll need a new <strong>Page View</strong> trigger. Also, you&rsquo;ll need a <strong>1st Party Cookie</strong> variable as instructed in <a href="https://www.simoahava.com/analytics/create-and-update-google-analytics-session-timeout-cookie/">the guide</a>. The final trigger should look something like this:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/02/page-view-trigger.jpg" title="Page View trigger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/02/page-view-trigger.jpg#ZgotmplZ" alt="Page View trigger" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2844 892'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Using this trigger on the IP Geolocation API tag, you&rsquo;ll restrict the API request to only happen once every 30 minutes of GA inactivity. That should keep the number of requests down nicely.</p>
<p>You can also throttle <em>per user</em>, by <a href="https://www.simoahava.com/analytics/two-ways-to-persist-data-via-google-tag-manager/">creating a cookie</a> after the API request has completed (e.g. in a new custom template or a Custom HTML tag), and then using the existence of this cookie to prevent the API tag from firing again.</p>
<p>I would personally recommend to throttle only per session, as ISPs can change as the user moves around, and scoping the ISP to the user might block actual, valid traffic as well.</p>

                
                  <h2 id="summary">Summary</h2>
<p>In this article, we&rsquo;ve learned how to repurpose a gallery template to return some of the data we&rsquo;ve lost as Google deprecated the <strong>Service Provider</strong> and <strong>Network Domain</strong> dimensions.</p>
<p>In addition to that, we go the additional bonus of collecting the <strong>hashed IP address</strong> of the user. This can be used to further filter out bots, as you can identify hashed IP addresses belonging to bots and add them to a blacklist either in your Google Tag Manager triggers, or in Google Analytics&rsquo; filters.</p>
<p>The downside of the IP Geolocation API is that it doesn&rsquo;t expose the <strong>Network Domain</strong> dimension. For this, you&rsquo;ll need some other API and some other solution. I&rsquo;m sure other authors will be quick to introduce solutions similar to mine, which you can then check out and implement if they seem better for your use cases.</p>
<p>There&rsquo;s an upside to using an API solution of your own rather than relying on Google&rsquo;s reverse lookups - you have more transparency, more options, and more methods to comply with laws and regulations that govern the parsing of user identifiers, personal data, and IP address lookups.</p>
<p>I hope you found this useful! Please let me know in the comments if you have suggestions for improving the setup, or if you didn&rsquo;t understand something - I&rsquo;m here to help.</p>

                
              
              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/custom-templates/">custom templates</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/api/">api</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/ip/">ip</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cookieless-tracking-cross-site-iframes/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Collect%20ISP%20As%20A%20Custom%20Dimension%20In%20Google%20Analytics%20https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://commento.simoahava.com/js/commento.js" data-no-livereload="true"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cookieless-tracking-cross-site-iframes/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Collect%20ISP%20As%20A%20Custom%20Dimension%20In%20Google%20Analytics%20https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Collect%20ISP%20As%20A%20Custom%20Dimension%20In%20Google%20Analytics%20https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://commento.simoahava.com/js/count.js"></script>

    <script>
      !function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),o=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");if(e){if(o){e.style.display="none"}t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"})}}();
    </script>
    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>
    <style>
      .ads {
	  width: 1px;
      }
      </style>
         

    
  </body>
</html>

