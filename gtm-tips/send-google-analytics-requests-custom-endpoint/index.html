<!doctype html><html lang=en-us><head><meta name=google-site-verification content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"#GTMTips: Send Google Analytics Requests To Custom Endpoint | Simo Ahava's blog","image":"https:\/\/www.simoahava.com\/images\/2020\/07\/send-google-analytics-request-custom-endpoint.jpg","editor":"Simo Ahava","publisher":{"@type":"Organization","name":"Simo Ahava's blog","logo":{"@type":"ImageObject","url":"https:\/\/www.simoahava.com\/images\/simo.png","height":"393","width":"407"}},"url":"https:\/\/www.simoahava.com\/gtm-tips\/send-google-analytics-requests-custom-endpoint\/","datePublished":"2020-08-12T07:01:00\u002b03:00","dateModified":"2020-08-12T07:01:00\u002b03:00","description":"Send the requests compiled by the Google Analytics JavaScript library to a custom endpoint rather than the default of google-analytics.com.","author":{"@type":"Person","name":"Simo Ahava"}}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>#GTMTips: Send Google Analytics Requests To Custom Endpoint | Simo Ahava's blog</title>
<script>window.dataLayer=window.dataLayer||[],window.dataLayer.push({pageType:"article",environment:null})</script><script>(function(e,t,n,s){window[n]=window[n]||[],window[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=e.getElementsByTagName(t)[0],o=e.createElement(t),a=n!="dataLayer"?"&l="+n:"";o.async=!0,o.src="https://sgtm.simoahava.com/gtm.js?id="+s+a,i.parentNode.insertBefore(o,i)})(document,"script","dataLayer","GTM-PZ7GMV9")</script><meta name=author content="Simo Ahava"><meta name=keywords content><link rel=icon href=https://www.simoahava.com/images/favicon.ico><link rel=amphtml href=https://www.simoahava.com/amp/gtm-tips/send-google-analytics-requests-custom-endpoint/><meta name=description content="Send the requests compiled by the Google Analytics JavaScript library to a custom endpoint rather than the default of google-analytics.com."><meta property="og:description" content="Send the requests compiled by the Google Analytics JavaScript library to a custom endpoint rather than the default of google-analytics.com."><meta property="og:type" content="blog"><meta property="og:title" content="#GTMTips: Send Google Analytics Requests To Custom Endpoint"><meta property="og:url" content="https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><meta property="og:site_name" content="Simo Ahava's blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="#GTMTips: Send Google Analytics Requests To Custom Endpoint"><meta name=twitter:description content="Send the requests compiled by the Google Analytics JavaScript library to a custom endpoint rather than the default of google-analytics.com."><meta name=twitter:creator content="@SimoAhava"><meta name=twitter:image content="https://www.simoahava.com/images/2020/07/send-google-analytics-request-custom-endpoint.jpg"><meta property="og:image" content="https://www.simoahava.com/images/2020/07/send-google-analytics-request-custom-endpoint.jpg"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/style.css></head><body><div id=_progress></div><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/>Simo Ahava's blog</a></div></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/><img class=sidebar-profile-picture loading=lazy src=https://www.simoahava.com/images/simo.png alt="Author's picture"></a><h4 class=sidebar-profile-name>Simo Ahava</h4><h5 class=sidebar-profile-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/><i class="sidebar-button-icon fa fa-lg fa-home"></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
<span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/gtm-tips/><i class="sidebar-button-icon fa fa-lg fa-magic"></i>
<span class=sidebar-button-desc>GTM Tips</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/about-simo-ahava/><i class="sidebar-button-icon fa fa-lg fa-question"></i>
<span class=sidebar-button-desc>About</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/tools/><i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
<span class=sidebar-button-desc>Tools</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/blog-statistics/><i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
<span class=sidebar-button-desc>Blog statistics</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/sahava target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/upcoming-talks/><i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
<span class=sidebar-button-desc>Upcoming talks</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/custom-templates/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Templates</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/newsletter/><i class="sidebar-button-icon fa fa-lg fa-bell"></i>
<span class=sidebar-button-desc>Newsletter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://masto.measure.chat/@SimoAhava target=_blank rel="noopener me"><i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
<span class=sidebar-button-desc>Mastodon</span></a></li></ul><ul class=sidebar-buttons></ul></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post><form id=search action=/search/><input name=q type=text class="form-control input--xlarge" placeholder="Search blog..." autocomplete=off></form><div class="post-header main-content-wrap text-left"><h1>#GTMTips: Send Google Analytics Requests To Custom Endpoint</h1><div class="postShorten-meta post-meta"><time datetime=2020-08-12T07:01:00+03:00>August 12, 2020
</time><span>in</span>
<a class=category-link href=/categories/gtm-tips>GTM Tips</a>
| <a href=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/#commento><comentario-count path=/gtm-tips/send-google-analytics-requests-custom-endpoint/ placeholder=... error-text="N/A " zero-text="0 " prefix suffix=" "></comentario-count>Comments</a></div></div><div class="post-content markdown"><div class=main-content-wrap><p>When you use <a href=https://analytics.google.com/>Google Analytics</a> on the web, you are most likely implementing one of <a href=https://developers.google.com/analytics/devguides/collection/analyticsjs>analytics.js</a>, the <a href=https://developers.google.com/analytics/devguides/collection/gtagjs>global site tag (gtag.js)</a>, or Universal Analytics tags via <a href=https://tagmanager.google.com/>Google Tag Manager</a>.</p><p>These libraries all end up doing the same thing: compiling a payload-rich HTTP request to an endpoint at <code>https://www.google-analytics.com</code>.</p><p>What if you want to have the JavaScript libraries do their job, but instead of sending the data to Google&rsquo;s servers, you send them to a new, custom endpoint?</p><p>Perhaps you&rsquo;re already using Google Tag Manager&rsquo;s new <a href=/analytics/server-side-tagging-google-tag-manager/><strong>Server-side tagging</strong></a> setup, and you want to redirect your site&rsquo;s Universal Analytics data collection through your new server-side proxy?</p><p>Or maybe you&rsquo;re using <a href=https://snowplowanalytics.com/>Snowplow Analytics</a>, and you want to leverage its capacity to <a href=/analytics/automatically-fork-google-analytics-hits-snowplow/>digest Google Analytics payloads</a> as well.</p><p>A recent update to <strong>gtag.js</strong> and <strong>Google Tag Manager</strong> has made it much easier to redirect the payload. In this <a href=/categories/gtm-tips/>#GTMTips</a> article, we&rsquo;ll take a look at this new field and how it works.</p><span class=simmer><span class=close>X</span><p><span class="fa fa-md fa-bell"></span>
<strong>The Simmer Newsletter</strong></p><p>Subscribe to the <a href=/newsletter/>Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!</p></span><h2 id=tip-116-redirect-the-google-analytics-payload-to-a-custom-endpoint>Tip 116: Redirect the Google Analytics payload to a custom endpoint</h2><div style=aspect-ratio:960/540 class="figure nocaption"><a href=/images/2020/07/send-google-analytics-request-custom-endpoint.jpg title="Send Google Analytics payload to custom endpoint"><img class=fig-img height=540 width=960 loading=lazy src=/images/2020/07/send-google-analytics-request-custom-endpoint.jpg#ZgotmplZ alt="Send Google Analytics payload to custom endpoint"></a></div><p>Within Google Tag Manager, the <strong>Universal Analytics</strong> template as well as the <a href=/analytics/google-analytics-settings-variable-in-gtm/><strong>Google Analytics Settings variable</strong></a> have a new setting under <strong>Advanced Configuration</strong>.</p><p>The <strong>Set Transport URL</strong> setting expands a text field to which you can now type a <strong>base URL</strong> string.</p><div style=aspect-ratio:1222/842 class="figure nocaption"><a href=/images/2020/07/set-transport-url.jpg title="Set Transport URL"><img class=fig-img height=842 width=1222 loading=lazy src=/images/2020/07/set-transport-url.jpg#ZgotmplZ alt="Set Transport URL"></a></div><p>A valid <strong>base URL</strong> is a URL string that begins with <code>http://</code> or <code>https://</code> and does <em>not</em> end with <code>/</code>.</p><p>Typically, you&rsquo;d just have a base hostname here, assuming your collector domain is housed on a subdomain mapped specifically for collecting the data. An example would be this:</p><p><code>https://collector.simoahava.com</code></p><p>It&rsquo;s possible to have the tracker embedded in a path as well, so this would be just as fine as a base URL:</p><p><code>https://www.simoahava.com/collector</code></p><p>However you build it, the payload will be sent to the <strong>base URL</strong> + <code>/collect</code>. A request might thus look like this:</p><p><code>https://collector.simoahava.com/collect?v=1&amp;t=pageview&amp;tid=UA-12345-1...</code></p><p>Occasionally, if you have <a href="https://support.google.com/analytics/answer/2444872?hl=en&amp;ref_topic=3413645">advertising features enabled</a>, the endpoint can be <strong>base URL</strong> + <code>/r/collect</code>. In some cases the endpoint can also be <strong>base URL</strong> + <code>/j/collect</code>, so you need to configure your server or service to account for these when configuring the collector APIs.</p><blockquote><p><strong>NOTE!</strong> In a Server container, the <a href=https://developers.google.com/tag-manager/serverside/api#extracteventsfrommpv1><code>extractEventsFromMpv1</code></a> API automatically intercepts all possible path variations of <code>/collect</code>, so you don&rsquo;t have to manually configure anything if building your own custom server-side tagging Client.</p></blockquote><h3 id=gtagjs>gtag.js</h3><p>The <strong>gtag.js</strong> library also supports this feature.</p><p>In gtag.js, the field is named <code>transport_url</code>, and it&rsquo;s set in the tracker configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>gtag(<span style=color:#a50>&#39;config&#39;</span>, <span style=color:#a50>&#39;&lt;MEASUREMENT_ID&gt;&#39;</span>, {
</span></span><span style=display:flex><span>  transport_url: <span style=color:#a50>&#39;https://collector.simoahava.com&#39;</span>
</span></span><span style=display:flex><span>});</span></span></code></pre></div><p>All hits that utilize this tracker will now send their payloads to <code>https://collector.simoahava.com</code> instead of the endpoint represented by the <code>MEASUREMENT_ID</code>.</p><h3 id=analyticsjs>analytics.js</h3><p>If you have an inline <strong>analytics.js</strong> implementation, there is a field named <code>transportUrl</code> that you <em>could</em> use for this purpose:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>ga(<span style=color:#a50>&#39;create&#39;</span>, <span style=color:#a50>&#39;UA-12345-1&#39;</span>, {name: <span style=color:#a50>&#39;ss&#39;</span>, transportUrl: <span style=color:#a50>&#39;https://collector.simoahava.com&#39;</span>});</span></span></code></pre></div><p>However, this is a bit of a relic and doesn&rsquo;t have official support going forward. The <code>transportUrl</code> field doesn&rsquo;t, for example, process the custom paths (<code>/r/</code>, <code>/j/</code>) correctly, which might lead to issues when working with ad integrations in your server-side endpoint.</p><p>There&rsquo;s no official word if analytics.js will ever be patched to have feature parity with <code>transportUrl</code>, so your best option right now is to use either <strong>gtag.js</strong> or <strong>Google Tag Manager</strong>.</p><h2 id=summary>Summary</h2><p>With the introduction of <a href=/analytics/server-side-tagging-google-tag-manager/><strong>Server-side tagging</strong></a> in Google Tag Manager, having a way to redirect the Google Analytics call away from the GA servers to your own custom endpoint is a necessity. That&rsquo;s why the Transport URL feature was released, and it should help a great deal in building your own event stream to your server-side container.</p><p>However, Universal Analytics has been around for so long that the payload format (<a href=https://developers.google.com/analytics/devguides/collection/protocol/v1>Measurement Protocol</a>) it uses has been baked into countless analytics pipelines. It&rsquo;s such a familiar schema that if I were to create a custom pipeline for analytics data collection, I would definitely include a processor for the Measurement Protocol format.</p><p>This setting should prove valuable to anyone working with a server-side tagging setup, where hits are proxied through a Google Tag Manager Server container rather than sent directly to Google&rsquo;s servers. Or, perhaps you&rsquo;ve built something that integrates the GA payload <a href=https://medium.com/datadriveninvestor/how-to-avoid-sampling-and-collect-complete-data-for-advanced-analytics-7bf0521c50fe>directly into BigQuery</a>, or maybe you&rsquo;re using
<a href=https://snowplowanalytics.com>Snowplow Analytics</a>; regardless, this feature will make life a bit easier for you, in case you want to delegate the JavaScript tracker functionality to Google&rsquo;s own libraries.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/google-tag-manager/>google tag manager</a>
<a class="tag tag--primary tag--small" href=/tags/server-side-tagging/>server-side tagging</a>
<a class="tag tag--primary tag--small" href=/tags/gtmtips/>gtmtips</a>
<a class="tag tag--primary tag--small" href=/tags/app+web/>app+web</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/build-custom-universal-analytics-client-server-side-tagging/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/server-side-tagging-google-tag-manager/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Google%20Analytics%20Requests%20To%20Custom%20Endpoint%20https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div><a name=commento></a><comentario-comments></comentario-comments></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2026 Simo Ahava. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/build-custom-universal-analytics-client-server-side-tagging/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/server-side-tagging-google-tag-manager/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Google%20Analytics%20Requests%20To%20Custom%20Endpoint%20https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Google%20Analytics%20Requests%20To%20Custom%20Endpoint%20https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/send-google-analytics-requests-custom-endpoint/"><i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src=https://www.simoahava.com/images/simo.png alt="Author's picture"><h4 id=about-card-name>Simo Ahava</h4><div id=about-card-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Senior Data Advocate at Reaktor</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Finland</div></div></div><div id=cover style=background-image:url(https://www.simoahava.com/images/maisema.jpg)></div><script defer src=https://comentario.simoahava.com/comentario.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous referrerpolicy=no-referrer></script><script defer src=/js/script.js></script><script>!function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),n=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");e&&(n&&(e.style.display="none"),t&&t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"}))}()</script></body></html>