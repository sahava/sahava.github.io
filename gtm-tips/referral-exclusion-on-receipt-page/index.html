<!doctype html><html lang=en-us><head><meta name=google-site-verification content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"#GTMTips: Referral Exclusion On Receipt Page | Simo Ahava's blog","image":"https:\/\/www.simoahava.com\/images\/2015\/11\/exclude-referrals-receipt-page.jpg","editor":"Simo Ahava","publisher":{"@type":"Organization","name":"Simo Ahava's blog","logo":{"@type":"ImageObject","url":"https:\/\/www.simoahava.com\/images\/simo.png","height":"393","width":"407"}},"url":"https:\/\/www.simoahava.com\/gtm-tips\/referral-exclusion-on-receipt-page\/","datePublished":"2015-11-19T07:27:02\u002b00:00","dateModified":"2015-11-19T07:27:02\u002b00:00","description":"Here\u0027s an easy way to block all those pesky payment portals from messing up your Google Analytics data. Set all referral hits to null on the receipt page of your site.","author":{"@type":"Person","name":"Simo Ahava"}}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>#GTMTips: Referral Exclusion On Receipt Page | Simo Ahava's blog</title>
<script>window.dataLayer=window.dataLayer||[],window.dataLayer.push({pageType:"article",environment:null})</script><script>(function(e,t,n,s){window[n]=window[n]||[],window[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=e.getElementsByTagName(t)[0],o=e.createElement(t),a=n!="dataLayer"?"&l="+n:"";o.async=!0,o.src="https://sgtm.simoahava.com/gtm.js?id="+s+a,i.parentNode.insertBefore(o,i)})(document,"script","dataLayer","GTM-PZ7GMV9")</script><meta name=author content="Simo Ahava"><meta name=keywords content><link rel=icon href=https://www.simoahava.com/images/favicon.ico><link rel=amphtml href=https://www.simoahava.com/amp/gtm-tips/referral-exclusion-on-receipt-page/><meta name=description content="Here's an easy way to block all those pesky payment portals from messing up your Google Analytics data. Set all referral hits to null on the receipt page of your site."><meta property="og:description" content="Here's an easy way to block all those pesky payment portals from messing up your Google Analytics data. Set all referral hits to null on the receipt page of your site."><meta property="og:type" content="blog"><meta property="og:title" content="#GTMTips: Referral Exclusion On Receipt Page"><meta property="og:url" content="https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><meta property="og:site_name" content="Simo Ahava's blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="#GTMTips: Referral Exclusion On Receipt Page"><meta name=twitter:description content="Here's an easy way to block all those pesky payment portals from messing up your Google Analytics data. Set all referral hits to null on the receipt page of your site."><meta name=twitter:creator content="@SimoAhava"><meta name=twitter:image content="https://www.simoahava.com/images/2015/11/exclude-referrals-receipt-page.jpg"><meta property="og:image" content="https://www.simoahava.com/images/2015/11/exclude-referrals-receipt-page.jpg"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/style.css></head><body><div id=_progress></div><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/>Simo Ahava's blog</a></div></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/><img class=sidebar-profile-picture loading=lazy src=https://www.simoahava.com/images/simo.png alt="Author's picture"></a><h4 class=sidebar-profile-name>Simo Ahava</h4><h5 class=sidebar-profile-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/><i class="sidebar-button-icon fa fa-lg fa-home"></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
<span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/gtm-tips/><i class="sidebar-button-icon fa fa-lg fa-magic"></i>
<span class=sidebar-button-desc>GTM Tips</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/about-simo-ahava/><i class="sidebar-button-icon fa fa-lg fa-question"></i>
<span class=sidebar-button-desc>About</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/tools/><i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
<span class=sidebar-button-desc>Tools</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/blog-statistics/><i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
<span class=sidebar-button-desc>Blog statistics</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/sahava target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/upcoming-talks/><i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
<span class=sidebar-button-desc>Upcoming talks</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/custom-templates/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Templates</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/newsletter/><i class="sidebar-button-icon fa fa-lg fa-bell"></i>
<span class=sidebar-button-desc>Newsletter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://masto.measure.chat/@SimoAhava target=_blank rel="noopener me"><i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
<span class=sidebar-button-desc>Mastodon</span></a></li></ul><ul class=sidebar-buttons></ul></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post><form id=search action=/search/><input name=q type=text class="form-control input--xlarge" placeholder="Search blog..." autocomplete=off></form><div class="post-header main-content-wrap text-left"><h1>#GTMTips: Referral Exclusion On Receipt Page</h1><div class="postShorten-meta post-meta"><time datetime=2015-11-19T07:27:02Z>November 19, 2015
</time><span>in</span>
<a class=category-link href=/categories/gtm-tips>GTM tips</a>
| <a href=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/#commento><comentario-count path=/gtm-tips/referral-exclusion-on-receipt-page/ placeholder=... error-text="N/A " zero-text="0 " prefix suffix=" "></comentario-count>Comments</a></div></div><div class="post-content markdown"><div class=main-content-wrap><p>You might have noticed that the <a href="https://support.google.com/analytics/answer/2795830?hl=en">Referral Exclusion List</a> in <a href=https://analytics.google.com/>Google Analytics</a> is difficult to maintain. You can&rsquo;t copy a list from one property to another, the list is a wildcard match for domain names (so all subdomains are automatically excluded), and it&rsquo;s just about the clunkiest user interface we&rsquo;ve seen since ERP tools from the 1990s. A while ago, I <a href=/gtm-tips/implement-referral-exclusions-via-gtm/>wrote of a solution</a> which lets you manage referral exclusions using <a href=https://tagmanager.google.com>Google Tag Manager</a>, and it&rsquo;s still a neat trick, as it&rsquo;s way more flexible than said clunky UI.</p><p>However, it&rsquo;s still an <em>a priori</em> setup. You need to <strong>know</strong> what referrals are coming in. Also, if you have hundreds of referrals that you want to exclude, it&rsquo;s still a headache. With Ecommerce payment gateway referrals, it&rsquo;s very common to have a huge amount of domains you didn&rsquo;t even know to exist polluting your session data.</p><p>In this tip, I&rsquo;ll show you a simple and elegant way to make sure that nothing interferes with correct attribution on your Ecommerce receipt page.</p><span class=simmer><span class=close>X</span><p><span class="fa fa-md fa-bell"></span>
<strong>The Simmer Newsletter</strong></p><p>Subscribe to the <a href=/newsletter/>Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!</p></span><h2 id=tip-34-exclude-all-referrals-on-your-receipt-page>Tip 34: Exclude all referrals on your receipt page</h2><div style=aspect-ratio:960/540 class="figure nocaption"><a href=/images/2015/11/exclude-referrals-receipt-page.jpg title="Exclude referrals on receipt page"><img class=fig-img height=540 width=960 loading=lazy src=/images/2015/11/exclude-referrals-receipt-page.jpg#ZgotmplZ alt="Exclude referrals on receipt page"></a></div><p>That&rsquo;s right! We&rsquo;re going to brutally exclude <strong>all</strong> referrals on the receipt page. No matter where you come from, you will not be counted as a referral, and thanks to Google Analytics&rsquo; last non-direct source attribution, your pre-payment-gateway-session will stay intact.</p><p>&ldquo;Exclude all referrals? Regardless of where they come from?&rdquo; I hear you whisper in fear. Speculations about me finally losing my mind along with my hair are flying to and fro like suicidal swans.</p><p>I&rsquo;m serious! Think of a scenario where a <em>referral</em> to your <em>receipt page</em> is significant. You&rsquo;re not going to be sending campaign traffic to that page. You&rsquo;re not going to want to see it in Google&rsquo;s search index. Unless you&rsquo;re the worst SEO manager in the world, you&rsquo;re not going to want to build links to that page. So we don&rsquo;t <em>care</em> about referrals to the receipt page. The hypothesis is that whenever someone lands on the receipt page, it&rsquo;s <em>always</em> as part of your checkout funnel.</p><p>I know, <em>always</em> is not something you should articulate outside of singing Bon Jovi at the local karaoke bar. But in this case it&rsquo;s worth the risk. The only reason you might want to see referral data on the receipt page is to debug some issue with your checkout funnel. But, my friends, there are better tools than Google Analytics&rsquo; session attribution to do that. If you&rsquo;re really concerned, you can always send the referrer as a Custom Dimension.</p><p>Anyway, to get things working, you need to do two things: create a <strong>Custom JavaScript Variable</strong> and modify the <strong>Tags</strong> which fire on the receipt page. Let&rsquo;s start with the first one.</p><p>Create a new Custom JavaScript Variable, and name it <strong>{{JS - Null referrer on thank you page}}</strong> or whatever suits your fancy. Next, populate it with the following code:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#00a>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#00a>return</span> {{Page Path}}.indexOf(<span style=color:#a50>&#39;/thank-you-page/&#39;</span>) &gt; -<span style=color:#099>1</span> ? <span style=color:#00a>null</span> : <span style=color:#0aa>document</span>.referrer;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>I&rsquo;m aware that this is different than the code in the image above. I&rsquo;m dark, mysterious, and unpredictable that way! (Both work just fine).</p><p>The key thing is to change the string in the <code>indexOf</code> method to match the path (or part of path) of your receipt page. It&rsquo;s case sensitive, so if you&rsquo;re one of the 3 people who think that URLs that are something else than all lowercase are cool, make sure you include the case in the check.</p><p>Once you&rsquo;ve created the Variable, head on over to your Universal Analytics Tags which fire on the receipt page. That&rsquo;s right, you&rsquo;ll need to edit <em>all</em> of them, because even a single Tag which gets through with incorrect referrer information will start a new session. In the Tag settings, browse down to <strong>Fields to Set</strong>, and add a new field with this setup:</p><p>Field Name: <strong>referrer</strong><br>Value: <strong>{{JS - Null referrer on thank you page}}</strong></p><div style=aspect-ratio:818/268 class="figure nocaption"><a href=/images/2015/11/field-to-set.jpg title="Field to set page view tag"><img class=fig-img height=268 width=818 loading=lazy src=/images/2015/11/field-to-set.jpg#ZgotmplZ alt="Field to set page view tag"></a></div><p>And now you&rsquo;re all set! When you run this setup, whenever the user lands on /thank-you-page/, all hits to GA are sent without a referrer.</p><p><em>Thanks to Michael] for bringing up the point of editing all the Tags on the page, not just the Page View Tag.</em></p><p>Simple, elegant, and quick.</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/ecommerce/>ecommerce</a>
<a class="tag tag--primary tag--small" href=/tags/google-tag-manager/>Google Tag Manager</a>
<a class="tag tag--primary tag--small" href=/tags/gtmtips/>gtmtips</a>
<a class="tag tag--primary tag--small" href=/tags/guide/>Guide</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/useful-gtm-for-ios-tips/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/better-qa-with-google-tag-manager-environments/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Referral%20Exclusion%20On%20Receipt%20Page%20https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div><a name=commento></a><comentario-comments></comentario-comments></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2026 Simo Ahava. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/useful-gtm-for-ios-tips/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/better-qa-with-google-tag-manager-environments/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Referral%20Exclusion%20On%20Receipt%20Page%20https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Referral%20Exclusion%20On%20Receipt%20Page%20https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/referral-exclusion-on-receipt-page/"><i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src=https://www.simoahava.com/images/simo.png alt="Author's picture"><h4 id=about-card-name>Simo Ahava</h4><div id=about-card-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Senior Data Advocate at Reaktor</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Finland</div></div></div><div id=cover style=background-image:url(https://www.simoahava.com/images/maisema.jpg)></div><script defer src=https://comentario.simoahava.com/comentario.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous referrerpolicy=no-referrer></script><script defer src=/js/script.js></script><script>!function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),n=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");e&&(n&&(e.style.display="none"),t&&t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"}))}()</script></body></html>