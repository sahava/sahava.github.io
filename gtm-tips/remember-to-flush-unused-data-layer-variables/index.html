

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <script>
      function gtag() { window.dataLayer = window.dataLayer || []; window.dataLayer.push(arguments); }
      gtag('event', 'optimize.callback', {
	    callback: function(e) {
	      window.dataLayer = window.dataLayer || [];
          window.dataLayer.push({
		    event: 'optimize.experimentLoaded',
            experimentTime: new Date().getTime()
	      });
	    }
      });
    </script>
    <script async src="https://www.googleoptimize.com/optimize.js?id=GTM-NGM64B"></script>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "#GTMTips: Remember To Flush Unused Data Layer Variables | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2015\/06\/flush-unused-datalayer-variables.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/gtm-tips\/remember-to-flush-unused-data-layer-variables\/",
  "datePublished": "2015-06-30T15:36:59\x2b00:00",
  "dateModified": "2015-06-30T15:36:59\x2b00:00",
  "description": "Remember to set unused variables in generic dataLayer pushes to undefined when they are not used. This way the values will not \x22leak\x22 from hit to hit.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>#GTMTips: Remember To Flush Unused Data Layer Variables | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/gtm-tips/remember-to-flush-unused-data-layer-variables/">
    
    <meta name="description" content="Remember to set unused variables in generic dataLayer pushes to undefined when they are not used. This way the values will not &#34;leak&#34; from hit to hit.">
    <meta property="og:description" content="Remember to set unused variables in generic dataLayer pushes to undefined when they are not used. This way the values will not &#34;leak&#34; from hit to hit.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="#GTMTips: Remember To Flush Unused Data Layer Variables">
    <meta property="og:url" content="https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="#GTMTips: Remember To Flush Unused Data Layer Variables">
    <meta name="twitter:description" content="Remember to set unused variables in generic dataLayer pushes to undefined when they are not used. This way the values will not &#34;leak&#34; from hit to hit.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2015/06/flush-unused-datalayer-variables.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2015/06/flush-unused-datalayer-variables.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      #GTMTips: Remember To Flush Unused Data Layer Variables
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2015-06-30T15:36:59Z">
        
  June 30, 2015

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM tips</a>
    
  


       | <a href="https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/#commento">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Here's a tip that's especially important to anyone working with a single-page application. <a href="https://tagmanager.google.com">Google Tag Manager</a> <em>persists</em> items in its <a href="https://www.simoahava.com/analytics/google-tag-manager-data-model/">data model</a> until you either manually delete the variable and/or its value from the data model, or until the user browses away from the page. There's nothing as annoying as the example in the image below, where a value that was set for an earlier Tag is resent with a new Tag, even though the purpose was to leave it out.</p>
<h2 id="tip-26-flush-unused-data-layer-variables">Tip 26: Flush unused Data Layer Variables</h2>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/06/flush-unused-datalayer-variables.jpg" title="Remember to flush unused data layer variables">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/06/flush-unused-datalayer-variables.jpg#ZgotmplZ" alt="Remember to flush unused data layer variables">
  
    </a>
  
  
</div>


<p>Let's extend the example in the image above. Say you have a Google Analytics Event Tag, which fires on the <code>makeMoney</code> Custom Event Trigger, and has the following Tag settings:</p>
<p><strong>Event Category:</strong> Make Money<br>
<strong>Event Action:</strong> {{DLV - userId}}<br>
<strong>Event Label:</strong> {{DLV - criminalStatus}}<br>
<strong>Event Value:</strong> {{DLV - howMuch}}</p>
<p>As you can see, the naming convention I use for the Variables is pretty self-explanatory. It's just the variable name in the Data Layer prefixed by &ldquo;DLV - &ldquo;.</p>
<p>So, this Tag fires when the first payload is pushed. It gets the following values:</p>
<p><strong>Event Category:</strong> Make Money<br>
<strong>Event Action:</strong> abcb-1234<br>
<strong>Event Label:</strong> true<br>
<strong>Event Value:</strong> 10000</p>
<p>This Event signifies that a user with ID &ldquo;abcb-1234&rdquo; has scored 10000 dollars in a nefarious scheme, and this event is thus labelled as a criminal act. I will send this information to the proper authorities, after first taking my cut.</p>
<p>Next, the same person, on the same page, decides to make amends and scores a far more appropriate amount of cash in this cyber-scam:</p>
<p><strong>Event Category:</strong> Make Money<br>
<strong>Event Action:</strong> ddff-2211<br>
<strong>Event Label:</strong> true<br>
<strong>Event Value:</strong> 2000</p>
<p>But what's that? Criminal status is still <strong>true</strong>?! But you left it out of the <code>dataLayer.push()</code>, why would it still be there? Shouldn't it be empty? Is there no way for this vigilante to escape the searchlights of the police helicopter patrolling the abandoned brick factory?</p>
<p>You see, because there was no reload, the value of the <code>criminalStatus</code> variable in GTM's data model remains <strong>true</strong> until overwritten, or until a page (re)load is executed.</p>
<p>This is why the following bit is important. Whenever you push a payload to <code>dataLayer</code> that makes a Tag Trigger, make sure you've accounted for <strong>any other Data Layer Variables the Tag might use</strong>. In the example we've used until now, if you want to make sure that <code>criminalStatus</code> is flushed for the second push, you would use the following syntax in the push:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">dataLayer.push({
  <span style="color:#a50">&#39;event&#39;</span> : <span style="color:#a50">&#39;makeMoney&#39;</span>,
  <span style="color:#a50">&#39;howMuch&#39;</span> : <span style="color:#a50">&#39;2000&#39;</span>,
  <span style="color:#a50">&#39;userId&#39;</span> : <span style="color:#a50">&#39;ddff-2211&#39;</span>,
  <span style="color:#a50">&#39;criminalStatus&#39;</span> : <span style="color:#00a">undefined</span>
});
</code></pre></div>
<p>This stores the value <code>undefined</code> for the variable <code>criminalStatus</code>, effectively making it so that the variable does not resolve, dropping the parameter from the Google Analytics hit entirely.</p>
<p>So remember to flush those unused variables!</p>
<p>One other thing. You might be concerned that when using <strong>Enhanced Ecommerce</strong>, this means that your impressions (which you send with the Page View Tag, right?) will be sent with every single other Enhanced Ecommerce hit on the page as well. Worry not! Enhanced Ecommerce is special. It leverages an older version of GTM's data model, where objects are not merged together. With <a href="https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">Enhanced Ecommerce</a>, only the most recent hit is ever processed by your Tags.</p>
<p>That's it. Go enjoy the summer!</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/data-layer/">data layer</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/gtmtips/">gtmtips</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cross-domain-tracking-across-subdomains/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/remove-email-addresses-from-url-parameters/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Remember%20To%20Flush%20Unused%20Data%20Layer%20Variables%20https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://cdn.commento.io/js/commento.js"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cross-domain-tracking-across-subdomains/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/remove-email-addresses-from-url-parameters/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Remember%20To%20Flush%20Unused%20Data%20Layer%20Variables%20https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Remember%20To%20Flush%20Unused%20Data%20Layer%20Variables%20https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/gtm-tips/remember-to-flush-unused-data-layer-variables/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://cdn.commento.io/js/count.js"></script>


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

