

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Macro Magic For Google Tag Manager | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2014\/03\/measurecamp.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/macro-magic-google-tag-manager\/",
  "datePublished": "2014-03-29T08:00:35\x2b00:00",
  "dateModified": "2014-03-29T08:00:35\x2b00:00",
  "description": "A bunch of Google Tag Manager macros that you might find useful when working with GTM.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.59.1 with theme Tranquilpeak 0.4.3-BETA">
    <title>Macro Magic For Google Tag Manager | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/macro-magic-google-tag-manager/">
    
    <meta name="description" content="A bunch of Google Tag Manager macros that you might find useful when working with GTM.">
    <meta property="og:description" content="A bunch of Google Tag Manager macros that you might find useful when working with GTM.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Macro Magic For Google Tag Manager">
    <meta property="og:url" content="/analytics/macro-magic-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Macro Magic For Google Tag Manager">
    <meta name="twitter:description" content="A bunch of Google Tag Manager macros that you might find useful when working with GTM.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2014/03/measurecamp.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2014/03/measurecamp.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      Macro Magic For Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2014-03-29T08:00:35Z">
        
  March 29, 2014

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/macro-magic-google-tag-manager/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              

<p>(Last updated June 2014) This post is an attempt at a whole new level of interaction. These words will transcend the barriers of time and space, bridging together the physical world and its digital counterpart. You see, in an undisclosed number of hours after the publishing of this blog post, I will be talking at the <a href="http://www.measurecamp.org">MeasureCamp</a> unconference on this very subject. Or, I hope I will. The whole unconference thing is somewhat confusing, and it involves lighting-fast reflexes and street smarts for slot selection; traits which I sadly lack.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/measurecamp.jpg" title="Simo at MeasureCamp">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/measurecamp.jpg#ZgotmplZ" alt="Simo at MeasureCamp">
  
    </a>
  
  
</div>



<p>However, if you DO see me speak at MeasureCamp, this post is meant as a companion to that talk. And if you do not (or did not, this transcendental approach is really confusing), perhaps this post will inspire you with some ideas for your own day-to-day <a href="http://www.google.com/tagmanager">Google Tag Manager</a> use.</p>

<p>In this post, my fair friends, I&rsquo;ve outlined a number of cool ways in which you can use macros to make your data collection woes a thing of the past. If you don&rsquo;t know what macros are or how they operate, be sure to check my <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/">macro guide</a>. Almost all of my Google Tag Manager posts in this blog revolve around macros in one way or another, so while you&rsquo;re at it, check out some of my <a href="https://www.simoahava.com/tags/google-tag-manager/">other GTM articles</a> as well. And sorry for this shameless self-promotion, I can&rsquo;t help it.</p>

<h2 id="introducing-macro-magic">Introducing Macro Magic</h2>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/macro-magic.jpg" title="Macro Magic in Google Tag Manager">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/macro-magic.jpg#ZgotmplZ" alt="Macro Magic in Google Tag Manager">
  
    </a>
  
  
</div>



<p>So what is Macro Magic? Well, to put it simply, it&rsquo;s what follows when you accept that macros, not tags, are what make GTM the time- and effort-saver that it is. Sometimes macros make your tag setups a lot sleeker and leaner, since the flexibility that they introduce to tags greatly reduces the need to capture every single variation of tracking in its own, unique tag. Sometimes they open doors to data collection methods you didn&rsquo;t think were possible with traditional, on-page tracking. And sometimes they&rsquo;re just little helper functions, which make operating GTM so much easier.</p>

<p>The examples below fall into these categories nicely, and I&rsquo;m sure there&rsquo;s something for everyone.</p>

<p>By the way, I am really, <strong>really</strong> looking forward to a Google Tag Manager which is accompanied by a resource library similar to <a href="https://www.google.com/analytics/gallery/">Google Analytics&rsquo; solution gallery</a>. Just imagine how cool it would be to have a library of tags and macros you can just download and insert into your container? Well, as long as it&rsquo;s just a utopian dream of mine, posts like this will probably be in demand.</p>

<p>Note that not all of these are my own inventions. It would be ridiculous to claim intellectual property for some of the macros, but where prudent, I&rsquo;ve added a link to the source of the macro. If you feel like I&rsquo;ve stolen your ideas, please let me know and I&rsquo;ll see if I can pass credit where it is due.</p>

<h2 id="1-client-time">1. Client time</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Use for</strong>: To get local time of <em>client</em> as opposed to the the time of the web server hosting the site.<br />
<strong>Example return value</strong>: 11</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create new Custom JavaScript Macro</p></li>

<li><p>Add the following code:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">now</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">now</span>.<span style="color:#a6e22e">getHours</span>();
}
</code></pre></div>

<p>Well it&rsquo;s easy to credit where I got the idea for this one. Google uses a version of this as an example of the Custom JavaScript Macro:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/client-time.jpg" title="Client time in JavaScript">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/client-time.jpg#ZgotmplZ" alt="Client time in JavaScript">
  
    </a>
  
  
</div>



<p>The idea behind this macro is that it returns the time (hours) of <em>the client</em> as opposed to the time of the website (i.e. server), which is what&rsquo;s measured by default.</p>

<p>So if you&rsquo;re interested in what the local time (in hours) is of the visitor, use this macro and store it as a custom dimension, for example.</p>

<h2 id="2-random-number-for-sampling">2. Random number for sampling</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#13-random-number">Random Number</a><br />
<strong>Use for</strong>: To fire a tag only for every 10th visitor, for example<br />
<strong>Example return value</strong>: 647156</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li>Create Random Number Macro</li>
</ol>

<p>OK, so the macro isn&rsquo;t difficult at all to create, nor is it anything magical (YET!). But this is a beautiful scenario for something as simple as the Random Number macro (which, I&rsquo;m sure, is often very neglected). This idea comes directly from Dan Russell, and you can read about this in his original blog post</p>

<p><a href="http://dan-russell.com/2013/03/sampling-a-percentage-of-your-users-with-google-tag-manager/">Sampling a percentage of your users with Google Tag Manager</a>.</p>

<p>The sweetness is not in the macro but in the rule which you&rsquo;ll use to fire your tags. If you want to fire a tag for every 10th visitor, you&rsquo;d add a rule with the following condition:</p>

<p><strong>{{Random Number Macro}} ends with 3</strong></p>

<p>If you want to fire a tag for every 100th visitor, you&rsquo;d edit the rule so that it&rsquo;s:</p>

<p><strong>{{Random Number Macro}} ends with 01</strong></p>

<p>It&rsquo;s so simple and beautiful. Because the Random Number macro returns a random number, you can assume that there&rsquo;s roughly a <sup>1</sup>&frasl;<sub>10</sub> chance that the number will end in 3, and roughly a <sup>1</sup>&frasl;<sub>100</sub> chance that it will end in 01.</p>

<p>How&rsquo;s that for pre-sampling your data before Google Analytics gets to work on it with its <a href="https://plus.google.com/100296234920140190649/posts/UAKPqCdpLE7">brutal thresholds</a>?</p>

<h2 id="3-return-file-extension-of-clicked-link">3. Return file extension of clicked link</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Other requirements</strong>: Macro for <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#2-auto-event-variable">Auto-Event Variable</a> of type Element (named {{element}} in this example)<br />
<strong>Use for</strong>: Rules, event fields<br />
<strong>Example return value</strong>: pdf</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript Macro</p></li>

<li><p>Add following code:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ext</span> <span style="color:#f92672">=</span> {{<span style="color:#a6e22e">element</span>}}.<span style="color:#a6e22e">pathname</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;.&#34;</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ext</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">?</span><span style="color:#a6e22e">ext</span>.<span style="color:#a6e22e">pop</span>()<span style="color:#f92672">:</span><span style="color:#e6db74">&#39;html&#39;</span>;
}
</code></pre></div>

<p>This macro came from Stéphane Hamel, in another inspiring, &ldquo;crowd-sourced&rdquo; <a href="https://plus.google.com/109635181158374226872/posts/AuVjXieWx7J">Google+ discussion</a>. The idea is that when a Link Click Listener is activated, this macro will return the file extension of the clicked link, and if one doesn&rsquo;t exist, it returns just <strong>html</strong>. So if the link was to <code>http://www.mydomain.com/brochure.pdf</code>, this macro will return <strong>pdf</strong>.</p>

<p>You can use this in your tags either as a rule or as a value for a specific field. For example, here&rsquo;s an event tag which sends the extension of the clicked link as one of the parameters:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/event-filetype.jpg" title="Filetype in Event tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/event-filetype.jpg#ZgotmplZ" alt="Filetype in Event tag">
  
    </a>
  
  
</div>



<p>If the link were to <a href="http://www.mydomain.com/brochure.pdf">http://www.mydomain.com/brochure.pdf</a>, this tag would fire with:</p>

<p>Event Category &ldquo;pdf link click&rdquo;<br />
Event Action &ldquo;brochure.pdf&rdquo; (more on this in the next chapter)<br />
Event Label &ldquo;<em>url of page where brochure.pdf was downloaded from</em>&ldquo;</p>

<h2 id="4-return-file-name-of-clicked-link">4. Return file name of clicked link</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a>
<strong>Other requirements</strong>: Macro for <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#2-auto-event-variable">Auto-Event Variable</a> of type Element (named {{element}} in this example)<br />
<strong>Use for</strong>: Event fields<br />
<strong>Example return value</strong>: brochure.pdf</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript Macro</p></li>

<li><p>Add following code:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">filepath</span> <span style="color:#f92672">=</span> {{<span style="color:#a6e22e">element</span>}}.<span style="color:#a6e22e">pathname</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>);
  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">filename</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">filepath</span>.<span style="color:#a6e22e">pop</span>();
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">filename</span>.<span style="color:#a6e22e">indexOf</span>(<span style="color:#e6db74">&#34;.&#34;</span>) <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">?</span><span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;n/a&#39;</span>;
}
</code></pre></div>

<p>This macro is very similar to the previous one, except now it returns the whole file name. If the downloaded link is not an asset with a file extension, the script returns the ambiguous &ldquo;n/a&rdquo; string, which can be used in blocking rules, for example.</p>

<p>Use this macro to make your link click event tags more dynamic. In the best case scenario, you&rsquo;ll just need one event tag for all your link clicks, because variable value macros like this are what make your tags the dynamic vessels they should be.</p>

<h2 id="5-check-if-clicked-link-is-internal">5. Check if clicked link is internal</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Other requirements</strong>: Macro for <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#2-auto-event-variable">Auto-Event Variable</a> of type Element URL (named {{element url}} in this example), macro for <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#14-url">URL</a> of type URL Hostname (named {{url hostname}} in this example)<br />
<strong>Use for</strong>: Firing rules<br />
<strong>Example return value</strong>: true</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript macro</p></li>

<li><p>Add following code within:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">return</span> {{<span style="color:#a6e22e">element</span> <span style="color:#a6e22e">url</span>}}.<span style="color:#a6e22e">indexOf</span>({{<span style="color:#a6e22e">url</span> <span style="color:#a6e22e">hostname</span>}}) <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
}
</code></pre></div>

<p>This returns <strong>true</strong> if the clicked element URL contains the hostname of the current page, and <strong>false</strong>, if the clicked element URL contains some other hostname.</p>

<p>You can use this in your firing rules, e.g. fire an &ldquo;Outbound link&rdquo; event only when the clicked link is not internal:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/outbound-link.jpg" title="Outbound link rule">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/outbound-link.jpg#ZgotmplZ" alt="Outbound link rule">
  
    </a>
  
  
</div>



<h2 id="6-get-clientid-using-ga-cookie">6. Get clientID using _ga cookie</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#1-1st-party-cookie">1st Party Cookie</a>, <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Other requirements</strong>: Universal Analytics property<br />
<strong>Use for</strong>: Offline measurement, stitching client data<br />
<strong>Example return value</strong>: 475226310.1380715146</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create 1st Party Cookie macro</p></li>

<li><p>Set cookie name to <strong>_ga</strong></p></li>

<li><p>Create Custom JavaScript macro</p></li>

<li><p>Add following code within:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">try</span> {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">cookie</span> <span style="color:#f92672">=</span> {{<span style="color:#a6e22e">ga</span> <span style="color:#a6e22e">cookie</span>}}.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;.&#34;</span>);
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">cookie</span>[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">cookie</span>[<span style="color:#ae81ff">3</span>];
  } <span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">e</span>) {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;No Universal Analytics cookie found&#34;</span>);
  }
}
</code></pre></div>

<p>First you create a new 1st Party Cookie macro, which returns the value of the _ga cookie. It might be something like <strong>GA1.2.475226310.1380715146</strong>. Next, the Custom JavaScript macro parses this string, and returns the third (client ID) and fourth (timestamp) elements of the cookie value (<strong>475226310.1380715146</strong>), which combine to make the complete clientID of the user.</p>

<p>You can then add this as a session-level custom dimension, for example, to identify which clientID committed to what actions on your site during their session. You could then use the <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/">Measurement Protocol</a> to work all sorts of offline-online data stitching magic with your database tools!</p>

<p>Note that I use a very rudimentary try-catch block for error handling. Feel free to handle errors in any way you want (as long as you do handle them!).</p>

<h2 id="7-get-clientid-using-ga-getall">7. Get clientID using ga.getAll()</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Other requirements</strong>: Universal Analytics property<br />
<strong>Use for</strong>: Offline measurement, stitching client data<br />
<strong>Example return value</strong>: 475226310.1380715146</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript macro</p></li>

<li><p>Add following code within:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">try</span> {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">tracker</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ga</span>.<span style="color:#a6e22e">getAll</span>()[<span style="color:#ae81ff">0</span>];
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">tracker</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;clientId&#39;</span>);
  } <span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">e</span>) {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Error fetching clientId&#34;</span>);
  }
}
</code></pre></div>

<p>This is Google&rsquo;s recommendation for fetching the client ID (rather than parsing the cookie). You basically access the <strong>ga</strong> object using the function <em>getAll()</em>. This would normally retrieve all named trackers, but you&rsquo;re only interested in the first one (which is the one GTM sets). Finally, it uses the <em>get</em> method of the tracker object to retrieve the value of the property <em>clientId</em>, which is, coincidentally, the clientId.</p>

<p><strong>NOTE!</strong> This macro will not work if it fires before a page view is sent. The tracker is created during the page view call, so you&rsquo;ll either have to use a callback function (see the next section) or have the tag which fetches the client ID fire upon <strong>{{event}} equals gtm.load</strong>.</p>

<h2 id="8-hitcallback-with-a-universal-analytics-tag">8. hitCallback with a Universal Analytics tag</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Use for</strong>: Imposing a tag firing order</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript macro</p></li>

<li><p>Add following code within:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span>(){<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({<span style="color:#e6db74">&#39;event&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;pageViewFired&#39;</span>});}
}
</code></pre></div>

<p>The Universal Analytics tag doesn&rsquo;t have a callback field that you can use (yet). So you&rsquo;ll have to resort to the &ldquo;Fields to set&rdquo; option, and add the callback function manually.</p>

<p>Anyway, the idea with hitCallback is to do something as soon as the tag has fired. In my example, I push an event called &lsquo;pageViewFired&rsquo;, which I can then use in some other tag to make sure it fires only after the page view has been sent. You&rsquo;d need to add the macro to your tag like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/hitcallback.jpg" title="hitCallback in your tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/hitcallback.jpg#ZgotmplZ" alt="hitCallback in your tag">
  
    </a>
  
  
</div>



<p>The field to set is called <strong>hitCallback</strong> and its value should be the macro you just created.</p>

<p>If you look at the code, you&rsquo;ll see a funny thing. You&rsquo;re <em>returning</em> the function which does all the work. Why, you wonder? Simple. When the event tag is fired, it will go through all the fields that have been set for the tag, performing all the actions within. If you didn&rsquo;t have the function returning another function, the callback would fire <strong>twice</strong>: first when the event tag&rsquo;s firing begins, and again when the tag has completed (when the callback function is actually called).</p>

<p>This might be a bit difficult to fathom, but it&rsquo;s just how GTM and JavaScript work. hitCallback is expecting a function, so the function in your callback tag has to <em>return</em> a function, because macros need to always return something.</p>

<p>Messy. But it works!</p>

<h2 id="9-return-url-path-query-string">9. Return URL path + query string</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Use for</strong>: Working with the query string<br />
<strong>Example return value</strong>: /analytics/?internal=true</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript macro</p></li>

<li><p>Add following code within:</p></li>
</ol>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">pathname</span><span style="color:#f92672">+</span><span style="color:#a6e22e">location</span>.<span style="color:#a6e22e">search</span>;
}
</code></pre></div>

<p>This is a very simple macro. There&rsquo;s no predefined macro for you to use if you want to return the url pathname with query parameters. This macro does just that.</p>

<h2 id="10-property-id-lookup-with-hostname">10. Property ID lookup with hostname</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#12-lookup-table">Lookup Table</a><br />
<strong>Other requirements</strong>: Macro for <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#14-url">URL</a> of type URL Hostname (named {{url hostname}} in this example)<br />
<strong>Use for</strong>: To have the same tracking tag for different property IDs on different domains<br />
<strong>Example return value</strong>: UA-12345-1</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create a Lookup Table macro</p></li>

<li><p>Add some tracking code as the Default Value (optional)</p></li>

<li><p>In the first column, choose {{url hostname}} as the macro that is evaluated</p></li>

<li><p>In the first column, add all the different hostnames you want to assign a property ID to</p></li>

<li><p>In the second column, add the respective property ID for each hostname</p></li>
</ol>

<p>This is a very useful macro if you have multiple domains with different property IDs tracked by the same container. Whenever you have the same tags running on all the different domains, using a lookup like this means you don&rsquo;t have to create a separate tag for each ID.</p>

<p>The macro should look like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/lookup-hostname.jpg" title="Lookup with hostname">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/lookup-hostname.jpg#ZgotmplZ" alt="Lookup with hostname">
  
    </a>
  
  
</div>



<p>This macro will return the correct property ID depending on which domain the user is browsing on.</p>

<h2 id="11-track-debug-hits-to-different-property-id">11. Track debug hits to different property ID</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#12-lookup-table">Lookup Table</a>, <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#8-debug-mode">Debug Mode</a><br />
<strong>Use for</strong>: When using GTM&rsquo;s debug mode, track your hits to a different property ID (e.g. test account)<br />
<strong>Example return value</strong>: UA-12345-1</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create a Debug Mode macro (named {{debug mode}} in this example)</p></li>

<li><p>Create a Lookup Table macro</p></li>

<li><p>Add some tracking code as the Default Value (optional)</p></li>

<li><p>In the first column, choose {{debug mode}} as the macro that is evaluated</p></li>

<li><p>In the first column, add rows for <strong>true</strong> and <strong>false</strong></p></li>

<li><p>In the second column, add the respective property ID for when debug mode is <strong>true</strong> and when it is <strong>false</strong></p></li>
</ol>

<p>This is very similar to the previous macro, but it uses the Debug Mode macro as well. Sometimes you&rsquo;ll notice yourself doing so much debug work that you&rsquo;ll want to track these hits on a different account altogether. This is a really simple way to do it.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/debug-lookup.jpg" title="Lookup table macro for debug mode">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/debug-lookup.jpg#ZgotmplZ" alt="Lookup table macro for debug mode">
  
    </a>
  
  
</div>



<p>The Debug Mode macro returns &ldquo;true&rdquo; if debug mode is on, and &ldquo;false&rdquo; if it&rsquo;s off. Use these values to assign a different property ID as the return value of the Lookup Table macro.</p>

<h2 id="12-get-title-attribute-of-document">12. Get title attribute of document</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#11-javascript-variable">JavaScript Variable</a><br />
<strong>Use for</strong>: Retrieving and using the document title attribute<br />
<strong>Example return value</strong>: Macro Magic For Google Tag Manager - Simo Ahava&rsquo;s Blog</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create JavaScript Variable macro</p></li>

<li><p>Set field Global Variable Name to <strong>document.title</strong></p></li>
</ol>

<p>This macro retrieves the HTML title attribute of your document. A great use case for this is if you want to process tags on a 404 page differently. You&rsquo;d then create a rule like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/404-page.jpg" title="Rule for 404 pages">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/404-page.jpg#ZgotmplZ" alt="Rule for 404 pages">
  
    </a>
  
  
</div>



<p>Another use case could be for <a href="https://www.simoahava.com/analytics/google-tag-manager-content-grouping/">content grouping</a>. Use the title macro to group your content logically in your tags.</p>

<h2 id="13-check-if-browser-has-cookies-enabled">13. Check if browser has cookies enabled</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#11-javascript-variable">JavaScript Variable</a><br />
<strong>Use for</strong>: Checking if user has cookies enabled, filter some bot traffic<br />
<strong>Example return value</strong>: true</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create JavaScript Variable macro</p></li>

<li><p>Set field Global Variable Name to <strong>navigator.cookieEnabled</strong></p></li>
</ol>

<p>The <strong>navigator.cookieEnabled</strong> property returns a boolean value (true/false) determined by whether or not the browser allows websites to write cookies. You can use this in your rules to make sure tags only fire for browsers with cookies, or to filter non-cookie data to a different view.</p>

<p>You could also use this to block tags from firing for search engine bots, since there&rsquo;s some consensus that a majority of them do not accept or use cookies (see <a href="http://www.davekz.com/googlebot-and-cookies/">this test for Googlebot</a> from February 2013).</p>

<h2 id="14-a-bunch-of-useful-auto-event-variable-extensions">14. A bunch of useful Auto-Event Variable extensions</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#7-data-layer-variable">Data Layer Variable</a>
<strong>Use for</strong>: Making the most of <a href="https://www.simoahava.com/analytics/auto-event-tracking-google-tag-manager/">auto-event tracking</a></p>

<p>Here&rsquo;s a list of extensions for your auto-event tracking. By creating Data Layer Variable macros, you can use them in your rules to make your event tracking and whatnot even more detailed. In the &ldquo;What it does&rdquo; sections, <em>the element</em> refers always to the element which was clicked / submitted and thus stored in dataLayer as <strong>gtm.element</strong>.</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.nodeName<br />
<strong>Example return value</strong>: IMG<br />
<strong>What it does</strong>: Returns the tag name of the element (well, strictly node name but in most cases it&rsquo;s the same thing)</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.value<br />
<strong>Example return value</strong>: Simo Ahava<br />
<strong>What it does</strong>: Returns the value of the element. This is useful if you&rsquo;re tracking input elements on your forms (with e.g. blur, focus, or change), and you want to send an event every time a form field has been filled.</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.hash<br />
<strong>Example return value</strong>: #chapter1<br />
<strong>What it does</strong>: Returns the hash (if any) of the element href. So if the link was to /this-page/?internal=true#chapter1, gtm.element.hash would return #chapter1</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.pathname<br />
<strong>Example return value</strong>: /this-page/<br />
<strong>What it does</strong>: Returns the path in the element href. If the link was to /this-page/?internal=true#chapter1, gtm.element.pathname would return /this-page/</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.search<br />
<strong>Example return value</strong>: ?internal=true<br />
<strong>What it does</strong>: Returns the full query string of the element. If the link was to /this-page/?internal=true#chapter1, gtm.element.search would return ?internal=true</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.parentElement<br />
<strong>Example return value</strong>: (object), extend further with some property of the parent element<br />
<strong>What it does</strong>: Returns the direct parent of the element, and you should extend this macro further to access its properties (e.g. gtm.element.parentElement.id returns the value stored in the ID attribute of the parent tag)</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.firstChild<br />
<strong>Example return value</strong>: (object), extend further with some property of the child element<br />
<strong>What it does</strong>: Returns the first direct descendant of the element, and you should extend this macro further to access its properties (e.g. gtm.element.firstChild.className returns value stored in the CLASS attribute of the child tag)</p>

<p><strong>Data Layer Variable Name</strong>: gtm.element.nextSibling<br />
<strong>Example return value</strong>: (object), extend further with some property of the sibling element<br />
<strong>What it does</strong>: Returns the next element in the DOM tree which is on the same hierarchical level as the element, and you should extend this macro further to access its properties (e.g. gtm.element.nextSibling.nodeName returns the tag name of the sibling tag)</p>

<p>So here&rsquo;s a bunch of extensions for you to play with. There&rsquo;s still a huge amount of stuff out there you can try, especially with forms, so I suggest that you set up a click listener on your site and play around with the DOM.</p>

<h2 id="15-detect-mobile-browser">15. Detect mobile browser</h2>

<p><strong>Macro Type</strong>: <a href="https://www.simoahava.com/analytics/macro-guide-google-tag-manager/#6-custom-javascript">Custom JavaScript</a><br />
<strong>Use for</strong>: Mobile-specific tracking<br />
<strong>Example return value</strong>: true</p>

<p><em>Instructions and description</em>:</p>

<ol>
<li><p>Create Custom JavaScript macro</p></li>

<li><p>Copy-paste the code from <a href="https://www.simoahava.com/images/2014/03/mobile-detection-gtm.txt">the attached TXT file</a></p></li>
</ol>

<p>I had to add the code in an attachment, because it&rsquo;s such a long and ugly piece of RegEx that it makes my eyes water. Sorry about that.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/03/mobile-browser.jpg" title="Mobile Browser detection script">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2014/03/mobile-browser.jpg#ZgotmplZ" alt="Mobile Browser detection script">
  
    </a>
  
  
</div>



<p>It&rsquo;s dirty, I know. This script checks the browser user agent string and returns true if it matches a mobile device user agent. If it doesn&rsquo;t, the script returns false.</p>

<p>This script is provided by (with slight modifications to fit GTM infrastructure) <a href="http://detectmobilebrowsers.com/">detectmobilebrowsers.com</a>.</p>

<h2 id="conclusions">Conclusions</h2>

<p>There&rsquo;s so much you can do with macros. I truly believe that the goal of all GTM implementations should be to achieve the elusive compromise between complexity and eye candy. It&rsquo;s important to keep a clean house when tag management is concerned, especially since Google Tag Manager doesn&rsquo;t, as of yet, provide us with too much to work with in terms of taxonomies, hierarchies and categories.</p>

<p>I wasn&rsquo;t kidding when I wrote in the beginning how I really want to see a solution gallery for GTM. I appreciate the fact that it will make posts like this obsolete (unless you enjoy my banter or the educational twist I hopefully succeed in conveying). Nevertheless, being able to share, store, and search for the amazing tags and macros that our vibrant community has produced would be the best thing since sliced bread.</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/macros/">macros</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/form-tracking-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/container-snippet-gtm-secrets-revealed/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Macro%20Magic%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/macro-magic-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/form-tracking-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/container-snippet-gtm-secrets-revealed/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Macro%20Magic%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/macro-magic-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Macro%20Magic%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/macro-magic-google-tag-manager/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/macro-magic-google-tag-manager/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

