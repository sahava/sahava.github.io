<!doctype html><html lang=en-us><head><meta name=google-site-verification content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Variable Guide For Google Tag Manager | Simo Ahava's blog","image":"https:\/\/www.simoahava.com\/images\/2015\/01\/variable-guide.jpg","editor":"Simo Ahava","publisher":{"@type":"Organization","name":"Simo Ahava's blog","logo":{"@type":"ImageObject","url":"https:\/\/www.simoahava.com\/images\/simo.png","height":"393","width":"407"}},"url":"https:\/\/www.simoahava.com\/analytics\/variable-guide-google-tag-manager\/","datePublished":"2015-01-05T08:20:41\u002b00:00","dateModified":"2015-01-05T08:20:41\u002b00:00","description":"Comprehensive guide to variables in Google Tag Manager. Included are a look under the hood as well as a plethora of examples how to use variables to make your container rock.","author":{"@type":"Person","name":"Simo Ahava"}}</script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Variable Guide For Google Tag Manager | Simo Ahava's blog</title>
<script>window.dataLayer=window.dataLayer||[],window.dataLayer.push({pageType:"article",environment:null})</script><script>(function(e,t,n,s){window[n]=window[n]||[],window[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var i=e.getElementsByTagName(t)[0],o=e.createElement(t),a=n!="dataLayer"?"&l="+n:"";o.async=!0,o.src="https://sgtm.simoahava.com/gtm.js?id="+s+a,i.parentNode.insertBefore(o,i)})(document,"script","dataLayer","GTM-PZ7GMV9")</script><meta name=author content="Simo Ahava"><meta name=keywords content><link rel=icon href=https://www.simoahava.com/images/favicon.ico><link rel=amphtml href=https://www.simoahava.com/amp/analytics/variable-guide-google-tag-manager/><meta name=description content="Comprehensive guide to variables in Google Tag Manager. Included are a look under the hood as well as a plethora of examples how to use variables to make your container rock."><meta property="og:description" content="Comprehensive guide to variables in Google Tag Manager. Included are a look under the hood as well as a plethora of examples how to use variables to make your container rock."><meta property="og:type" content="blog"><meta property="og:title" content="Variable Guide For Google Tag Manager"><meta property="og:url" content="https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><meta property="og:site_name" content="Simo Ahava's blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Variable Guide For Google Tag Manager"><meta name=twitter:description content="Comprehensive guide to variables in Google Tag Manager. Included are a look under the hood as well as a plethora of examples how to use variables to make your container rock."><meta name=twitter:creator content="@SimoAhava"><meta name=twitter:image content="https://www.simoahava.com/images/2015/01/variable-guide.jpg"><meta property="og:image" content="https://www.simoahava.com/images/2015/01/variable-guide.jpg"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/style.css></head><body><div id=_progress></div><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/>Simo Ahava's blog</a></div></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/><img class=sidebar-profile-picture loading=lazy src=https://www.simoahava.com/images/simo.png alt="Author's picture"></a><h4 class=sidebar-profile-name>Simo Ahava</h4><h5 class=sidebar-profile-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/><i class="sidebar-button-icon fa fa-lg fa-home"></i>
<span class=sidebar-button-desc>Home</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
<span class=sidebar-button-desc>Categories</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Tags</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/categories/gtm-tips/><i class="sidebar-button-icon fa fa-lg fa-magic"></i>
<span class=sidebar-button-desc>GTM Tips</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/about-simo-ahava/><i class="sidebar-button-icon fa fa-lg fa-question"></i>
<span class=sidebar-button-desc>About</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/tools/><i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
<span class=sidebar-button-desc>Tools</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/blog-statistics/><i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
<span class=sidebar-button-desc>Blog statistics</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/sahava target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
<span class=sidebar-button-desc>GitHub</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/upcoming-talks/><i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
<span class=sidebar-button-desc>Upcoming talks</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/custom-templates/><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>Templates</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/newsletter/><i class="sidebar-button-icon fa fa-lg fa-bell"></i>
<span class=sidebar-button-desc>Newsletter</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://masto.measure.chat/@SimoAhava target=_blank rel="noopener me"><i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
<span class=sidebar-button-desc>Mastodon</span></a></li></ul><ul class=sidebar-buttons></ul></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post><form id=search action=/search/><input name=q type=text class="form-control input--xlarge" placeholder="Search blog..." autocomplete=off></form><div class="post-header main-content-wrap text-left"><h1>Variable Guide For Google Tag Manager</h1><div class="postShorten-meta post-meta"><time datetime=2015-01-05T08:20:41Z>January 5, 2015
</time><span>in</span>
<a class=category-link href=/categories/analytics>Analytics</a>
| <a href=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/#commento><comentario-count path=/analytics/variable-guide-google-tag-manager/ placeholder=... error-text="N/A " zero-text="0 " prefix suffix=" "></comentario-count>Comments</a></div></div><div class="post-content markdown"><div class=main-content-wrap><p><em>(Updated 21 February 2019)</em></p><p>The <a href=http://analytics.blogspot.fi/2014/10/making-tag-management-more-accessible.html>current version</a> of <a href=http://tagmanager.google.com>Google Tag Manager</a> was released in October 2014. With the release, we saw a brand-spanking new UI, a lot of new functionalities (revamped <a href=/analytics/auto-event-tracking-gtm-2-0/>auto-event tracking</a>, for example), plus a new terminology to cope with. We moved away from the programming-centric concepts of <em>Macros</em> and <em>Rules</em> to the more tactile <em>variables</em> and <em>triggers</em>.</p><p>It&rsquo;s difficult to rank the changes. The new <a href=/analytics/auto-event-tracking-gtm-2-0/>Auto-Event Tracking</a> is perhaps most impactful, but the improvements done to triggers and variables, when compared to the previous version of GTM, require attention as well.</p><div style=aspect-ratio:1246/562 class="figure nocaption"><a href=/images/2015/01/variable-guide.jpg title="variable guide for google tag manager"><img class=fig-img height=562 width=1246 loading=lazy src=/images/2015/01/variable-guide.jpg#ZgotmplZ alt="variable guide for google tag manager"></a></div><p>Thus, I give you my variable Guide for Google Tag Manager. For reference, feel free to take a look at the old <a href=/analytics/macro-guide-google-tag-manager/>macro guide</a>, since especially the different variable types have been left largely untouched.</p><div id=toc-container><h1 id=table-of-contents>Table of Contents</h1><input type=checkbox id=show><label for=show id=showbtn><h1 id=table-of-contents-mobile>Table of Contents</h1><span class=show>&nbsp;[+show]</span><span class=hide>&nbsp;[â€“hide]</span></label><nav id=TableOfContents><ul><li><a href=#introduction-to-variables>Introduction to Variables</a></li><li><a href=#technical-details-and-how-to>Technical details and how-to</a></li><li><a href=#built-in-variables>Built-in Variables</a><ul><li><a href=#pages>Pages</a></li><li><a href=#utilities>Utilities</a></li><li><a href=#errors>Errors</a></li><li><a href=#clicks>Clicks</a></li><li><a href=#forms>Forms</a></li><li><a href=#history>History</a></li><li><a href=#videos>Videos</a></li><li><a href=#scrolling>Scrolling</a></li><li><a href=#visibility>Visibility</a></li></ul></li><li><a href=#debugging-variables>Debugging Variables</a></li><li><a href=#variable-types>Variable Types</a></li><li><a href=#1-http-referrer>1. HTTP Referrer</a></li><li><a href=#2-url>2. URL</a></li><li><a href=#3-first-party-cookie>3. First Party Cookie</a></li><li><a href=#4-custom-javascript>4. Custom JavaScript</a></li><li><a href=#5-data-layer-variable>5. Data Layer Variable</a></li><li><a href=#6-javascript-variable>6. JavaScript Variable</a></li><li><a href=#7-undefined-value>7. Undefined Value</a></li><li><a href=#8-auto-event-variable>8. Auto-Event Variable</a></li><li><a href=#9-dom-element>9. DOM Element</a></li><li><a href=#10-element-visibility>10. Element Visibility</a></li><li><a href=#11-constant>11. Constant</a></li><li><a href=#12-custom-event>12. Custom Event</a></li><li><a href=#13-environment-name>13. Environment Name</a></li><li><a href=#14-google-analytics-settings>14. Google Analytics Settings</a></li><li><a href=#15-lookup-table>15. Lookup Table</a></li><li><a href=#16-random-number>16. Random Number</a></li><li><a href=#17-regex-table>17. RegEx Table</a></li><li><a href=#18-container-id>18. Container ID</a></li><li><a href=#19-container-version-number>19. Container Version Number</a></li><li><a href=#20-debug-mode>20. Debug Mode</a></li><li><a href=#summary>Summary</a></li></ul></nav></div><span class=simmer><span class=close>X</span><p><span class="fa fa-md fa-bell"></span>
<strong>The Simmer Newsletter</strong></p><p>Subscribe to the <a href=/newsletter/>Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!</p></span><h2 id=introduction-to-variables>Introduction to Variables</h2><p>In computing terms, <em>variables</em> denote compartments in computer memory, which are reserved for storing values. This is a significant achievement in efficiency, because it means that values can be reused across functions, procedures, and environments. The alternative would be to treat each representation of the same value as unique, temporary, and disposable, creating a mass of redundancy and inefficiency, and making the current computing landscape a whole lot different.</p><p>In Google Tag Manager, the term <em>variable</em> is used to denote a helper function that your tags, triggers, and other variables can invoke to retrieve values from. Thus, the idea is very similar to the broader concept of computing <em>variables</em> explored in the previous paragraph.</p><p>In GTM, invoking the variable function is done with a specific syntax:</p><p><strong>{{variable name}}</strong></p><p>As we&rsquo;ll learn later on, you can&rsquo;t invoke variables wherever you&rsquo;d want to. But in an approved context, the syntax <strong>{{variable name}}</strong> would run the underlying function of the variable with the name &ldquo;variable name&rdquo;, and pass the value returned by that function to its execution context (the tag, trigger, or variable where the syntax was used).</p><p>One of the first things all Google Tag Manager containers which run <a href=http://www.google.com/analytics>Google Analytics</a> tags should do is this:</p><div style=aspect-ratio:690/494 class="figure nocaption"><a href=/images/2015/01/gatc-constant.jpg title="constant variable google analytics tracking code"><img class=fig-img height=494 width=690 loading=lazy src=/images/2015/01/gatc-constant.jpg#ZgotmplZ alt="constant variable google analytics tracking code"></a></div><p>Here, instead of always typing the tracking code for your web property (UA-XXXXXX-X) into each GA tag, you can create a Constant variable, which stores the value. Thus, whenever the variable name is invoked using the correct syntax, the tracking code returned by the Constant variable will be included in the appropriate tag field. This is something I&rsquo;ve actually written a <a href=/gtm-tips/save-gatc-constant-string-macro/>#GTMtips post</a> about this.</p><p>I will go so far as to say that variables can make or break GTM. When skeptics ask me what is the main benefit of having GTM on the site, I always end up talking about variables. They add a level of flexibility and customization that can really make your tagging lean, efficient, performance-driven, and time-saving.</p><p>At the same time, variables can be difficult to fathom, especially when we get to the technical details (see below), or when we try to tackle the amazingly multi-faceted and deviously difficult Custom JavaScript variable. I hope this guide will help you get to the bottom of variables, and encourage you to find your own ways of performing <a href=/analytics/macro-magic-google-tag-manager/>magic</a> tricks with your GTM container.</p><h2 id=technical-details-and-how-to>Technical details and how-to</h2><p>For you to be able to invoke a GTM variable, you need to be working in a <em>script context</em>, or the template field needs to support variable references.</p><p>A supported template field can be uncovered by looking for the little variable symbol next to a field:</p><div style=aspect-ratio:1376/860 class="figure nocaption"><a href=/images/2015/01/variable-context.jpg title="variable context in GTM tags"><img class=fig-img height=860 width=1376 loading=lazy src=/images/2015/01/variable-context.jpg#ZgotmplZ alt="variable context in GTM tags"></a></div><p>As you can see, the &ldquo;Tag firing priority&rdquo; field will <em>not</em> be able to invoke a variable, but the &ldquo;Auto Link Domains&rdquo; will. In fact, if you click the little variable icon, you will see a drop-down list from which you can pick the variable you want to use. This way you don&rsquo;t have to worry about correct syntax, as GTM will do it for you.</p><div style=aspect-ratio:712/538 class="figure nocaption"><a href=/images/2015/01/drop-down-menu.jpg title="variable menu"><img class=fig-img height=538 width=712 loading=lazy src=/images/2015/01/drop-down-menu.jpg#ZgotmplZ alt="variable menu"></a></div><p>The other places where you&rsquo;ll frequently run into variables are:</p><ol><li><p>Triggers</p></li><li><p>Custom HTML tags</p></li><li><p>Custom JavaScript variables</p></li></ol><p>With triggers (remember to read my <a href=/analytics/trigger-guide-google-tag-manager/>Trigger guide</a> as well!), you will always need to specify a variable as the target of the trigger condition. Every single trigger condition needs a variable that is evaluated against some value. In fact, the condition builder is created so that you can&rsquo;t possibly <em>not</em> choose a variable. It&rsquo;s obligatory!</p><div style=aspect-ratio:1790/742 class="figure nocaption"><a href=/images/2015/01/trigger-selector.jpg title="trigger selector menu"><img class=fig-img height=742 width=1790 loading=lazy src=/images/2015/01/trigger-selector.jpg#ZgotmplZ alt="trigger selector menu"></a></div><p>Note that the <strong>value</strong> (right-hand) field of the trigger condition is <strong>NOT</strong> a variable context!</p><p>As for Custom HTML tags and Custom JavaScript variables, you can call variables from the scripts within, but you won&rsquo;t have the helpful drop-down menu to assist you. You will need to manually type the call, using the correct syntax and the correct (case-sensitive) variable name:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#aaa;font-style:italic>&lt;!-- Sample Variable call in a Custom HTML Tag --&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#1e90ff;font-weight:700>script</span>&gt;
</span></span><span style=display:flex><span>  (<span style=color:#00a>function</span>() {
</span></span><span style=display:flex><span>    alert({{custom alert string}});
</span></span><span style=display:flex><span>  })();
</span></span><span style=display:flex><span>&lt;/<span style=color:#1e90ff;font-weight:700>script</span>&gt;</span></span></code></pre></div><p>The code above will pop-up a browser alert, where the content will be the string returned by the variable named <strong>custom alert string</strong>. Note! If the variable doesn&rsquo;t return a string, you might run into problems with the <code>alert</code> method, so you need to be well aware of return types and values at all times.</p><p>If you try to use a variable that doesn&rsquo;t exist (or whose name you mistyped), you won&rsquo;t be able to perform any operations on the container version (create, publish, etc.). You&rsquo;ll run into an error message that looks like this:</p><div style=aspect-ratio:1228/438 class="figure nocaption"><a href=/images/2015/01/variable-error.jpg title="variable Error GTM"><img class=fig-img height=438 width=1228 loading=lazy src=/images/2015/01/variable-error.jpg#ZgotmplZ alt="variable Error GTM"></a></div><p>So remember to check all the places where you&rsquo;ve manually typed a variable call. It&rsquo;s also possible that you&rsquo;ve jumped the gun and called a variable, but then you forgot to create the variable itself. Retrace your steps and fix any broken links.</p><p>One cool thing that GTM does for you is this: when you change a variable name, <strong>all</strong> references to the variable are automatically updated. Even the ones you&rsquo;ve typed in manually into Custom HTML tags and Custom JavaScript variables! This is incredibly time-saving, since you don&rsquo;t have to go through every single reference, rewriting the code to match the new name.</p><p>Variables are <strong>resolved</strong> according to the following process:</p><ul><li><p>If the variable is not attached to a trigger or a tag, <strong>the variable is never resolved</strong> (unless, of course, the variable is referenced from some other variable that <em>is</em> resolved).</p></li><li><p>If the variable is referenced in a trigger that is not attached to any tags, <strong>the variable is never resolved</strong>.</p></li><li><p>If the variable is referenced in a trigger that is attached to a tag, <strong>the variable is resolved every single time an <code>event</code> key is pushed into <code>dataLayer</code></strong>.</p></li><li><p>If the variable is referenced in a tag, <strong>the variable is resolved every single time the tag fires</strong>.</p></li></ul><p>The last one is interesting. When a trigger causes a tag to &ldquo;fire&rdquo;, the process is actually this:</p><ol><li><p>Variable calls are transformed into the actual function calls (<code>google_tag_manager['containerId'].macro('gtm10')</code>)</p></li><li><p>The tag code is injected on the site</p></li><li><p>The tag code is executed, and all variable functions within are resolved</p></li></ol><p>As you can see, a variable is actually a method of the <code>google_tag_manager</code> object. The parameter that is given to the <code>macro()</code> method is basically &lsquo;gtm&rsquo; plus a unique sequential number. This means that it&rsquo;s very difficult to identify which <code>macro()</code> parameter is associated with which variable, which is why debugging has become an all-important tool in understanding how variables work.</p><p>The other, common case of variable resolution has to do with trigger conditions. When an &rsquo;event&rsquo; key is pushed into <code>dataLayer</code>, every single trigger that is attached to a tag in your container is evaluated for the &rsquo;event&rsquo; condition. In addition to checking the <code>event</code> value, all variables referenced in the trigger are evaluated, too.</p><p>You might want to re-read the previous paragraphs to grasp the idea, but this has very severe repercussions on how variables should (and should not be used):</p><p><strong>Variables must never have side effects</strong></p><p>Remember how variables should only be used to return values? Well, sometimes you might be tempted to use a variable to change the state of the global object or to set or push stuff into <code>dataLayer</code>. <strong>Don&rsquo;t do it!</strong> Because variables can be resolved in multiple ways, and not just in tags as you&rsquo;d expect, you might find yourself creating infinite loops, pushing stuff into <code>dataLayer</code> multiple times, or severely hurting page performance.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#00a>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#aaa;font-style:italic>// DON&#39;T DO THIS:
</span></span></span><span style=display:flex><span><span style=color:#aaa;font-style:italic></span>  <span style=color:#0aa>window</span>.dataLayer.push({
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>  });
</span></span><span style=display:flex><span>  <span style=color:#aaa;font-style:italic>// OR THIS:
</span></span></span><span style=display:flex><span><span style=color:#aaa;font-style:italic></span>  alert(<span style=color:#a50>&#34;test&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#aaa;font-style:italic>// OR THIS:
</span></span></span><span style=display:flex><span><span style=color:#aaa;font-style:italic></span>  <span style=color:#0aa>window</span>.temp = getTempValue();
</span></span><span style=display:flex><span>  <span style=color:#aaa;font-style:italic>// DO THIS:
</span></span></span><span style=display:flex><span><span style=color:#aaa;font-style:italic></span>  <span style=color:#00a>var</span> a = <span style=color:#0aa>window</span>.thisValue;
</span></span><span style=display:flex><span>  <span style=color:#00a>var</span> b = getSomeOtherValue();
</span></span><span style=display:flex><span>  <span style=color:#00a>return</span> a + <span style=color:#a50>&#39;: &#39;</span> + b;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>If you&rsquo;ve made it this far, congratulations. As a developer, I think it&rsquo;s all-important to understand how variables work beyond the obvious, if only to realize the potential that variables have in improving the efficiency of your work with GTM.</p><h2 id=built-in-variables>Built-in Variables</h2><p>The new version of Google Tag Manager introduced Built-in variables. These are helpful, most commonly used variables, whose existence is based on binary logic: active / inactive. If the Built-in variable is activated, it can be used as any other variable, and if it&rsquo;s not activated, it can&rsquo;t.</p><p>Built-in variables are thus no more than a shorthand for exploiting some of the most frequently used variable types in Google Tag Manager. I find it a bit odd that they&rsquo;re not all activated by default, since there&rsquo;s absolutely no harm in them being available for use.</p><p>You will find the Built-in variables displayed prominently in the top of the variables screen of your Google Tag Manager Container:</p><div style=aspect-ratio:1142/674 class="figure nocaption"><a href=/images/2015/01/built-in-variables-gtm.jpg title="Built-in Variables"><img class=fig-img height=674 width=1142 loading=lazy src=/images/2015/01/built-in-variables-gtm.jpg#ZgotmplZ alt="Built-in Variables"></a></div><p>If the Built-in variable is listed here, it is active in the container. To add new Built-in variables, click the red <strong>CONFIGURE</strong> button, and check the box next to each variable you want to add to the container.</p><div style=aspect-ratio:1242/740 class="figure nocaption"><a href=/images/2015/01/configure-built-in-variables.jpg title="Configure built-in variables"><img class=fig-img height=740 width=1242 loading=lazy src=/images/2015/01/configure-built-in-variables.jpg#ZgotmplZ alt="Configure built-in variables"></a></div><p>As with all variables, if the Built-in variable cannot be resolved (e.g. there was no Click action and you want to use Click ID), the variable returns the JavaScript <em>undefined</em> type.</p><p>Here are the Built-in variables with a brief description of what they return:</p><h3 id=pages>Pages</h3><ul><li><p><strong>Page URL</strong> - returns a string containing the full URL of the current page without hash fragment (<code>https://www.simoahava.com/article?parameter=true</code>)</p></li><li><p><strong>Page Hostname</strong> - returns a string containing the the hostname of the current page (<code>www.simoahava.com</code>)</p></li><li><p><strong>Page Path</strong> - returns a string containing the relative path of the current page (<code>/article</code>)</p></li><li><p><strong>Referrer</strong> - returns a string containing the URL of the page which brought the visitor to the current page (<code>https://www.simoahava.com/home/</code>), from <code>document.referrer</code></p></li></ul><h3 id=utilities>Utilities</h3><ul><li><p><strong>Event</strong> - returns a string containing the value stored in the &rsquo;event&rsquo; <code>dataLayer</code> key</p></li><li><p><strong>Environment Name</strong> - returns the name of the <a href=/analytics/better-qa-with-google-tag-manager-environments/>environment</a> currently being previewed (either via the Share Preview link or the environment&rsquo;s container snippet)</p></li><li><p><strong>Container ID</strong> - returns a string containing the container ID (<em>GTM-XXXXXX</em>)</p></li><li><p><strong>Container Version</strong> - returns a string containing the current container version</p></li><li><p><strong>Random Number</strong> - returns a number, randomized between 0 and 2147483647</p></li><li><p><strong>HTML ID</strong> - returns the identifier of the Custom HTML tag. Used with <a href=/analytics/understanding-tag-sequencing-in-google-tag-manager/>tag sequencing</a>.</p></li></ul><h3 id=errors>Errors</h3><ul><li><p><strong>Error Message</strong> - returns a string containing the error message dispatched by a JavaScript Error trigger</p></li><li><p><strong>Error Line</strong> - returns a string containing the line number where the error was thrown</p></li><li><p><strong>Error URL</strong> - returns a string containing the URL of the script where the error was thrown</p></li><li><p><strong>Debug Mode</strong> - returns a Boolean (true/false) depending on if the user is in GTM debug mode or not</p></li></ul><h3 id=clicks>Clicks</h3><ul><li><p><strong>Click Element</strong> - returns an HTML element that was the target of an auto-event action; this object is retrieved from the <code>gtm.element</code> key in <code>dataLayer</code></p></li><li><p><strong>Click Classes</strong> - returns a string contained in the <code>className</code> attribute value of the auto-event element</p></li><li><p><strong>Click ID</strong> - returns a string contained in the <code>id</code> attribute value of the auto-event element</p></li><li><p><strong>Click Target</strong> - returns a string contained in the <code>target</code> attribute value of the auto-event element</p></li><li><p><strong>Click URL</strong> - returns a string contained in the <code>href</code> or <code>action</code> attribute value of the auto-event element</p></li><li><p><strong>Click Text</strong> - returns a string contained in the <code>textContent / innerText</code> attribute value of the auto-event element</p></li></ul><h3 id=forms>Forms</h3><p>These are exactly the same as the Click variables. I&rsquo;m not sure why we need two sets of variables, when one generic &ldquo;Auto-Event&rdquo; type would suffice.</p><h3 id=history>History</h3><ul><li><p><strong>New History Fragment</strong> - returns a string containing the new URL fragment after a page history change auto-event action is registered</p></li><li><p><strong>Old History Fragment</strong> - returns a string containing the previous URL fragment</p></li><li><p><strong>New History State</strong> - returns an object containing the new history state after a <code>pushState()</code> has been registered</p></li><li><p><strong>Old History State</strong> - returns an object containing the old history state</p></li><li><p><strong>History Source</strong> - returns a string describing the event that initiated the history change (e.g. <code>popstate</code> or <code>pushState</code>)</p></li></ul><h3 id=videos>Videos</h3><ul><li><p><strong>Video Provider</strong> - returns a string containing the video service being tracked (currently <a href=/analytics/the-youtube-video-trigger-in-google-tag-manager/>YouTube</a> only supported).</p></li><li><p><strong>Video Status</strong> - returns a string with the status of the video that caused the trigger to fire. Could be one of <code>'start'</code>, <code>'pause'</code>, <code>'buffering'</code>, <code>'progress'</code>, or <code>'complete'</code>.</p></li><li><p><strong>Video URL</strong> - returns a string with the URL of the embedded video.</p></li><li><p><strong>Video Title</strong> - returns a string with the title of the embedded video.</p></li><li><p><strong>Video Duration</strong> - returns a number with the total length of the video in seconds.</p></li><li><p><strong>Video Current Time</strong> - returns a number with the time mark where the user currently is (i.e. when the event was triggered).</p></li><li><p><strong>Video Percent</strong> - returns a number with the percentage mark where the user currently is.</p></li><li><p><strong>Video Visible</strong> - returns <code>true</code> or <code>false</code>, depending on if the video was visible in the browser viewport when the event was triggered.</p></li></ul><h3 id=scrolling>Scrolling</h3><ul><li><p><strong>Scroll Depth Threshold</strong> - returns a number with the value of the <a href=/analytics/scroll-depth-trigger-google-tag-manager/>scroll tracking</a> threshold that was crossed (e.g. <code>25</code> for 25 percent or 25 pixels, depending on which the trigger is configured with).</p></li><li><p><strong>Scroll Depth Units</strong> - returns a string with <code>'percent'</code> or <code>'pixels'</code>, depending on which threshold type the trigger is tracking.</p></li><li><p><strong>Scroll Direction</strong> - returns a string with <code>'vertical'</code> or <code>'horizontal'</code>, depending on which direction is being tracked with the trigger.</p></li></ul><h3 id=visibility>Visibility</h3><ul><li><p><strong>Percent Visible</strong> - returns a number with the percentage of visibility for the <a href=/analytics/element-visibility-trigger-google-tag-manager/>element whose visibility is being tracked</a> (e.g. <code>50</code> if half of the element is in the viewport).</p></li><li><p><strong>On-Screen Duration</strong> - returns a number with the total cumulative time (in milliseconds) that the element has been in the viewport when the trigger fires.</p></li></ul><p>As you can see, the Built-in variables are just a quicker way to access some of the most common variable types. Read on, and check especially the chapter on variable types, as that will help you understand Built-in variables better as well.</p><h2 id=debugging-variables>Debugging Variables</h2><p>In the amazingly wonderful <a href=https://support.google.com/tagmanager/answer/6107056>Debug Mode</a>, there&rsquo;s a tab for variables:</p><div style=aspect-ratio:1516/526 class="figure nocaption"><a href=/images/2015/01/debug-variables.jpg title="debug mode variables"><img class=fig-img height=526 width=1516 loading=lazy src=/images/2015/01/debug-variables.jpg#ZgotmplZ alt="debug mode variables"></a></div><p>By clicking that tab, you can explore the <strong>state of each variable upon every single <code>dataLayer</code> interaction</strong>. <a href=/analytics/google-tag-manager-data-model/>As you probably know</a>, every single push to the <code>dataLayer</code> has the potential to change the state of the data used by GTM, which is why you must be able to observe this state with every interaction. And this is what the variables section of the Debug pane enables you to do.</p><p>For example, here are two different <em>states</em> of <code>dataLayer</code>. The first state is when the Container snippet is first loaded, and the &rsquo;event&rsquo; key is pushed with the value &lsquo;gtm.js&rsquo;:</p><div style=aspect-ratio:1550/522 class="figure nocaption"><a href=/images/2015/01/pageview-debug.jpg title="Pageview debug mode"><img class=fig-img height=522 width=1550 loading=lazy src=/images/2015/01/pageview-debug.jpg#ZgotmplZ alt="Pageview debug mode"></a></div><p>As you can see, I&rsquo;ve selected the &ldquo;Page View&rdquo; event in the left-hand-side navigation of the Debug pane. This corresponds to a <code>dataLayer.push()</code>, where the &rsquo;event&rsquo; key was populated with &lsquo;gtm.js&rsquo;.</p><p>Next, I select the &ldquo;Window Loaded&rdquo; event from the navigation. Here&rsquo;s what the &rsquo;event&rsquo; key looks like in this particular state:</p><div style=aspect-ratio:1500/530 class="figure nocaption"><a href=/images/2015/01/pageload-debug.jpg title="Window loaded debug mode"><img class=fig-img height=530 width=1500 loading=lazy src=/images/2015/01/pageload-debug.jpg#ZgotmplZ alt="Window loaded debug mode"></a></div><p>As you can see, the value of the &rsquo;event&rsquo; key has changed. So with the debug pane, you can explore the values stored in each variable at any given <code>dataLayer</code> interaction.</p><p>If a variable has the value <em>undefined</em>, it means that the variable did not resolve. If you see this value in a state where you are certain the variable <em>should</em> have a proper value, it means there&rsquo;s something wrong with your variables, tags, or triggers, and you need to look into it more carefully.</p><p>By clicking the Tags tab, you can examine what your variables returned in any tag that has fired (or not):</p><div style=aspect-ratio:1392/490 class="figure nocaption"><a href=/images/2015/01/debug-tags.jpg title="Debug tags"><img class=fig-img height=490 width=1392 loading=lazy src=/images/2015/01/debug-tags.jpg#ZgotmplZ alt="Debug tags"></a></div><p>You can also look at tags which <em>didn&rsquo;t fire</em>, and focus on the trigger. The visual display will tell you which variable condition did not pass the check, and you&rsquo;ll know there&rsquo;s something for you to debug again:</p><div style=aspect-ratio:1170/504 class="figure nocaption"><a href=/images/2015/01/debug-triggers.jpg title="Debug triggers"><img class=fig-img height=504 width=1170 loading=lazy src=/images/2015/01/debug-triggers.jpg#ZgotmplZ alt="Debug triggers"></a></div><p>The Debug tool is incredibly useful, as it allows you to double-check how variables work in your current setup.</p><h2 id=variable-types>Variable Types</h2><div style=aspect-ratio:1250/1410 class="figure nocaption"><a href=/images/2015/01/variable-types.jpg title="Variable types"><img class=fig-img height=1410 width=1250 loading=lazy src=/images/2015/01/variable-types.jpg#ZgotmplZ alt="Variable types"></a></div><p>There are a number of useful variable types for you to choose from, and you can use the Custom JavaScript variable to create custom variables of your own. Many of the variable types have some cool customization options as well, so you should take the time to study their many uses.</p><h2 id=1-http-referrer>1. HTTP Referrer</h2><div style=aspect-ratio:872/494 class="figure nocaption"><a href=/images/2015/01/http-referrer.jpg title="HTTP Referrer"><img class=fig-img height=494 width=872 loading=lazy src=/images/2015/01/http-referrer.jpg#ZgotmplZ alt="HTTP Referrer"></a></div><p>Use the <strong>HTTP Referrer</strong> variable to identify details about the page that brought the visitor to the current one. The value is retrieved from the <code>document.referrer</code> property. <strong>Note</strong>: There is a Built-In variable for this (Referrer).</p><p><strong>RETURNS</strong></p><p><em>String</em> with the URL of the referring page. You can specify a URL component if you wish (see the URL variable for more information about the various component types).</p><p><strong>USE CASE(S)</strong></p><p>You could create a trigger which fires when HTTP Referrer does not contain your own domain. This would mean that the user arrived from outside your site to the current page.</p><h2 id=2-url>2. URL</h2><div style=aspect-ratio:712/538 class="figure nocaption"><a href=/images/2015/01/url-variable-1.jpg title="URL Variable"><img class=fig-img height=538 width=712 loading=lazy src=/images/2015/01/url-variable-1.jpg#ZgotmplZ alt="URL Variable"></a></div><p>The <strong>URL</strong> variable can be used to access components of the current page URL (default) or of any URL string returned by a variable. This is a very versatile variable type, and is especially useful for traversing query parameters and hash fragments in your URLs. <strong>Note</strong>: There are Built-In variables for this (Page URL, Page Hostname, Page Path).</p><p>The Component Types you can choose are:</p><p><strong>Full URL</strong> - returns the full URL without the hash fragment, e.g. &lsquo;<a href="https://www.simoahava.com/?home=true'">https://www.simoahava.com/?home=true'</a>.</p><p><strong>Protocol</strong> - returns the protocol of the URL, e.g. &lsquo;https&rsquo;.</p><p><strong>Host Name</strong> - returns the hostname of the URL without the port number, e.g. <code>www.simoahava.com</code>. You can choose to <em>Strip &lsquo;www.&rsquo;</em> to strip the &lsquo;www&rsquo; subdomain from the hostname.</p><p><strong>Port</strong> - returns the port number used in the URL, or &lsquo;80&rsquo; for HTTP / &lsquo;443&rsquo; for HTTPS, if the URL has no port number.</p><p><strong>Path</strong> - returns only the pathname in the URL. You can also specify <em>Default Pages</em> to strip pages with names like &lsquo;index.html&rsquo; or &lsquo;index.php&rsquo; from the return string.</p><p><strong>Query</strong> - returns the entire query parameter string (without leading &lsquo;?&rsquo;), if you don&rsquo;t specify a query key. If you do specify a query key, only the value of this key is returned, or <em>undefined</em> if no such key is found in the URL.</p><p><strong>Fragment</strong> - returns the value of the URL&rsquo;s fragment without the leading &lsquo;#&rsquo;, e.g. &lsquo;anchor1&rsquo;.</p><p>You can expand the <em>More Settings</em> tab to find a source selector. In this selector, you can choose the variable whose return value the URL variable will access.</p><p><strong>RETURNS</strong></p><p>The return value for the URL type you specified in the Component Type selection, or <em>undefined</em> if no such component is found in the URL variable. By default, the URL variable that is accessed is the page URL, but you can choose any variable which returns a string with a URL in it.</p><p><strong>USE CASE(S)</strong></p><p>This is, again, a very versatile variable. For example, check the following article for an example of how to use the URL variable to fix your site&rsquo;s internal search tracking:</p><ul><li><a href=/analytics/fix-ga-site-search-google-tag-manager/>Fix GA Site Search With Google Tag Manager</a></li></ul><h2 id=3-first-party-cookie>3. First Party Cookie</h2><div style=aspect-ratio:814/540 class="figure nocaption"><a href=/images/2015/01/1st-party-cookie-1.jpg title="1st Party Cookie Variable"><img class=fig-img height=540 width=814 loading=lazy src=/images/2015/01/1st-party-cookie-1.jpg#ZgotmplZ alt="1st Party Cookie Variable"></a></div><p>The <strong>1st Party Cookie</strong> variable returns the value for the first browser cookie with the name you specify in the Cookie Name field. For example, if you have a cookie called &ldquo;session&rdquo;, you can use the 1st Party Cookie variable to retrieve the value for this particular cookie.</p><p><strong>RETURNS</strong></p><p><em>String</em> containing the value stored in the cookie, or <em>undefined</em>, if no such cookie exists.</p><p><strong>USE CASE(S)</strong></p><p>I&rsquo;ve used cookies a lot in my guides. Here are two examples for using cookies:</p><ul><li><p><a href=/gtm-tips/prevent-repeat-transactions/>#GTMtips: Prevent Repeat Transactions</a></p></li><li><p><a href=/gtm-tips/once-userid-always-userid/>#GTMtips: Once userId, Always userId</a></p></li></ul><h2 id=4-custom-javascript>4. Custom JavaScript</h2><div style=aspect-ratio:842/502 class="figure nocaption"><a href=/images/2015/01/custom-javascript-1.jpg title="Custom JavaScript Variable"><img class=fig-img height=502 width=842 loading=lazy src=/images/2015/01/custom-javascript-1.jpg#ZgotmplZ alt="Custom JavaScript Variable"></a></div><p>The <strong>Custom JavaScript</strong> variable is surely the most versatile variable in the set. You can use it to run arbitrary JavaScript on the page. It creates a script context, meaning you can also call other variables from within using the appropriate syntax.</p><p>The Custom JavaScript variable needs to follow two simple rules. First, the script must be wrapped in an anonymous function block (<code>function() { ... }</code>). Second, the function must have a return statement (<code>return somevalue;</code>).</p><p>The third, unwritten rule is that the function should only return a value. You shouldn&rsquo;t use a Custom JavaScript variable to modify the global namescape by pushing values to <code>dataLayer</code> for example. If you want to tamper with global variables from a function, it&rsquo;s better to create a Custom HTML tag for this purpose.</p><p><strong>RETURNS</strong></p><p>Depends on what you have in the <code>return</code> statement. You can return any variable or value, even other functions, other GTM variables, or nothing (a simple <code>return;</code> is the equivalent of returning the <em>undefined</em> value).</p><p><strong>USE CASE(S)</strong></p><p>Many of my articles use the Custom JavaScript variable to some extent. Take a look at these to get started:</p><ul><li><p><a href=/analytics/custom-event-listeners-gtm/>Custom Event Listeners For GTM</a></p></li><li><p><a href=/analytics/simple-regex-lookup-table-for-google-tag-manager/>Simple RegEx Table For Google Tag Manager</a></p></li><li><p><a href=/analytics/macro-magic-google-tag-manager/>Macro Magic For Google Tag Manager</a></p></li></ul><h2 id=5-data-layer-variable>5. Data Layer Variable</h2><div style=aspect-ratio:852/622 class="figure nocaption"><a href=/images/2015/01/data-layer-variable-1.jpg title="Data Layer Variable"><img class=fig-img height=622 width=852 loading=lazy src=/images/2015/01/data-layer-variable-1.jpg#ZgotmplZ alt="Data Layer Variable"></a></div><p>The <strong>Data Layer variable</strong> is extremely versatile as well. When you create a Data Layer variable, you specify the Data Layer key whose value you want to retrieve. When the variable is resolved, GTM will look for the most recent value for the key in the <a href=/analytics/google-tag-manager-data-model/>internal data model</a>. For primitive values (Strings, numbers, Booleans, functions), the variable will return whatever was most recently pushed into the key. For plain objects and Arrays, the variable will return the result of a recursive merge, where only shared keys are replaced.</p><p>You can use dot notation to access both Data Layer variable keys which have a dot in their name (e.g. <code>gtm.element</code>), or to access properties of DOM element objects (e.g. <code>gtm.element.dataset.name</code>).</p><p>You can use dot notation to access Array members as well. Square notation won&rsquo;t work, so replace the square notation with dots: <code>products[0].name</code> becomes <code>products.0.name</code>.</p><p><strong>RETURNS</strong></p><p>The value stored in the Data Layer variable whose name you point out in the Data Layer variable Name field. You can also retrieve the value of an object property, if you are sure that the variable holds an object. To access Array members, use dot notation instead of square notation. You can also specify a Default Value which will be returned if no variable with the given name can be found from the Data Layer when the variable is resolved. If you don&rsquo;t give a default value, the Data Layer variable will return <em>undefined</em> in case no variable with the given name is found.</p><p><strong>USE CASE(S)</strong></p><p>The Data Layer variable is your best friend when you want to make the most of Auto-Event Tracking. The Built-In variables and the Auto-Event variable types only give you a handful of DOM properties to choose from in the auto-event element. Use the Data Layer variable to traverse the <code>gtm.element</code> object as you wish.</p><p>Remember to read my two earlier, in-depth articles about the Data Layer:</p><ul><li><p><a href=/analytics/data-layer/>The Data Layer</a></p></li><li><p><a href=/analytics/google-tag-manager-data-model/>Google Tag Manager&rsquo;s Data Model</a></p></li></ul><h2 id=6-javascript-variable>6. JavaScript Variable</h2><div style=aspect-ratio:704/422 class="figure nocaption"><a href=/images/2015/01/javascript-variable-1.jpg title="JavaScript variable"><img class=fig-img height=422 width=704 loading=lazy src=/images/2015/01/javascript-variable-1.jpg#ZgotmplZ alt="JavaScript variable"></a></div><p>The <strong>JavaScript</strong> variable returns the value stored in the global JavaScript variable you specify. Note, this is NOT the same as the Custom JavaScript variable, which is a function declaration.</p><p><strong>RETURNS</strong></p><p>The value stored in the global JavaScript variable that you specify. If no such global variable exists, the <em>undefined</em> value is returned instead.</p><p><strong>USE CASE(S)</strong></p><p>Here&rsquo;s an example of using the JavaScript variable with a custom tag. In this example, I show you how to fire a single tag multiple times by increasing a global JavaScript variable counter with each iteration, and then fetching the value of this variable in linked tags and variables.</p><ul><li><a href=/analytics/fun-google-tag-manager-part-2/>Fun With Google Tag Manager: Part 2</a></li></ul><h2 id=7-undefined-value>7. Undefined Value</h2><div style=aspect-ratio:1098/590 class="figure nocaption"><a href=/images/2019/02/undefined-value.jpg title="Undefined Value variable"><img class=fig-img height=590 width=1098 loading=lazy src=/images/2019/02/undefined-value.jpg#ZgotmplZ alt="Undefined Value variable"></a></div><p>The <strong>Undefined Value</strong> variable is extremely simple (so simple, in fact, that I&rsquo;m wondering why it&rsquo;s not a Built-in variable). Its sole purpose is to return the JavaScript <code>undefined</code> value. So it&rsquo;s essentially the same as a Custom JavaScript variable with:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#00a>function</span>() {
</span></span><span style=display:flex><span>  <span style=color:#00a>return</span>;
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p><strong>RETURNS</strong></p><p>The variable returns the <code>undefined</code> JavaScript value.</p><p><strong>USE CASE(S)</strong></p><p>Use it whenever you might want to use the <code>undefined</code> value effectively. For example, you might want to use it in a Lookup Table or a RegEx Table, returning <code>undefined</code> when you want to ignore the value of the table in some cases (such as if you want to <a href=/gtm-tips/undefined-dimensions-wont-get-sent/>drop a Custom Dimension from a hit</a>.</p><h2 id=8-auto-event-variable>8. Auto-Event Variable</h2><div style=aspect-ratio:734/620 class="figure nocaption"><a href=/images/2015/01/auto-event-variable-1.jpg title="Auto-event variable"><img class=fig-img height=620 width=734 loading=lazy src=/images/2015/01/auto-event-variable-1.jpg#ZgotmplZ alt="Auto-event variable"></a></div><p><strong>Auto-Event variables</strong> are used to access the target element of an <a href=/analytics/auto-event-tracking-gtm-2-0/>auto-event action</a> (e.g. Click, Error, Form Submit). When you create a new Auto-Event variable, you need to specify just which component of the target element you want to access.</p><p><strong>Element</strong> - Accesses the DOM Element itself that was the target of the auto-event action. This element is stored under the key <code>gtm.element</code> in the Data Layer, and you can create your own, customized auto-event variables using the Data Layer variable, and traversing the <code>gtm.element</code> object as you would any other DOM element. For example, to get the value stored in the ID attribute of the auto-event element&rsquo;s parent, you&rsquo;d create a Data Layer variable which points to <code>gtm.element.parentElement.id</code>. <strong>Note</strong>: There are Built-In variables for this (Click Element and Form Element).</p><p><strong>Element Classes</strong> - Returns the value of the <code>class</code> attribute of the auto-event element. Stored in the Data Layer under the key <code>gtm.elementClasses</code>. <strong>Note</strong>: There are Built-In variables for this (Click Class and Form Class).</p><p><strong>Element ID</strong> - Returns the value of the <code>id</code> attribute of the auto-event element. Stored in the Data Layer under the key <code>gtm.elementId</code>. <strong>Note</strong>: There are Built-In variables for this (Click ID and Form ID).</p><p><strong>Element Target</strong> - Returns the value of the <code>target</code> attribute of the auto-event element. Stored in the Data Layer under the key <code>gtm.elementTarget</code>. <strong>Note</strong>: There are Built-In variables for this (Click Target and Form Target).</p><p><strong>Element Text</strong> - Returns the value of either the <code>textContent</code> or <code>innerText</code> property of the auto-event element. The return value is trimmed of whitespace and normalized to account for differences in how browsers interpret element text. <strong>Note</strong>: There are Built-In variables for this (Click Text and Form Text).</p><p><strong>Element URL</strong> - Returns the value of either the <code>href</code> or the <code>action</code> attribute of the auto-event element. You can further specify just which URL component you want to access (see the section for the URL variable type for more information). Stored in the Data Layer under the key <code>gtm.elementUrl</code>. <strong>Note</strong>: There are Built-In variables for this (Click URL and Form URL).</p><p><strong>History New URL Fragment</strong> - Returns the new URL fragment set with a browser history event. Stored in Data Layer under the key <em>gtm.newUrlFragment</em>. <strong>Note</strong>: There is a Built-In variable for this (New History Fragment).</p><p><strong>History Old URL Fragment</strong> - Returns the old URL fragment replaced in the browser history event. Stored in Data Layer under the key <em>gtm.oldUrlFragment</em>. <strong>Note</strong>: There is a Built-In variable for this (Old History Fragment).</p><p><strong>History New State</strong> - Returns the new state object set with a browser history event. Stored in Data Layer under the key <em>gtm.newHistoryState</em>. <strong>Note</strong>: There is a Built-In variable for this (New History State).</p><p><strong>History Old State</strong> - Returns the old state object replaced in the browser history event. Stored in Data Layer under the key <em>gtm.oldHistoryState</em>. <strong>Note</strong>: There is a Built-In variable for this (Old History State).</p><p><strong>History Change Source</strong> - Returns a string denoting the event that triggered the history change event (<em>popstate</em>, <em>pushState</em>, <em>replaceState</em>, or <em>polling</em>). Stored in Data Layer under the key <em>gtm.historyChangeSource</em>. <strong>Note</strong>: There is a Built-In variable for this (History Source).</p><p><strong>RETURNS</strong></p><p>The Auto-Event variable returns the value appropriate for the selected element type. If no relevant auto-event has been registered, the variable returns the <em>Default Value</em> (if set), or <em>undefined</em>.</p><p><strong>USE CASE(S)</strong></p><p>There are <em>many</em> use cases for the Auto-Event variable. To get you started, I suggest you take a look at the following articles:</p><ul><li><p><a href=/analytics/auto-event-tracking-gtm-2-0/>Auto-Event Tracking In GTM 2.0</a></p></li><li><p><a href=/analytics/form-tracking-google-tag-manager/>Advanced Form Tracking In Google Tag Manager</a></p></li><li><p><a href=/analytics/google-tag-manager-history-listener/>Google Tag Manager: The History Listener</a></p></li></ul><h2 id=9-dom-element>9. DOM Element</h2><div style=aspect-ratio:740/682 class="figure nocaption"><a href=/images/2015/01/dom-element-1.jpg title="DOM Element variable"><img class=fig-img height=682 width=740 loading=lazy src=/images/2015/01/dom-element-1.jpg#ZgotmplZ alt="DOM Element variable"></a></div><p>You can use the <strong>DOM Element</strong> variable to retrieve the text content of any given DOM Element. You can also use it to retrieve the value of any attribute of the DOM Element.</p><p><strong>RETURNS</strong></p><p>The text content of the given DOM Element, or the value of the given attribute (optional). If no DOM Element with the given ID or CSS selector is found, the variable returns the <em>null</em> value.</p><p><strong>USE CASE(S)</strong></p><p>You can use this to access any arbitrary DOM Element on the page. This becomes useful if you want to fire an event only if a certain element is on the page.</p><h2 id=10-element-visibility>10. Element Visibility</h2><div style=aspect-ratio:414/461 class="figure nocaption"><a href=/images/2015/01/element-visibility-variable.jpg title="Element Visibility variable"><img class=fig-img height=461 width=414 loading=lazy src=/images/2015/01/element-visibility-variable.jpg#ZgotmplZ alt="Element Visibility variable"></a></div><p>The <strong>Element Visibility</strong> variable lets you know if any particular element was <a href=/analytics/element-visibility-trigger-google-tag-manager/><em>visible</em></a> in the browser viewport when the trigger fired. Visibility requires that the element be positioned above the fold of the page in the active browser tab. In other words, the element must actually be <em>in sight</em> of the user. The only exception is if there is some other window in front of the browser window where the element is otherwise visible. In this case, GTM would consider the element to still be visible, even though it&rsquo;s not technically viewable by the user.</p><p><strong>RETURNS</strong></p><p>The variable returns either True / False indicating if the element was visible or not, respectively, or a percentage of how much of the element was visible when the variable was resolved. You can choose which output type to use in the settings of the variable.</p><p><strong>USE CASE(S)</strong></p><p>You can set the visibility variable to check an element with CSS selector <code>body</code>, and minimum 1 percent visible. This variable would then tell you if the page was visible in the viewport when the variable was called.</p><h2 id=11-constant>11. Constant</h2><div style=aspect-ratio:718/428 class="figure nocaption"><a href=/images/2015/01/constant-variable.jpg title="Constant variable"><img class=fig-img height=428 width=718 loading=lazy src=/images/2015/01/constant-variable.jpg#ZgotmplZ alt="Constant variable"></a></div><p>The <strong>Constant</strong> variable is a prime example of how variables are reusable. If you have any string of characters that you need to use often, or which you might need to update in the future, it&rsquo;s best to store it as a Constant variable instead.</p><p><strong>RETURNS</strong></p><p>The Constant variable returns the <em>string</em> you choose to type in the Value field.</p><p><strong>USE CASE(S)</strong></p><p>The obvious use case is your Google Analytics web property ID. By storing the UA-XXXXX-X code in the Constant variable, you won&rsquo;t need to look it up every single time you create a new GA tag.</p><h2 id=12-custom-event>12. Custom Event</h2><div style=aspect-ratio:464/344 class="figure nocaption"><a href=/images/2015/01/custom-event-1.jpg title="Custom Event variable"><img class=fig-img height=344 width=464 loading=lazy src=/images/2015/01/custom-event-1.jpg#ZgotmplZ alt="Custom Event variable"></a></div><p>The <strong>Custom Event</strong> variable returns the value of the &rsquo;event&rsquo; key in the Data Layer. For example, if you run the following code: <code>dataLayer.push({'event' : 'thisEvent'});</code>, then the Custom Event variable would hold the value &rsquo;thisEvent&rsquo; after the push. <strong>Note</strong>: There is a Built-In variable for this (Event).</p><p><strong>RETURNS</strong></p><p>The value stored in the &rsquo;event&rsquo; key in the Data Layer.</p><p><strong>USE CASE(S)</strong></p><p>Honestly, I can&rsquo;t figure out what this variable is for. If I had to guess, it&rsquo;s a remnant of the old GTM, where you could accidentally delete the <em>{{event}}</em> macro and then use the Custom Event macro to bring it back. In the new UI, there&rsquo;s a Built-In variable for Event, and at the time of writing there&rsquo;s also the internal variable _<em>event</em> which you can&rsquo;t delete or deactivate. So there really is no need to create a new Custom Event variable.</p><h2 id=13-environment-name>13. Environment Name</h2><div style=aspect-ratio:586/338 class="figure nocaption"><a href=/images/2015/01/environment-name.jpg title="Environment Name"><img class=fig-img height=338 width=586 loading=lazy src=/images/2015/01/environment-name.jpg#ZgotmplZ alt="Environment Name"></a></div><p>The <strong>Environment Name</strong> variable is similar to Custom Event in that it doesn&rsquo;t really add anything to GTM. There already is a Built-In variable for &ldquo;Environment Name&rdquo;, which you should use instead of creating this User-Defined variable.</p><p><strong>RETURNS</strong></p><p><em>String</em> with the current <a href=/analytics/better-qa-with-google-tag-manager-environments/>environment</a> name if using an environment snippet, or the draft version identifier if in Preview mode. It won&rsquo;t return anything for Live or Latest versions.</p><p><strong>USE CASE(S)</strong></p><p>Use it to fire tags only if in a certain environment. Remember to read my <a href=/analytics/better-qa-with-google-tag-manager-environments/>Environment Guide</a> while you&rsquo;re at it!</p><h2 id=14-google-analytics-settings>14. Google Analytics Settings</h2><div style=aspect-ratio:1770/1000 class="figure nocaption"><a href=/images/2015/01/google-analytics-settings.jpg title="Google Analytics Settings variable"><img class=fig-img height=1000 width=1770 loading=lazy src=/images/2015/01/google-analytics-settings.jpg#ZgotmplZ alt="Google Analytics Settings variable"></a></div><p>The <strong>Google Analytics Settings</strong> variable returns a set of Universal Analytics tag settings. This can be used to configure multiple tags at once, consolidating their Custom Dimensions and Fields to set, for example.</p><p>Note that the Google Analytics Settings variable can only be used in a Universal Analytics tag. You can&rsquo;t invoke the variable in other contexts.</p><p><strong>RETURNS</strong></p><p>A configuration of Google Analytics Settings to be used in a Universal Analytics tag.</p><p><strong>USE CASE(S)</strong></p><p>Use the Google Analytics Settings variable to consolidate tag settings across your Universal Analytics tags. For inspiration, read <a href=/analytics/google-analytics-settings-variable-in-gtm/>this article</a>.</p><h2 id=15-lookup-table>15. Lookup Table</h2><div style=aspect-ratio:1776/862 class="figure nocaption"><a href=/images/2015/01/lookup-table-variable-1.jpg title="Lookup Table variable"><img class=fig-img height=862 width=1776 loading=lazy src=/images/2015/01/lookup-table-variable-1.jpg#ZgotmplZ alt="Lookup Table variable"></a></div><p>The <strong>Lookup Table</strong> variable performs any number of lookups that you specify, returning the value of the first match. Since this is a <em>Lookup Table</em>, the value lookup is always exact match and case-sensitive. You can create your own, <a href=/analytics/simple-regex-lookup-table-for-google-tag-manager/>custom Lookup Table</a> if this is too strict for you.</p><p>The <em>Input variable</em> specifies the variable which will be used as the input in the lookups. On each row that you add to the table, you give an output value to be returned by the variable, if the input variable is matched with the Input field value of the row. You can <a href=/gtm-tips/chain-macros-lookup-tables/>chain Lookup Tables</a> together, creating a powerful, efficient, and flexible value lookup for your tags and variables.</p><p><strong>RETURNS</strong></p><p>The value in the Output field of the first row that is matched against the Input variable. You can also give a <em>Default Value</em> which will be returned if no match is made. If you don&rsquo;t specify a <em>Default Value</em>, the variable will return the <em>undefined</em> value if no match is made.</p><p><strong>USE CASE(S)</strong></p><p>Take a look at my original article for some ideas:</p><ul><li><a href=/analytics/google-tag-manager-lookup-table-macro/>Google Tag Manager: The Lookup Table Macro</a></li></ul><p>Bounteous has also a <a href=https://www.bounteous.com/insights/2014/11/20/gtm-lookup-table-upload/>really interesting guide</a> on automating the Lookup Table variable creation process.</p><h2 id=16-random-number>16. Random Number</h2><div style=aspect-ratio:652/338 class="figure nocaption"><a href=/images/2015/01/random-number.jpg title="Random Number"><img class=fig-img height=338 width=652 loading=lazy src=/images/2015/01/random-number.jpg#ZgotmplZ alt="Random Number"></a></div><p>The <strong>Random Number</strong> variable returns a random number between 0 and 2147483647. <strong>Note</strong>: There is a Built-In variable for this (Random Number).</p><p><strong>RETURNS</strong></p><p>A number, randomized between 0 and 2147483647.</p><p><strong>USE CASE(S)</strong></p><p>You can use the Random Number variable to <a href=/analytics/macro-magic-google-tag-manager/>sample your visitors</a>.</p><h2 id=17-regex-table>17. RegEx Table</h2><div style=aspect-ratio:891/558 class="figure nocaption"><a href=/images/2015/01/regex-table-variable.jpg title="RegEx Table variable"><img class=fig-img height=558 width=891 loading=lazy src=/images/2015/01/regex-table-variable.jpg#ZgotmplZ alt="RegEx Table variable"></a></div><p>The <strong>RegEx Table</strong> variable lets you create a pattern-matching table. It functions similarly to the Lookup Table, with the obvious difference that lookups are exact match only, whereas regular expressions are far more flexible in what you can match against. There are some other additional features in the RegEx Table, which you can read about <a href=/analytics/the-regex-table-variable-in-google-tag-manager/>here</a>.</p><p><strong>RETURNS</strong></p><p>Whatever you have defined in each individual Output field, and the Default Value field.</p><p><strong>USE CASE(S)</strong></p><p>You can use the RegEx Table with a Just Links trigger to determine what type of link was clicked. See the screenshot above for hints how to do this.</p><h2 id=18-container-id>18. Container ID</h2><div style=aspect-ratio:562/332 class="figure nocaption"><a href=/images/2015/01/container-id.jpg title="container id"><img class=fig-img height=332 width=562 loading=lazy src=/images/2015/01/container-id.jpg#ZgotmplZ alt="container id"></a></div><p>This is also a <strong>Built-In variable</strong>, so use that instead of creating a new User-Defined variable.</p><p><strong>RETURNS</strong></p><p>The public ID (GTM-XXXXXX) of the Container.</p><p><strong>USE CASE(S)</strong></p><p>This is important in <a href=/analytics/understanding-tag-sequencing-in-google-tag-manager/>tag sequencing</a>, as it&rsquo;s used to signal when a Custom HTML tag has finished completion. You should also send the Container ID as a Custom Dimension in your GTM hits - that way you can see in Google Analytics which hits were sent from which container.</p><h2 id=19-container-version-number>19. Container Version Number</h2><div style=aspect-ratio:644/318 class="figure nocaption"><a href=/images/2015/01/container-version-number-1.jpg title="Container Version Number"><img class=fig-img height=318 width=644 loading=lazy src=/images/2015/01/container-version-number-1.jpg#ZgotmplZ alt="Container Version Number"></a></div><p>This is pretty self-explanatory. The <strong>Container Version Number</strong> returns the version number of the container that is implemented on the site, or QUICK_PREVIEW if you are previewing the workspace draft.
<strong>Note</strong>: There is a Built-In variable for this (Container Version).</p><p><strong>RETURNS</strong></p><p><em>String</em> with the current GTM Container version number, or <em>QUICK_PREVIEW</em>, if the workspace draft is in preview mode.</p><p><strong>USE CASE(S)</strong></p><p>Assign a Google Analytics Custom Dimension for the container version ID, which will help you analyze the impact of changes various versions of the GTM container have had. This is a great way to debug your GTM and GA implementations.</p><h2 id=20-debug-mode>20. Debug Mode</h2><div style=aspect-ratio:596/356 class="figure nocaption"><a href=/images/2015/01/debug-mode-1.jpg title="Debug Mode variable"><img class=fig-img height=356 width=596 loading=lazy src=/images/2015/01/debug-mode-1.jpg#ZgotmplZ alt="Debug Mode variable"></a></div><p>The <strong>Debug Mode</strong> variable returns <code>true</code> if the user is viewing the container in Preview mode, and <code>false</code> if not. <strong>Note</strong>: There is a Built-In variable for this (Debug Mode).</p><p><strong>RETURNS</strong></p><p><em>true</em> when the user is in Container Debug mode, and <em>false</em> when not.</p><p><strong>USE CASE(S)</strong></p><p>With the Lookup Table variable, you can collect all your GA hits in Debug mode to a separate, test property. Read about this idea in my <a href=/analytics/macro-magic-google-tag-manager/>Macro Magic</a> article.</p><p>You can also send the Debug Mode value as a Custom Dimension, if you want to collect all hits to the same GA property. This way you can filter with the Custom Dimension and collect all your debug hits to a separate Google Analytics profile.</p><h2 id=summary>Summary</h2><p>I&rsquo;m bold enough to claim that once you understand variables, you can call yourself a Google Tag Master. It&rsquo;s not just what the different variable types are. It&rsquo;s how you use them together to create sense out of the complexity that almost any tag implementation brings in its wake.</p><p>Just remember to pay heed to the technical details as well. If you don&rsquo;t understand the process of how variables are resolved, you&rsquo;ll often run into unexpected situations. Most often it&rsquo;s a &lsquo;race condition&rsquo;, where the variable is trying to access some other data source which isn&rsquo;t ready yet.</p><p>Be respectful of the &rsquo;no side effects&rsquo; rule as well. Do not use variables for anything else except to build a well-formed <code>return</code> statement. If you feel like you need to increase the complexity of your function calls, use a Custom HTML tag instead.</p><p>Were you interested in some other aspect of variables that I didn&rsquo;t cover here? Or do you have a great use case in mind for some variable type? Sound off in the comments, thanks!</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">TAGGED IN</span><br><a class="tag tag--primary tag--small" href=/tags/google-tag-manager/>Google Tag Manager</a>
<a class="tag tag--primary tag--small" href=/tags/guide/>Guide</a>
<a class="tag tag--primary tag--small" href=/tags/macros/>macros</a>
<a class="tag tag--primary tag--small" href=/tags/variables/>variables</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/add-konami-code-to-your-site/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/track-content-enhanced-ecommerce/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=Variable%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/variable-guide-google-tag-manager/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div><a name=commento></a><comentario-comments></comentario-comments></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2026 Simo Ahava. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default" href=/gtm-tips/add-konami-code-to-your-site/><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">NEXT</span></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=/analytics/track-content-enhanced-ecommerce/><span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-facebook"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://twitter.com/intent/tweet?text=Variable%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/variable-guide-google-tag-manager/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i></a></li><li class="post-action hide-xs"><a class="post-action-btn btn btn--default" target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-linkedin"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#commento><i class="fa-regular fa-comments"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-search"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options><li class=share-option><a class=share-option-btn target=new href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://twitter.com/intent/tweet?text=Variable%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/variable-guide-google-tag-manager/%20via%20@SimoAhava"><i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span></a></li><li class=share-option><a class=share-option-btn target=new href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/variable-guide-google-tag-manager/"><i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span></a></li></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src=https://www.simoahava.com/images/simo.png alt="Author's picture"><h4 id=about-card-name>Simo Ahava</h4><div id=about-card-bio>Husband | Father | Analytics developer<br>simo (at) simoahava.com</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>Senior Data Advocate at Reaktor</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Finland</div></div></div><div id=cover style=background-image:url(https://www.simoahava.com/images/maisema.jpg)></div><script defer src=https://comentario.simoahava.com/comentario.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous referrerpolicy=no-referrer></script><script defer src=/js/script.js></script><script>!function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),n=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");e&&(n&&(e.style.display="none"),t&&t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"}))}()</script></body></html>