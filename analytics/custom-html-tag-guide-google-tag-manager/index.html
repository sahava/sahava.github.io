

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "The Custom HTML Tag Guide For Google Tag Manager | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2020\/01\/custom-html-tag-guide.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/custom-html-tag-guide-google-tag-manager\/",
  "datePublished": "2020-01-28T09:00:14\x2b02:00",
  "dateModified": "2020-01-28T09:00:14\x2b02:00",
  "description": "In this article, we talk about Custom HTML tags, and the opportunities they offer for dynamic element insertion with Google Tag Manager.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>The Custom HTML Tag Guide For Google Tag Manager | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/custom-html-tag-guide-google-tag-manager/">
    
    <meta name="description" content="In this article, we talk about Custom HTML tags, and the opportunities they offer for dynamic element insertion with Google Tag Manager.">
    <meta property="og:description" content="In this article, we talk about Custom HTML tags, and the opportunities they offer for dynamic element insertion with Google Tag Manager.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="The Custom HTML Tag Guide For Google Tag Manager">
    <meta property="og:url" content="https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="The Custom HTML Tag Guide For Google Tag Manager">
    <meta name="twitter:description" content="In this article, we talk about Custom HTML tags, and the opportunities they offer for dynamic element insertion with Google Tag Manager.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2020/01/custom-html-tag-guide.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2020/01/custom-html-tag-guide.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      The Custom HTML Tag Guide For Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2020-01-28T09:00:14&#43;02:00">
        
  January 28, 2020

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/#commento">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>One of the most prominent features of <a href="https://tagmanager.google.com/">Google Tag Manager</a> since the dawn of time (actually, late 2012) is the <strong>Custom HTML tag</strong>. This little piece of magic lets Google Tag Manager <em>inject</em> an HTML element to the page. Since time immemorial (still late 2012), it's allowed us to turn Google Tag Manager from a sandboxed prisoner of the native tag templates to a no-holds-barred client-side content management solution.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/custom-html-tag-guide.jpg" title="Custom HTML tag guide">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/custom-html-tag-guide.jpg#ZgotmplZ" alt="Custom HTML tag guide">
  
    </a>
  
  
</div>


<p>In this article, we'll discuss how the Custom HTML tag <strong>works</strong>, and what you might be tempted to use it for.</p>
<h2 id="the-custom-html-tag">The Custom HTML tag</h2>
<p>As the name implies, the Custom HTML tag lets you add <strong>HTML elements</strong> to the page.</p>
<p>Anything you type into the Custom HTML tag will be interpreted as HTML.</p>
<h3 id="adding-content-to-the-tag">Adding content to the tag</h3>
<p>Let's create a Custom HTML tag that looks like this:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/custom-html-tag-example.jpg" title="Custom HTML tag example">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/custom-html-tag-example.jpg#ZgotmplZ" alt="Custom HTML tag example">
  
    </a>
  
  
</div>


<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#1e90ff;font-weight:bold">script</span>&gt;
  console.log(<span style="color:#a50">&#39;Hello!&#39;</span>);
&lt;/<span style="color:#1e90ff;font-weight:bold">script</span>&gt;

&lt;<span style="color:#1e90ff;font-weight:bold">div</span>&gt;
  &lt;<span style="color:#1e90ff;font-weight:bold">span</span>&gt;Hello!&lt;/<span style="color:#1e90ff;font-weight:bold">span</span>&gt;
&lt;/<span style="color:#1e90ff;font-weight:bold">div</span>&gt;</code></pre></div>
<p>This tag adds <strong>three</strong> elements to the page: a <code>&lt;script&gt;</code> block compiled into and executed as JavaScript, a <code>div</code> block, and a <code>&lt;span&gt;</code> embedded in the <code>&lt;div&gt;</code>.</p>
<p>When you publish the container and take a look at the minified source of the container JavaScript (as we all do), here's what it looks like:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/html-minified.jpg" title="Custom HTML tag as a data object">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/html-minified.jpg#ZgotmplZ" alt="Custom HTML tag as a data object">
  
    </a>
  
  
</div>


<p>The reason your beautifully formatted tag looks like this is because the HTML is encoded - a wise step to take before any strings are evaluated into HTML elements.</p>
<blockquote>
<p>You might wonder what the <code>enableIframeMode</code> and <code>enableEditJsMacroBehavior</code> flags are - well, they're legacy features that are no longer visible in the UI. If you know your stuff, you can actually make them show up in the Custom HTML tag interface, but they won't do anything.</p>
</blockquote>
<p>So, you've now created a Custom HTML tag, and you've seen how the tag is added to the container library. But how does it end up on the page? And where?</p>
<h3 id="the-injection">The injection</h3>
<p>When it's time for Google Tag Manager to &ldquo;fire&rdquo; the Custom HTML tag, it goes through the following motions:</p>
<ol>
<li>A dummy <code>&lt;div&gt;</code> is created to which the encoded string representing your Custom HTML tag is added using the <code>.innerHTML</code> property.</li>
<li>This forces the browser to parse the encoded string as HTML, resulting in the tags you added to the Custom HTML tag to actually turn into HTML elements.</li>
<li>One by one, these elements are removed from the dummy <code>&lt;div&gt;</code> and passed for injection.</li>
<li>Upon injection, each element is added as the last child of the <code>document.body</code> element.</li>
</ol>
<p>There are some nuances to this process, such as how Google Tag Manager handles the <code>onHtmlSuccess</code> and <code>onHtmlFailure</code> callbacks in <a href="https://www.simoahava.com/analytics/understanding-tag-sequencing-in-google-tag-manager/">tag sequencing</a>, and how <code>&lt;script&gt;</code> elements are stripped of all custom attributes before injection. But overall, this is the process.</p>
<p>Now, what this essentially means is that anything you type into a Custom HTML tag is added to the end of <code>body</code>, whatever that is at the time of injection. Typically, this translates to: <strong>&ldquo;The bottom of the page&rdquo;</strong>, but this is not a given with today's fluid layouts.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/injected-code.jpg" title="Injected elements">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/injected-code.jpg#ZgotmplZ" alt="Injected elements">
  
    </a>
  
  
</div>


<p>One <strong>extremely important</strong> thing to keep in mind is that when you add a new element to the page you force a <strong>reflow</strong> of the content. Basically, the browser has to calculate again dimensions, positioning, layouts, and attributes of elements preceding, surrounding, and nested within the injected element.</p>
<p>This is not a painless operation. Each element you add compounds to the problem, and on <strong>single-page apps</strong> which might not reset the DOM between transitions, you could end up with hundreds of injected elements on the page, each hurting the performance in exponential increments.</p>
<p>We'll get to this in the summary, but just to foreshadow the conclusion:</p>
<p><strong>Avoid using Custom HTML tags unless it's absolutely necessary</strong>.</p>
<p>Yes, I do recognize the irony of such a disclaimer on this particular article.</p>
<h2 id="scenarios-for-custom-html-tags">Scenarios for Custom HTML tags</h2>
<p>Why use Custom HTML tags? Why use a tag management solution for element injection?</p>
<p>Great question! And one I don't have a hard-and-fast answer for. I'd say an abundance of Custom HTML tags in a container is symptomatic of one (or more) of the following things:</p>
<ol>
<li>You have use cases <strong>far too complicated</strong> for GTM's native tags or <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/">custom templates</a> to handle.</li>
<li>You have <strong>too little knowledge</strong> about GTM (or JavaScript) to know that some of your custom HTML tags could be replaced with native tags or custom templates.</li>
<li>You have an <strong>inflexible organization</strong>, where getting the web developers to add your customizations directly to the page templates (or other site code) is not an option.</li>
<li>You've found a <strong>cool thing</strong> online, and you want to quickly proof-of-concept it before passing it to the web developers for proper implementation.</li>
<li>You are <strong>drunk with power</strong> over what you can do on your site with Google Tag Manager, and no bald dude from Finland is going to stop you from doing it.</li>
</ol>
<p>It's your container - you are of course free to use it however you wish. But if scenarios (2) and (3) ring a bell, I strongly urge you to seek change to the status quo. Being ignorant about the intricacies of GTM and JavaScript can be counter-productive to the beneficial effects that these technologies enable. Similarly, working against the constraints set by your organization will cause more friction in the long run, and can lead to inflamed communication structures, a crappy site, and unstable data collection.</p>
<p>Having said all that, let's explore some of the scenarios where you might be tempted to use a Custom HTML tag!</p>
<h3 id="adding-an-element-to-a-particular-position-on-the-page">Adding an element to a particular position on the page</h3>
<p>The downside of the Custom HTML tag is that it injects the element to the end of <code>&lt;body&gt;</code>. But what use is that? If the element is a visual component (something that should be shown on the screen), then most likely the end of <code>&lt;body&gt;</code> is <strong>not</strong> where you want it to end up in.</p>
<p>To rectify this, you need to use <strong>JavaScript</strong> and its <a href="https://www.w3schools.com/js/js_htmldom_nodes.asp">DOM manipulation methods</a>.</p>
<p>The trick is to find some element that's <em>already</em> on the page, and then position the new element <em>relative</em> to that.</p>
<p>For example, let's say I want to add a little <em>subtitle</em> to this current page, so that it ends up looking like this:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/subtitle.jpg" title="Subtitle example">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/subtitle.jpg#ZgotmplZ" alt="Subtitle example">
  
    </a>
  
  
</div>


<p>Now, if I created a Custom HTML tag with just this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#1e90ff;font-weight:bold">h3</span>&gt;It&#39;s really cool - I promise!&lt;/<span style="color:#1e90ff;font-weight:bold">h3</span>&gt;</code></pre></div>
<p>The element would be added to the end of <code>&lt;body&gt;</code> and wouldn't look very good.</p>
<p>So, instead, I need to <strong>create a new element with JavaScript</strong>, and then <strong>position this new element relative to the title of the page</strong>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#1e90ff;font-weight:bold">script</span>&gt;
  (<span style="color:#00a">function</span>() {
    <span style="color:#aaa;font-style:italic">// Create a new H3 element
</span><span style="color:#aaa;font-style:italic"></span>    <span style="color:#00a">var</span> h3 = <span style="color:#0aa">document</span>.createElement(<span style="color:#a50">&#39;h3&#39;</span>);
    
    <span style="color:#aaa;font-style:italic">// Add the text content
</span><span style="color:#aaa;font-style:italic"></span>    h3.innerText = <span style="color:#a50">&#34;It&#39;s really cool - I promise!&#34;</span>;
    
    <span style="color:#aaa;font-style:italic">// Get the reference to the current heading
</span><span style="color:#aaa;font-style:italic"></span>    <span style="color:#00a">var</span> title = <span style="color:#0aa">document</span>.querySelector(<span style="color:#a50">&#39;h1&#39;</span>);
    
    <span style="color:#aaa;font-style:italic">// Inject the new element right after the H1
</span><span style="color:#aaa;font-style:italic"></span>    <span style="color:#00a">if</span> (title) {
      title.parentElement.insertBefore(h3, title.nextSibling);
    }
  })();
&lt;/<span style="color:#1e90ff;font-weight:bold">script</span>&gt;</code></pre></div>
<p>The end result? You can see it in the screenshot above.</p>
<p>There's a subtle irony here - you are using Custom HTML tag to <strong>create an element</strong> (the <code>&lt;script&gt;</code>) that <strong>creates an element</strong> (the <code>&lt;h3&gt;</code>). Yes, it would be cool if you could specify in a Custom HTML tag to where the element is inserted. Actually, it would be even cooler if there were a <strong>custom template</strong> that allows you to create elements with positioning options. That way you wouldn't need the invasive end-of-body script injection at all!</p>
<p>But I digress.</p>
<h3 id="adding-a-script-as-high-up-in-ltheadgt-as-possible">Adding a script &ldquo;as high up&rdquo; in &lt;head&gt; as possible</h3>
<p>This is somewhat related to the previous scenario, but it deserves its own treatment because of how often the scenario emerges.</p>
<p>Sometimes, a vendor instructs you to <strong>&ldquo;Place our script as HIGH UP in <code>&lt;head&gt;</code> as possible&rdquo;</strong>.</p>
<p>This is instructed because the vendor wants their script to fire <strong>as soon as possible</strong> on the page. The higher an element in <code>&lt;head&gt;</code>, the sooner the browser parses it as part of the page render.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/script-in-head.jpg" title="Fire script in head">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/script-in-head.jpg#ZgotmplZ" alt="Fire script in head">
  
    </a>
  
  
</div>


<p>However, this benefit is largely <strong>lost</strong> when using Google Tag Manager. When the Google Tag Manager library has loaded, it's typical that the parsing of <code>&lt;head&gt;</code> has already finished, and the browser is well into rendering the <code>&lt;body&gt;</code>. Because of this, trying to inject a script as high up in <code>&lt;head&gt;</code> as possible doesn't make any sense, and is actually <strong>detrimental</strong> to the intended end result.</p>
<p>Why? Because when you create a Custom HTML tag that then creates an element and injects it into <code>&lt;head&gt;</code>, the browser first needs to inject the Custom HTML tag (performance hit), and then it needs to create the new element (another performance hit), and finally it needs to inject the new element into <code>&lt;head&gt;</code> (performance hit).</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/script-injection.jpg" title="Proper script injection">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/script-injection.jpg#ZgotmplZ" alt="Proper script injection">
  
    </a>
  
  
</div>


<p>Instead - all you need to do is add the <code>&lt;script&gt;</code> directly to the Custom HTML tag. This way it will get inserted to the end of <code>&lt;body&gt;</code>, and the browser will execute it as soon as possible.</p>
<h3 id="load-vendor-javascript">Load vendor JavaScript</h3>
<p>In fact, let's continue the thought experiment from the previous scenario. Let's say you <strong>do</strong> have a vendor whose JavaScript you want to load on the site, and you've established that all you need to do is add the <code>&lt;script&gt;</code> element to the page with a Custom HTML tag.</p>
<p>My friend. <strong>Do not use a Custom HTML tag at all</strong>.</p>
<p>Instead, create a <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/#tag-template-walkthrough">custom tag template</a> that uses the <a href="https://developers.google.com/tag-manager/templates/api#injectscript"><code>injectScript</code> API</a> to load the library.</p>
<p>Custom templates are optimized to inject and load the JavaScript, and they introduce a <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/#permissions">permissions</a> and <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/#policies">policies</a> model for safe(r) injection.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/custom-template-injection.jpg" title="Custom Template injection">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/custom-template-injection.jpg#ZgotmplZ" alt="Custom Template injection">
  
    </a>
  
  
</div>


<p>Going forward, this will be the best way to proceed with <code>&lt;script&gt;</code> injection. It won't help you with some of the other scenarios, as the JavaScript sandbox of templates is extremely restricting. So if you want to add <a href="https://www.simoahava.com/analytics/custom-event-listeners-gtm/">custom event listeners</a>, for example, you'll still need ye olde Custom HTML tag.</p>
<h3 id="modify-user-experience">Modify user experience</h3>
<p>One of the things you might be tempted to do with Google Tag Manager's Custom HTML tags is <strong>modify the user experience</strong>. This could be adding something like a <strong>cookie banner</strong>, or maybe editing the <strong>styles</strong> on the page, or perhaps adding an <strong><code>&lt;iframe&gt;</code></strong> that loads some fancy widget to your ecommerce site.</p>
<p>I'd like to warn you of the perils of doing these things with Google Tag Manager.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/consent-popup-gtm.jpg" title="Consent pop-up Google Tag Manager">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/consent-popup-gtm.jpg#ZgotmplZ" alt="Consent pop-up Google Tag Manager">
  
    </a>
  
  
</div>


<p>First of all, <strong>Google Tag Manager</strong> can be blocked by browsers (e.g. <a href="https://www.brave.com/">Brave</a>) and by ad/content blockers. This is a rising trend (with browsers&rsquo; <a href="https://www.cookiestatus.com">tracking protections</a> reducing the need for separate ad blockers).</p>
<p>The second reason is that you are separating functionality and/or experience from the site itself. You're most likely relying on the positioning and selection of specific HTML elements to anchor your custom code. However, Google Tag Manager is <em>decoupled</em> from your site builds, and it's extremely perilous to <em>assume</em> that the site will stay unchanged.</p>
<p>Thus, if even a single selector in your <code>querySelector()</code> argument changes on the site, your custom-built code can stop working or, even worse, break something else on the site.</p>
<p>On top of these are the reasons related to performance that I've mentioned earlier in this article. Each dynamic element injection will exponentially degrade the page performance, leading to annoying things like your custom elements flickering in and out, to degraded data quality (when an iframe you dynamically modify has time to load before you make the changes), all the way to page-stuttering, user-experience-decimating slowness, especially on single-page apps.</p>
<p>So, please, do consider <strong>not</strong> using Google Tag Manager as a content management system.</p>
<h2 id="summary">Summary</h2>
<p>This was a brief foray into the magical world of Custom HTML tags.</p>
<p>If I could talk to the 2012 me, I would tell him to start considering the downsides of Custom HTML tags sooner, and stop getting drunk on Google Tag Manager's infinite capability for script injection and rather think about the whole organization, the whole site, and the whole context of the environment where GTM runs, before making hazardous decisions <em>just because</em>.</p>
<p>That being said, Custom HTML tags do have their use cases today. In fact, creating a click listener with a Custom HTML tag (<code>document.addEventListener()</code>) can actually be <strong>better</strong> than firing some custom code with Google Tag Manager's click triggers.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2020/01/click-listener.jpg" title="Click listener">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2020/01/click-listener.jpg#ZgotmplZ" alt="Click listener">
  
    </a>
  
  
</div>


<p>This is because a click trigger would fire the tag again and again (injecting it again and again) whenever the click trigger is a success. Whereas if you create your own little click listener in a Custom HTML tag and handle the repetitive task in the callback, you'll avoid the injection mayhem.</p>
<p>I also strongly vouch for the usefulness of Custom HTML tags for building proof-of-concepts. You can quickly try out different experiences and designs, and you can publish the changes for a sample of your visitors. If you're happy with the results, you can then propose these changes to be added to the site code proper.</p>
<p>Nevertheless, perhaps one day, I hope, <a href="https://www.simoahava.com/analytics/custom-templates-guide-for-google-tag-manager/">custom templates</a> will make Custom HTML tags obsolete.</p>
<p>As parting words, when using Custom HTML tags <em>especially</em> to inject code you've found online, a famous Russian proverb is not out of place:</p>
<p><strong>Trust, but verify</strong>.</p>
<p>If you don't understand what the code does, consult your friendly local web developer and ask them.</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/custom-html/">custom html</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cdnjs-hosted-libraries-template-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=The%20Custom%20HTML%20Tag%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://cdn.commento.io/js/commento.js"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/collect-isp-custom-dimension-google-analytics/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cdnjs-hosted-libraries-template-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=The%20Custom%20HTML%20Tag%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=The%20Custom%20HTML%20Tag%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/custom-html-tag-guide-google-tag-manager/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://cdn.commento.io/js/count.js"></script>


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

