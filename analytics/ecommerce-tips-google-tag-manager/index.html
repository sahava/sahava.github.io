

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "eCommerce Tips For Google Tag Manager | Simo Ahava's blog",
  "image": "https://www.simoahava.com/images/2014/09/ecommerce-process.png",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.simoahava.com/images/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/",
  "datePublished": "2014-10-06T07:10:27+00:00",
  "dateModified": "2014-10-06T07:10:27+00:00",
  "description": "Tips for setting up Google Analytics Ecommerce and Enhanced Ecommerce tracking via Google Tag Manager.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.31 with theme Tranquilpeak 0.4.3-BETA">
    <title>eCommerce Tips For Google Tag Manager | Simo Ahava's blog</title>
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZ7GMV9');</script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/ecommerce-tips-google-tag-manager/">
    
    <meta name="description" content="Tips for setting up Google Analytics Ecommerce and Enhanced Ecommerce tracking via Google Tag Manager.">
    <meta property="og:description" content="Tips for setting up Google Analytics Ecommerce and Enhanced Ecommerce tracking via Google Tag Manager.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="eCommerce Tips For Google Tag Manager">
    <meta property="og:url" content="/analytics/ecommerce-tips-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="eCommerce Tips For Google Tag Manager">
    <meta name="twitter:description" content="Tips for setting up Google Analytics Ecommerce and Enhanced Ecommerce tracking via Google Tag Manager.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2014/09/ecommerce-process.png">  
      <meta property="og:image" content="https://www.simoahava.com/images/2014/09/ecommerce-process.png">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      eCommerce Tips For Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2014-10-06T07:10:27Z">
        
  October 6, 2014

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              

<p>I&rsquo;ve noticed that <a href="https://support.google.com/tagmanager/answer/3002596?hl=en">setting up eCommerce</a> in <a href="http://www.google.com/tagmanager">Google Tag Manager</a> (and now the new <a href="https://developers.google.com/tag-manager/enhanced-ecommerce">Enhanced ecommerce</a>) is very difficult for many. I&rsquo;m sure part of the problem is that eCommerce is for many users the moment that GTM forces you to take steps in to the developer&rsquo;s domain, since it&rsquo;s obvious that you&rsquo;ll need to add some code to the web page.</p>

<p>This isn&rsquo;t a tutorial on how to do eCommerce in Google Tag Manager. To get started, you&rsquo;ll want to check out the official documentation. Sure, it might be inaccurate in places, and especially the translations are lacking, but <code>dataLayer</code> form and function is nicely described within.</p>

<p><a href="https://developers.google.com/tag-manager/enhanced-ecommerce">Enhanced Ecommerce (UA) Developer Guide</a>
<a href="https://support.google.com/tagmanager/answer/3002596?hl=en">Google Analytics Ecommerce</a></p>

<p>This article has tips and answers to some frequently asked questions around eCommerce. Hopefully they will help you understand how eCommerce and Google Tag Manager work together.</p>

<h2 id="the-process-in-a-nutshell">The process in a nutshell</h2>

<p>Here&rsquo;s how eCommerce and Google Tag Manager conspire to get you the all-important data of your web transactions.</p>

<ol>
<li><p>Your <strong>eCommerce platform</strong> and/or your <strong>Content Management Solution (CMS)</strong> render the source code</p></li>

<li><p>If the page includes transactional information, this source code must include all required details about the transaction in the <code>dataLayer</code> object</p></li>

<li><p>When the tag which carries the transaction to GA fires, it will look at the <code>dataLayer</code> object</p></li>

<li><p>If it finds all the required information within, it will send the transaction hit to GA</p></li>
</ol>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/09/ecommerce-process.png" title="The eCommerce process in Google Tag Manager">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2014/09/ecommerce-process.png#ZgotmplZ" alt="The eCommerce process in Google Tag Manager">
  
    </a>
  
  
</div>



<p>Most of the following chapters will shed more light on these points, but the key thing to remember is this:</p>

<p><strong>Your eCommerce and/or CMS platform do almost all the work in tracking your transactions.</strong></p>

<p>The backend solution, whether it&rsquo;s your CMS or a dedicated eCommerce platform such as <a href="http://www.magentocommerce.com/magento-connect/google-tag-manager-3.html">Magento</a>, or even a WordPress plugin (such as <a href="http://www.woothemes.com/woocommerce/">WooCommerce</a>), has to do the grunt work of populating the keys in the data layer.</p>

<p>With a Python-based application, the page template might look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    <span style="color:#e6db74">&#39;transactionId&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;{{ transactionId }}&#39;</span>,
});</code></pre></div>

<p>With PHP, it might look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    <span style="color:#e6db74">&#39;transactionId&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&lt;?php echo $transactionId ?&gt;&#39;</span>,
});</code></pre></div>

<p>With QBASIC, it might look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    <span style="color:#e6db74">&#39;transactionId&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;PRINT T$; GOTO END&#39;</span>
});</code></pre></div>

<p>OK, the QBASIC script was fictitious, I was trying to be funny. But nostalgia, right? Right?</p>

<p>So don&rsquo;t expect GTM to come up with values for these variables magically. You will need a developer to help you here, and you will need a cooperative backend platform.</p>

<p>Now, sometimes you might be tempted to scrape the DOM for eCommerce information. That means that you have some JavaScript in place which retrieves all the necessary transactional data from elements on the page, such as headings, body text, even image ALT texts.</p>

<p><em>This is not the recommended approach!</em></p>

<p>There are many, excellent reasons for decoupling semantic information (information with no inherent value to what is rendered in the browser document) from the presentational layer. This is what the data layer was invented for. I strongly suggest you avoid taking the seemingly easy path of scraping on-page elements, especially with business-critical transactional tags.</p>

<p>Note, however, that some aspects of Enhanced eCommerce as it stands today might actually benefit from a combination of DOM scraping and <code>dataLayer</code> utilization. We&rsquo;ll go over this later in the post.</p>

<p>Here are the actual tips:</p>

<ol>
<li><p>dataLayer before GTM</p></li>

<li><p>Use a custom event</p></li>

<li><p>Make sure all the data is there</p></li>

<li><p>Don&rsquo;t forget your JavaScript</p></li>

<li><p>Enhanced eCommerce is special</p></li>
</ol>

<p>And we&rsquo;ll wrap it up with a neat summary.</p>

<h2 id="datalayer-before-gtm">dataLayer before GTM</h2>

<p>This is a very common problem. The tag that carries your transaction information fires <strong>before</strong> the transaction data is in <code>dataLayer</code>. D&rsquo;uh!</p>

<p>When a tag fires, it has access to the <em>current state</em> of all variables in the global namespace. <code>dataLayer</code> is one of them. If <code>dataLayer</code> doesn&rsquo;t have the required variables on the moment that the transactional tag fires, you won&rsquo;t see data from that hit in GA.</p>

<p>Here&rsquo;s an example. This is what your normal eCommerce tag looks like:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/09/transaction-tag.png" title="transaction-tag">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2014/09/transaction-tag.png#ZgotmplZ" alt="transaction-tag">
  
    </a>
  
  
</div>



<p>As you can see, there are VERY few options to work with. You just set Track Type to Transaction, add a rule, and you&rsquo;re good to go.</p>

<p>The point is that this tag will fire as soon as the container snippet is loaded, i.e. when <a href="https://www.simoahava.com/analytics/container-snippet-gtm-secrets-revealed/">the container snippet</a> pushes <code>'event' : 'gtm.js'</code> into <code>dataLayer</code>. Because the tag looks into <code>dataLayer</code> for the transaction details, they have to be there by the time the tag fires!</p>

<p>Thus, this will work:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  window.<span style="color:#a6e22e">dataLayer</span> <span style="color:#f92672">=</span> window.<span style="color:#a6e22e">dataLayer</span> <span style="color:#f92672">||</span> [];
  <span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    <span style="color:#e6db74">&#39;transactionId&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;1234&#39;</span>,
    <span style="color:#e6db74">&#39;transactionAffiliation&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Acme Clothing&#39;</span>,
    <span style="color:#e6db74">&#39;transactionTotal&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">38.26</span>,
    <span style="color:#e6db74">&#39;transactionTax&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1.29</span>,
    <span style="color:#e6db74">&#39;transactionShipping&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5</span>,
    <span style="color:#e6db74">&#39;transactionProducts&#39;</span><span style="color:#f92672">:</span> [{
        <span style="color:#e6db74">&#39;sku&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;DD44&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;T-Shirt&#39;</span>,
        <span style="color:#e6db74">&#39;category&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">11.99</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
    },{
        <span style="color:#e6db74">&#39;sku&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;AA1243544&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Socks&#39;</span>,
        <span style="color:#e6db74">&#39;category&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">9.99</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
    }]
  });
&lt;/<span style="color:#f92672">script</span>&gt;
<span style="color:#75715e">&lt;!-- Google Tag Manager --&gt;</span>
&lt;<span style="color:#f92672">noscript</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//www.googletagmanager.com/ns.html?id=GTM-P8XR&#34;</span>
  <span style="color:#a6e22e">height</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;display:none;visibility:hidden&#34;</span>&gt;&lt;/<span style="color:#f92672">iframe</span>&gt;&lt;/<span style="color:#f92672">noscript</span>&gt;
&lt;<span style="color:#f92672">script</span>&gt;(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">w</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">s</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">i</span>){<span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>]<span style="color:#f92672">||</span>[];<span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>].<span style="color:#a6e22e">push</span>({<span style="color:#e6db74">&#39;gtm.start&#39;</span><span style="color:#f92672">:</span>
  <span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">getTime</span>(),<span style="color:#a6e22e">event</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;gtm.js&#39;</span>});<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#a6e22e">s</span>)[<span style="color:#ae81ff">0</span>],
  <span style="color:#a6e22e">j</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">createElement</span>(<span style="color:#a6e22e">s</span>),<span style="color:#a6e22e">dl</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span><span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;dataLayer&#39;</span><span style="color:#f92672">?</span><span style="color:#e6db74">&#39;&amp;l;=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">l</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;&#39;</span>;<span style="color:#a6e22e">j</span>.<span style="color:#66d9ef">async</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>;<span style="color:#a6e22e">j</span>.<span style="color:#a6e22e">src</span><span style="color:#f92672">=</span>
  <span style="color:#e6db74">&#39;//www.googletagmanager.com/gtm.js?id=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">i</span><span style="color:#f92672">+</span><span style="color:#a6e22e">dl</span>;<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">parentNode</span>.<span style="color:#a6e22e">insertBefore</span>(<span style="color:#a6e22e">j</span>,<span style="color:#a6e22e">f</span>);
  })(window,document,<span style="color:#e6db74">&#39;script&#39;</span>,<span style="color:#e6db74">&#39;dataLayer&#39;</span>,<span style="color:#e6db74">&#39;GTM-P8XR&#39;</span>);&lt;/<span style="color:#f92672">script</span>&gt;
<span style="color:#75715e">&lt;!-- End Google Tag Manager --&gt;</span></code></pre></div>

<p>As you can see, the data is <strong>before</strong> the container snippet, so the <code>dataLayer</code> object is populated with all the required variables by the time the tag fires.</p>

<p>However, this will NOT work:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Google Tag Manager --&gt;</span>;
&lt;<span style="color:#f92672">noscript</span>&gt;&lt;<span style="color:#f92672">iframe</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;//www.googletagmanager.com/ns.html?id=GTM-P8XR&#34;</span>
<span style="color:#a6e22e">height</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;display:none;visibility:hidden&#34;</span>&gt;&lt;/<span style="color:#f92672">iframe</span>&gt;&lt;/<span style="color:#f92672">noscript</span>&gt;
&lt;<span style="color:#f92672">script</span>&gt;(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">w</span>,<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">s</span>,<span style="color:#a6e22e">l</span>,<span style="color:#a6e22e">i</span>){<span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>]<span style="color:#f92672">=</span><span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>]<span style="color:#f92672">||</span>[];<span style="color:#a6e22e">w</span>[<span style="color:#a6e22e">l</span>].<span style="color:#a6e22e">push</span>({<span style="color:#e6db74">&#39;gtm.start&#39;</span><span style="color:#f92672">:</span>
<span style="color:#66d9ef">new</span> Date().<span style="color:#a6e22e">getTime</span>(),<span style="color:#a6e22e">event</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;gtm.js&#39;</span>});<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">f</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#a6e22e">s</span>)[<span style="color:#ae81ff">0</span>],
<span style="color:#a6e22e">j</span><span style="color:#f92672">=</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">createElement</span>(<span style="color:#a6e22e">s</span>),<span style="color:#a6e22e">dl</span><span style="color:#f92672">=</span><span style="color:#a6e22e">l</span><span style="color:#f92672">!=</span><span style="color:#e6db74">&#39;dataLayer&#39;</span><span style="color:#f92672">?</span><span style="color:#e6db74">&#39;&amp;l;=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">l</span><span style="color:#f92672">:</span><span style="color:#e6db74">&#39;&#39;</span>;<span style="color:#a6e22e">j</span>.<span style="color:#66d9ef">async</span><span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>;<span style="color:#a6e22e">j</span>.<span style="color:#a6e22e">src</span><span style="color:#f92672">=</span>
<span style="color:#e6db74">&#39;//www.googletagmanager.com/gtm.js?id=&#39;</span><span style="color:#f92672">+</span><span style="color:#a6e22e">i</span><span style="color:#f92672">+</span><span style="color:#a6e22e">dl</span>;<span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">parentNode</span>.<span style="color:#a6e22e">insertBefore</span>(<span style="color:#a6e22e">j</span>,<span style="color:#a6e22e">f</span>);
})(window,document,<span style="color:#e6db74">&#39;script&#39;</span>,<span style="color:#e6db74">&#39;dataLayer&#39;</span>,<span style="color:#e6db74">&#39;GTM-P8XR&#39;</span>);&lt;/<span style="color:#f92672">script</span>&gt;
<span style="color:#75715e">&lt;!-- End Google Tag Manager --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    <span style="color:#e6db74">&#39;transactionId&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;1234&#39;</span>,
    <span style="color:#e6db74">&#39;transactionAffiliation&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Acme Clothing&#39;</span>,
    <span style="color:#e6db74">&#39;transactionTotal&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">38.26</span>,
    <span style="color:#e6db74">&#39;transactionTax&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1.29</span>,
    <span style="color:#e6db74">&#39;transactionShipping&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">5</span>,
    <span style="color:#e6db74">&#39;transactionProducts&#39;</span><span style="color:#f92672">:</span> [{
        <span style="color:#e6db74">&#39;sku&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;DD44&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;T-Shirt&#39;</span>,
        <span style="color:#e6db74">&#39;category&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">11.99</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
    },{
        <span style="color:#e6db74">&#39;sku&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;AA1243544&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Socks&#39;</span>,
        <span style="color:#e6db74">&#39;category&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">9.99</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>
    }]
  });
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>This time, the transaction data is pushed <strong>after</strong> the container snippet has loaded, and there&rsquo;s a very strong possibility that the data is not rendered in <code>dataLayer</code> when the Transaction Tag fires.</p>

<p>The same applies to any data you might try to move in a Custom HTML Tag. The Custom HTML Tag fires at its earliest with <strong>{{event}} equals gtm.js</strong>, because that&rsquo;s the <a href="https://www.simoahava.com/gtm-tips/gtmtips-rules-nutshell/">earliest possible event</a> to fire your tags on. However, your transaction tag is ALSO firing on that event, meaning there&rsquo;s a possibility that your transaction tag will fire first, and thus won&rsquo;t find the transaction details in <code>dataLayer</code>. You can try to rectify this with Tag Priority, but in this case it would be better to look at the next tip.</p>

<h2 id="use-a-custom-event">Use a custom event</h2>

<p>If you can&rsquo;t push your data into <code>dataLayer</code> before <strong>{{event}} equals gtm.js</strong> fires, or if there&rsquo;s even the tiniest possibility that the data won&rsquo;t be rendered in time, you could just as well push a custom event of your own.</p>

<p>For example, if you&rsquo;re using a Custom HTML Tag to build your eCommerce <code>dataLayer</code>, add an &lsquo;event&rsquo; push in there, which you&rsquo;ll then use as the firing rule for your transactional tags:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
    ... <span style="color:#a6e22e">eCommerce</span> <span style="color:#a6e22e">properties</span> ...,
    <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;transactionComplete&#39;</span>
  });
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>Then your transactional tag needs to fire on <strong>{{event}} equals transactionComplete</strong>. This way you&rsquo;ll be 100 % certain that the data is in <code>dataLayer</code> by the time the tag fires, because the trigger event is pushed at the same times as the transactional data!</p>

<h2 id="make-sure-all-the-data-is-there">Make sure all the data is there</h2>

<p>The developer guides tell you exactly what variables are required. In traditional eCommerce, here&rsquo;s what your Transaction Tag will look for:</p>

<p><strong>Transaction ID</strong> - <code>transactionId</code>
<strong>Transaction Total</strong> - <code>transactionTotal</code>
<strong>Product Name</strong> - <code>name</code>
<strong>Product SKU</strong> - <code>sku</code>
<strong>Product Price</strong> - <code>price</code>
<strong>Product Quantity</strong> - <code>quantity</code></p>

<p>If any of these fields are missing from <code>dataLayer</code>, the Transaction Tag will not get sent.</p>

<p>Oh, and also: <code>transactionId</code> and <code>sku</code> need to be unique. If you have multiple transactions with the same ID, or if you have many products with the same SKU, your data will be skewed.</p>

<p>With Enhanced eCommerce, there are many more fields to observe, so be sure to read both the Google Tag Manager Developer Guide (linked to in the beginning of this post), as well as the general guide for <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-ecommerce">Enhanced eCommerce in Google Analytics</a>.</p>

<h2 id="don-t-forget-your-javascript">Don&rsquo;t forget your JavaScript</h2>

<p>We&rsquo;re in the developers&rsquo; domain here. Don&rsquo;t forget that. Here are some things you should check first if your tags are not firing:</p>

<p><strong>Each object key requires a value</strong> - If you want to omit a property from the push, either send it with an empty string, or drop it out of the push altogether. Don&rsquo;t send it without a value at all:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;purchase&#39;</span> <span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#39;actionField&#39;</span> <span style="color:#f92672">:</span> , <span style="color:#75715e">// WRONG! This key requires a value
</span><span style="color:#75715e"></span>      ...
});
<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;purchase&#39;</span> <span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#39;actionField&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;&#39;</span>, <span style="color:#75715e">// BETTER!
</span><span style="color:#75715e"></span>      ...
});</code></pre></div>

<p><strong>Know when to add a comma to the end of the line</strong> - If the properties are siblings of each other, that is, they have the same parent, then each line must end in a comma <strong>except</strong> the last line. Here&rsquo;s how it should go:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> { <span style="color:#75715e">// No comma, starts a new hierarchy
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;purchase&#39;</span> <span style="color:#f92672">:</span> { <span style="color:#75715e">// No comma, starts a new hierarchy
</span><span style="color:#75715e"></span>      <span style="color:#e6db74">&#39;actionField&#39;</span> <span style="color:#f92672">:</span> {<span style="color:#e6db74">&#39;list&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel Gallery&#39;</span>}, <span style="color:#75715e">// Comma, followed by a sibling
</span><span style="color:#75715e"></span>      <span style="color:#e6db74">&#39;products&#39;</span> <span style="color:#f92672">:</span> [{ <span style="color:#75715e">// No comma, starts a new hierarchy
</span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;product1&#39;</span>, <span style="color:#75715e">// Comma, followed by a sibling
</span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;12345&#39;</span> <span style="color:#75715e">// No comma, last member in current object
</span><span style="color:#75715e"></span>      },{ <span style="color:#75715e">// Comma, since there are two objects in this &#39;products&#39; Array 
</span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;product2&#39;</span>, <span style="color:#75715e">// Comma, followed by a sibling
</span><span style="color:#75715e"></span>        <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;23456&#39;</span> <span style="color:#75715e">// No comma, last member in current object
</span><span style="color:#75715e"></span>      }] <span style="color:#75715e">// No comma, last member in current object
</span><span style="color:#75715e"></span>    }  <span style="color:#75715e">// No comma, last member in current object
</span><span style="color:#75715e"></span>  }, <span style="color:#75715e">// Comma, followed by a sibling
</span><span style="color:#75715e"></span>  <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;transactionComplete&#39;</span> <span style="color:#75715e">// No comma, last member in current object
</span><span style="color:#75715e"></span>});  </code></pre></div>

<p><strong>Respect the type requirements</strong> - Let&rsquo;s first address the elephant in the room. Always, <em>always</em> remember to use a period as the decimal separator in a number, not a comma. When passing a numeric value, the comma can be horribly misinterpreted:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">...
<span style="color:#e6db74">&#39;price&#39;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">75</span>, <span style="color:#75715e">// WRONG!
</span><span style="color:#75715e"></span><span style="color:#e6db74">&#39;quantity&#39;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
...</code></pre></div>

<p>Here, the browser interprets the first comma as the property separator, and the <code>75,</code> that follows is not a syntactically valid key-value pair, and will result in an error. Here&rsquo;s how it should look:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">...
<span style="color:#e6db74">&#39;price&#39;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">33.75</span>,
<span style="color:#e6db74">&#39;quantity&#39;</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>
...</code></pre></div>

<p>Now the number is actually a number, with a period as the decimal separator.</p>

<p>With enhanced eCommerce, the type for price and other monetary values is confusingly <strong>Currency</strong>, which is not a JavaScript type, but just use a string with the decimal as the separator, e.g.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;currencyCode&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;EUR&#39;</span>, <span style="color:#75715e">// Local currency, type string
</span><span style="color:#75715e"></span>    <span style="color:#e6db74">&#39;impressions&#39;</span><span style="color:#f92672">:</span> [
     {
       <span style="color:#e6db74">&#39;name&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Triblend Android T-Shirt&#39;</span>, <span style="color:#75715e">// Name, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;id&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;12345&#39;</span>, <span style="color:#75715e">// ID, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;price&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;15.25&#39;</span>, <span style="color:#75715e">// Price, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;brand&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Google&#39;</span>, <span style="color:#75715e">// Brand, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;category&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Apparel&#39;</span>, <span style="color:#75715e">// Category, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;variant&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Gray&#39;</span>, <span style="color:#75715e">// Variant, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;list&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Search Results&#39;</span>, <span style="color:#75715e">// List, type string
</span><span style="color:#75715e"></span>       <span style="color:#e6db74">&#39;position&#39;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span> <span style="color:#75715e">// Position, type number
</span><span style="color:#75715e"></span>     }]
     ...</code></pre></div>

<p>So remember: respect the type requirements. A <code>number</code> is written as just the plain number, using a period as the decimal separator: <strong>15.35</strong>. No quotes there. A <code>string</code> is a combination of characters wrapped in single or double quotes: <strong>&rsquo;T-shirt&rsquo;</strong>.</p>

<h2 id="enhanced-ecommerce-is-special">Enhanced eCommerce is special</h2>

<p>I&rsquo;ve alluded to Enhanced eCommerce a couple of times already, but now it&rsquo;s time to tackle the beast. If you thought there was a lot of <code>dataLayer</code> this and JavaScript that in the previous tips, you&rsquo;re going to overload with all the development effort that Enhanced eCommerce requires.</p>

<p>Let&rsquo;s start with the obvious:</p>

<p><strong>You do not use the Transaction tag type for Enhanced eCommerce</strong>.</p>

<p>The Transaction tag is for traditional eCommerce, and as the <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-ecommerce">Enhanced eCommerce dev guide</a> clearly states:</p>

<p><em>&ldquo;Important: The Enhanced Ecommerce plug-in should not be used alongside the Ecommerce (ecommerce.js) plug-in for the same property.&rdquo;</em></p>

<p>So don&rsquo;t confuse the two. Enhanced eCommerce gives you a far more granular and funnel-like look at how visits progress in terms of your purchase funnel.</p>

<p>The thing is, with Enhanced eCommerce all hits are piggy-backed on top of existing tags, such as Pageview and Event. The key is to remember to set Enhanced eCommerce features on in the settings of your tags, AND to use <code>dataLayer</code> to carry the data through the tag to Google. Again, you will need to make sure that <code>dataLayer</code> is initialized with all the required data before the tags fire.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2014/10/enable-enhanced.png" title="Enable Enhanced eCommerce">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2014/10/enable-enhanced.png#ZgotmplZ" alt="Enable Enhanced eCommerce">
  
    </a>
  
  
</div>



<p>With Enhanced eCommerce, all the previous tips apply tenfold. That&rsquo;s because there are so many more variables to appreciate, so many more type requirements to observe, so many more ways to get the data flowing to GA.</p>

<p>Another important thing about the new feature is that any tag which has Enhanced eCommerce enabled will only process whatever was in the <strong>most recent</strong> &lsquo;ecommerce&rsquo; variable push to the <code>dataLayer</code>. So if you have, for example:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;impressions&#39;</span> <span style="color:#f92672">:</span> ...
  }
});
<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;detail&#39;</span> <span style="color:#f92672">:</span> ...
  }
});</code></pre></div>

<p>Only the latter push will be processed by your tag which fires on <strong>{{event}} equals gtm.js</strong>. This is because the &lsquo;ecommerce&rsquo; object is still processed with &ldquo;version 1&rdquo; of the data layer, where repeated pushes of the same object name are <strong>not</strong> merged. Thus each new push overwrites the previous value of the object. In any case, it&rsquo;s crucial that you take this into account. What it means, in practice, is:</p>

<p><strong>If you have many Enhanced eCommerce actions / items you need to send in a single tag, you must combine them in a single <code>dataLayer.push()</code>!</strong></p>

<p>Needless to say, it will be practically impossible to implement eCommerce with the new features <em>without</em> involving your developers. After all, you are combining on-page actions (clicks, impressions) with the information in <code>dataLayer</code>. Even on the best of days, those two don&rsquo;t mix well.</p>

<p>Here are some general tips for Enhanced eCommerce:</p>

<ul>
<li><p><code>dataLayer</code> has a maximum length of 300 items. A search page on a large web store can have hundreds and hundreds of products, especially if you utilize lazy load methods, or something similar. So try to populate <code>dataLayer</code> with as much information pre-load as possible, and refrain from dynamically adding data into the structure.</p></li>

<li><p>Sometimes the page elements might be dynamic. For example, you might need to account for sorting the items according to different criteria, or the same item might be in different categories, depending on what sort methods the user has chosen. In those cases you might need to scrape Page Category, for example, from the DOM, and push it into the product listing in the data model. Be sure to read <a href="https://www.simoahava.com/analytics/google-tag-manager-data-model/">this guide</a> for information how to update existing products in GTM&rsquo;s data layer.</p></li>

<li><p>Start small and scale up, if the task seems too big to comprehend. Start with tracking the shopping cart, checkout funnel, and purchases. Next plan and implement the path from product impression, to product click, to product detail view. Finally, work yourself around promotions, campaigns, and refunds, if you wish.</p></li>

<li><p>If you want to send multiple items using a single Enhanced eCommerce enabled GTM tag, you need to combine the items into a single push. Only the most recent <code>dataLayer.push()</code> with the &lsquo;ecommerce&rsquo; key is processed by your Enhanced eCommerce enabled GTM tag! An even better practice is to always include an &lsquo;event&rsquo; key in your post-container-snippet pushes, and use this &lsquo;event&rsquo; key to fire your tag with every single &lsquo;ecommerce&rsquo; push to <code>dataLayer</code>.</p></li>
</ul>

<h2 id="summary">Summary</h2>

<p>The trouble with eCommerce is that it&rsquo;s so deep in the developers&rsquo; domain, but it involves a tool mainly directed at marketers. Naturally, this demands that communication between the technical and the non-technical stakeholders must flow naturally.</p>

<p>Biggest problems occur when the developers do not understand eCommerce, its purposes, or how transactional information is passed through <code>dataLayer</code> into the analytics platform. Also, sometimes non-developers want to tackle eCommerce on their own, because they&rsquo;ve had success with the TMS thus far, and soon they&rsquo;ve bitten more than they can chew.</p>

<p>The truth is that eCommerce requires a lot of knowledge transfer between the people who plan and the people who implement. Otherwise simple problems like failure to appreciate JavaScript type requirements, or what product details need to be represented in <code>dataLayer</code>, will cause errors.</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/ecommerce/">ecommerce</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/enhanced-ecommerce/">enhanced ecommerce</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/guide/">Guide</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/datalayer-declaration-vs-push/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/hitcallback-eventcallback/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=eCommerce%20Tips%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/datalayer-declaration-vs-push/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/hitcallback-eventcallback/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=eCommerce%20Tips%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/ecommerce-tips-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%25!s%28BADINDEX%29">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fwww.simoahava.com%2Fanalytics%2Fecommerce-tips-google-tag-manager%2F%20%25!s%28BADINDEX%29%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%25!s%28BADINDEX%29">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=%25!s%28BADINDEX%29">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

