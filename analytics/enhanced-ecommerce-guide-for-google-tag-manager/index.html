

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Enhanced Ecommerce Guide For Google Tag Manager | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2018\/09\/enhanced-ecommerce-guide-for-google-tag-manager.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/enhanced-ecommerce-guide-for-google-tag-manager\/",
  "datePublished": "2018-09-19T08:35:17\u002b03:00",
  "dateModified": "2018-09-19T08:35:17\u002b03:00",
  "description": "Guide to Google Analytics\u0027 Enhanced Ecommerce, and how to implement it using Google Tag Manager.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Enhanced Ecommerce Guide For Google Tag Manager | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article', environment:  null });
    </script>
    

    
    
    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://sgtm.simoahava.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
    
    <meta name="description" content="Guide to Google Analytics&#39; Enhanced Ecommerce, and how to implement it using Google Tag Manager.">
    <meta property="og:description" content="Guide to Google Analytics&#39; Enhanced Ecommerce, and how to implement it using Google Tag Manager.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Enhanced Ecommerce Guide For Google Tag Manager">
    <meta property="og:url" content="https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Enhanced Ecommerce Guide For Google Tag Manager">
    <meta name="twitter:description" content="Guide to Google Analytics&#39; Enhanced Ecommerce, and how to implement it using Google Tag Manager.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2018/09/enhanced-ecommerce-guide-for-google-tag-manager.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2018/09/enhanced-ecommerce-guide-for-google-tag-manager.jpg">
    


    

      
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
      
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    
    <div id="_progress"></div>
    
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener ">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/newsletter/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bell"></i>
      
      <span class="sidebar-button-desc">Newsletter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://mastodon.social/@ahava" target="_blank" rel="noopener me">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
      
      <span class="sidebar-button-desc">Mastodon</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          <div class="post-header main-content-wrap text-left">
  
  

    <h1>
      Enhanced Ecommerce Guide For Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2018-09-19T08:35:17&#43;03:00">
        
  September 19, 2018

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


      | <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/#commento">Comments</a>
      
  </div>


</div>

          <div class="post-content markdown">
            <div class="main-content-wrap">
	      
                
  	        <p><a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-ecommerce">Enhanced Ecommerce</a> is certainly one of the finest reporting user interface features that <a href="https://analytics.google.com">Google Analytics</a> has to offer. Enhanced Ecommerce, as the name implies, is a set of dimensions, metrics, and reports, which combine to provide you with a fairly complete view into how users are interacting with your products in your webstore. The main downside of Enhanced Ecommerce is, as with all good things, that it&rsquo;s complicated to implement.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/enhanced-ecommerce-guide-for-google-tag-manager.jpg" title="enhanced ecommerce guide for google tag manager">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/enhanced-ecommerce-guide-for-google-tag-manager.jpg#ZgotmplZ" alt="enhanced ecommerce guide for google tag manager" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1006 443'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Luckily, there&rsquo;s <a href="https://tagmanager.google.com/">Google Tag Manager</a>. Theoretically, you could implement Enhanced Ecommerce through Google Tag Manager without ever adding a single line of functional logic into the codebase of your web site. You could do everything by simply <a href="#a-word-on-scraping-the-dom"><em>scraping</em> the Document Object Model</a> (DOM). However, as we have hopefully learned over the years - GTM is a tool with which fastidiousness trumps fast.</p>
<p>Whenever you&rsquo;re working with <code>dataLayer</code>, for example, you&rsquo;re investing into the stability of your data collection process. Thus, even though I will be talking about DOM scraping <a href="#a-word-on-scraping-the-dom">further on</a> in the guide, the focus here will be on a setup where the <strong>front-end</strong> produces HTML documents and/or JavaScript that populates the Ecommerce values into the <code>dataLayer</code> without using DOM scraping or other client-side hacks to do the job.</p>
<p>There is a lot of information in this article. Much of it is already covered in Google&rsquo;s excellent <a href="https://developers.google.com/tag-manager/enhanced-ecommerce">Enhanced Ecommerce Developer Guide</a>, but there are plenty of <em>gotchas</em> that I might have covered in earlier articles (see the <a href="#further-reading">Further Reading</a> chapter), or which I might not even have written down before.</p>
<blockquote>
<p><strong>NOTE!</strong> This is an <strong>implementation</strong> guide. If you want to know how Enhanced Ecommerce works or how to map your site into relevant interactions, you&rsquo;ll want to look at Google&rsquo;s <a href="https://support.google.com/analytics/answer/6014841?hl=en">support center documentation</a>.</p>
</blockquote>
<div id="toc-container"><h1 id="table-of-contents">Table of Contents</h1> <input type="checkbox" id="show"><label for="show" id="showbtn"><h1 id="table-of-contents-mobile">Table of Contents</h1><span class="show">&nbsp;[+show]</span><span class="hide">&nbsp;[–hide]</span></label><nav id="TableOfContents">
  <ul>
    <li><a href="#how-to-read-this-guide">How to read this guide</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#differences-and-similarities-to-standard-ecommerce">Differences (and similarities) to Standard Ecommerce</a></li>
    <li><a href="#implementation-guidelines">Implementation guidelines</a>
      <ul>
        <li><a href="#populate-the-data-layer">Populate the Data Layer</a></li>
        <li><a href="#send-the-data-to-google-analytics-using-the-data-layer">Send the data to Google Analytics using the Data Layer</a></li>
        <li><a href="#send-the-data-to-google-analytics-using-a-custom-javascript-variable">Send the data to Google Analytics using a Custom JavaScript variable</a></li>
        <li><a href="#page-view-or-event-tag">Page View or Event tag</a></li>
        <li><a href="#a-word-on-scraping-the-dom">A word on scraping the DOM</a></li>
        <li><a href="#combining-different-data-types-in-a-single-eec-hit">Combining different data types in a single EEC hit</a></li>
        <li><a href="#product-scoped-custom-dimensions-and-metrics">Product-scoped Custom Dimensions and Metrics</a></li>
        <li><a href="#the-product-list">The Product List</a></li>
        <li><a href="#local-currency">Local Currency</a></li>
      </ul>
    </li>
    <li><a href="#remember-be-consistent">Remember: be consistent</a></li>
    <li><a href="#data-types-actions">Data types: Actions</a>
      <ul>
        <li><a href="#product-detail-views">Product Detail Views</a>
          <ul>
            <li><a href="#data-layer-composition">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#add-to-cart">Add to Cart</a>
          <ul>
            <li><a href="#data-layer-composition-1">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-1">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#remove-from-cart">Remove from Cart</a>
          <ul>
            <li><a href="#data-layer-composition-2">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-2">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#checkout">Checkout</a>
          <ul>
            <li><a href="#data-layer-composition-3">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-3">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#checkout-option">Checkout option</a>
          <ul>
            <li><a href="#data-layer-composition-4">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-4">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#purchase">Purchase</a>
          <ul>
            <li><a href="#data-layer-composition-5">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-5">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#refund">Refund</a>
          <ul>
            <li><a href="#data-layer-composition-6">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-6">Tag configuration example</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#data-types-impressions">Data types: Impressions</a>
      <ul>
        <li><a href="#impression-views">Impression Views</a>
          <ul>
            <li><a href="#data-layer-composition-7">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-7">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#impression-clicks">Impression Clicks</a>
          <ul>
            <li><a href="#data-layer-composition-8">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-8">Tag configuration example</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#data-types-promotions">Data types: Promotions</a>
      <ul>
        <li><a href="#promotion-views">Promotion Views</a>
          <ul>
            <li><a href="#data-layer-composition-9">Data Layer composition</a></li>
            <li><a href="#tag-configuration-example-9">Tag configuration example</a></li>
          </ul>
        </li>
        <li><a href="#promotion-clicks">Promotion Clicks</a>
          <ul>
            <li><a href="#tag-configuration-example-10">Tag configuration example</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#debugging-the-setup">Debugging the setup</a>
      <ul>
        <li><a href="#preview-mode">Preview mode</a></li>
        <li><a href="#google-analytics-debugger-and-chrome-devtools">Google Analytics Debugger and Chrome DevTools</a></li>
      </ul>
    </li>
    <li><a href="#golden-rules-of-enhanced-ecommerce">Golden rules of Enhanced Ecommerce</a>
      <ul>
        <li><a href="#do-whatever-you-want">Do whatever you want</a></li>
        <li><a href="#the-purchase-action-is-most-important">The Purchase action is most important</a></li>
        <li><a href="#only-one-action-per-hit">Only one action per hit</a></li>
        <li><a href="#include-all-the-necessary-details-in-every-hit">Include all the necessary details in every hit</a></li>
        <li><a href="#there-is-some-attribution">There is some attribution</a></li>
        <li><a href="#be-wary-of-the-payload-size-limit">Be wary of the payload size limit</a></li>
      </ul>
    </li>
    <li><a href="#further-reading">Further reading</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav></div>

                <span class="simmer">
  <span class="close">X</span>
  <p>
    <span class="fa fa-md fa-bell"></span>
    <strong>The Simmer Newsletter</strong>
  </p>
  <p>
    Subscribe to the <a href="https://www.simoahava.com/newsletter/">Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!
  </p>
  </span>

                
                  <h2 id="how-to-read-this-guide">How to read this guide</h2>
<p>Obviously, it would make sense if you read the guide from top-to-bottom. However, I fully acquiesce that the loquaciousness of my rhetoric might be tedious to some in all its verbose glory. Also, sometimes I write douchy things like that.</p>
<p>So, depending on what your role is in the implementation project, there might be only some chapters that are relevant for you. However, don&rsquo;t neglect to consult with all the stakeholders in the project! It doesn&rsquo;t make sense for a developer to write code without understanding what the code is needed for. Similarly, it doesn&rsquo;t make sense for the person operating Google Tag Manager to utilize the <code>dataLayer</code> structures without understanding the limitations of the back-end or front-end systems.</p>
<blockquote>
<p><strong>If you are a developer, tasked with implementing the <code>dataLayer</code> objects</strong>, you&rsquo;ll want to read the following chapters (in order):</p>
</blockquote>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#populate-the-data-layer">Populate the Data Layer</a></li>
<li><a href="#a-word-on-scraping-the-dom">A word on scraping the DOM</a></li>
<li><a href="#combining-different-data-types-in-a-single-eec-hit">Combining different data types in a single EEC hit</a></li>
<li><a href="#product-scoped-custom-dimensions-and-metrics">Product-scoped Custom Dimensions and Metrics</a></li>
<li><a href="#remember-be-consistent">Remember: be consistent</a></li>
<li><a href="#data-types-actions">Data types: Actions</a> and all its sub-sections</li>
<li><a href="#data-types-impressions">Data types: Impressions</a> and all its sub-sections</li>
<li><a href="#data-types-promotions">Data types: Promotions</a> and all its sub-sections</li>
</ol>
<blockquote>
<p><strong>If you are the person tasked with setting up EEC via the Google Tag Manager User Interface</strong>, you&rsquo;ll want to focus on the following chapters (in order):</p>
</blockquote>
<ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#differences-and-similarities-to-standard-ecommerce">Differences (and similarities) to Standard Ecommerce</a></li>
<li><a href="#send-the-data-to-google-analytics-using-the-data-layer">Send the data to Google Analytics using the Data Layer</a></li>
<li><a href="#send-the-data-to-google-analytics-using-a-custom-javascript-variable">Send the data to Google Analytics using a Custom JavaScript variable</a></li>
<li><a href="#page-view-or-event-tag">Page View or Event tag</a></li>
<li><a href="#data-types-actions">Data types: Actions</a> and all its sub-sections</li>
<li><a href="#data-types-impressions">Data types: Impressions</a> and all its sub-sections</li>
<li><a href="#data-types-promotions">Data types: Promotions</a> and all its sub-sections</li>
<li><a href="#debugging-the-setup">Debugging the setup</a></li>
<li><a href="#golden-rules-of-enhanced-ecommerce">Golden rules of Enhanced Ecommerce</a></li>
</ol>
<p>As I said, I still wish you&rsquo;d spend the time reading the entire guide. I don&rsquo;t think there&rsquo;s any irrelevant information to anyone working on the project, and it makes sense to understand the full complexity of the implementation rather than focus only on the things that are directly relevant to your work.</p>

                
                  <h2 id="introduction">Introduction</h2>
<p>Implementing Enhanced Ecommerce requires an overview of the following components:</p>
<ul>
<li>
<p>The various <strong>data types</strong> that can be sent to GA (<a href="#data-types-actions"><strong>Actions</strong></a>, <a href="#impression-views"><strong>Impression Views</strong></a>, <a href="#promotion-views"><strong>Promotion Views</strong></a>).</p>
</li>
<li>
<p>How the <code>'ecommerce'</code> object is compiled and <a href="#send-the-data-to-google-analytics-using-the-data-layer">pushed to <code>dataLayer</code></a> (or generated with a <a href="#send-the-data-to-google-analytics-using-a-custom-javascript-variable">Custom JavaScript variable</a>).</p>
</li>
<li>
<p>How this data is sent with <a href="#page-view-or-event-tag">a tag</a> to Google Analytics.</p>
</li>
</ul>
<p>All three of these components are necessary, and all three require some understanding of how Google Tag Manager works, how tags and triggers interact with <code>dataLayer</code>, and how the Enhanced Ecommerce data is sent to Google Analytics. These will all be covered in this guide.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/implementation-process.jpg" title="Implementation process">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/implementation-process.jpg#ZgotmplZ" alt="Implementation process" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 966 410'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Needless to say, if you want a <strong>robust</strong> implementation, interaction and co-operation with your site&rsquo;s front-end developers is <strong>an absolute must</strong>. Typically, the front-end developers utilize page templates and server-side variables (using <strong>PHP</strong> or <strong>React.js</strong>, for example) to build the HTML structure of any given page. On Enhanced Ecommerce pages, it&rsquo;s important that they integrate the front-end with whatever ecommerce system you have in use, so that this system produces the necessary values dynamically for the front-end developers to funnel through into the <code>dataLayer</code>.</p>
<p>For interactions that take place after the page load, such as cart interactions, the front-end developers might need update the site JavaScript to populate the <code>dataLayer</code> object with the necessary values in the client.</p>
<p>Or you can just throw caution to the wind and <a href="#a-word-on-scraping-the-dom">scrape everything off the HTML itself</a> through Google Tag Manager. The purpose of this guide isn&rsquo;t to recommend any specific course of action, but to highlight the different ways in which you can run the Enhanced Ecommerce implementation project.</p>

                
                  <h2 id="differences-and-similarities-to-standard-ecommerce">Differences (and similarities) to Standard Ecommerce</h2>
<p>If you&rsquo;ve been running <a href="https://support.google.com/tagmanager/answer/6107169?hl=en">Standard Ecommerce</a> through Google Tag Manager, there are mainly <strong>three</strong> major differences between that and Enhanced Ecommerce.</p>
<ul>
<li>
<p><strong>Standard Ecommerce</strong> only collects transactions (i.e. &ldquo;Purchase&rdquo; hits in EEC) - there are no other components to its funnel (in fact, there is no funnel).</p>
</li>
<li>
<p><strong>Standard Ecommerce</strong> uses a different <code>category</code> format.</p>
</li>
<li>
<p><strong>Standard Ecommerce</strong> doesn&rsquo;t support <a href="https://www.simoahava.com/gtm-tips/product-scoped-custom-dimensions-and-metrics/">Product-scoped Custom Dimensions and Metrics</a>.</p>
</li>
</ul>
<p>One thing to pay heed to is that <strong>you can collect both Standard Ecommerce and Enhanced Ecommerce hits</strong> to an Enhanced Ecommerce -enabled Google Analytics view! This means that if you leave your &ldquo;old&rdquo; tracking in place and run an Enhanced Ecommerce implementation in parallel, you might end up <strong>double-counting</strong> transactions.</p>
<p>Google Analytics <em>does</em> deduplicate identical transactions sent in a session, but it&rsquo;s enough for some component in the two different tracking methods to differ for GA to collect the data twice.</p>
<p><strong>Product Category</strong> is collected to a different dimension, depending on which method you are using. So if you populate the <code>category</code> key for a product using either method, the dimension you&rsquo;re looking for in GA is going to be different.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/product-category-dimensions.jpg" title="Product Category Dimensions">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/product-category-dimensions.jpg#ZgotmplZ" alt="Product Category Dimensions" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 648 209'%3E%3C/svg%3E">
  
    </a>
  
  
</div>



                
                  <h2 id="implementation-guidelines">Implementation guidelines</h2>
<p>The following chapters will cover certain aspects of an Enhanced Ecommerce implementation. As I stated in the <a href="#introduction">Introduction</a>, how the values are populated into <code>dataLayer</code> depend on the integration between your site&rsquo;s front-end and the Ecommerce platform you use. Some platforms such as WooCommerce for WordPress introduce this integration using a <a href="https://gtm4wp.com/how-to-articles/how-to-setup-enhanced-ecommerce-tracking">plugin</a>, others such as Magento provide it out-of-the-box as a <a href="https://docs.magento.com/m1/ee/user_guide/marketing/google-tag-manager.html">feature</a>.</p>
<p>However, there are plenty of custom Ecommerce platforms and setups out there which require tinkering for them to produce the values into variables that your front-end developers can then utilize.</p>
<p>The next chapter, for example, simply instructs what the generic <code>dataLayer</code> object needs to look like. How you end up populating the values into the required keys is up to you, but typically it&rsquo;s done in one of the following ways:</p>
<ol>
<li>
<p>The <code>dataLayer.push()</code> is written directly into the page template by whatever server-side mechanism you have for producing the templates.</p>
</li>
<li>
<p>The <code>dataLayer.push()</code> is generated dynamically by your web server or the Ecommerce platform using typically a combination of JavaScript and HTTP requests.</p>
</li>
<li>
<p>The key-value pairs are populated by scraping the page HTML using Google Tag Manager.</p>
</li>
</ol>
<h3 id="populate-the-data-layer">Populate the Data Layer</h3>
<p>Enhanced Ecommerce requires a <strong>specific syntax</strong> for the objects pushed to <code>dataLayer</code> or generated with a Custom JavaScript variable. For example, a <code>dataLayer.push()</code> with the minimum required Ecommerce object for a <a href="#purchase">Purchase</a> looks like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.purchase&#39;</span>,
  ecommerce: {
    purchase: {
      actionField: {
        id: <span style="color:#a50">&#39;1&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;p&#39;</span>
      }]
    }
  }
});
</code></pre></div>
<p>Do note that <strong>Google Tag Manager only reacts to <code>dataLayer.push()</code> commands</strong>. No other array methods will do anything in GTM, so it&rsquo;s imperative that you do not improvise with this. All the interactions with <code>dataLayer</code> must be done with <code>push()</code>.</p>
<p>Within the push, all the keys listed under and including <code>ecommerce</code> are required. The <code>event</code> key is something I <a href="https://www.simoahava.com/gtm-tips/add-the-event-key-to-datalayer-pushes/">strongly recommend</a> to add to every single <code>dataLayer.push()</code> object.</p>
<p>Now, you will need to populate the keys in the object with relevant values. For example, the value for <code>ecommerce.purchase.actionField.id</code> would need to be a unique identifier of the order itself. You could generate one randomly using JavaScript, but typically you&rsquo;ll want to use the <strong>same</strong> order ID that was included in the actual transaction. That way you can later augment details about this transaction using <a href="https://support.google.com/analytics/answer/3191589?hl=en">Data Import</a>, for example.</p>
<p>Similarly, you&rsquo;ll need to collect details about the products in the transaction, and send any variant, brand, and category information as metadata, too.</p>
<p>How you do this really depends on what the integration to your Ecommerce system is like. It&rsquo;s impossible to give generic instructions, because each Ecommerce platform differs in how it provides the values for you to exploit in other on-site code. But if you already have an Ecommerce system in place, I recommend you read through its documentation and try to find out how you can request or access these values and variables from this system.</p>
<h3 id="send-the-data-to-google-analytics-using-the-data-layer">Send the data to Google Analytics using the Data Layer</h3>
<p>When you select the <strong>Use data layer</strong> option in the Enhanced Ecommerce settings of a Google Analytics Page View or Event tag (or a <a href="https://www.simoahava.com/analytics/google-analytics-settings-variable-in-gtm/">Google Analytics Settings variable</a>), you instruct the tag to look into the Data Layer and pull the key-value pairs from the <code>ecommerce</code> object pushed <strong>most recently</strong> into <code>dataLayer</code>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/use-data-layer.jpg" title="Use Data Layer">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/use-data-layer.jpg#ZgotmplZ" alt="Use Data Layer" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1076 474'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>This sounds pretty straight-forward. All you need to do is make sure the object pushed into <code>dataLayer</code> follows the exact correct syntax, and that it&rsquo;s pushed into <code>dataLayer</code> before (or in the same push as) the tag that accesses the data via <strong>Use data layer</strong> fires.</p>
<p>However, there are two important things to note here.</p>
<ol>
<li>
<p>The <code>dataLayer.push()</code> <strong>must</strong> be perfectly formed. There&rsquo;s no way to modify it on-the-go if you activate the &ldquo;Use data layer&rdquo; option. So it&rsquo;s absolutely vital that you specify and audit the object that is being pushed into <code>dataLayer</code> for Enhanced Ecommerce data collection.</p>
</li>
<li>
<p>When a tag with &ldquo;Use data layer&rdquo; fires, it really only accesses the <strong>most recent</strong> <code>ecommerce</code> push. So, if you&rsquo;ve split Product Impressions into multiple pushes and then fire the tag when the last one is done, if the tag has &ldquo;Use data layer&rdquo; checked, only the last impressions object is sent to Google Analytics.</p>
</li>
</ol>
<p>Point (2) might sound counter-intuitive, but it actually makes sense. If GTM didn&rsquo;t exhibit this behavior, then all <code>ecommerce</code> pushes done on a single page would tag along with all the subsequent Enhanced Ecommerce payloads. By sending only the most recently pushed object, this behavior can be avoided.</p>
<p>It&rsquo;s precisely because of this behavior that I again strongly recommend to <strong>always include the <code>event</code> key in every single Enhanced Ecommerce object</strong>. Why? Because then you can use <strong>Custom Event triggers</strong> to fire your Enhanced Ecommerce tags at precisely the correct time, and the most recent object they access will always be the one that triggered the tag. That way you won&rsquo;t lose any data because of pushes that didn&rsquo;t trigger any tags.</p>
<p>However, you might want to take a look at the next section, too.</p>
<h3 id="send-the-data-to-google-analytics-using-a-custom-javascript-variable">Send the data to Google Analytics using a Custom JavaScript variable</h3>
<p>One of my main issues with the <code>dataLayer</code> object syntax for Enhanced Ecommerce in Google Tag Manager is its rigidity. The &ldquo;Use data layer&rdquo; option requires that you follow a very specific, unwieldy syntax.</p>
<p>This means that it might be a huge effort to get the data into the correct format in the first place. But then you also need to have a process in place so that you can update it with minimal delay, and so that you can audit it to make sure no data is lost.</p>
<p>So, thankfully, Google Tag Manager also lets you send the data using a <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">Custom JavaScript variable</a>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/custom-js-variable.jpg" title="Custom JavaScript variable">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/custom-js-variable.jpg#ZgotmplZ" alt="Custom JavaScript variable" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 992 478'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Using the variable has a very simple logic. All the variable needs to do is <strong>return</strong> a valid <code>ecommerce</code> object. In other words, the variable needs to return exactly the same thing that the developers would push into <code>dataLayer</code> in a perfect world.</p>
<p>And how is this useful? Well, you could have the Ecommerce data pushed into <code>dataLayer</code> in <em>any</em> format, and then use the Custom JavaScript variable to transform it into a valid <code>ecommerce</code> object. This way, you don&rsquo;t need to confuse matters with a rigid <code>dataLayer</code> specification, but rather the Ecommerce platform can push the data into <code>dataLayer</code> in whatever format suits it best. Then, with some JavaScript magic, you can pull this data through the Custom JavaScript variable into your tag.</p>
<p>Or, if you want to go the DOM scraping route, you can do all the scraping in the Custom JavaScript variable, and have it return a valid <code>ecommerce</code> object with all the key-value pairs in place.</p>
<p>You can also modify a <strong>valid</strong> <code>ecommerce</code> object in the <code>dataLayer</code> in case you need to add some dynamic updates to it (such as Product-scoped Custom Dimensions). For example, here&rsquo;s me adding a <a href="#product-scoped-custom-dimensions-and-metrics">Product-scoped Custom Dimension</a> to all the products in a Purchase object:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#00a">function</span>() {
  <span style="color:#aaa;font-style:italic">// Create a copy of the variable to avoid
</span><span style="color:#aaa;font-style:italic"></span>  <span style="color:#aaa;font-style:italic">// modifying the source object by reference
</span><span style="color:#aaa;font-style:italic"></span>  <span style="color:#00a">var</span> ecom = JSON.parse(JSON.stringify({{Data Layer Variable - ecommerce}}));
  <span style="color:#00a">try</span> {
    ecom.purchase.products.forEach(<span style="color:#00a">function</span>(prod) {
      prod.dimension10 = {{get discount}}(prod.id);
    });
  } <span style="color:#00a">catch</span>(e) {}
  <span style="color:#00a">return</span> {
    ecommerce: ecom
  };
}
</code></pre></div>
<p>With this simple example, I&rsquo;m updating a perfectly valid <code>ecommerce</code> object (represented by <strong>{{Data Layer Variable - ecommerce}}</strong>), by adding a new field to every single product.</p>
<p>As you can see, I&rsquo;m making a <strong>copy</strong> of the original variable with the <code>JSON.parse(JSON.stringify(obj))</code> method. Because JavaScript copies objects by reference, any changes you make to the <code>ecom</code> variable would reflect in the original object stored in <code>dataLayer</code>. This might have adverse effects if the variable is run more than once, especially if you&rsquo;re running calculations on any fields (the calculations would be done over and over again).</p>
<p>One additional <strong>important thing to note</strong>. Data Layer Variables are, by default, <a href="https://www.simoahava.com/gtm-tips/data-layer-variable-versions-explained/"><strong>Version 2</strong></a>. This means that they will merge all the existing <code>ecommerce</code> pushes into one big <code>ecommerce</code> object. So when you create the variable for <code>ecommerce</code>, you might want to use <strong>Version 1</strong>. Read <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">this article</a> for more information.</p>
<h3 id="page-view-or-event-tag">Page View or Event tag</h3>
<p>Whether you want to use a Page View or Event tag and how you setup your Custom Event triggers is completely up to you.</p>
<p>Personally, I <strong>always</strong> use Event tags. Why? Because if you use a Page View tag, you lack insight into what Enhanced Ecommerce events have been collected in Google Analytics. This might make debugging a broken implementation difficult. By using events, I can always look at the Top Events report to see all the Enhanced Ecommerce hits sent to GA.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/event-list.jpg" title="Event report">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/event-list.jpg#ZgotmplZ" alt="Event report" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1532 786'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can even add things like order ID as the Event Label of these hits, so that you can really start debugging if the event for the order was sent but no transaction was actually received in the Ecommerce reports.</p>
<p>If you do use an Event tag, setting the <code>nonInteraction</code> field is, again, up to you. Personally, I set it to <code>true</code> when the event is sent with the page load, and <code>false</code> in all other instances.</p>
<p>But you do exactly what works best for you. Sometimes you might want to avoid events if you&rsquo;re approaching the 500 hits per session limit. Not a good reason, but a reason nonetheless.</p>
<h3 id="a-word-on-scraping-the-dom">A word on scraping the DOM</h3>
<p><strong>Scraping the DOM</strong> refers to the habit of accessing the dynamic HTML representation of the page (the Document Object Model) directly with JavaScript and populating the Enhanced Ecommerce key-value pairs with values found on the page. On a receipt page, for example, you often see the order ID, the total value of the transaction, all products, shipping costs, and so forth. So you could just as well scrape these from the page rather than going through a complicated specification project with your front-end developers.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#00a">function</span>() {
  <span style="color:#00a">var</span> orderId = <span style="color:#0aa">document</span>.querySelector(<span style="color:#a50">&#39;#order span.id&#39;</span>).textContent,
      revenue = <span style="color:#0aa">document</span>.querySelector(<span style="color:#a50">&#39;#order span.total&#39;</span>).textContent,
      products = [].map.call(<span style="color:#0aa">document</span>.querySelectorAll(<span style="color:#a50">&#39;#order .product&#39;</span>), <span style="color:#00a">function</span>(prod) {
    <span style="color:#00a">return</span> {
      id: prod.getAttribute(<span style="color:#a50">&#39;data-id&#39;</span>),
      name: prod.innerText
    };
  });
  <span style="color:#00a">return</span> {
    ecommerce: {
      purchase: {
        actionField: {
          id: orderId,
          revenue: revenue
        },
        products: products
      }
    }
  };
}
</code></pre></div>
<p>It&rsquo;s not pretty, and it comes with a lot of baggage and technical debt. For one, you&rsquo;re introducing a huge weak link in your tracking. If anything changes on the page, e.g. due to an A/B-test, it&rsquo;s possible your scraper will break.</p>
<p>Furthermore, it&rsquo;s fairly common to <strong>not</strong> include all details about products on the receipt page. Typically, just the name, ID, price, and tax of the line item is enough. This means you&rsquo;ll miss all the other vital metadata such as product category, brand, variant, etc.</p>
<p>In other words, scraping might be the easy way to get some data quick, and for that it&rsquo;s a great tool. But used on its own to carry the data quality of your entire Enhanced Ecommerce process? Not so much.</p>
<h3 id="combining-different-data-types-in-a-single-eec-hit">Combining different data types in a single EEC hit</h3>
<p>Enhanced Ecommerce in Google Tag Manager allows you to send more than one data type in a single Enhanced Ecommerce hit. This is because all the data types are deconstructed into parameters of the Google Analytics request, and as long as each parameter only has a single value, you can combine them to your heart&rsquo;s content.</p>
<p>However, you can&rsquo;t combine them in any way you like. The rule of thumb is that each hit can only contain one <a href="#data-types-actions"><strong>Action</strong></a>, one <a href="#data-types-impressions"><strong>Impression</strong></a>, and one <a href="#data-types-promotions"><strong>Promotion</strong></a> object. But it gets a bit more complicated than that, since there are more shared fields between the different data types, invalidating certain combinations. Here are the valid combinations you can send:</p>
<ul>
<li>
<p><strong>Impression View</strong> with <strong>Promotion View</strong> and <strong>Action</strong></p>
</li>
<li>
<p><strong>Impression View</strong> with one of <strong>Promotion View</strong> or <strong>Action</strong></p>
</li>
<li>
<p><strong>Promotion View</strong> with one of <strong>Impression View</strong> or <strong>Action</strong></p>
</li>
</ul>
<p>See the chapter titled <a href="#data-types-actions"><strong>Data types: Actions</strong></a> to understand what <strong>Actions</strong> comprise. Note that <strong>Impression Click</strong> and <strong>Promotion Click</strong> are <strong>Actions</strong> even if they&rsquo;re listed in a different chapter (it was more logical to group them with impression and promotion views, respectively).</p>
<p>A typical mistake is to try to send a Product Detail View and a Product Add To Cart in the same push, or a Product Add To Cart and a Product Checkout in the same push. This isn&rsquo;t valid, since these objects occupy many of the same parameter names (e.g. all the product keys), so by trying to populate them twice in the same hit, you end up making a royal mess of things.</p>
<h3 id="product-scoped-custom-dimensions-and-metrics">Product-scoped Custom Dimensions and Metrics</h3>
<p>With Enhanced Ecommerce, Google Analytics introduced <a href="https://www.simoahava.com/gtm-tips/product-scoped-custom-dimensions-and-metrics/">Product-scoped Custom Dimensions and Metrics</a>. These are extra metadata that can be added directly into the objects within a <code>products</code> array.</p>
<p>The <code>dataLayer</code> syntax is, again, fairly rigid. They <strong>must</strong> be named <code>dimensionN</code> and <code>metricN</code> (where <code>N</code> is the index number), and they must be embedded in the product object that is included in the <code>products</code> array. For example, this is a valid way to send a Product-scoped Custom Dimension into index 5:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
  ecommerce: {
    purchase: {
      actionField: {
        id: <span style="color:#a50">&#39;t1&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;p1&#39;</span>,
        dimension5: <span style="color:#a50">&#39;Black&#39;</span> <span style="color:#aaa;font-style:italic">// Product-scoped Custom Dimension in index 5
</span><span style="color:#aaa;font-style:italic"></span>      }]
    }
  }
}
</code></pre></div>
<p>As you can see, <code>dimension5</code> is in the object within in the <code>products</code> array.</p>
<p>Because of this rather rigid way of adding the dimensions and metrics, I suggest taking a look at the <a href="#send-the-data-to-google-analytics-using-a-custom-javascript-variable">Custom JavaScript variable</a> option for mutating the object pushed into <code>dataLayer</code> into a valid Enhanced Ecommerce object.</p>
<h3 id="the-product-list">The Product List</h3>
<p><strong>Product List</strong> is a very important attribute in Enhanced Ecommerce tracking. For one, it&rsquo;s really one of the only places in Enhanced Ecommerce where some sort of <a href="https://www.simoahava.com/analytics/attribution-enhanced-ecommerce-reports/">attribution</a> takes place. But also, it&rsquo;s a great way to look at how different parts of the site contribute to the success of your ecommerce efforts.</p>
<p>The Product List is a key that you can add into the <code>actionField</code> object of all Action data types. You can also add it to <a href="#impression-views">Impression View</a> objects directly.</p>
<p>The <strong>attribution</strong> works in a very specific way. When you send the <code>list</code> attribute in one of your Enhanced Ecommerce actions or impressions, then after that every single subsequent Enhanced Ecommerce action will be credited to that list <strong>as long as the product IDs in those subsequent actions match those of the one where you sent the list</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2016/07/list-attribution.jpg" title="attribution in list">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2016/07/list-attribution.jpg#ZgotmplZ" alt="attribution in list" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1666 862'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>In other words, if you send a Product Detail View for a product with ID <code>123</code>, and you use the list value &ldquo;discount&rdquo;, then every single subsequent Enhanced Ecommerce action for a product with ID <code>123</code> within that session will be attributed to that list.</p>
<p>As soon as the Product ID changes or you send some other <code>list</code> value, this funnel will break and a new one will start.</p>
<p>You&rsquo;ll also see plenty of <code>(not set)</code> product lists in your reports. This is due to sessions expiring and new ones starting without any Product List information. Naturally, if your funnel doesn&rsquo;t include a Product List for all possible interactions, you&rsquo;ll see <code>(not set)</code> due to this, too.</p>
<p>Do note that attribution is always <strong>session-scoped</strong>, so if the session timeout is reached or the session is broken for some other reason, attribution will break, too.</p>
<p>If this sounds confusing, please read my <a href="https://www.simoahava.com/analytics/attribution-enhanced-ecommerce-reports/">article on the topic</a>.</p>
<h3 id="local-currency">Local Currency</h3>
<p>If visitors to your site can choose to shop with different currencies, you can utilize Google Analytics&rsquo; Local Currency feature to normalize these values once they hit your GA reports. All you need to do is specify the <a href="https://support.google.com/analytics/answer/6205902?hl=en">currency code</a> either directly in the <code>dataLayer</code> object, or as a field in the tag which sends the Enhanced Ecommerce data to GA.</p>
<p>For example, here&rsquo;s what a <code>dataLayer.push()</code> for a purchase made with Euros would look like:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.purchase&#39;</span>,
  ecommerce: {
    currencyCode: <span style="color:#a50">&#39;EUR&#39;</span>,
    purchase: {
      actionField: {
        id: <span style="color:#a50">&#39;order_id&#39;</span>,
        revenue: <span style="color:#a50">&#39;11.00&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_id&#39;</span>,
        price: <span style="color:#a50">&#39;11.00&#39;</span>,
        quantity: <span style="color:#099">1</span>
      }]
    }
  }
});
</code></pre></div>
<p>Note that if you use a local currency, remember to set keys like <code>revenue</code> and <code>price</code> in that local currency (so no need to do any conversions in the client).</p>
<p>GA will then convert these local currencies to whatever currency you have configured in the Google Analytics view.</p>
<p>If you want to add this currency code as a field in the tag (or Google Analytics Settings variable), you can add it by browsing to <strong>Fields to Set</strong>, and adding a new field:</p>
<p><strong>Field name</strong>: currencyCode<br>
<strong>Value</strong>: EUR</p>
<p>Instead of &ldquo;EUR&rdquo;, you can use a variable that pulls the currency code from e.g. the Data Layer or a browser cookie.</p>

                
                  <h2 id="remember-be-consistent">Remember: be consistent</h2>
<p>One very important thing about Enhanced Ecommerce is that it&rsquo;s (mostly) hit-scoped. The only exception is the minimal attribution with Product Lists and promotions.</p>
<p>In other words, if you send a Product Category of <code>T-Shirt</code> with a product in a Product Detail View, that information will only be available to queries involving Product Detail Views and that particular product. Nothing carries over or persists to the subsequent hits.</p>
<p>You&rsquo;ll need to include <strong>all metadata</strong> about <strong>all products and all actions</strong> in <strong>all Enhanced Ecommerce objects</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/category-broken.jpg" title="Category broken attribution">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/category-broken.jpg#ZgotmplZ" alt="Category broken attribution" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2378 326'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>This is one of the reasons why DOM scraping is not a good idea. It&rsquo;s rare to see the same information on every single page where you have Enhanced Ecommerce actions.</p>
<p>This is also one of the reasons why implementing Enhanced Ecommerce might be a headache to developers. It&rsquo;s possible that the different parts of the funnel are governed by different systems. For example, a fairly typical CMS setup could handle Product Detail Views, but then cart additions are done using a SaaS cart service, checkout is done using PayPal, and purchase receipt page is yet another system.</p>
<p>In order to persist all product data from one page to another, you might need to introduce client-side persistence using <a href="https://www.simoahava.com/analytics/two-ways-to-persist-data-via-google-tag-manager/">cookies or browser storage</a>, for example.</p>

                
                  <h2 id="data-types-actions">Data types: Actions</h2>
<p><strong>Actions</strong> are Enhanced Ecommerce events that include some type of user-initiated action. This isn&rsquo;t always a clear definition, and e.g. Product Detail Views could arguably not be user-initiated actions. But that&rsquo;s the definition that Google uses.</p>
<p>The following chapters will depict what the <code>dataLayer</code> object for each action should look like, and what a typical tag/trigger combination would be.</p>
<h3 id="product-detail-views">Product Detail Views</h3>
<p>Product Detail Views are typically sent when the <strong>user views details about a product</strong>. This is, again typically, on a dedicated product page, but it could just as well be expanded content in a search results list, or something else.</p>
<h4 id="data-layer-composition">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.list</code></td>
<td>String</td>
<td><code>'Expanded content'</code></td>
<td>Where the Product Detail View occurred. Useful if you want to see how different &ldquo;lists&rdquo; contribute to funnel success.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>The SKU of the product. I recommend sending any variant IDs using a Product-scoped Custom Dimension.</td>
</tr>
<tr>
<td><code>products[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product. Any variant name can be sent with the <code>variant</code> key.</td>
</tr>
<tr>
<td><code>products[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>products[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>products[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>products[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>products[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> for a Product Detail View would look like with all the <strong>relevant</strong> keys populated:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.detail&#39;</span>,
  ecommerce: {
    detail: {
      actionField: {
        list: <span style="color:#a50">&#39;Search Results&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY PRODUCT&#39;</span>,
        category: <span style="color:#a50">&#39;guides/google-tag-manager/enhanced-ecommerce&#39;</span>,
        variant: <span style="color:#a50">&#39;Text&#39;</span>,
        brand: <span style="color:#a50">&#39;SIMO AHAVA&#39;</span>,
        dimension3: <span style="color:#a50">&#39;Ecommerce&#39;</span>,
        metric5: <span style="color:#099">12</span>,
        metric6: <span style="color:#099">1002</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/product-detail-view-tag.jpg" title="Product Detail View tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/product-detail-view-tag.jpg#ZgotmplZ" alt="Product Detail View tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1934 1866'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.detail</code></p>
<h3 id="add-to-cart">Add to Cart</h3>
<p>The Add to Cart hit is sent whenever a product (or products) are added to cart. The <code>quantity</code> of each product needs to reflect the number of items that were <strong>added</strong> to the cart in this action, and not the final tally of each item in the cart.</p>
<h4 id="data-layer-composition-1">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.list</code></td>
<td>String</td>
<td><code>'Search results'</code></td>
<td>Where the Add to Cart happened. If there are multiple places on the site where products can be added to cart, it&rsquo;s a good idea to differentiate between them using the Product List attribute.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>The SKU of the product.</td>
</tr>
<tr>
<td><code>products[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product.</td>
</tr>
<tr>
<td><code>products[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>products[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>products[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>products[].quantity</code></td>
<td>Integer</td>
<td><code>1</code></td>
<td>The quantity of this product added to cart.</td>
</tr>
<tr>
<td><code>products[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>products[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> for an Add to Cart would look like with all the <strong>relevant</strong> keys populated:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.add&#39;</span>,
  ecommerce: {
    add: {
      actionField: {
        list: <span style="color:#a50">&#39;Shopping cart&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY PRODUCT&#39;</span>,
        category: <span style="color:#a50">&#39;guides/google-tag-manager/enhanced-ecommerce&#39;</span>,
        variant: <span style="color:#a50">&#39;Text&#39;</span>,
        brand: <span style="color:#a50">&#39;SIMO AHAVA&#39;</span>,
        quantity: <span style="color:#099">2</span>,
        dimension3: <span style="color:#a50">&#39;Ecommerce&#39;</span>,
        metric5: <span style="color:#099">12</span>,
        metric6: <span style="color:#099">1002</span>
      },{
        id: <span style="color:#a50">&#39;another_product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY ADD-ON&#39;</span>,
        quantity: <span style="color:#099">1</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-1">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/add-to-cart-tag.jpg" title="Add To Cart tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/add-to-cart-tag.jpg#ZgotmplZ" alt="Add To Cart tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1880 1868'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The variable in <strong>Event Label</strong> is a Data Layer Variable that points to <code>ecommerce.add.actionField.list</code>. This returns the Product List of the hit, if any.</p>
<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.add</code></p>
<h3 id="remove-from-cart">Remove from Cart</h3>
<p>Remove from Cart is what you would send when items are removed from the cart. The <code>quantity</code> you send for each item needs to reflect the quantity that was removed in the action, and not the quantity of items remaining in the cart.</p>
<h4 id="data-layer-composition-2">Data Layer composition</h4>
<p>The Data Layer composition for Remove from Cart is identical to that of Add to Cart.</p>
<p>Similarly, the <code>dataLayer.push()</code> example would be identical, except the first key under <code>ecommerce</code> is named <code>remove</code> rather than <code>add</code>, and the event name is different:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.remove&#39;</span>,
  ecommerce: {
    remove: {
      actionField: {...},
      products: [...]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-2">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/remove-from-cart-tag.jpg" title="Remove from cart tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/remove-from-cart-tag.jpg#ZgotmplZ" alt="Remove from cart tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 923 925'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The variable in <strong>Event Label</strong> is a Data Layer Variable that points to <code>ecommerce.remove.actionField.list</code>. This returns the Product List of the hit, if any.</p>
<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.remove</code></p>
<h3 id="checkout">Checkout</h3>
<p>A Checkout is sent when the user enters the checkout funnel. For every discrete <strong>step</strong> in the funnel, you send a checkout hit to GA. Steps are typically pages (on a multi-page checkout) or sections of the form (on a single-page checkout).</p>
<p>The <code>products</code> array should only be sent <strong>with the first step</strong>. Sending it with any other step will do nothing.</p>
<p>You can also add an <code>option</code> key to the checkout hit, in case you want to send extra details about the checkout step itself (such as selected payment method or shipment method). Alternatively, you can use the Checkout Option action to send the option information after the step has first been sent-</p>
<h4 id="data-layer-composition-3">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.step</code></td>
<td>Integer</td>
<td><code>1</code></td>
<td>The number of the checkout step. These should be sent in order, where the first step is 1. You can define what these steps mean in the Google Analytics Admin user interface.</td>
</tr>
<tr>
<td><code>actionField.option</code></td>
<td>String</td>
<td><code>'Visa'</code></td>
<td>You can send the <code>option</code> key if there is extra metadata (e.g. shipping or payment method) you want to send with the step hit itself.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>The SKU of the product.</td>
</tr>
<tr>
<td><code>products[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product.</td>
</tr>
<tr>
<td><code>products[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>products[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>products[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>products[].quantity</code></td>
<td>Number</td>
<td><code>3</code></td>
<td>The quantity of the given product checked out.</td>
</tr>
<tr>
<td><code>products[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>products[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> for <strong>the first Checkout step</strong> would look like with all the <strong>relevant</strong> keys populated:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.checkout&#39;</span>,
  ecommerce: {
    checkout: {
      actionField: {
        step: <span style="color:#099">1</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY PRODUCT&#39;</span>,
        category: <span style="color:#a50">&#39;guides/google-tag-manager/enhanced-ecommerce&#39;</span>,
        variant: <span style="color:#a50">&#39;Text&#39;</span>,
        brand: <span style="color:#a50">&#39;SIMO AHAVA&#39;</span>,
        quantity: <span style="color:#099">2</span>,
        dimension3: <span style="color:#a50">&#39;Ecommerce&#39;</span>,
        metric5: <span style="color:#099">12</span>,
        metric6: <span style="color:#099">1002</span>
      },{
        id: <span style="color:#a50">&#39;another_product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY ADD-ON&#39;</span>,
        quantity: <span style="color:#099">1</span>
      }]
    }
  }
});
</code></pre></div>
<p>The <code>dataLayer.push()</code> for <strong>the second Checkout step</strong> where you also send the payment method would look like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.checkout&#39;</span>,
  ecommerce: {
    checkout: {
      actionField: {
        step: <span style="color:#099">2</span>,
        option: <span style="color:#a50">&#39;MasterCard&#39;</span>
      }
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-3">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/checkout-tag.jpg" title="Checkout tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/checkout-tag.jpg#ZgotmplZ" alt="Checkout tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 944 937'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The variables {{checkout step}} and {{checkout option}} are Data Layer variables for <code>ecommerce.checkout.actionField.step</code> and <code>ecommerce.checkout.actionField.option</code>, respectively. They return the corresponding values from the checkout hit.</p>
<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.checkout</code></p>
<h3 id="checkout-option">Checkout option</h3>
<p>A Checkout option hit is always sent <strong>after the corresponding Checkout Step has already been sent</strong>. So you can&rsquo;t send a Checkout option hit for step 2 if you haven&rsquo;t first sent a regular Checkout hit for step 2.</p>
<p>Use the Checkout option hit to send extra information about a checkout step. For example, if Checkout step 2 is where the user chooses the payment method, you&rsquo;ll want to send Checkout step 2 when the user first lands on the payment method selection page, and then the Checkout option hit after they&rsquo;ve clicked or selected the payment method.</p>
<h4 id="data-layer-composition-4">Data Layer composition</h4>
<p>The <code>dataLayer.push()</code> is very simple. In <code>actionField</code>, you indicate with <code>step</code> to which Checkout step this option should be attached (Integer), and <code>option</code> is the option value itself.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.checkout_option&#39;</span>,
  ecommerce: {
    checkout_option: {
      actionField: {
        step: <span style="color:#099">2</span>,
        option: <span style="color:#a50">&#39;Expedited delivery&#39;</span>
      }
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-4">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/checkout-option-tag.jpg" title="Checkout option tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/checkout-option-tag.jpg#ZgotmplZ" alt="Checkout option tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 924 934'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.checkout_option</code></p>
<h3 id="purchase">Purchase</h3>
<p>The Purchase hit is, arguably, the most important hit in the Enhanced Ecommerce funnel. Without a reliable Purchase hit being collected, all the funnels, attribution models, goal values, conversion calculations, and transaction data become fairly unusable.</p>
<p>In other words, make sure most of the resources is invested in getting the Purchase hit right.</p>
<h4 id="data-layer-composition-5">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.id</code></td>
<td>String</td>
<td><code>order_12345</code></td>
<td>The unique order ID of the transaction. Should match the actual ID of the order.</td>
</tr>
<tr>
<td><code>actionField.affiliation</code></td>
<td>String</td>
<td><code>'Simo Shop'</code></td>
<td>Extra details about where the purchase happened.</td>
</tr>
<tr>
<td><code>actionField.revenue</code></td>
<td>String</td>
<td><code>'11.00'</code></td>
<td>Total transaction value. You can include tax and shipping, or you can choose to send the revenue without tax and shipping. The value <strong>must not</strong> include anything else except number separated by a decimal point. Don&rsquo;t use a comma as the separator, and don&rsquo;t include any currency symbols.</td>
</tr>
<tr>
<td><code>actionField.tax</code></td>
<td>String</td>
<td><code>'1.00'</code></td>
<td>Tax paid. Same formatting instructions as with revenue.</td>
</tr>
<tr>
<td><code>actionField.shipping</code></td>
<td>String</td>
<td><code>'2.00'</code></td>
<td>Cost of shipping. Same formatting instructions as with revenue.</td>
</tr>
<tr>
<td><code>actionField.coupon</code></td>
<td>String</td>
<td><code>'SUMMER2019'</code></td>
<td>The coupon code that was used for the entire transaction.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>The SKU of the product.</td>
</tr>
<tr>
<td><code>products[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product.</td>
</tr>
<tr>
<td><code>products[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>products[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>products[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>products[].quantity</code></td>
<td>Number</td>
<td><code>3</code></td>
<td>The quantity of the given product purchased.</td>
</tr>
<tr>
<td><code>products[].price</code></td>
<td>String</td>
<td><code>'10.00'</code></td>
<td>The price of one item. Same formatting instructions as with revenue.</td>
</tr>
<tr>
<td><code>products[].coupon</code></td>
<td>String</td>
<td><code>'SHIRTSOFF'</code></td>
<td>The coupon code used for this particular product.</td>
</tr>
<tr>
<td><code>products[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>products[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> for a Purchase hit would look like with all the <strong>relevant</strong> keys populated:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.purchase&#39;</span>,
  ecommerce: {
    currencyCode: <span style="color:#a50">&#39;EUR&#39;</span>,
    purchase: {
      actionField: {
        id: <span style="color:#a50">&#39;ORDER12345&#39;</span>,
        affiliation: <span style="color:#a50">&#39;Simo\&#39;s shop&#39;</span>,
        revenue: <span style="color:#a50">&#39;11.00&#39;</span>,
        tax: <span style="color:#a50">&#39;1.00&#39;</span>,
        shipping: <span style="color:#a50">&#39;2.00&#39;</span>,
        coupon: <span style="color:#a50">&#39;SUMMER2019&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY PRODUCT&#39;</span>,
        category: <span style="color:#a50">&#39;guides/google-tag-manager/enhanced-ecommerce&#39;</span>,
        variant: <span style="color:#a50">&#39;Text&#39;</span>,
        brand: <span style="color:#a50">&#39;SIMO AHAVA&#39;</span>,
        quantity: <span style="color:#099">2</span>,
        price: <span style="color:#a50">&#39;3.50&#39;</span>,
        dimension3: <span style="color:#a50">&#39;Ecommerce&#39;</span>,
        metric5: <span style="color:#099">12</span>,
        metric6: <span style="color:#099">1002</span>
      },{
        id: <span style="color:#a50">&#39;another_product_id&#39;</span>,
        name: <span style="color:#a50">&#39;MY ADD-ON&#39;</span>,
        price: <span style="color:#a50">&#39;1.00&#39;</span>,
        quantity: <span style="color:#099">1</span>,
        coupon: <span style="color:#a50">&#39;ADD-ONS OFF&#39;</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-5">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/purchase-tag.jpg" title="Purchase tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/purchase-tag.jpg#ZgotmplZ" alt="Purchase tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 923 929'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The variable {{order id}} is a Data Layer variable for <code>ecommerce.purchase.actionField.id</code>, and it returns the transaction ID. The variable {{revenue}} is a Data Layer variable for <code>ecommerce.purchase.actionField.revenue</code>, and it returns the revenue of the transaction.</p>
<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.purchase</code></p>
<h3 id="refund">Refund</h3>
<p>The Refund hit should be sent if the user requests a refund of the product through the website.</p>
<p>Important: <strong>this does NOT remove the original transaction or negate it in any way</strong>. The Refund hit is a hit of its own, and will be used to populate metrics like &ldquo;Refund Amount&rdquo; and &ldquo;Product Refund Amount&rdquo;. This makes the Refund hit type fairly useless, in my opinion, but it might have its uses if you simply want to know whether refunds are requested via the website.</p>
<h4 id="data-layer-composition-6">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.id</code></td>
<td>String</td>
<td><code>order_12345</code></td>
<td>If the user requested a <strong>full refund</strong> of the order, then you <strong>only</strong> need to send the transaction ID with the hit.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>If the user only wanted a refund for some items, you need to also send the <code>id</code> of each along with the quantity refunded.</td>
</tr>
<tr>
<td><code>products[].quantity</code></td>
<td>Number</td>
<td><code>3</code></td>
<td>The quantity of the given item refunded.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> would look like for a completely refunded transaction:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.refund&#39;</span>,
  ecommerce: {
    refund: {
      actionField: {
        id: <span style="color:#a50">&#39;ORDER12345&#39;</span>
      }
    }
  }
});
</code></pre></div>
<p>This is what the <code>dataLayer.push()</code> would look like for a partially refunded transaction:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.refund&#39;</span>,
  ecommerce: {
    refund: {
      actionField: {
        id: <span style="color:#a50">&#39;ORDER12345&#39;</span>
      }, 
      products: [{
        id: <span style="color:#a50">&#39;another_product_id&#39;</span>,
        quantity: <span style="color:#099">1</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-6">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/refund-tag.jpg" title="refund tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/refund-tag.jpg#ZgotmplZ" alt="refund tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 964 933'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The variable {{order id}} returns the transaction ID that was refunded. The variable {{total quantity refunded}} is a Custom JavaScript variable which returns the total quantity of all items that were refunded.</p>
<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.refund</code></p>

                
                  <h2 id="data-types-impressions">Data types: Impressions</h2>
<p><strong>Impressions</strong> are what you send when the user sees a listing of products in a Search Results page, for example. Basically, wherever you show a listing of products without going into enough detail for that to count as a Product Detail View, use impressions.</p>
<p>Impressions comprise of a &ldquo;view&rdquo;, where the user sees the product in a listing, and a &ldquo;click&rdquo;, where the user clicks a product in the listing (to go to its Product Detail page, for example).</p>
<p>Note that you might be tempted to send <strong>all the products on the listing page</strong> as impressions in a single hit. This might get you into trouble with Google Analytics&rsquo; maximum payload size of 8KB (that&rsquo;s typically around 30-50 product impressions). To avoid this, you can do a number of things, such as <a href="https://www.simoahava.com/analytics/automatically-reduce-google-analytics-payload-length/">automatically reduce the payload length</a>, or split the impressions into <a href="https://www.savio.no/analytics/easier-enhanced-ecommerce-product-promo-tracking">multiple hits</a>.</p>
<p>The best thing you can do, but also the most complicated thing to implement, is to create a <a href="https://www.simoahava.com/analytics/true-view-impressions-google-tag-manager/">true view listener</a>, where impressions are sent in batches depending on what the user actually sees in the viewport. So when the user scrolls to a new set of product impressions, you send only those impressions in a hit once they&rsquo;ve all entered the viewport. This requires a lot of coordination with your developers, but it&rsquo;s well worth the effort.</p>
<h3 id="impression-views">Impression Views</h3>
<p>Impression Views are collected when the user <strong>sees</strong> a product impression in some listing, such as Search Results, Recently Viewed Products, or Related Products.</p>
<p>With Impression Views, it&rsquo;s important to populate the <code>list</code> field with a label that describes the listing where the impression view happened.</p>
<h4 id="data-layer-composition-7">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>impressions[].id</code></td>
<td>String</td>
<td><code>product_id</code></td>
<td>The SKU of the product.</td>
</tr>
<tr>
<td><code>impressions[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product.</td>
</tr>
<tr>
<td><code>impressions[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>impressions[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>impressions[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>impressions[].list</code></td>
<td>String</td>
<td><code>'Related products'</code></td>
<td>The list name where the impression was viewed.</td>
</tr>
<tr>
<td><code>impressiosn[].position</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>The position of the item in the list (e.g. was it the first item in the list, the second, the third, etc.).</td>
</tr>
<tr>
<td><code>impressions[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>impressions[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> would look like for a set of product impressions with all the <strong>relevant</strong> keys included:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.impressionView&#39;</span>,
  ecommerce: {
    impressions: [{
      id: <span style="color:#a50">&#39;product_1&#39;</span>,
      name: <span style="color:#a50">&#39;Great article&#39;</span>,
      category: <span style="color:#a50">&#39;guides/google-tag-manager/javascript&#39;</span>,
      list: <span style="color:#a50">&#39;Related products&#39;</span>,
      position: <span style="color:#099">1</span>,
      dimension3: <span style="color:#a50">&#39;500 pages&#39;</span>
    },{
      id: <span style="color:#a50">&#39;product_2&#39;</span>,
      name: <span style="color:#a50">&#39;Greater article&#39;</span>,
      category: <span style="color:#a50">&#39;guides/google-tag-manager/java&#39;</span>,
      list: <span style="color:#a50">&#39;Related products&#39;</span>,
      position: <span style="color:#099">2</span>,
      dimension3: <span style="color:#a50">&#39;1500 pages&#39;</span>
    }]
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-7">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/impression-view-tag.jpg" title="Impression view tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/impression-view-tag.jpg#ZgotmplZ" alt="Impression view tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 929 927'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.impressionView</code></p>
<h3 id="impression-clicks">Impression Clicks</h3>
<p>Impression Clicks (or Product Clicks) are technically <strong>Actions</strong>, but I decided to group them under Impressions since that&rsquo;s where they belong.</p>
<p>An Impression Click is sent when an impression that the user has viewed is clicked. It&rsquo;s an important metric to follow in case you are measuring Impression Views, because once you start collecting Impression Clicks, too, you can measure things like click-through-rates per product list, position, and individual impression.</p>
<h4 id="data-layer-composition-8">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>actionField.list</code></td>
<td>String</td>
<td><code>'Related products'</code></td>
<td>The list where the user first viewed the product and then clicked it. Make sure the value of the <code>list</code> attribute matches that sent with the Impression View.</td>
</tr>
<tr>
<td><code>products[].id</code></td>
<td>String</td>
<td><code>'P12345'</code></td>
<td>The SKU of the product.</td>
</tr>
<tr>
<td><code>products[].name</code></td>
<td>String</td>
<td><code>'T-Shirt'</code></td>
<td>The name of the product.</td>
</tr>
<tr>
<td><code>products[].category</code></td>
<td>String</td>
<td><code>'clothes/shirts/t-shirts'</code></td>
<td>Product category of the item. Can have maximum five levels of hierarchy.</td>
</tr>
<tr>
<td><code>products[].variant</code></td>
<td>String</td>
<td><code>'Large'</code></td>
<td>What variant of the main product this is.</td>
</tr>
<tr>
<td><code>products[].brand</code></td>
<td>String</td>
<td><code>'NIKE'</code></td>
<td>The brand name of the product.</td>
</tr>
<tr>
<td><code>products[].position</code></td>
<td>Integer</td>
<td><code>1</code></td>
<td>The position of the impression that was clicked.</td>
</tr>
<tr>
<td><code>products[].dimensionN</code></td>
<td>String</td>
<td><code>'Blue'</code></td>
<td>A Product-scoped Custom Dimension for index number N.</td>
</tr>
<tr>
<td><code>products[].metricN</code></td>
<td>Integer</td>
<td><code>3</code></td>
<td>A Product-scoped Custom Metric for index number N.</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> for an Impression Click would look like with all the <strong>relevant</strong> keys populated:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.impressionClick&#39;</span>,
  ecommerce: {
    click: {
      actionField: {
        list: <span style="color:#a50">&#39;Related products&#39;</span>
      },
      products: [{
        id: <span style="color:#a50">&#39;product_2&#39;</span>,
        name: <span style="color:#a50">&#39;Greater article&#39;</span>,
        category: <span style="color:#a50">&#39;guides/google-tag-manager/java&#39;</span>,
        position: <span style="color:#099">2</span>,
        dimension3: <span style="color:#a50">&#39;1500 pages&#39;</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-8">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/impression-click-tag.jpg" title="Impression Click tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/impression-click-tag.jpg#ZgotmplZ" alt="Impression Click tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 981 940'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.impressionClick</code></p>

                
                  <h2 id="data-types-promotions">Data types: Promotions</h2>
<p>Promotions are similar to impressions in that they, too, comprise a View and a Click. However, unlike any of the other Enhanced Ecommerce data types, promotions do not involve products. Rather, you are measuring the <strong>promotions</strong> themselves. These would typically be banners, product category highlights or something similar.</p>
<p>With promotion tracking, you can measure the success of your site marketing efforts, by seeing if viewing and clicking individual banners and advertisements lead to ecommerce success.</p>
<h3 id="promotion-views">Promotion Views</h3>
<p>Promotion Views are sent when the user sees a promotion on the site. As with impressions, you can send more than one Promotion View in a hit, but as with impressions, you need to be careful not to group too many views into one hit, as you might be in danger of breaching the 8KB size limit for the Google Analytics payload.</p>
<h4 id="data-layer-composition-9">Data Layer composition</h4>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>promotions[].id</code></td>
<td>String</td>
<td><code>'summer_campaign'</code></td>
<td>Unique identifier for the promotion.</td>
</tr>
<tr>
<td><code>promotions[].name</code></td>
<td>String</td>
<td><code>'Summer Campaign 2019'</code></td>
<td>The name of the promotion.</td>
</tr>
<tr>
<td><code>promotions[].creative</code></td>
<td>String</td>
<td><code>'front_page_banner_1'</code></td>
<td>A name for the creative where the promotion is showing.</td>
</tr>
<tr>
<td><code>promotions[].position</code></td>
<td>String</td>
<td><code>'slot_2'</code></td>
<td>Some way to distinguish the position of the promotion in the creative (e.g. second slide of a carousel).</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> would look like for a set of Promotion Views with all the <strong>relevant</strong> keys included:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.promotionView&#39;</span>,
  ecommerce: {
    promoView: {
      promotions: [{
        id: <span style="color:#a50">&#39;summer_campaign&#39;</span>,
        name: <span style="color:#a50">&#39;Summer Campaign 2019&#39;</span>,
        creative: <span style="color:#a50">&#39;Front Page Carousel&#39;</span>,
        position: <span style="color:#a50">&#39;Slide 1&#39;</span>
      },{
        id: <span style="color:#a50">&#39;fall_campaign&#39;</span>,
        name: <span style="color:#a50">&#39;Fall Campaign 2019&#39;</span>,
        creative: <span style="color:#a50">&#39;Front Page Carousel&#39;</span>,
        position: <span style="color:#a50">&#39;Slide 2&#39;</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-9">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/promotion-view-tag.jpg" title="Promotion view tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/promotion-view-tag.jpg#ZgotmplZ" alt="Promotion view tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 903 932'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.promotionView</code></p>
<h3 id="promotion-clicks">Promotion Clicks</h3>
<p>A Promotion Click is collected when an individual promotion is clicked. It&rsquo;s important to measure these if you are also measuring Promotion Views, because this way you&rsquo;ll get a solid understanding of the click-through rate of individual promotions and how these promotions are involved in generating revenue in your webstore.</p>
<p>Available fields in the <code>ecommerce</code> object:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>promotions[].id</code></td>
<td>String</td>
<td><code>'summer_campaign'</code></td>
<td>Unique identifier for the promotion.</td>
</tr>
<tr>
<td><code>promotions[].name</code></td>
<td>String</td>
<td><code>'Summer Campaign 2019'</code></td>
<td>The name of the promotion.</td>
</tr>
<tr>
<td><code>promotions[].creative</code></td>
<td>String</td>
<td><code>'front_page_banner_1'</code></td>
<td>A name for the creative where the promotion was clicked.</td>
</tr>
<tr>
<td><code>promotions[].position</code></td>
<td>String</td>
<td><code>'slot_2'</code></td>
<td>Some way to distinguish the position of the promotion in the creative (e.g. second slide of a carousel).</td>
</tr>
</tbody>
</table>
<p>This is what the <code>dataLayer.push()</code> would look like for a Promotion Views with all the <strong>relevant</strong> keys included:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer = <span style="color:#0aa">window</span>.dataLayer || [];
<span style="color:#0aa">window</span>.dataLayer.push({
  event: <span style="color:#a50">&#39;eec.promotionClick&#39;</span>,
  ecommerce: {
    promoClick: {
      promotions: [{
        id: <span style="color:#a50">&#39;fall_campaign&#39;</span>,
        name: <span style="color:#a50">&#39;Fall Campaign 2019&#39;</span>,
        creative: <span style="color:#a50">&#39;Front Page Carousel&#39;</span>,
        position: <span style="color:#a50">&#39;Slide 2&#39;</span>
      }]
    }
  }
});
</code></pre></div>
<blockquote>
<p>Remember, if you want to use a Custom JavaScript variable instead, the variable must return the <code>ecommerce</code> object from the <code>dataLayer.push()</code> above.</p>
</blockquote>
<h4 id="tag-configuration-example-10">Tag configuration example</h4>
<p>Typical <strong>Event tag</strong>:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/promotion-click-tag.jpg" title="Promotion click tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/promotion-click-tag.jpg#ZgotmplZ" alt="Promotion click tag" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 960 931'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The <strong>trigger</strong> would be a <strong>Custom Event trigger</strong> with the following setting:</p>
<p><strong>Event name</strong>: <code>eec.promotionClick</code></p>

                
                  <h2 id="debugging-the-setup">Debugging the setup</h2>
<p>Once you have everything in place, you&rsquo;ll want to debug your setup. The things you are looking for are:</p>
<ul>
<li>
<p>Are all the keys configured in the <code>dataLayer.push()</code> (or the Custom JavaScript variable) getting picked up and being sent to Google Analytics?</p>
</li>
<li>
<p>Is the payload length too long?</p>
</li>
<li>
<p>Is there a risk of data duplication with some hits?</p>
</li>
</ul>
<p>To debug these, you really only need three tools: GTM&rsquo;s own Preview mode, the Google Analytics Debugger browser extension, and Google Chrome browser&rsquo;s DevTools. Yes, there are plenty of other tools you can use, but these have proven to be more than enough in my own experience.</p>
<h3 id="preview-mode">Preview mode</h3>
<p>With Preview mode, you can analyze what fields were sent with your Enhanced Ecommerce -enabled Google Analytics tag. You can also compare these fields with what was originally pushed into <code>dataLayer</code>, or what the Custom JavaScript variable returned.</p>
<p>Once you have your <code>ecommerce</code> object either pushed into <code>dataLayer</code> or generated by a Custom JavaScript variable, the next step is to go to Preview mode, then browsing the site and generating the action that sends the ecommerce data to GA.</p>
<p>Here&rsquo;s what you&rsquo;re looking for in the Preview mode:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/preview-mode.jpg" title="Preview mode">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/preview-mode.jpg#ZgotmplZ" alt="Preview mode" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 684 260'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>In the left-hand side, you&rsquo;re looking for the <strong>Event name</strong> that you pushed into <code>dataLayer</code> with the <code>'event'</code> key. Remember, you should add one in to every single push?</p>
<p>Click that event, and you should see your Enhanced Ecommerce tag in the list tags that fired. If you don&rsquo;t, it means there&rsquo;s something wrong with its trigger. So find the tag in the list of tags that did <strong>not</strong> fire, select it, and scroll down to its triggers. You&rsquo;ll see a red X next to each trigger condition that failed, so double-check them and make sure the conditions pass when they should.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/tag-did-not-fire.jpg" title="Tag did not fire">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/tag-did-not-fire.jpg#ZgotmplZ" alt="Tag did not fire" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 675 267'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Anyway, if the tag DID fire and if it sent an event (or page view) hit to Google Analytics successfully, you&rsquo;ll see <strong>Succeeded</strong> as its Firing Status. Double-check that the Enhanced Ecommerce settings are correct, too.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/successful-tag-preview-mode.jpg" title="Successful tag in preview mode">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/successful-tag-preview-mode.jpg#ZgotmplZ" alt="Successful tag in preview mode" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 848 490'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<h3 id="google-analytics-debugger-and-chrome-devtools">Google Analytics Debugger and Chrome DevTools</h3>
<p>Now you know that your tag fired and that it sent the event/pageview to GA successfully. But what about the Enhanced Ecommerce payload? Were all the keys and values you configured included?</p>
<p>For this, you have plenty of options. You can use a tool like <a href="https://chrome.google.com/webstore/detail/tag-assistant-by-google/kejbdjndbnbjgmefkgdddjlbokphdefk?hl=en">Google Tag Assistant</a> which will tell you what parameters were included in the hit. Or you can use <a href="https://www.thyngster.com/">David Vallejo&rsquo;s</a> excellent <a href="https://chrome.google.com/webstore/detail/gtm-debug/ilnpmccnfdjdjjikgkefkcegefikecdc?hl=en">GTM Debug</a> Chrome extension, which has a great visualization of the Enhanced Ecommerce data.</p>
<p>The key is to see what data was included in the hit and to compare that against what was pushed into <code>dataLayer</code> or what the Custom JavaScript variable returned.</p>
<p>Personally, I simply use the <a href="https://chrome.google.com/webstore/detail/google-analytics-debugger/jnkmfdileelhofjcijamephohjechhna?hl=en"><strong>Google Analytics Debugger</strong></a> extension. It uses the <a href="https://developers.google.com/web/tools/chrome-devtools/console/">JavaScript Console</a> of the web browser to output a log of all the interactions with Google Analytics trackers on the page.</p>
<p>For example, in my Purchase example above, this is what the GA debugger will tell me:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/ga-debugger-output.jpg" title="GA Debugger output">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/ga-debugger-output.jpg#ZgotmplZ" alt="GA Debugger output" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1514 533'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Here, you can see that the hit is missing the <strong>tax</strong> that I pushed into <code>dataLayer</code>. The key I used was <code>orderTax</code>, as you can see in the screenshot.</p>
<p>So now I open this guide again, scroll all the way to the Purchase hit, look at the Data Layer Composition example, and see my mistake. It shouldn&rsquo;t be <code>orderTax</code>, it should be just <code>tax</code>.</p>
<p>I fix the <code>dataLayer.push()</code>, re-run the test and now I can see that everything works.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2018/09/ga-debugger-works.jpg" title="GA Debugger output">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2018/09/ga-debugger-works.jpg#ZgotmplZ" alt="GA Debugger output" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1506 515'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Here&rsquo;s the <strong>most important thing about debugging Enhanced Ecommerce hits</strong>:</p>
<blockquote>
<p><strong>Never</strong> be satisfied with using Preview mode alone. Preview mode will only tell you if a tag fired, NOT if it sent the correct data to Google Analytics. You <strong>must</strong> debug the actual payload sent to Google Analytics, too. For this, Chrome&rsquo;s DevTools are a great tool, but there are plenty of extensions out there that outline the data in a clear and concise manner.</p>
</blockquote>

                
                  <h2 id="golden-rules-of-enhanced-ecommerce">Golden rules of Enhanced Ecommerce</h2>
<p>Now follow some Enhanced Ecommerce tips that I consider absolutely vital for any implementation. I&rsquo;ve accumulated them over years of practice, and I don&rsquo;t hesitate to call them &ldquo;rules&rdquo; even if I&rsquo;m typically very cautious to give any kind of recommendations to anyone.</p>
<p>So read through them, and if you have more suggestions for golden rules, let me know in the comments!</p>
<h3 id="do-whatever-you-want">Do whatever you want</h3>
<p>This is important. You can use Enhanced Ecommerce <strong>however you want</strong>. There&rsquo;s no law that forces you to use the data types in the way that Google recommends you to.</p>
<p>For example, not all websites have a shopping cart. You directly buy products from product pages. In those cases, don&rsquo;t send the Add to Cart event. Or, alternatively, send a dummy Add to Cart whenever the user moves to the checkout funnel.</p>
<p>It&rsquo;s entirely up to you.</p>
<p>Heck, you can even use Enhanced Ecommerce for something completely unrelated to ecommerce. For example, you can use it to <a href="https://www.simoahava.com/analytics/track-content-enhanced-ecommerce/">track content engagement on your site</a>.</p>
<h3 id="the-purchase-action-is-most-important">The Purchase action is most important</h3>
<p>The <strong>Purchase</strong> action is absolutely the most important part of Enhanced Ecommerce. You can ignore or mess up all the other steps in the funnel, but you will <strong>never</strong> want to screw up the purchase hit. So many metrics and dimensions rely on the transaction data to be accurate.</p>
<p>When you&rsquo;re calculating the investment for implementing Enhanced Ecommerce, add some extra buffer to getting the purchase right. It&rsquo;s that important.</p>
<h3 id="only-one-action-per-hit">Only one action per hit</h3>
<p>Remember to only send <strong>one action</strong> per hit. There are <a href="#combining-different-data-types-in-a-single-eec-hit">other limitations</a>, too, but this is the most common mistake.</p>
<p>You might be tempted to send multiple Checkout steps, for example, but this would violate this rule.</p>
<p>You can only include a single action in a <code>dataLayer.push</code> (or in the returned object from a Custom JavaScript variable), so make sure to debug this thoroughly.</p>
<h3 id="include-all-the-necessary-details-in-every-hit">Include all the necessary details in every hit</h3>
<p><strong>Consistency is key</strong>. If you send product details such as product variant, brand and category in a Product Detail View, you&rsquo;ll want to send these with all the subsequent actions (Add to Cart, Checkout, Purchase), too. Otherwise when analyzing the funnel using any of these dimensions as the primary dimension of analysis, you&rsquo;ll only see data for Product Detail Views and not for any of the other steps.</p>
<p>There is no automatic persistence or attribution of product metadata - you <strong>must</strong> send them with every single hit.</p>
<p>Also, the metadata <strong>must</strong> be in the same format in every step. You can&rsquo;t send <code>brand: 'NIKE'</code> in one step, <code>brand: 'Nike'</code> in another, and <code>brand: 'nike'</code> in another, and expect Google Analytics to treat these as the same value. They will generate three different rows with their own funnels when analyzed using Product Brand as the dimension.</p>
<h3 id="there-is-some-attribution">There is some attribution</h3>
<p>Note that there is <em>some</em> attribution in Enhanced Ecommerce; in Product Lists and Promotions, specifically.</p>
<p>When a product is purchased, this purchase will be attributed to the <strong>last promotion</strong> the user clicked (or viewed if there was no click) in the session.</p>
<p>Similarly, when any Ecommerce action is taken, this action is also attributed to the <strong>last Product List</strong> that was included in an earlier action, <strong>as long as the Product ID in these two actions match</strong>.</p>
<p>In other words, if you send a Product Detail View for product with ID <code>my_shirt</code>, using <code>product_page</code> as the Product List attribute value, then any subsequent action that also involves <code>my_shirt</code> will be attributed to the <code>product_page</code> list. Useful, right?</p>
<p>Just remember that <strong>attribution is session-scoped</strong>. If the session timeout is reached, or if the session cuts off for some other reason, any Product List and Promotion attribution information is lost. That&rsquo;s why you might see <code>(not set)</code> in the corresponding reports.</p>
<h3 id="be-wary-of-the-payload-size-limit">Be wary of the payload size limit</h3>
<p>Remember that the maximum payload length of a Google Analytics request is <strong>8192 bytes</strong>. If you&rsquo;re collecting Product Impressions, or if the typical cart size in your store is 30+ products, you&rsquo;ll want to see if you&rsquo;re approaching this limit.</p>
<p>The Google Analytics Debugger will output an error into the console in case you are trying to send hits that are longer than this limit.</p>
<p>See <a href="https://www.simoahava.com/analytics/send-google-analytics-payload-length-as-custom-dimension/">this article</a> for information how to track payload length, and <a href="https://www.simoahava.com/analytics/automatically-reduce-google-analytics-payload-length/">this</a> for a little tool that automatically reduces the payload length.</p>

                
                  <h2 id="further-reading">Further reading</h2>
<p>I&rsquo;ve written a <strong>lot</strong> about Enhanced Ecommerce. The easiest way to find this content is to simply <a href="https://www.simoahava.com/search/?q=enhanced+ecommerce">do a search on my site</a>.</p>
<p>As for other content, here is a random selection of goodies found on the web:</p>
<ul>
<li>
<p><a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-ecommerce">Google&rsquo;s Enhanced Ecommerce Developer Guide for Universal Analytics</a></p>
</li>
<li>
<p><a href="https://developers.google.com/tag-manager/enhanced-ecommerce">Google&rsquo;s Enhanced Ecommerce Developer Guide for Google Tag Manager</a></p>
</li>
<li>
<p><a href="https://ga-dev-tools.appspot.com/enhanced-ecommerce/">Google&rsquo;s Enhanced Ecommerce Demo Store</a></p>
</li>
<li>
<p><a href="https://www.bounteous.com/insights/2016/06/13/google-analytics-enhanced-ecommerce-the-order-of-implementation/">Bounteous&rsquo; Enhanced Ecommerce Guide</a></p>
</li>
<li>
<p><a href="https://www.bounteous.com/labs/recipes/enhanced-ecommerce-variable-pack/">Bounteous&rsquo; Enhanced Ecommerce Variable Pack</a></p>
</li>
<li>
<p><a href="https://gtm4wp.com/how-to-articles/how-to-setup-enhanced-ecommerce-tracking">Google Tag Manager For WordPress Enhanced Ecommerce Guide</a></p>
</li>
</ul>

                
                  <h2 id="summary">Summary</h2>
<p>I hope this guide is useful! It is written as an implementation manual rather than a guide for Enhanced Ecommerce in general.</p>
<p>Google&rsquo;s own documentation is excellent, but there are places where it&rsquo;s a bit misleading. With this guide, I wanted to get all the relevant information into one place.</p>
<p>Note that I don&rsquo;t mention <a href="https://developers.google.com/tag-manager/ios/v5/">Google Tag Manager For Firebase</a> at all. There&rsquo;s a reason for that: it&rsquo;s still underdeveloped. There is basic support for Enhanced Ecommerce, but nothing for Product-scoped Custom Dimensions or Metrics, for example. Hopefully these will be introduced soon into the SDKs.</p>
<p>As always, any comments are much appreciated! Please let me know if the guide was useful and if I glossed over or neglected to add some important information. Thank you!</p>

                
              
              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/enhanced-ecommerce/">enhanced ecommerce</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/guide/">guide</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/workspace-mode-gtm-tools/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/format-value-option-in-google-tag-manager-variables/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Enhanced%20Ecommerce%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://commento.simoahava.com/js/commento.js" data-no-livereload="true"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/workspace-mode-gtm-tools/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/format-value-option-in-google-tag-manager-variables/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Enhanced%20Ecommerce%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
          <i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Enhanced%20Ecommerce%20Guide%20For%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/%20via%20@SimoAhava">
          <i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/enhanced-ecommerce-guide-for-google-tag-manager/">
          <i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://commento.simoahava.com/js/count.js"></script>

    <script>
      !function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),o=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");if(e){if(o){e.style.display="none"}t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"})}}();
    </script>
    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>
    <style>
      .ads {
	  width: 1px;
      }
      </style>
         

    
  </body>
</html>

