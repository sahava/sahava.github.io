

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Measure Cart Value In Enhanced Ecommerce | Simo Ahava's blog",
  "image": "https://www.simoahava.com/images/2015/07/cart-value.png",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.simoahava.com/images/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/",
  "datePublished": "2015-07-13T15:11:01+00:00",
  "dateModified": "2015-07-13T15:11:01+00:00",
  "description": "How to collect and measure shopping cart value in your Google Analytics Enhanced Ecommerce funnel. Use Google Tag Manager to setup the measurement.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.31 with theme Tranquilpeak 0.4.3-BETA">
    <title>Measure Cart Value In Enhanced Ecommerce | Simo Ahava's blog</title>
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZ7GMV9');</script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/measure-cart-value-in-enhanced-ecommerce/">
    
    <meta name="description" content="How to collect and measure shopping cart value in your Google Analytics Enhanced Ecommerce funnel. Use Google Tag Manager to setup the measurement.">
    <meta property="og:description" content="How to collect and measure shopping cart value in your Google Analytics Enhanced Ecommerce funnel. Use Google Tag Manager to setup the measurement.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Measure Cart Value In Enhanced Ecommerce">
    <meta property="og:url" content="/analytics/measure-cart-value-in-enhanced-ecommerce/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Measure Cart Value In Enhanced Ecommerce">
    <meta name="twitter:description" content="How to collect and measure shopping cart value in your Google Analytics Enhanced Ecommerce funnel. Use Google Tag Manager to setup the measurement.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2015/07/cart-value.png">  
      <meta property="og:image" content="https://www.simoahava.com/images/2015/07/cart-value.png">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      Measure Cart Value In Enhanced Ecommerce
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2015-07-13T15:11:01Z">
        
  July 13, 2015

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              

<p>One of the glaring omissions in the <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/enhanced-ecommerce">Enhanced Ecommerce</a> reports of <a href="https://analytics.google.com">Universal Analytics</a> is the ability to calculate <strong>cart value</strong> for products. <em>Cart value</em>, here, is the value that has been added to the cart.</p>

<p>This value can be used to query for products that have the highest discrepancy between cart value and generated revenue. These are missed opportunities of the highest caliber.</p>

<p>With some <strong>Custom Metrics</strong> magic, we can, however, get cart value into our reports, and we can find our most and least &ldquo;effective&rdquo; products with just a glance:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/cart-value.png" title="Cart Value Google Analytics">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/cart-value.png#ZgotmplZ" alt="Cart Value Google Analytics">
  
    </a>
  
  
</div>



<p>As you can see, my most revenue-generating product, <strong>The Ahava Machine 2.0</strong>, also has the most value left in the shopping cart. This is more interesting to me than comparing the <strong>buy-to-detail</strong> and <strong>cart-to-detail</strong> ratios, as now I actually have a currency attached to the gap between purchases and cart interactions.</p>

<p>It&rsquo;s very easy to setup. We will, of course, be using <a href="https://tagmanager.google.com">Google Tag Manager</a>, here, but with a little tinkering you should be able to set it up with the on-page tracking code as well, if you are archaic enough to still use that. I&rsquo;m assuming here that you already have <strong>Enhanced Ecommerce</strong> setup through Google Tag Manager, and you have a valid <code>ecommerce.add</code> (and <code>ecommerce.remove</code>) object in <code>dataLayer</code> or returned with a <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">Custom JavaScript Variable</a>.</p>

<p>To get things rolling, you need to create the Custom Metric itself. A <strong>product-scoped Custom Metric</strong> will be scoped to a single product in a single Enhanced Ecommerce interaction. So, if you send a product-scoped Custom Metric with a product object in the <code>ecommerce.add.products</code> Array, the metric can only be queried against that particular product. The metric itself will only apply to the Add To Cart interaction, but you can of course combine valid metrics for the same product as I have done in the screenshot above.</p>

<h2 id="create-the-custom-metric">Create the Custom Metric</h2>

<p>In the Property settings in your Google Analytics Admin, open <strong>Custom Definitions &gt; Custom Metrics</strong>, and click <strong>+ New Custom Metric</strong>.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/custom-metric.png" title="New Custom Metric">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/custom-metric.png#ZgotmplZ" alt="New Custom Metric">
  
    </a>
  
  
</div>



<p>In the screen that opens, give the Custom Metric a name (I chose Cart Value), select <strong>Product</strong> as the scope and <strong>Currency (Decimal)</strong> as the type.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/custom-metric-settings.png" title="Custom Metric Settings">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/custom-metric-settings.png#ZgotmplZ" alt="Custom Metric Settings">
  
    </a>
  
  
</div>



<p>Remember to make sure the Metric has <strong>Active</strong> checked, and then click <strong>Save</strong>.</p>

<p>You should be back in the Custom Metrics screen. Make note of the <strong>Index</strong> the Custom Metric receives. You&rsquo;ll need this in a short while.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/custom-metric-list.png" title="List of Custom Metrics">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/custom-metric-list.png#ZgotmplZ" alt="List of Custom Metrics">
  
    </a>
  
  
</div>



<p>Next we&rsquo;ll head on over to Google Tag Manager, where we&rsquo;ll modify the <code>ecommerce.add</code> object to include the new Custom Metric with the value that was added to cart.</p>

<h2 id="send-the-custom-metric-with-the-product-object">Send the Custom Metric with the product object</h2>

<p>Let&rsquo;s assume that your <code>ecommerce.add</code> object looks like this in <code>dataLayer</code>:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;addToCart&#39;</span>,
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;add&#39;</span> <span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#39;products&#39;</span> <span style="color:#f92672">:</span> [{
        <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;42&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The Ahava Machine 2.0&#39;</span>,
        <span style="color:#e6db74">&#39;brand&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;AHAVA&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;3999.90&#39;</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;2&#39;</span>,
        <span style="color:#e6db74">&#39;variant&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Awesome|Kick-ass&#39;</span>
      }]
    }
  }
});</code></pre></div>

<p>So it&rsquo;s a fairly basic affair. With an object like this, you&rsquo;ll be able to track adds-to-cart no problem through Enhanced Ecommerce.</p>

<p>But if we want to have the product-scoped Custom Metric there, we&rsquo;ll need to add <code>metricX</code> <em>into</em> the product object in the <code>products</code> Array like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">...
<span style="color:#e6db74">&#39;products&#39;</span> <span style="color:#f92672">:</span> [{
  <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;42&#39;</span>,
  <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The Ahava Machine 2.0&#39;</span>,
  <span style="color:#e6db74">&#39;brand&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Ahava&#39;</span>,
  <span style="color:#e6db74">&#39;price&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;3999.90&#39;</span>,
  <span style="color:#e6db74">&#39;quantity&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;2&#39;</span>,
  <span style="color:#e6db74">&#39;variant&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Awesome|Kick-ass&#39;</span>,
  <span style="color:#e6db74">&#39;metric1&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;7999.80&#39;</span>
}]
...</code></pre></div>

<p>That would solve it. You&rsquo;d push the total value of the cart addition for that particular product into the Custom Metric at index <strong>1</strong> (which we got from previous chapter), after which you&rsquo;ll accumulate cart value for that particular product.</p>

<p>On top of that, you&rsquo;d need to push a <strong>negative</strong> value for cart removals, right? So the <code>ecommerce.remove</code> object for when you want to remove one of the Ahava Machines (why would you, seriously?) looks like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
  <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;removeFromCart&#39;</span>,
  <span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#39;remove&#39;</span> <span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#39;products&#39;</span> <span style="color:#f92672">:</span> [{
        <span style="color:#e6db74">&#39;id&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;42&#39;</span>,
        <span style="color:#e6db74">&#39;name&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;The Ahava Machine 2.0&#39;</span>,
        <span style="color:#e6db74">&#39;price&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;3999.90&#39;</span>,
        <span style="color:#e6db74">&#39;quantity&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;1&#39;</span>,
        <span style="color:#e6db74">&#39;metric1&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;-3999.90&#39;</span>
      }]
    }
  }
});</code></pre></div>

<p>That way you&rsquo;ll have the correct balance in your Cart Value metric at all times.</p>

<p>But this sucks! It sucks because <code>metric1</code> is <em>purely</em> for Google Analytics. It&rsquo;s not generic! <code>dataLayer</code> should be as generic as possible.</p>

<p>So let&rsquo;s do what I did in <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">my previous article</a> about modifying the <code>ecommerce</code> object using a Custom JavaScript Variable. We&rsquo;ll add the Custom Metric <em>dynamically</em> using a Custom JavaScript Variable.</p>

<p>How cool is that? I know, very cool.</p>

<h2 id="modify-the-ecommerce-object-in-the-data-layer">Modify the &lsquo;ecommerce&rsquo; object in the Data Layer</h2>

<p>First, you&rsquo;ll need to create a Data Layer Variable for the <code>ecommerce</code> object, just as I did in the article linked to a paragraph or two ago. It looks like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/dlv-ecommerce.png" title="Data Layer Variable ecommerce">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/dlv-ecommerce.png#ZgotmplZ" alt="Data Layer Variable ecommerce">
  
    </a>
  
  
</div>



<p>This will return the most recent <code>ecommerce</code> object stored in the Data Layer. Since we&rsquo;re working with the Add To Cart or Remove From Cart events, it will return the <code>ecommerce.add</code> or <code>ecommerce.remove</code> object, respectively. This makes sense, right?</p>

<p>Next, we&rsquo;ll need a <strong>Custom JavaScript Variable</strong>, which adds the Custom Metric into the payload, and returns the modified <code>ecommerce</code> object to your Tag. You can name it whatever you want, e.g. <strong>{{JS - Modified EEC Cart Object}}</strong>. The Custom JavaScript would look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">function</span>() {
  <span style="color:#66d9ef">try</span> {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">index</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;1&#39;</span>; <span style="color:#75715e">// Change to reflect the Custom Metric Index
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ecom</span> <span style="color:#f92672">=</span> {{<span style="color:#a6e22e">DLV</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">ecommerce</span>}};
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">i</span>, <span style="color:#a6e22e">len</span>, <span style="color:#a6e22e">prefix</span>, <span style="color:#a6e22e">obj</span>;
    <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;add&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">ecom</span>) {
      <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;
      <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;add&#39;</span>;
    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;remove&#39;</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">ecom</span>) {
      <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;-&#39;</span>;
      <span style="color:#a6e22e">obj</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;remove&#39;</span>;
    }
    <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">typeof</span> <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;undefined&#39;</span>) {
      <span style="color:#66d9ef">for</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">len</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">ecom</span>[<span style="color:#a6e22e">obj</span>][<span style="color:#e6db74">&#39;products&#39;</span>].<span style="color:#a6e22e">length</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">len</span>; <span style="color:#a6e22e">i</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>) {
        <span style="color:#a6e22e">ecom</span>[<span style="color:#a6e22e">obj</span>][<span style="color:#e6db74">&#39;products&#39;</span>][<span style="color:#a6e22e">i</span>][<span style="color:#e6db74">&#39;metric&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">index</span>] <span style="color:#f92672">=</span>
          <span style="color:#a6e22e">prefix</span> <span style="color:#f92672">+</span> (<span style="color:#a6e22e">ecom</span>[<span style="color:#a6e22e">obj</span>][<span style="color:#e6db74">&#39;products&#39;</span>][<span style="color:#a6e22e">i</span>][<span style="color:#e6db74">&#39;price&#39;</span>] <span style="color:#f92672">*</span>
          <span style="color:#a6e22e">ecom</span>[<span style="color:#a6e22e">obj</span>][<span style="color:#e6db74">&#39;products&#39;</span>][<span style="color:#a6e22e">i</span>][<span style="color:#e6db74">&#39;quantity&#39;</span>]);
      }
    }
    <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">ecom</span>};
  } <span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">e</span>) {
    <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;ecommerce&#39;</span> <span style="color:#f92672">:</span> {{<span style="color:#a6e22e">DLV</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">ecommerce</span>}}};
  }
}</code></pre></div>

<p>This piece of JavaScript takes the existing <code>ecommerce.add</code> or <code>ecommerce.remove</code> object, and cycles through all the products stored within. For each product, it calculates the product&rsquo;s <code>price</code> multiplied by its <code>quantity</code>. This gives the total value for that product in the cart interaction. This value is then stored in the <code>metricX</code>, and X is defined in the beginning using the <code>index</code> variable. The value is positive if it was an Add To Cart action, and negative if it was a Remove From Cart action.</p>

<p>The Variable finally returns the modified <code>ecommerce</code> object, which is then used by your Tag as instructed in <a href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">this article</a>. If you can&rsquo;t bother to read through the linked article, you will need to change your Tags&rsquo; Enhanced Ecommerce settings to not use the Data Layer, but rather retrieve the data from the Custom JavaScript Variable you just created.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/tag-settings.png" title="Tag Settings for custom javascript variable">
  
    <img class="fig-img" src="https://www.simoahava.com/images/2015/07/tag-settings.png#ZgotmplZ" alt="Tag Settings for custom javascript variable">
  
    </a>
  
  
</div>



<h2 id="summary">Summary</h2>

<p>The core of this article is really simple. Let&rsquo;s use a Custom Metric to fix a flaw in Enhanced Ecommerce reports of Universal Analytics. The flaw is that Cart Value isn&rsquo;t automatically calculated, as it would be <em>very</em> simple to do so with the existing dimensions and metrics.</p>

<p>Cart Value lets us see how much value is left into the shopping cart when people are browsing on your site. When someone adds a product to the cart, the value added is automatically saved into the Custom Metric for that particular product in the Add To Cart action. When products are removed from the cart, their value is deducted from the Custom Metric.</p>

<p>Using the product-scoped Custom Metric lets you then query the Custom Metric with the Product SKU or Name, for example, and you can combine total Product Revenue in the custom report as well, as in the screenshot at the very beginning of this article.</p>

<p>The Custom JavaScript Variable method lets you add a lot of platform-specific flexibility to your Enhanced Ecommerce measurement. Let&rsquo;s just hope this is one of those articles that becomes obsolete soon, as Google Analytics hopefully introduces Cart Value as a default metric in the Enhanced Ecommerce reports!</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/enhanced-ecommerce/">enhanced ecommerce</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-analytics/">google analytics</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/folders-and-syntax-highlighting-in-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Measure%20Cart%20Value%20In%20Enhanced%20Ecommerce%20https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/folders-and-syntax-highlighting-in-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/enhanced-ecommerce-with-a-custom-javascript-variable/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Measure%20Cart%20Value%20In%20Enhanced%20Ecommerce%20https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/measure-cart-value-in-enhanced-ecommerce/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%25!s%28BADINDEX%29">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fwww.simoahava.com%2Fanalytics%2Fmeasure-cart-value-in-enhanced-ecommerce%2F%20%25!s%28BADINDEX%29%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%25!s%28BADINDEX%29">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=%25!s%28BADINDEX%29">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

