

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Track Form Abandonment With Google Tag Manager | Simo Ahava's blog",
  "image": "https://www.simoahava.com/images/2015/07/form-abandonment.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.simoahava.com/images/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/",
  "datePublished": "2015-07-24T08:12:30+00:00",
  "dateModified": "2015-07-24T08:12:30+00:00",
  "description": "Track how, where, and when users are abandoning your forms. Use Google Tag Manager to send the data to Google Analytics.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.53 with theme Tranquilpeak 0.4.3-BETA">
    <title>Track Form Abandonment With Google Tag Manager | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    <script src="//de.cdn-v3.conductrics.com/ac-GeQBKxGTiA/v3/agent-api/js/f-TNZdDPOknZ/dt-8BnrVvfJuB1PwktQxXXgVK2OikZ9WR?apikey=api-WDrqMnckreSqejZgDAMu" type="text/javascript"></script>

    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PZ7GMV9');</script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/track-form-abandonment-with-google-tag-manager/">
    
    <meta name="description" content="Track how, where, and when users are abandoning your forms. Use Google Tag Manager to send the data to Google Analytics.">
    <meta property="og:description" content="Track how, where, and when users are abandoning your forms. Use Google Tag Manager to send the data to Google Analytics.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Track Form Abandonment With Google Tag Manager">
    <meta property="og:url" content="/analytics/track-form-abandonment-with-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Track Form Abandonment With Google Tag Manager">
    <meta name="twitter:description" content="Track how, where, and when users are abandoning your forms. Use Google Tag Manager to send the data to Google Analytics.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2015/07/form-abandonment.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2015/07/form-abandonment.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      Track Form Abandonment With Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2015-07-24T08:12:30Z">
        
  July 24, 2015

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              

<p><strong>Form abandonment</strong> isn&rsquo;t always easy to define. Most often, it refers to when someone starts to fill in an HTML form, but leaves the page without submitting it. As a definition, this works nicely. However, with multi-page forms it naturally refers only to the <em>last</em> page of the form. Also, especially with government institutions, forms can be saved to be submitted later. Here, again, <em>form abandonment</em> must be reconsidered.</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/form-abandonment.jpg" title="Form abandonment in Google Tag Manager">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/form-abandonment.jpg#ZgotmplZ" alt="Form abandonment in Google Tag Manager">
  
    </a>
  
  
</div>



<p>In this article, I&rsquo;ll go over <strong>four</strong> different ways to track form abandonment in <a href="https://analytics.google.com">Google Analytics</a>, using <a href="https://tagmanager.google.com">Google Tag Manager</a> to setup the tracking. The definition I&rsquo;ll use is the first one: abandonment occurs when someone enters a form page, but leaves it without submitting the form. Do note that GA might not be the right tool to actually track issues with your form. There are dedicated resources for that, such as <a href="http://www.clicktale.com">ClickTale</a> or <a href="http://www.hotjar.com">Hotjar</a>. But if you want to measure form engagement as part of a more coherent visitor journey, then it might make sense to track this engagement (or lack thereof) in Google Analytics.</p>

<p>The different methods I&rsquo;ll go over, in order of difficulty (as perceived by myself):</p>

<ol>
<li><p>Advanced Segment in Google Analytics</p></li>

<li><p>Event sent if form interacted with</p></li>

<li><p>Event sent with the last field interacted with</p></li>

<li><p>Event sent with full interaction history</p></li>
</ol>

<p>Well, the first one can be done without Google Tag Manager at all. But the others require some setting up.</p>

<p>The <em>technology</em>, if you will, is based on the beautiful combination of <code>beforeUnload</code>, a browser event that is dispatched when the user leaves or closes the web page, and the <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#transport">transport</a> field in Universal Analytics. With these in place, GA will receive an event that contains information about form interaction when the user leaves the form page. You can then use an Advanced Segment to only view interaction data for sessions where the form was not submitted.</p>

<p>I&rsquo;ll even show you a simple way of sending the event only if the user didn&rsquo;t submit the form.</p>

<p>Note that this guide is created around a very simple, basic form, which has been created according to <strong>B</strong>est <strong>P</strong>ractices; capital B, capital P. If you have some Ajax-postback-dynamic-validation-jQuery-horror-ultra-modern-form, this might not work for you, and you&rsquo;ll have to put your JavaScript skills to the test as you apply these lessons to the abomination you&rsquo;re cursed to work with.</p>

<p>Don&rsquo;t say I didn&rsquo;t warn you!</p>

<p>(<strong>UPDATE</strong>. My colleague, Lauri Piispanen, wrote a very, very nice upgrade to the Custom HTML Tag, and it&rsquo;s freely downloadable from <a href="https://github.com/lauripiispanen/auto-gtm-form-abandonment">his GitHub repo</a>. It automatically tracks multiple forms on the page!)</p>

<h2 id="advanced-segment-in-google-analytics">Advanced Segment in Google Analytics</h2>

<p>In Google Analytics, the simplest way to track form abandonment is to create an <strong>Advanced Segment</strong>, which includes Sessions where the form page was visited, but the session itself did not include a conversion for the form submission:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/advanced-segment.jpg" title="Advanced Segment for Form Abandonment">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/advanced-segment.jpg#ZgotmplZ" alt="Advanced Segment for Form Abandonment">
  
    </a>
  
  
</div>



<p>This is OK. It&rsquo;s not polished, as it doesn&rsquo;t really tell us anything about <em>why</em> the form was abandoned. Also, a simple page view of the form page is simply not a good way to extrapolate intent. But for all intents and purposes, this exposes possible flaws in a crucial funnel on your website.</p>

<p>As you create the Events in the chapters that follow, you can substitute the <strong>Page</strong> rule in the segment condition with an Event rule that matches the Event you&rsquo;ve created.</p>

<h2 id="the-base-custom-html-tag">The base Custom HTML Tag</h2>

<p>This Custom HTML Tag is what we&rsquo;ll use to setup the <code>beforeUnload</code> listener as well as the interaction handlers created incrementally in the following chapters.</p>

<p>So, <code>beforeUnload</code> is a browser event that is dispatched when the page is unloaded from the browser. Most typical ways for a page to unload is if the user is redirected to some other page (via a link or form submission, for example), or if the user decides to close the browser. Naturally, if the user&rsquo;s computer crashes, no controlled <code>beforeUnload</code> event is dispatched.</p>

<p>We want to use this browser event to invoke a <code>dataLayer.push()</code> when the user leaves the page. This <code>push()</code> will include a custom <code>event</code> key as well as values for the fields in the Event Tag we&rsquo;ll create in the next chapter.</p>

<p>Create a Custom HTML Tag, give it some illustrious name, and set it to fire only on pages with forms. Here&rsquo;s the code we&rsquo;ll work on. Just copy-paste it into the Tag.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  (<span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">eventAction</span>;
    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;beforeunload&#39;</span>, <span style="color:#66d9ef">function</span>() {
      window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
        <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;formAbandonment&#39;</span>,
        <span style="color:#e6db74">&#39;eventCategory&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Form Abandonment&#39;</span>,
        <span style="color:#e6db74">&#39;eventAction&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">eventAction</span>
      });
    });
  
    <span style="color:#75715e">// Add actual logic here...
</span><span style="color:#75715e"></span>  })();
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>That&rsquo;s pretty simple, right? All you do is attach a listener to the page, which waits for the <code>beforeunload</code> event. When that takes place, a <code>dataLayer.push()</code> is invoked, which is then used to fire a Google Analytics Event Tag with all your abandonment issues within. The whole thing is wrapped in an immediately-invoked function expression to protect the global namespace from being polluted with your variables.</p>

<h2 id="the-event-tag">The Event Tag</h2>

<p>Before we go on, let&rsquo;s create the Event Tag itself. And before we do that, you&rsquo;ll need to create a Custom Event Trigger and two Data Layer Variables.</p>

<p>The Custom Event Trigger looks like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/event-trigger.jpg" title="Custom Event Trigger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/event-trigger.jpg#ZgotmplZ" alt="Custom Event Trigger">
  
    </a>
  
  
</div>



<p>And the two Data Layer Variables look like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/dlv-eventcategory.jpg" title="DLV - eventCategory">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/dlv-eventcategory.jpg#ZgotmplZ" alt="DLV - eventCategory">
  
    </a>
  
  
</div>






<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/dlv-eventaction.jpg" title="DLV - eventAction">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/dlv-eventaction.jpg#ZgotmplZ" alt="DLV - eventAction">
  
    </a>
  
  
</div>



<p>Next, onto the Event Tag itself. It&rsquo;s your basic affair, with a simple Event Category and Event Action. I&rsquo;ve set the <strong>Non-Interaction</strong> field to True, since this isn&rsquo;t really a user interaction but more like metadata about the page view, but you can do as you wish.</p>

<p><strong>Remember to add your new Custom Event Trigger you just created to this Tag.</strong></p>

<p>The Tag itself looks like this:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/07/event-tag.jpg" title="GA Event Tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/07/event-tag.jpg#ZgotmplZ" alt="GA Event Tag">
  
    </a>
  
  
</div>



<p>You&rsquo;ll need one more thing that&rsquo;s not visible in the screenshot. Go to <strong>More Settings</strong> -&gt; <strong>Fields to Set</strong>, and add the following:</p>

<p>Field Name: <strong>transport</strong><br />
Value: <strong>beacon</strong></p>

<p>This will utilize a beautiful feature of the Universal Analytics library, where any HTTP request that is initiated as the page is unloaded will be allowed to complete before the page or browser is run down. It doesn&rsquo;t have <a href="http://caniuse.com/#feat=beacon">stellar browser support</a>, which means that horrible browsers such as Internet Explorer might simply exit the page before the request to GA completes. But we can live with that.</p>

<p>Now that we&rsquo;ve taken care of the foundations, we can get to the juicy stuff. Are you ready? I didn&rsquo;t hear you? ARE YOU READY?</p>

<p>Sorry for that.</p>

<h2 id="track-simple-interaction">Track simple interaction</h2>

<p>&ldquo;Simple interaction&rdquo; here translates to: <strong>the user changed the value of any form field</strong>. That&rsquo;s all we care about. It doesn&rsquo;t matter which field, and it doesn&rsquo;t matter how many form fields. We want to draw a line between two types of people: those who didn&rsquo;t interact with the form at all, and those who did.</p>

<p>To make this work, you&rsquo;ll need to add <strong>another</strong> custom listener into the Custom HTML Tag. Here&rsquo;s what we&rsquo;ll go with in the Custom HTML Tag you&rsquo;ve already created:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  (<span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">eventAction</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">formSelector</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;form&#39;</span>; <span style="color:#75715e">// Modify this CSS selector to match your form. Default is first form on the page.
</span><span style="color:#75715e"></span>    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;beforeunload&#39;</span>, <span style="color:#66d9ef">function</span>() {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eventAction</span>) {
        window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
          <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;formAbandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventCategory&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Form Abandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventAction&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">eventAction</span>
        });
      }
    });
  
    document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#a6e22e">formSelector</span>).<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;change&#39;</span>, <span style="color:#66d9ef">function</span>() {
      <span style="color:#a6e22e">eventAction</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;True&#39;</span>;
    });
  })();
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>In the beginning, you define a <code>formSelector</code>. This is a basic CSS selector that you use to target a single form, e.g. &lsquo;<strong>#formId</strong>&rsquo; or &lsquo;<strong>.formClass</strong>&rsquo;. If you choose a selector that can have potentially multiple hits on the page, this script will only listen to the <strong>first</strong> instance.</p>

<p>In the end, we add a <code>change</code> listener to this particular form. If a <code>change</code> event is registered in any of the form fields, i.e. the form field value changes, then the <code>eventAction</code> variable is given a value &lsquo;true&rsquo;.</p>

<p>Finally, the <code>dataLayer.push()</code> that sends the payload to <code>dataLayer</code> which triggers the Event Tag is set to execute only if the <code>eventAction</code> variable is set. Thus, you&rsquo;ll only report on potential form abandonments if the user has interacted with the form.</p>

<p>The Event Tag will have Event Category <strong>Form Abandonment</strong> and Event Action <strong>True</strong>.</p>

<p>To get the most out of this solution, you&rsquo;d create an Advanced Segment in Google Analytics, where you</p>

<ul>
<li><p><strong>Include only sessions</strong> where form goal completions is <strong>0</strong></p></li>

<li><p><strong>AND</strong> where Event Category equals <strong>Form Abandonment</strong></p></li>
</ul>

<p>You need the &ldquo;goal completions is 0&rdquo; because this Event will be dispatched when a form is submitted as well. In order to only send the Event when the user has interacted with the form but did not submit it, jump to chapter 7.</p>

<p>Like I said, this is a very simple, rudimentary way of analyzing traffic that interacted but did not submit.</p>

<h2 id="track-last-field-interacted-with">Track last field interacted with</h2>

<p>Let&rsquo;s improve the previous solution a little. Instead of just blindly looking at who interacted and who didn&rsquo;t, let&rsquo;s send the <strong>last field</strong> the user interacted with to GA. Maybe this will give us some clue about what made the user abandon the form.</p>

<p>So, modify the Custom HTML Tag to look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  (<span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">eventAction</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">formSelector</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;form&#39;</span>; <span style="color:#75715e">// Modify this CSS selector to match your form. Default is first form on the page.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">attribute</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;name&#39;</span>;
    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;beforeunload&#39;</span>, <span style="color:#66d9ef">function</span>() {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eventAction</span>) {
        window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
          <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;formAbandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventCategory&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Form Abandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventAction&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">eventAction</span>
        });
      }
    });
  
    document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#a6e22e">formSelector</span>).<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;change&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {
      <span style="color:#a6e22e">eventAction</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">e</span>[<span style="color:#e6db74">&#39;target&#39;</span>].<span style="color:#a6e22e">getAttribute</span>(<span style="color:#a6e22e">attribute</span>);
    });
  })();
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>We&rsquo;ve added a new variable, <code>attribute</code>. In this, you specify the attribute name that you want to collect to describe which form field was the last one that was interacted with. I would recommend against choosing <strong>value</strong> or anything that the user can add content to. This is to protect your GA account from inadvertently collecting personally identifiable information such as e-mail addresses and such.</p>

<p>The other additions are the <code>e</code> parameter in the callback function of the &lsquo;change&rsquo; listener, and the attribute value of the <code>e['target']</code> object as the value that <code>eventAction</code> retrieves. The <code>target</code> parameter of the event object contains the HTML element that was the target of the event action, which in this case would be the form field whose value changed.</p>

<p>I would recommend you use the <code>name</code> attribute, since it&rsquo;s usually the most descriptive one (especially with well-formed forms).</p>

<p>So, an input field like <code>&lt;input name=&quot;email&quot; type=&quot;text&quot;&gt;</code> would send &lsquo;email&rsquo; as the Event Action of the Event Tag.</p>

<p>Now, again, this would send an Event every time someone leaves the form page, so you&rsquo;ll get some false positives as well. Remember to apply the Advanced Segment, where you look for sessions with this event (using the Event Category filter in the segment settings), and sessions without any form submissions (using a goal completion filter or something similar).</p>

<h2 id="get-full-interaction-history">Get full interaction history</h2>

<p>Here we&rsquo;ll extend the Event Action value that is sent to Google Analytics to include a complete &ldquo;history&rdquo; of fields that were interacted with this. This is done as a trail that might look like this:</p>

<p><strong>firstName &gt; lastName &gt; address &gt; creditCardNumber &gt; expirationDate &gt; creditCardNumber</strong></p>

<p>As you can see, it will record multiple interactions as well. The history example above would indicate that the Credit Card Number field was the one that caused the user to disdainfully abandon your form.</p>

<p>To make this work, here&rsquo;s the revamped version of the Custom HTML Tag:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  (<span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">formSelector</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;form&#39;</span>; <span style="color:#75715e">// Modify this CSS selector to match your form. Default is first form on the page.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">attribute</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;name&#39;</span>;
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">history</span> <span style="color:#f92672">=</span> [];
    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;beforeunload&#39;</span>, <span style="color:#66d9ef">function</span>() {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">history</span>.<span style="color:#a6e22e">length</span>) {
        window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
          <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;formAbandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventCategory&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Form Abandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventAction&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">history</span>.<span style="color:#a6e22e">join</span>(<span style="color:#e6db74">&#39; &gt; &#39;</span>)
        });
      }
    });
  
    document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#a6e22e">formSelector</span>).<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;change&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">e</span>) {
      <span style="color:#a6e22e">history</span>.<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">e</span>[<span style="color:#e6db74">&#39;target&#39;</span>].<span style="color:#a6e22e">getAttribute</span>(<span style="color:#a6e22e">attribute</span>));
    });
  })();
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>Let&rsquo;s see. We&rsquo;ve removed the variable <code>eventAction</code>, and opted for a new Array named <code>history</code>. Instead of checking for whether the <code>eventAction</code> variable has a value, we now check if the <code>history</code> Array has any contents. If it does, we <code>join()</code> the <code>history</code> Array as a string delimited with whitespace-&gt;-whitespace. So, an Array that looks like <code>['firstName', 'lastName', 'phone']</code> becomes <code>'firstName &gt; lastName &gt; phone'</code>.</p>

<p>Finally, in the <code>change</code> listener we use the <code>history.push()</code> method to insert the specified attribute value of the changed form field into the <code>history</code> Array.</p>

<p>Thus, each time the user changes a value of a form field, the specified attribute (&lsquo;name&rsquo; is again recommended) value will be pushed into the <code>history</code> Array, and this is how we get our neatly formatted interaction history to GA as the Event Action value of the hit.</p>

<p>This is, as you might have guessed, a very simple way of mapping form abandonment. Nevertheless, it does give you some idea about which fields are interacted with and how much. In fact, you can easily convert this from a form abandonment survey into an engagement analysis. Using some simple data analysis, you can map the most common paths in your form.</p>

<h2 id="only-send-event-when-a-form-isn-t-submitted">Only send event when a form isn&rsquo;t submitted</h2>

<p>The major caveat with all the previous examples, apart from the browser support, is that the event is sent every time the page is unloaded and a field has changed, so for <strong>successful</strong> form submissions as well. This means you&rsquo;ll need to create an Advanced Segment in GA to make the most of your form abandonment analysis.</p>

<p>However, you can tweak the Custom HTML Tag slightly to only send the form abandonment event when the page unloads for some other reason than a form submission. To do this, the revised Custom HTML Tag should look like this:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
  (<span style="color:#66d9ef">function</span>() {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">eventAction</span>, <span style="color:#a6e22e">i</span>;

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">checkSubmit</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>() {
      <span style="color:#a6e22e">i</span> <span style="color:#f92672">=</span> window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
      <span style="color:#66d9ef">while</span> (<span style="color:#a6e22e">i</span> <span style="color:#f92672">&gt;</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) {
        <span style="color:#66d9ef">if</span> (window.<span style="color:#a6e22e">dataLayer</span>[<span style="color:#a6e22e">i</span>][<span style="color:#e6db74">&#39;event&#39;</span>] <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;gtm.formSubmit&#39;</span>) {
          <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>;
        }
        <span style="color:#a6e22e">i</span><span style="color:#f92672">--</span>;
      }
    };

    window.<span style="color:#a6e22e">addEventListener</span>(<span style="color:#e6db74">&#39;beforeunload&#39;</span>, <span style="color:#66d9ef">function</span>() {
      <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">checkSubmit</span>()) {
        window.<span style="color:#a6e22e">dataLayer</span>.<span style="color:#a6e22e">push</span>({
          <span style="color:#e6db74">&#39;event&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;formAbandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventCategory&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Form Abandonment&#39;</span>,
          <span style="color:#e6db74">&#39;eventAction&#39;</span> <span style="color:#f92672">:</span> <span style="color:#a6e22e">eventAction</span>
        });
      }
    });
  
    <span style="color:#75715e">// Add actual logic here...
</span><span style="color:#75715e"></span>  })();
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></div>

<p>The first change is that you define a new counter variable <code>i</code>. Next, there&rsquo;s a new mini-function in town called <code>checkSubmit()</code>. This loops through <code>dataLayer</code>, starting from the end, and returns the Boolean value <code>true</code> if an &lsquo;event&rsquo; key with the value &lsquo;gtm.formSubmit&rsquo; is found. This would indicate that the unload was due to a form submission.</p>

<p>Finally, the <code>window.dataLayer.push()</code> is wrapped in an <code>if</code> block, which is executed only if the <code>checkSubmit()</code> function does <strong>not</strong> return a truthy value. This is because we want to send the Event only if a form submission <em>didn&rsquo;t</em> cause the page unload.</p>

<p>You might be wondering why not just check against the value of the <strong>{{Event}}</strong> key. Well, GTM has some internal logic running which prevents the value of a Data Layer Variable from being modified during the lifetime of a Tag. Thus, <strong>{{Event}}</strong> will always return <strong>gtm.js</strong> or whatever event name you&rsquo;re using to fire the Custom HTML Tag in the first place.</p>

<p>If you already have the <code>if</code> block there to check for either <code>eventAction</code> or <code>history.length</code>, you can simply add the <strong>checkSubmit()</strong> check with Boolean logic:</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">eventAction</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">checkSubmit</span>()) {
  ...
}

<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">history</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span><span style="color:#a6e22e">checkSubmit</span>()) {
  ...
}
</code></pre></div>

<p>This solution might not work on single-page apps or web pages which have forms that do not redirect. In these cases, you&rsquo;ll need to make additional checks to see if the form that was submitted was the one you&rsquo;re actually tracking. It&rsquo;s relatively simple, but I won&rsquo;t explain it here as it&rsquo;s an edge case.</p>

<p>With JavaScript and GTM, it&rsquo;s always a little bit of give-and-take, so you&rsquo;ll need to modify these solutions to fit whatever frameworks and setups you have running on your site. With a generic, Best Practices -infused HTML form, though, these setups should work beautifully.</p>

<h2 id="summary">Summary</h2>

<p>Tracking form abandonment is an interesting way to see what types of interactions (or lack thereof) result in your forms not being submitted. Fixing this funnel can be key to opening up your website to exponential goal conversions.</p>

<p>However, <em>abandonment</em> is very difficult to define, and you need to ask the correct business questions first before you can start looking for a solution. The four different methods outlined here serve a very simple hypothesis that correlates the fields of a form with the user&rsquo;s tendency to leave the form unfinished. This correlation might not work on many forms.</p>

<p>Like I mention in the guide, it would be very simple to convert this from a form abandonment analysis to a form interaction analysis, where you inspect the &ldquo;history&rdquo; of the filled fields to see if users are bouncing around the form and not following the chronology or layout that you have established.</p>

<p>If none of this resonates with you, at least you&rsquo;ll have some cool new tricks up your sleeve with the <code>transport : beacon</code> field as well as the <code>beforeunload</code> browser event!</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/custom-html/">custom html</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/form/">form</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/guide/">Guide</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/form-field-timing-with-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/access-array-members-in-the-data-layer/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Track%20Form%20Abandonment%20With%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/form-field-timing-with-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/access-array-members-in-the-data-layer/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Track%20Form%20Abandonment%20With%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Track%20Form%20Abandonment%20With%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/track-form-abandonment-with-google-tag-manager/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

