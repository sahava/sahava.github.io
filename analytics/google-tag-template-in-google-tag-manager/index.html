

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "The Google Tag Template In Google Tag Manager | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2023\/06\/google-tag.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/google-tag-template-in-google-tag-manager\/",
  "datePublished": "2023-09-06T07:01:00\u002b03:00",
  "dateModified": "2023-09-06T07:01:00\u002b03:00",
  "description": "A walkthrough of the Google Tag template in Google Tag Manager.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>The Google Tag Template In Google Tag Manager | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article', environment:  null });
    </script>
    

    
    
    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://sgtm.simoahava.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/google-tag-template-in-google-tag-manager/">
    
    <meta name="description" content="A walkthrough of the Google Tag template in Google Tag Manager.">
    <meta property="og:description" content="A walkthrough of the Google Tag template in Google Tag Manager.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="The Google Tag Template In Google Tag Manager">
    <meta property="og:url" content="https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="The Google Tag Template In Google Tag Manager">
    <meta name="twitter:description" content="A walkthrough of the Google Tag template in Google Tag Manager.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
	  <meta property="og:image" content="https://www.simoahava.com/images/2023/06/google-tag-template-google-tag-manager.jpg">
      <meta name="twitter:image" content="https://www.simoahava.com/images/2023/06/google-tag-template-google-tag-manager.jpg">
    


    

      
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
      
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    
    <div id="_progress"></div>
    
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" loading="lazy" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener ">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/newsletter/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bell"></i>
      
      <span class="sidebar-button-desc">Newsletter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://masto.measure.chat/@SimoAhava" target="_blank" rel="noopener me">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
      
      <span class="sidebar-button-desc">Mastodon</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          <div class="post-header main-content-wrap text-left">
  
    <div class="figure nocaption">
      <img class="cover" src="https://www.simoahava.com/images/2023/06/google-tag-template-google-tag-manager.jpg" width="750" height="422" alt="The Google Tag Template In Google Tag Manager">
    </div>
  
  

    <h1>
      The Google Tag Template In Google Tag Manager
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-09-06T07:01:00&#43;03:00">
        
  September 6, 2023

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


      | <a href="https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/#commento">Comments</a>
      
  </div>


</div>

          <div class="post-content markdown">
            <div class="main-content-wrap">
	      
                
  	        <p>Google is going all-in with <a href="https://developers.google.com/tag-platform/gtagjs">Google Tag</a>. We&rsquo;ve already seen <a href="https://www.simoahava.com/analytics/one-tag-rule-them-all-introducing-google-tag/">the consolidation effort</a> through products like Google Analytics 4, and now Google is extending the merging of the tagging stack into Google Tag Manager, too.</p>
<p>I&rsquo;m referring to the new <strong>Google Tag</strong> that has replaced Google Analytics 4 configuration tags in your Google Tag Manager containers.</p>
<p>With this release, all your old GA4 configuration tags have been <strong>auto-migrated</strong> to the new Google Tag.</p>
<p><strong>Functionality-wise, nothing has changed.</strong></p>
<p>However, you&rsquo;ll see that some of the settings you used to configure with UI toggles have now been replaced with key-value pairs in the settings list (more on this below).</p>



<div style="aspect-ratio: 1766 / 1106;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/06/google-tag.jpg" title="Google Tag">
  
    <img class="fig-img" height="1106" width="1766" loading="lazy" src="https://www.simoahava.com/images/2023/06/google-tag.jpg#ZgotmplZ" alt="Google Tag">
  
    </a>
  
  
</div>


<p>The Google Tag can load <strong>any</strong> supported product in the Google stack. The product is loaded by adding <a href="https://support.google.com/tagmanager/answer/12002338#find-tag-id">the <strong>Tag ID</strong></a> to the dedicated field.</p>
<p>The Google Tag also supports <strong>two</strong> new <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/">settings variables</a>:</p>
<ul>
<li><strong>Google Tag: Configuration Settings</strong> for loading configuration-specific settings with the Google Tag. <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/#google-tag-configuration-settings">Read more</a></li>
<li><strong>Google Tag: Event Settings</strong> for establishing fixed-value event parameters that will be used by all tags that reference this Google Tag. <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/#google-tag-event-settings">Read more</a></li>
</ul>
<p>In this article, I&rsquo;ll walk you through what to expect from the new Google Tag.</p>
<p>To echo my sentiments about these changes, I fully agree with my good friend <a href="https://www.twitter.com/AnalyticsNinja">Yehoshua Coren</a> of <a href="https://www.analytics-ninja.com/">Analytics Ninja</a> fame:</p>



<div style="aspect-ratio: 1072 / 450;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/analytics-ninja.jpg" title="Analytics Ninja">
  
    <img class="fig-img" height="450" width="1072" loading="lazy" src="https://www.simoahava.com/images/2023/08/analytics-ninja.jpg#ZgotmplZ" alt="Analytics Ninja">
  
    </a>
  
  
</div>


<p><a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/">Be sure to check out my article on the new settings variables</a>, too, as well as <a href="https://support.google.com/tagmanager/answer/12002338">the official Google Tag documentation</a>.</p>
<div id="toc-container"><h1 id="table-of-contents">Table of Contents</h1> <input type="checkbox" id="show"><label for="show" id="showbtn"><h1 id="table-of-contents-mobile">Table of Contents</h1><span class="show">&nbsp;[+show]</span><span class="hide">&nbsp;[–hide]</span></label><nav id="TableOfContents">
  <ul>
    <li><a href="#auto-migration">Auto-migration</a></li>
    <li><a href="#how-to-configure-the-google-tag">How to configure the Google Tag</a>
      <ul>
        <li><a href="#configuration-settings">Configuration settings</a></li>
        <li><a href="#shared-event-settings">Shared event settings</a></li>
      </ul>
    </li>
    <li><a href="#event-tag-configuration">Event tag configuration</a>
      <ul>
        <li><a href="#add-configuration-settings-to-the-event-tags">Add configuration settings to the Event tag(s)</a></li>
        <li><a href="#one-google-tag-per-tag-id-per-page">One Google Tag per Tag ID per page!</a></li>
      </ul>
    </li>
    <li><a href="#how-do-i">How do I&hellip;</a>
      <ul>
        <li><a href="#configure-automatic-page-view-dispatch">Configure automatic page view dispatch</a></li>
        <li><a href="#configure-the-server-side-google-tag-manager-url">Configure the server-side Google Tag Manager URL</a></li>
        <li><a href="#configure-first-party-user-data-dispatch-to-server-containers">Configure first-party user data dispatch to Server containers</a></li>
        <li><a href="#add-user-properties-for-google-analytics-4">Add user properties for Google Analytics 4</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav></div>

                <span class="simmer">
  <span class="close">X</span>
  <p>
    <span class="fa fa-md fa-bell"></span>
    <strong>The Simmer Newsletter</strong>
  </p>
  <p>
    Subscribe to the <a href="https://www.simoahava.com/newsletter/">Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!
  </p>
  </span>

                
                  <h2 id="auto-migration">Auto-migration</h2>
<blockquote>
<p>The migration is only relevant for Google Analytics 4 configuration tags that existed before the roll-out. Once the roll-out (and migration) is complete, all new product configurations will be done with just the Google Tag.</p>
</blockquote>
<p>Leading up to the migration, you&rsquo;ll see a banner like this in the Google Tag Manager user interface:</p>



<div style="aspect-ratio: 2156 / 144;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/migration-coming.jpg" title="Migration coming">
  
    <img class="fig-img" height="144" width="2156" loading="lazy" src="https://www.simoahava.com/images/2023/08/migration-coming.jpg#ZgotmplZ" alt="Migration coming">
  
    </a>
  
  
</div>


<p>Once the migration is complete, the banner changes to this:</p>



<div style="aspect-ratio: 2504 / 128;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/migration-done.jpg" title="Migration done">
  
    <img class="fig-img" height="128" width="2504" loading="lazy" src="https://www.simoahava.com/images/2023/08/migration-done.jpg#ZgotmplZ" alt="Migration done">
  
    </a>
  
  
</div>


<p>The migration itself includes the following things:</p>
<ol>
<li>Your <strong>Google Analytics 4: Configuration</strong> tags will be automatically migrated to Google Tags.</li>
<li>The <strong>Send a page view event when this configuration loads</strong> toggle becomes a new configuration key named <code>send_page_view</code> with the value either <code>true</code> or <code>false</code>, depending on how you had it configured in the GA4 configuration tag.</li>
<li>The <strong>Send to server container</strong> toggle becomes a new configuration key named <code>server_container_url</code> with the value from the GA4 configuration tag.</li>
<li>The <strong>Include user-provided data from your website (Server only)</strong> toggle becomes a new configuration key named <code>user_data</code> with the value set to the <strong>User-Provided Data</strong> variable from the GA4 configuration tag.</li>
</ol>



<div style="aspect-ratio: 5018 / 2492;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/migration-before-after.jpg" title="Migration before / after">
  
    <img class="fig-img" height="2492" width="5018" loading="lazy" src="https://www.simoahava.com/images/2023/08/migration-before-after.jpg#ZgotmplZ" alt="Migration before / after">
  
    </a>
  
  
</div>


<p>I really want to emphasize this point:</p>
<p>There are no <strong>functional differences</strong> between the old setup and the new setup upon the migration.</p>
<p>The biggest difficulty will be in maneuvering in this new user interface, trying to find what the new key names are for the fields that you used to toggle with user interface elements. And that&rsquo;s hopefully something this article can help with.</p>

                
                  <h2 id="how-to-configure-the-google-tag">How to configure the Google Tag</h2>
<p>You can find the <strong>Google Tag</strong> type in the tag configuration menu.</p>



<div style="aspect-ratio: 1580 / 1034;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/05/tag-picker.jpg" title="Tag picker">
  
    <img class="fig-img" height="1034" width="1580" loading="lazy" src="https://www.simoahava.com/images/2023/05/tag-picker.jpg#ZgotmplZ" alt="Tag picker">
  
    </a>
  
  
</div>


<p>To reduce clutter in the interface, tags related to individual Google products (such as Google Analytics and Google Ads) are now behind a secondary menu you can reach by clicking the product name in the main tag picker interface.</p>
<p>The Google Tag needs a <strong>Tag ID</strong>. This can be one of many different things, so I recommend you <a href="https://support.google.com/tagmanager/answer/12002338#find-tag-id">follow the documentation to find what your Tag ID is</a>. For simplicity&rsquo;s sake, if you&rsquo;re configuring the Google Tag to load a GA4 configuration, you can use the Measurement ID of your GA4 data stream (<code>G-XXXXXXXXXX</code>).</p>



<div style="aspect-ratio: 1054 / 514;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/measurement-id.jpg" title="Measurement ID">
  
    <img class="fig-img" height="514" width="1054" loading="lazy" src="https://www.simoahava.com/images/2023/08/measurement-id.jpg#ZgotmplZ" alt="Measurement ID">
  
    </a>
  
  
</div>


<p>Once you&rsquo;ve added the Tag ID, you can proceed to add <strong>configuration settings</strong> as well as <strong>shared event settings</strong> across your product tags.</p>
<h3 id="configuration-settings">Configuration settings</h3>
<p>Product-specific configurations can be added directly to the Google Tag under the <strong>Configuration settings</strong> heading.</p>
<p>I recommend loading the settings using a <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/#google-tag-configuration-settings">Google Tag: Configuration Settings variable</a>, but you can also add (or override) individual parameters using the table fields.</p>
<p>Since the new configuration settings only accept key-value pairs of parameters, the settings that used to have dedicated UI toggles in the GA4 configuration tag have now been replaced with the following keys:</p>
<table>
<thead>
<tr>
<th>Parameter name</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>send_page_view</code></td>
<td><code>false</code></td>
<td>Whether to send a <code>page_view</code> event automatically when this Google Tag loads.</td>
</tr>
<tr>
<td><code>server_container_url</code></td>
<td><code>https://sst.mydomain.com</code></td>
<td>The URL of your server container, if you want to divert this Google Tag&rsquo;s traffic to your server-side GTM.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>First-party user data</strong> for Server containers and <strong>user properties</strong> for Google Analytics are configured with <a href="#shared-event-settings">Shared event settings</a>.</p>
</blockquote>
<p><a href="https://support.google.com/tagmanager/answer/13438166#parameters">You can find the full list of supported configuration settings here</a>.</p>
<h3 id="shared-event-settings">Shared event settings</h3>
<p><strong>Shared event settings</strong> is where you can configure event parameters that any product tags that reference this Google Tag will make use of.</p>
<p>This includes custom event parameters (e.g. <code>navigation_menu_id</code>), predefined event parameters (e.g. <code>currency</code>) as well as custom settings that do not correspond with actual event parameters (e.g. <code>user_properties</code> and <code>user_data</code>).</p>
<blockquote>
<p>In fact, there&rsquo;s a lot of overlap between what you can set in <strong>Configuration settings</strong> and what you can set in <strong>Shared event settings</strong>. Ideally, you should follow the documentation to figure out what the <a href="https://support.google.com/tagmanager/answer/13438166#parameters">predefined configuration settings</a> and <a href="https://support.google.com/tagmanager/answer/13438771#parameters">predefined event settings</a> are.</p>
</blockquote>



<div style="aspect-ratio: 1754 / 788;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/shared-event-settings.jpg" title="Shared event settings">
  
    <img class="fig-img" height="788" width="1754" loading="lazy" src="https://www.simoahava.com/images/2023/08/shared-event-settings.jpg#ZgotmplZ" alt="Shared event settings">
  
    </a>
  
  
</div>


<p>As with configuration settings, I recommend loading shared event settings from a <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/#google-tag-event-settings">Google Tag: Event Settings</a> variable. You can also add (or override) individual parameters using the table fields.</p>
<blockquote>
<p>An additional perk of using a <strong>Google Tag: Event Settings</strong> variable is that the variable has a table for setting Google Analytics User Properties one by one instead of in bulk.</p>
</blockquote>
<p>If you do want to add user properties in bulk (or with dynamic evaluation criteria), you can use the parameter <code>user_properties</code> set to a JavaScript object. <a href="#add-user-properties-for-google-analytics-4">Read this for an example</a>.</p>
<p>To add first-party user data (<a href="https://developers.google.com/tag-platform/tag-manager/server-side/ads-setup#enhanced_conversions">for Server containers</a>), you need to add a new setting with the name <code>user_data</code> and set its value to a <strong>User-Provided Data</strong> variable.</p>
<p>As before, <strong>custom event parameters</strong> you add will be included in any events that fire after this Google Tag, as long as these event tags reference the Measurement ID loaded by the Google Tag.</p>
<blockquote>
<p>Also as before, the values configured in the Google Tag will be <strong>fixed</strong> to the values when the Google Tag last fired. It&rsquo;s thus <strong>not</strong> the right place to add any dynamic values such as hit timestamps or anything else where the value might change from one event to the next!</p>
</blockquote>

                
                  <h2 id="event-tag-configuration">Event tag configuration</h2>
<p>Even though this article is about the Google Tag, I think it&rsquo;s useful to review how the Google Analytics 4 <strong>Event tag</strong> works, because there are some additional nuances especially with the advent of the new settings variables.</p>
<p>When you create a <strong>Google Analytics 4 Event</strong> tag, you&rsquo;ll notice that the <strong>Measurement ID selector</strong> has changed, too.</p>



<div style="aspect-ratio: 1774 / 596;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/measurement-id-input.jpg" title="measurement-id-input.jpg">
  
    <img class="fig-img" height="596" width="1774" loading="lazy" src="https://www.simoahava.com/images/2023/08/measurement-id-input.jpg#ZgotmplZ" alt="measurement-id-input.jpg">
  
    </a>
  
  
</div>


<p>This selector will automatically look through the container for a <strong>Google Tag</strong> that&rsquo;s mapped with the same Measurement ID (it even works if you use a <strong>Constant variable</strong> for the Measurement ID!).</p>



<div style="aspect-ratio: 1774 / 594;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/measurement-id-validated.jpg" title="measurement-id-validated.jpg">
  
    <img class="fig-img" height="594" width="1774" loading="lazy" src="https://www.simoahava.com/images/2023/08/measurement-id-validated.jpg#ZgotmplZ" alt="measurement-id-validated.jpg">
  
    </a>
  
  
</div>


<blockquote>
<p>If you see a validation error for the Measurement ID, <strong>don&rsquo;t worry</strong>. If you&rsquo;re pulling the Measurement ID from a Lookup Table variable, for example, or if GA4 is loaded as an additional destination with the Google Tag, the validator won&rsquo;t be able to match the ID from the event tag with what the Google Tag actually loads.</p>
</blockquote>
<h3 id="add-configuration-settings-to-the-event-tags">Add configuration settings to the Event tag(s)</h3>
<p>Under <strong>Event Parameters</strong>, you can add <em>configuration settings</em> as well.</p>
<blockquote>
<p>This won&rsquo;t necessarily work for <strong>all</strong> configuration settings – some of them, such as <strong>cookie settings</strong>, need to be established when the Google Tag first fires.</p>
</blockquote>



<div style="aspect-ratio: 1742 / 828;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/server-container-url-event.jpg" title="Server container URL">
  
    <img class="fig-img" height="828" width="1742" loading="lazy" src="https://www.simoahava.com/images/2023/08/server-container-url-event.jpg#ZgotmplZ" alt="Server container URL">
  
    </a>
  
  
</div>


<p>For example, I like to add the <code>server_container_url</code> (using an Event Settings variable unlike in the screenshot above!) to all my event tags to make sure that they will <em>always</em> send data to the Server container – even if I&rsquo;ve inadvertently introduced a race condition with the Google Tag (see below).</p>
<h3 id="one-google-tag-per-tag-id-per-page">One Google Tag per Tag ID per page!</h3>
<p>One very important thing to remember about the Google Tag is that you should <strong>only ever have one single set of configurations per Tag ID active on the page</strong> at any given time.</p>
<p>Multiple configurations <strong>will</strong> override each other.</p>
<p>For example, if you first fire a <strong>Google Tag</strong> with the <code>server_container_url</code> setting, and shortly after another Google Tag (for the same Tag ID) without this setting, then the configuration <em>without</em> the <code>server_container_url</code> is the one that will apply to any events that fire later.</p>



<div style="aspect-ratio: 1906 / 878;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/google-tag-trigger.jpg" title="Google Tag trigger">
  
    <img class="fig-img" height="878" width="1906" loading="lazy" src="https://www.simoahava.com/images/2023/08/google-tag-trigger.jpg#ZgotmplZ" alt="Google Tag trigger">
  
    </a>
  
  
</div>


<p>Similarly, it&rsquo;s a good practice to set the Google Tag to fire <strong>as early as possible</strong> in the load process. Typically you&rsquo;ll want to use either the <strong>Consent Initialization</strong> or the <strong>Initialization</strong> trigger events, depending on whether you are loading consent signals or not.</p>
<p>If an event tag ever happens to fire <strong>before</strong> its corresponding Google Tag has fired, the event tag will generate a <strong>dummy configuration</strong> for itself, without <em>any</em> custom settings you might have configured in your Google Tag. This, too, can mess up your <a href="https://www.simoahava.com/analytics/server-side-tagging-google-tag-manager/">server-side Google Tag Manager</a> setup.</p>
<blockquote>
<p>This leads to a fun thought experiment: You could build your Google Analytics 4 setup in Google Tag Manager without a single Google Tag created! The event tags will generate their own configuration using settings you add to the event tags&rsquo; Event Parameters.</p>
</blockquote>
<blockquote>
<p>The experiment seemed to work fine when I tested it – the only thing that didn&rsquo;t work was the automatic <code>page_view</code> event dispatch. But I don&rsquo;t recommend doing this in a production environment – it&rsquo;s just a fun experiment to highlight the enormous amount of overlap that exists between the Google Tag and individual product tags&hellip;</p>
</blockquote>

                
                  <h2 id="how-do-i">How do I&hellip;</h2>
<p>In this chapter, I&rsquo;ll share some walkthroughs for navigating the new Google Tag.</p>
<p>An important (and confusing) aspect of Google Tag, and individual product tags that use it, is that many of the settings can be configured in multiple places.</p>
<p>For example, you can add Google Analytics User Properties in any one of these settings, technically:</p>
<ul>
<li>Under Google Analytics User Properties in an Event Settings variable.</li>
<li>Under User Properties in a Google Analytics 4 Event tag.</li>
<li>With the key <code>user_properties</code> in the Google Tag&rsquo;s Configuration Settings.</li>
<li>With the key <code>user_properties</code> in a Configuration Settings variable.</li>
<li>With the key <code>user_properties</code> in the Google Tag&rsquo;s Event Settings.</li>
<li>With the key <code>user_properties</code> in an Event Settings variable.</li>
<li>With the key <code>user_properties</code> in the Event Parameters of a Google Analytics 4 event tag.</li>
</ul>
<p>And this applies to <em>most</em> configuration settings. But in this chapter I&rsquo;ll share what I think is the optimal way of adding these features to your Google Tags (and related product tags).</p>
<h3 id="configure-automatic-page-view-dispatch">Configure automatic page view dispatch</h3>
<p>You need to add the field <code>send_page_view</code> with the value <code>true</code> or <code>false</code> into the Google Tag&rsquo;s <strong>Configuration Settings</strong> directly or by using a Configuration Settings variable (the recommended approach).</p>



<div style="aspect-ratio: 1768 / 500;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/send-page-view.jpg" title="send page view setting">
  
    <img class="fig-img" height="500" width="1768" loading="lazy" src="https://www.simoahava.com/images/2023/08/send-page-view.jpg#ZgotmplZ" alt="send page view setting">
  
    </a>
  
  
</div>


<p>Note that it&rsquo;s <code>true</code> by default, so if you <strong>do</strong> want the automatic page view dispatch to happen, you don&rsquo;t need to add the field at all.</p>
<h3 id="configure-the-server-side-google-tag-manager-url">Configure the server-side Google Tag Manager URL</h3>
<p>To add the URL of the Server container, you need to use the <code>server_container_url</code> field, with the value set to the URL origin of your Server container (e.g. <code>https://sgtm.simoahava.com</code>).</p>
<p>You can set this in the Google Tag&rsquo;s <strong>Configuration Settings</strong> directly or with a Configuration Settings variable (recommended).</p>



<div style="aspect-ratio: 1766 / 484;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/server-container-url.jpg" title="Server container URL">
  
    <img class="fig-img" height="484" width="1766" loading="lazy" src="https://www.simoahava.com/images/2023/08/server-container-url.jpg#ZgotmplZ" alt="Server container URL">
  
    </a>
  
  
</div>


<blockquote>
<p>As a good practice, I recommend <em>also</em> adding it to an Event Settings variable that all of your Google Analytics 4 event tags reference. That way any rogue GA4 configurations won&rsquo;t be able to prevent your event data collection to your server container.</p>
</blockquote>
<h3 id="configure-first-party-user-data-dispatch-to-server-containers">Configure first-party user data dispatch to Server containers</h3>
<p>To collect <strong>first-party user data</strong> to Server containers, you can add the field <code>user_data</code> to the Google Tag&rsquo;s <strong>Shared event settings</strong> directly or by using an Event Settings variable (the recommended approach).</p>



<div style="aspect-ratio: 1766 / 604;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/event-settings-user-data.jpg" title="Event settings / User Data">
  
    <img class="fig-img" height="604" width="1766" loading="lazy" src="https://www.simoahava.com/images/2023/08/event-settings-user-data.jpg#ZgotmplZ" alt="Event settings / User Data">
  
    </a>
  
  
</div>


<p>You can also set this in the <strong>Event Parameters</strong> of a Google Analytics 4 event tag (with or without an Event Settings variable), if the user data isn&rsquo;t available when the Google Tag fires.</p>
<h3 id="add-user-properties-for-google-analytics-4">Add user properties for Google Analytics 4</h3>
<p>You have a number of options for adding user properties for Google Analytics 4.</p>
<p>If you want to add them one by one, the best place to add them is in an <strong>Event Settings</strong> variable in the dedicated Google Analytics User Properties table. This variable can be attached to a Google Tag or a GA4 Event tag, depending on when the values are available on the page.</p>



<div style="aspect-ratio: 1772 / 968;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/05/user-props-event-settings.jpg" title="User properties">
  
    <img class="fig-img" height="968" width="1772" loading="lazy" src="https://www.simoahava.com/images/2023/05/user-props-event-settings.jpg#ZgotmplZ" alt="User properties">
  
    </a>
  
  
</div>


<p>If you don&rsquo;t want to use an Event Settings variable, you can also add them directly into a <strong>GA4 Event</strong> tag, using a similar table UI.</p>



<div style="aspect-ratio: 1768 / 636;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/user-properties-event-tag.jpg" title="User properties in an event tag">
  
    <img class="fig-img" height="636" width="1768" loading="lazy" src="https://www.simoahava.com/images/2023/08/user-properties-event-tag.jpg#ZgotmplZ" alt="User properties in an event tag">
  
    </a>
  
  
</div>


<p>Another option is to add the user properties in bulk. This is useful if you want to set multiple properties in one go, or if you want to use some custom JavaScript logic to determine the list of properties to set at any given time.</p>
<p>In this case, you&rsquo;d need to use the key <code>user_properties</code> whose value is set to a JavaScript object, where the key-value pairs correspond with the user properties (and their values) you want to set:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#00a">function</span>() {
  <span style="color:#00a">var</span> user_props = {
    loyalty_status: {{Get user loyalty status}},
    signup_method: <span style="color:#a50">&#39;email&#39;</span>
  };
  <span style="color:#00a">return</span> user_props;
}
</code></pre></div>



<div style="aspect-ratio: 1760 / 834;" class="figure nocaption">
  
    <a href="https://www.simoahava.com/images/2023/08/user-props-js-key.jpg" title="User props JS key">
  
    <img class="fig-img" height="834" width="1760" loading="lazy" src="https://www.simoahava.com/images/2023/08/user-props-js-key.jpg#ZgotmplZ" alt="User props JS key">
  
    </a>
  
  
</div>



                
                  <h2 id="summary">Summary</h2>
<p>Upon release, the Google Tag is <em>mostly</em> a cosmetic update, where the Google Analytics 4 configuration tags have been replaced with this more <strong>product-agnostic</strong> approach.</p>
<p>From a Google Analytics 4 developer&rsquo;s point of view, I&rsquo;m personally not a fan of the <strong>degraded UX</strong> when compared to the old configuration tags. Instead of having handy user interface features like checkboxes and drop-down menus for configuring GA4-specific settings, we now have to utilize the parameter table.</p>
<p>At the same time, I love that we can now use <a href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/">settings variables</a>! Once Google Tag becomes more prolific across all Google&rsquo;s tagging products, setting everything up through GTM will probably be very intuitive and streamlined.</p>
<p>It&rsquo;s still <em>very</em> confusing how everything works together. For example, you can configure settings in the Google Tag, but you can also configure them in an Event tag. User Properties are added with a key-value pair in a Google Tag but in a table selector in an Event tag. This all boils down to how Google Tag <strong>isn&rsquo;t just for Google Analytics 4</strong>. The decision to make it completely product-agnostic must have been a difficult one.</p>



<div style="aspect-ratio: 4368 / 2463;" class="figure ">
  
    <a href="https://www.simoahava.com/images/2023/08/g-tag.jpg" title="Source: https://support.google.com/tagmanager/answer/12002338">
  
    <img class="fig-img" height="2463" width="4368" loading="lazy" src="https://www.simoahava.com/images/2023/08/g-tag.jpg#ZgotmplZ" alt="Source: https://support.google.com/tagmanager/answer/12002338">
  
    </a>
  
   
    <span class="caption">Source: https://support.google.com/tagmanager/answer/12002338</span>
  
</div>


<p>I think we&rsquo;re entering <strong>phase 2.0</strong> of Google&rsquo;s tagging platform. The first phase was building tagging solutions that would eventually share a backend and much of the implementation logic.</p>
<p>This second phase is about <strong>consolidating</strong> this shared technology to avoid the redundancy of deploying almost identical libraries to cater to the different tagging products. Instead, you&rsquo;d ideally deploy <strong>just a single tag library</strong> and then toggle which products you want to activate.</p>
<p>While I feel like this consolidation is more in Google&rsquo;s favor than in the favor of their end users, <strong>I do understand the rationale</strong>. It must be daunting to users (especially those with limited implementation skills) to wade through the waters of different product implementation guides and container snippets and configuration strings and such.</p>
<p>For these users, having a single tag with (hopefully) intuitive UI controls is a boon.</p>
<p>For us <strong>power users</strong> who want to use GTM as a deployment system for <em>non-Google tags</em>, too, I&rsquo;m happy that none of our advanced feature sets is compromised with this shift. But I&rsquo;m also worried that this might change in the future.</p>
<p>I think Google still has a <strong>lot of product design work</strong> ahead of them to make Google Tag more intuitive and to alleviate the concerns of <em>purpose muddling</em>.</p>
<p>For example, with Google Tag Manager I have full control over what is actually happening on the website – I control that with triggers. With Google Tag, I no longer have that control. Google Tag admins can now sideload additional products through the Google Tag UI, and they can enable potentially hazardous things like <a href="https://support.google.com/tagmanager/answer/12131703#Data&amp;zippy=%2Cinclude-user-provided-data-from-your-website%2Callow-user-provided-data-capabilities">automatic user data scraping</a>.</p>
<p>With this release, my mind is stimulated by a very confusing combination of <strong>optimism</strong>, <strong>curiosity</strong>, <strong>skepticism</strong>, and <strong>doubt</strong>. A typical Google release, in other words.</p>

                
              
              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag/">google tag</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-analytics-4/">google analytics 4</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cloud-run-server-side-tagging-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=The%20Google%20Tag%20Template%20In%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://commento.simoahava.com/js/commento.js" data-no-livereload="true"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2025 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/cloud-run-server-side-tagging-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/settings-variables-for-ga4-in-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=The%20Google%20Tag%20Template%20In%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
          <i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=The%20Google%20Tag%20Template%20In%20Google%20Tag%20Manager%20https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/%20via%20@SimoAhava">
          <i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/google-tag-template-in-google-tag-manager/">
          <i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://commento.simoahava.com/js/count.js"></script>

    <script>
      !function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),o=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");if(e){if(o){e.style.display="none"}t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"})}}();
    </script>
    <style>
      .ads {
	  width: 1px;
      }
      </style>
         

    
  </body>
</html>

