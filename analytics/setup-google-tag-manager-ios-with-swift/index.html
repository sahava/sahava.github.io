

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Setup Google Tag Manager iOS With Swift | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2015\/10\/swift-xcode.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/setup-google-tag-manager-ios-with-swift\/",
  "datePublished": "2015-10-20T12:16:27\x2b00:00",
  "dateModified": "2015-10-20T12:16:27\x2b00:00",
  "description": "Guide for setting up Google Tag Manager tracking in your iOS app using Swift and the legacy SDK.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.61.0 with theme Tranquilpeak 0.4.3-BETA">
    <title>Setup Google Tag Manager iOS With Swift | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/setup-google-tag-manager-ios-with-swift/">
    
    <meta name="description" content="Guide for setting up Google Tag Manager tracking in your iOS app using Swift and the legacy SDK.">
    <meta property="og:description" content="Guide for setting up Google Tag Manager tracking in your iOS app using Swift and the legacy SDK.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Setup Google Tag Manager iOS With Swift">
    <meta property="og:url" content="/analytics/setup-google-tag-manager-ios-with-swift/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Setup Google Tag Manager iOS With Swift">
    <meta name="twitter:description" content="Guide for setting up Google Tag Manager tracking in your iOS app using Swift and the legacy SDK.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2015/10/swift-xcode.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2015/10/swift-xcode.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      Setup Google Tag Manager iOS With Swift
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2015-10-20T12:16:27Z">
        
  October 20, 2015

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


       | <a href="https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>I've been meaning to write about <a href="https://tagmanager.google.com/">Google Tag Manager</a> for <strong>mobile apps</strong> for such a long time. Finally, I have some great use cases to share, as well as some useful examples for implementing <a href="https://developers.google.com/tag-manager/ios/v3/">GTM for iOS</a>. That's right, this is an <strong>iOS</strong> guide, and, to be more specific, geared towards a successful <strong>Swift</strong> implementation.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/swift-xcode.jpg" title="Google Tag Manager iOS with Swift">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/swift-xcode.jpg#ZgotmplZ" alt="Google Tag Manager iOS with Swift">
  
    </a>
  
  
</div>


<p>If you didn't know, <a href="https://developer.apple.com/swift/">Swift</a> is a relatively new programming language, developed by Apple for iOS and OS X programming. It's got some nice synergies with existing Objective-C implementations, which means you can either gradually migrate to Swift, or just start writing new apps with it instantly.</p>
<h1 id="table-of-contents">Table of Contents</h1><nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started">Getting started</a></li>
    <li><a href="#1-google-tag-manager-setup">1. Google Tag Manager setup</a></li>
    <li><a href="#2-create-a-new-xcode-workspace">(2. Create a new Xcode workspace)</a></li>
    <li><a href="#3-download-the-sdks-using-cocoapods">3. Download the SDKs using Cocoapods</a></li>
    <li><a href="#4-create-and-edit-the-bridging-header-file">4. Create and edit the Bridging Header file</a></li>
    <li><a href="#5-load-google-tag-manager-in-the-project">5. Load Google Tag Manager in the project</a>
      <ul>
        <li><a href="#51-add-container-binary-to-project">5.1. Add container binary to project</a></li>
        <li><a href="#52-modify-appdelegate">5.2. Modify AppDelegate</a></li>
      </ul>
    </li>
    <li><a href="#6-push-stuff-to-data-layer">6. Push stuff to Data Layer</a></li>
    <li><a href="#bonus-simple-interface-for-interacting-with-the-data-layer">BONUS: Simple interface for interacting with the Data Layer</a></li>
    <li><a href="#comments-on-google-tag-manager-for-ios">Comments on Google Tag Manager for iOS</a></li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
<p>In this article, we'll walk through a simple Swift implementation of Google Tag Manager and Google Analytics. I'll very briefly review the GTM SDK in the Comments chapter, but this is a how-to article, not a why-should-I writeup. I'm going to be expanding on this theme of mobile GTM in future texts, so this will stand out as a starting point for understanding how the SDK plays together with your application.</p>
<p>Many thanks to my colleague, Sampsa Kuronen, for exposing me to the dark arts of Xcode and Swift.</p>
<h2 id="getting-started">Getting started</h2>
<p>This guide is written with the assumption that you're using the latest version of <a href="https://developer.apple.com/xcode/">Xcode</a> as your IDE of choice. It's not the best IDE (by far) out there, but it has been created with iOS and OS X programming in mind, meaning there are certain benefits from using it.</p>
<p>Another, quite obvious, assumption is that you have access to your project source. You will be <strong>adding new files</strong>, <strong>importing headers</strong> and <strong>modifying project source code</strong>. It's a good idea to run everything you're doing by your team, as you don't want to merge unverified source code into your project.</p>
<p>Here's something you might not yet fully realize:</p>
<p><strong>GTM for mobile apps <em>is not the same</em> as GTM for the web!</strong></p>
<p>The level of freedom you have when working with the latter simply does not exist in the mobile app world. We're working with <strong>projects</strong> and <strong>applications</strong>, so you need to have a solid understanding of how to do software development in a proper and consistent manner, abiding to any design patterns you have found successful.</p>
<h2 id="1-google-tag-manager-setup">1. Google Tag Manager setup</h2>
<p>To get things rolling, let's setup Google Tag Manager first. In this tutorial, we'll create a simple Screen View Tag to test the implementation with. In later chapters, we'll go over the event payload as well, but it's up to you to create the Tag for it.</p>
<p>In GTM, create a new Container under some Account. Choose <strong>iOS</strong> as the container type, and give it a descriptive name.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/create-container.jpg" title="Google Tag Manager container">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/create-container.jpg#ZgotmplZ" alt="Google Tag Manager container">
  
    </a>
  
  
</div>


<p>Next, you'll be whisked to the Container Overview, and you'll see a small popup saying your container is ready to use. You can close that.</p>
<p>As you can see, it looks pretty much like GTM for web.</p>
<p>Next, go to <strong>Tags</strong>, and click <strong>New</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/tags-new.jpg" title="New Tag">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/tags-new.jpg#ZgotmplZ" alt="New Tag">
  
    </a>
  
  
</div>


<p>Wow, that's <strong>way fewer</strong> Tags than in GTM for web. Let's hope we'll get more soon! Also, make note that there is no <strong>Custom HTML Tag</strong>. It makes perfect sense, since you're not working with HTML, but I thought I should point it out nevertheless.</p>
<p>We'll be creating a simple <strong>Google Analytics</strong> Tag , which sends an <strong>App View</strong> (also known as a Screen View) to Google Analytics when the first <strong>View</strong> of the app loads (don't worry, it will all be clear soon). So, create the Google Analytics Tag, and add the <strong>Tracking ID</strong>.</p>
<p>Make sure that <strong>App View</strong> is selected as the Track Type, and expand <strong>More Settings</strong> -&gt; <strong>Fields to Set</strong>.</p>
<p>Click <code>+ Add Field</code>, and add <strong>screenName</strong> as the Field Name. In Value, click the &ldquo;Variable&rdquo; button and choose <strong>New Variable&hellip;</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/new-variable.jpg" title="new-variable">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/new-variable.jpg#ZgotmplZ" alt="new-variable">
  
    </a>
  
  
</div>


<p>We need to create a Variable, which picks up the desired Screen Name from the Data Layer (<em>Screen Name</em> is to an app what <em>Page</em> is to a website). So, after marvelling the list of Variables that's <a href="https://support.google.com/tagmanager/answer/6106899?hl=en#mobile">completely different</a> from GTM for web, choose <strong>Data Layer Variable</strong>.</p>
<p>Give it a descriptive name, e.g. <strong>DLV - screenName</strong>, and set the Variable Name field to <strong>screenName</strong>. Save the new Variable.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/data-layer-variable-screenName.jpg" title="data layer variable screenName">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/data-layer-variable-screenName.jpg#ZgotmplZ" alt="data layer variable screenName">
  
    </a>
  
  
</div>


<p>Next, in the Tag screen, click <strong>Continue</strong> and proceed to the <strong>Fire On</strong> step.</p>
<p>In this step, click <strong>Custom</strong>, as you want to create a new Trigger for the Tag. So, in the popup that appears, click <strong>New</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/new-trigger.jpg" title="Create new Custom Trigger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/new-trigger.jpg#ZgotmplZ" alt="Create new Custom Trigger">
  
    </a>
  
  
</div>


<p>Give the Trigger a descriptive name, e.g. <strong>Event - screenView</strong>, and set the condition as in the screenshot below.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/custom-trigger.jpg" title="Custom Event Trigger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/custom-trigger.jpg#ZgotmplZ" alt="Custom Event Trigger">
  
    </a>
  
  
</div>


<p>Save the Trigger, and then click &ldquo;Create Tag&rdquo; to, well, create the Tag.</p>
<p>Phew, almost done here! We'll go with just this one Tag, as this is a simple setup guide.</p>
<p>Next, go to the <strong>Versions</strong> page of your GTM container, and click open the <strong>Actions</strong> menu for the only container version you'll see (the initial draft). Click <strong>Publish</strong> and follow the prompts to publish your container.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/publish-container.jpg" title="Publish container">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/publish-container.jpg#ZgotmplZ" alt="Publish container">
  
    </a>
  
  
</div>


<p>There, GTM is <strong>almost</strong> ready, hungry to process the Data Layer commands you dispatch from your app.</p>
<p>Just one more thing to do. You'll need to download the container version <strong>binary</strong>, as GTM for apps is a bit different in how it processes containers. Basically, you can't trust that the app will have access to a container downloaded over the network, so you'll always want to provide a local container binary file for the app as well. Read more about this in chapter 5.1.</p>
<p>So, click open the <strong>Actions</strong> menu for the <strong>Live</strong> container version, and choose Download. Make sure you download it somewhere you can easily find it from.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/gtm-download-container.jpg" title="Download GTM container version">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/gtm-download-container.jpg#ZgotmplZ" alt="Download GTM container version">
  
    </a>
  
  
</div>


<p>That's it! We're done with the GTM setup. All that's left is the minor task of upgrading your App to use the Google Tag Manager (and Google Analytics) SDK!</p>
<p>Congratulate yourself with a power bar and some coffee.</p>
<p>I'll wait. Maybe get some coffee myself, and boogie silently to your profound success in setting up GTM!</p>
<h2 id="2-create-a-new-xcode-workspace">(2. Create a new Xcode workspace)</h2>
<p>I won't linger here, as I'm actually assuming you already have an <a href="https://developer.apple.com/xcode/">Xcode</a> project and workspace to work with. If you need something to get started with, take a look at <a href="http://www.raywenderlich.com/115279/swift-2-tutorial-part-2-a-simple-ios-app">this tutorial</a> by Ray Wenderlich. If you pay close attention to the screenshots in the article you're reading right now, you might notice that I'm actually using Ray's Tip Calculator as the basis for this article.</p>
<p>If you only have a project setup and no workspace, keep reading. When you add the required dependencies to your project using Cocoapods (see below), a workspace is automatically generated for you.</p>
<h2 id="3-download-the-sdks-using-cocoapods">3. Download the SDKs using Cocoapods</h2>
<p>In order for Google Tag Manager to work with your app, you will need to download the SDKs for both Google Tag Manager and Google Analytics. To do that we'll use <a href="https://cocoapods.org/">Cocoapods</a>, which is an open-source dependency manager for your iOS and OS X projects. As you might have guessed, both Google Analytics and Google Tag Manager SDKs are also distributed as Pods.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/cocoapods.jpg" title="Cocoapods">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/cocoapods.jpg#ZgotmplZ" alt="Cocoapods">
  
    </a>
  
  
</div>


<p>After you've installed Cocoapods (if you need help, check e.g. <a href="https://developers.google.com/ios/cocoapods">this guide</a>), you need to go to your workspace root directory (the one with your .xcodeproj and .xcworkspace files), and type:</p>
<p><code>pod init</code></p>
<p>This command initializes a simple Podfile for your project.</p>
<p>Open Podfile with your favorite editor.</p>
<p>Between the lines <code>target 'YourProject' do</code> and <code>end</code>, you need to add the Pod references you want to download and install for your project, so add the following construct into the file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">target <span style="color:#e6db74">&#39;YourProject&#39;</span> <span style="color:#66d9ef">do</span>
  pod <span style="color:#e6db74">&#39;GoogleTagManager&#39;</span>
  pod <span style="color:#e6db74">&#39;Google/Analytics&#39;</span>
end</code></pre></div>
<p>Once you've done this, you can run the command <code>pod install</code>, which will automatically install and import all the files to your Xcode project. Neat, huh?</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/pod-install.jpg" title="Install Google Analytics and google Tag Manager dependencies">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/pod-install.jpg#ZgotmplZ" alt="Install Google Analytics and google Tag Manager dependencies">
  
    </a>
  
  
</div>


<p>Now that you've installed the Pods, the next thing you need to do is import them into your project.</p>
<p>It's not exactly straightforward, as Google Tag Manager source code is in Objective-C, which means you can't just directly import it to your Swift project. Instead, you need to use something called a <strong>Bridging Header</strong>.</p>
<h2 id="4-create-and-edit-the-bridging-header-file">4. Create and edit the Bridging Header file</h2>
<p>A <em>bridging header</em> is key to creating projects where the codebase includes code from multiple languages - Objective-C and Swift in this case. Basically, you use a bridging header file to expose Objective-C structures in your Swift files, so that you can, for example, work with the GTM SDK (which is Objective-C at the time of writing) without having to worry about clashes and conflicts that occur when working across languages.</p>
<p>First of all, if you installed the Pods correctly, you should see them in your <strong>Project navigator</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/tree-view.jpg" title="Project navigator">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/tree-view.jpg#ZgotmplZ" alt="Project navigator">
  
    </a>
  
  
</div>


<p>Now, to create the bridging header file, go to <strong>File</strong> -&gt; <strong>New</strong> -&gt; <strong>File</strong>. Under <strong>iOS</strong> / <strong>Source</strong>, you'll find <strong>Header File</strong>, so select that and click <strong>Next</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/bridging-header-create.jpg" title="Create new header file">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/bridging-header-create.jpg#ZgotmplZ" alt="Create new header file">
  
    </a>
  
  
</div>


<p>Give the file a name: <code>yourProjectName-Bridging-Header.h</code>, and save it in your project root. Remember to choose a target for the file, so that the header file is properly associated with your project.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/new-header.jpg" title="New header file settings">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/new-header.jpg#ZgotmplZ" alt="New header file settings">
  
    </a>
  
  
</div>


<p>You should see the file open in your editor. Add the following import statements to the file, and then save it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">#<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">TAGManager.h</span><span style="color:#e6db74">&#34;</span>
#<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">TAGContainer.h</span><span style="color:#e6db74">&#34;</span>
#<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">TAGContainerOpener.h</span><span style="color:#e6db74">&#34;</span>
#<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">TAGDataLayer.h</span><span style="color:#e6db74">&#34;</span>
#<span style="color:#66d9ef">import</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">TAGLogger.h</span><span style="color:#e6db74">&#34;</span>
#<span style="color:#66d9ef">import</span> &lt;<span style="color:#a6e22e">Google</span><span style="color:#f92672">/</span><span style="color:#a6e22e">Analytics</span>.<span style="color:#a6e22e">h</span>&gt;</code></pre></div>
<p>These headers include all the necessary Google Tag Manager headers, as well as all the Google Analytics SDK headers.</p>
<p>Finally, you need to include the bridging header file in your build settings.</p>
<p>Click your project (the root level node) in your Project navigator. In the settings screen that opens, choose the tag labelled <strong>Build Settings</strong>, and scroll all the way down to <strong>Swift Compiler - Code Generation</strong>.</p>
<p>Edit the field next to <strong>Objective-C Bridging Header</strong>, and type in the file name of the bridging header file you just created.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/build-settings.jpg" title="build-settings">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/build-settings.jpg#ZgotmplZ" alt="build-settings">
  
    </a>
  
  
</div>


<p>Now, build your project and make sure everything checks out right.</p>
<p>Next up, setting up Google Tag Manager in the project!</p>
<h2 id="5-load-google-tag-manager-in-the-project">5. Load Google Tag Manager in the project</h2>
<p>My, how far we've come!</p>
<p>If you look at how the <a href="https://developers.google.com/tag-manager/ios/v3/">developer guide kicks off</a>, you'll notice the rather limited capabilities of Google Tag Manager for mobile. For now, at least. Basically, you can dispatch Google Analytics hits and run custom functions. Also, you can change configuration values.</p>
<p>In this tutorial, we'll focus on the first use case, so we'll setup a simple interface for tracking screen views and events to Google Analytics.</p>
<h3 id="51-add-container-binary-to-project">5.1. Add container binary to project</h3>
<p>Before we do anything, however, we'll need to add the <strong>container version binary</strong> to the project. This is rather important, as even though GTM can load a &ldquo;fresh&rdquo; container over the network, some of the interactions on the site might actually need to be tracked <em>before</em> the asynchronous operation of loading the container is complete. In this case, GTM can fall back to the local container binary, also referred to as the <em>default</em> container.</p>
<p><strong>NOTE!</strong> This also means that you should try to keep the binary in the project as up-to-date as possible, so that batches which use the binary would be as similar as possible to those that use the fresh container. So make it a habit that every time you publish a new container version, you download the version binary, and add it to the project (delete the old binary first).</p>
<p>We'll cover all this very soon, don't worry.</p>
<p>In Xcode, simply drag-and-drop the container binary file to your project. A window should open, where you need to make sure that you add the file to your target (so check the relevant box).</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/add-file.jpg" title="Add container binary to project">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/add-file.jpg#ZgotmplZ" alt="Add container binary to project">
  
    </a>
  
  
</div>


<p>If you don't have a <strong>Supporting Files</strong> group under your project, now's a good time to create one. Right-click on the container binary, and choose <strong>New Group from Selection</strong>. Name the group Supporting Files. Your navigator should look like this:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/supporting-files.jpg" title="Supporting files group">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/supporting-files.jpg#ZgotmplZ" alt="Supporting files group">
  
    </a>
  
  
</div>


<p>If you already do have a Supporting Files group, just move the binary into that folder.</p>
<p>Next up, <em>source code and stuff</em>.</p>
<h3 id="52-modify-appdelegate">5.2. Modify AppDelegate</h3>
<p>The <strong>AppDelegate.swift</strong> file is where you control states of your app. For example, when the app loads, AppDelegate, well, <em>delegates</em> operations to different parts of your application. Similarly, when your phone rings and interrupts the application, you'd control this process through AppDelegate.</p>
<p>Since Google Tag Manager is something you want to load as the application loads, you'll need to make changes to AppDelegate.swift. So, proceed to open the file in your editor.</p>
<p>We want to modify the function which is called once the application is loaded. Aptly, there's one that looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">application</span>(application: UIApplication, didFinishLaunchingWithOptions launchOptions: [NSObject: AnyObject]?) -&gt; Bool {
    <span style="color:#75715e">//</span><span style="color:#75715e"> </span><span style="color:#75715e">O</span><span style="color:#75715e">v</span><span style="color:#75715e">e</span><span style="color:#75715e">r</span><span style="color:#75715e">r</span><span style="color:#75715e">i</span><span style="color:#75715e">d</span><span style="color:#75715e">e</span><span style="color:#75715e"> </span><span style="color:#75715e">p</span><span style="color:#75715e">o</span><span style="color:#75715e">i</span><span style="color:#75715e">n</span><span style="color:#75715e">t</span><span style="color:#75715e"> </span><span style="color:#75715e">f</span><span style="color:#75715e">o</span><span style="color:#75715e">r</span><span style="color:#75715e"> </span><span style="color:#75715e">c</span><span style="color:#75715e">u</span><span style="color:#75715e">s</span><span style="color:#75715e">t</span><span style="color:#75715e">o</span><span style="color:#75715e">m</span><span style="color:#75715e">i</span><span style="color:#75715e">z</span><span style="color:#75715e">a</span><span style="color:#75715e">t</span><span style="color:#75715e">i</span><span style="color:#75715e">o</span><span style="color:#75715e">n</span><span style="color:#75715e"> </span><span style="color:#75715e">a</span><span style="color:#75715e">f</span><span style="color:#75715e">t</span><span style="color:#75715e">e</span><span style="color:#75715e">r</span><span style="color:#75715e"> </span><span style="color:#75715e">a</span><span style="color:#75715e">p</span><span style="color:#75715e">p</span><span style="color:#75715e">l</span><span style="color:#75715e">i</span><span style="color:#75715e">c</span><span style="color:#75715e">a</span><span style="color:#75715e">t</span><span style="color:#75715e">i</span><span style="color:#75715e">o</span><span style="color:#75715e">n</span><span style="color:#75715e"> </span><span style="color:#75715e">l</span><span style="color:#75715e">a</span><span style="color:#75715e">u</span><span style="color:#75715e">n</span><span style="color:#75715e">c</span><span style="color:#75715e">h</span><span style="color:#75715e">.</span>
    <span style="color:#75715e">//</span><span style="color:#75715e"> </span><span style="color:#75715e">.</span><span style="color:#75715e">.</span><span style="color:#75715e">.</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}</code></pre></div>
<p>That's the callback we'll open the container in. Here, &ldquo;open the container&rdquo; means we'll make it available for dispatching hits using the available interfaces. On top of that, having a container available is a prerequisite for interacting with the <code>TAGDataLayer</code> interface. This is a slight departure, again, for how things work with GTM for web, where you could create a <code>dataLayer</code> object before the container loading began.</p>
<p>Add the following lines into the function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> tagManager = TAGManager.instance()
TAGContainerOpener.openContainerWithId(
    <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">GTM-XXXXXX</span><span style="color:#e6db74">&#34;</span>,
    tagManager: tagManager,
    openType: kTAGOpenTypePreferFresh,
    timeout: <span style="color:#66d9ef">nil</span>,
    notifier: <span style="color:#66d9ef">self</span>)
<span style="color:#75715e">//</span><span style="color:#75715e"> </span><span style="color:#75715e">i</span><span style="color:#75715e">f</span><span style="color:#75715e"> </span><span style="color:#75715e">D</span><span style="color:#75715e">E</span><span style="color:#75715e">B</span><span style="color:#75715e">U</span><span style="color:#75715e">G</span>
tagManager.logger.setLogLevel(kTAGLoggerLogLevelVerbose)</code></pre></div>
<p>Line-by-line, here's what happens. First, you initialize an immutable variable named <code>tagManager</code> as a singleton instance of the <code>TAGManager</code> class.</p>
<p>Next, you use the <code>TAGContainerOpener</code> interface to signal that you want to fetch a container to work with. Remember to change the <strong>&ldquo;GTM-XXXXXX&rdquo;</strong> to whatever the container ID you're using is.</p>
<p>This next bit is a bit more complicated.</p>
<p>When you download the container binary into the Supporting Files of your project, it's called a <em>default container</em>. This is what GTM uses until a saved container is found, or if this saved container is not fresh (&gt; 12 hours old), a new, fresh one is loaded over the network. This is why it's imperative that the saved binary is usable. The first screen view of the app might well be ready to dispatch before a non-default container has loaded, which means you want the default container to be as accurate as possible.</p>
<p>When choosing the <code>openType</code> value, I suggest you use either <code>kTAGOpenTypePreferNonDefault</code> or <code>kTAGOpenTypePreferFresh</code>.</p>
<p><code>kTAGOpenTypePreferNonDefault</code> attempts to load a saved container (i.e. one that was previously loaded over the network), regardless of whether it's stale or not. Stale means it's over 12 hours old. This means that you'll have a container to work with sooner. If the container is stale, Google Tag Manager starts an asynchronous request for a fresh container over the network.</p>
<p><code>kTAGOpenTypePreferFresh</code> only loads a saved container if it's fresh. If it isn't, it loads a new, fresh container over the network.</p>
<p>Both revert to the default container if a saved container couldn't be loaded or if there was a network error.</p>
<p>Next, you can enable logging. I've commented <strong>if DEBUG</strong> because it might be a good idea to verbosely log only if you're debugging the app, since it produces a <em>lot</em> of console output, which is unnecessary overhead in the live app.</p>
<p>You might have noticed that I skipped over the <code>notifier: self</code> key-value pair in the <code>TAGContainerOpener</code> call. That's because it requires a bit more attention.</p>
<p>The <code>notifier</code> parameter is basically a setting, where I instruct GTM to notify my app when a container becomes available. Once a container is available, our methods and functions can create an instance of the <code>AppDelegate</code> class to access the loaded container. You can use <code>container</code> to <a href="https://developers.google.com/tag-manager/ios/v3/#get-values">update your app's configuration values</a> through GTM, for example.</p>
<p>Because you're invoking <code>self</code> as the parameter value, it means that the class you're currently in (<code>AppDelegate</code>) needs to implement the <code>TAGContainerNotifier</code> protocol, as <code>self</code> is bound to an instance of the current class.</p>
<p>Scroll up to the beginning of AppDelegate, and change the class declaration to:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AppDelegate</span>: UIResponder, UIApplicationDelegate, TAGContainerOpenerNotifier {
    ...
    <span style="color:#66d9ef">var</span> container: TAGContainer?</code></pre></div>
<p>In other words, you add the <code>TAGContainerOpenerNotifier</code> to the declaration line, and in the beginning of the class (so <em>not</em> in a <code>func</code>), you create a new variable <code>container</code>, which refers to a <code>TAGContainer</code> optional.</p>
<p>Phew! Almost there.</p>
<p>In the end of the class, after all the other <code>func</code> declarations, add a new one:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">containerAvailable</span>(container: TAGContainer) -&gt; Void {
    dispatch_async(dispatch_get_main_queue(), {
        <span style="color:#66d9ef">self</span>.container = container;
    });
}</code></pre></div>
<p>And now things should start aligning in your mind.</p>
<p><code>containerAvailable</code> is the callback that <code>TAGContainerOpener</code> invokes once a container becomes available. The container is passed as a parameter to this function.</p>
<p>Next, we initialize <code>self.container</code> with the retrieved container. This way your app can use the loaded container through an instance of the <code>AppDelegate</code> class.</p>
<p>By the way, here's a nifty trick. If you want to <strong>always</strong> load a fresh container over the network, you can add the following line to the <code>dispatch_async</code> callback:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">container.refresh()</code></pre></div>
<p>This forces a fresh container load over the network.</p>
<p>How you want to load the container is completely up to you. Some methods, such as <code>container.refresh()</code>, impose more network requests than others, so it's always a compromise between freshness vs. availability vs. network load.</p>
<p>Much of the container load process is explained <a href="https://developers.google.com/tag-manager/ios/v3/#open-advanced">here</a>, though I have to say it's not very clearly documented at all (and it's in Objective-C).</p>
<p>Now, build the project and make sure no errors pop up. You can run the project, and you should already see some verbose logging:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/debug-verbose.jpg" title="Verbose logging">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/debug-verbose.jpg#ZgotmplZ" alt="Verbose logging">
  
    </a>
  
  
</div>


<p>You're ready to push stuff to the Data Layer to fire your Tags. Awesome!</p>
<h2 id="6-push-stuff-to-data-layer">6. Push stuff to Data Layer</h2>
<p>This is where Google Tag Manager for apps is very similar to GTM for web. By invoking the <code>push</code> method of the Data Layer instance, GTM will react to the dictionary you push and fire any relevant Tags.</p>
<p>To try it out, open a view controller file in your project. If it's a default project setup, there should be one named <code>ViewController.swift</code>.</p>
<p>Now, to send the screen view, it makes sense to only send it once the view has loaded. So, find the method with the following signature, or create one if it doesn't exist:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewWillAppear</span>(animated: Bool) {
  <span style="color:#66d9ef">super</span>.viewWillAppear(animated)
}</code></pre></div>
<p>Let's create an instance of <code>dataLayer</code> and push the payload to it. So modify the function to look like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewWillAppear</span>(animated: Bool) {
  <span style="color:#66d9ef">super</span>.viewWillAppear(animated)
  <span style="color:#66d9ef">let</span> dataLayer = TAGManager.instance().dataLayer
  dataLayer.push([<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">event</span><span style="color:#e6db74">&#34;</span> : <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">screenView</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">screenName</span><span style="color:#e6db74">&#34;</span> : <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Home</span><span style="color:#e6db74">&#34;</span>])
}</code></pre></div>
<p>First you create an immutable variable <code>dataLayer</code>, which is a reference pointing to the <code>dataLayer</code> interface of a <code>TAGManager</code> instance.</p>
<p>Next, you do the <code>dataLayer.push()</code>, sending a dictionary with key-value pairs. As with GTM for web, the <code>'event'</code> is what makes things tick, and the other variables can (and will) be utilized if that's how you've set the Tags up.</p>
<p>Since we already have a Tag which uses the <code>'screenName'</code> variable, this code should work, sending a screen view with <strong>Home</strong> as the screen name.</p>
<p>Go ahead, build the project and run your app. You should see something like this in the debugger:</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2015/10/debugger-sent-hit.jpg" title="Debugging sent hits">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2015/10/debugger-sent-hit.jpg#ZgotmplZ" alt="Debugging sent hits">
  
    </a>
  
  
</div>


<p>As you can see, the <strong>&amp;cd;</strong> (for screen name) and <strong>&amp;t;</strong> parameters are right there, meaning the payload is OK. Then, there's the GET request to the Google Analytics endpoint, signalling that the payload has been dispatched.</p>
<p>And that's it! You've got a functioning Google Tag Manager installation in your hands.</p>
<h2 id="bonus-simple-interface-for-interacting-with-the-data-layer">BONUS: Simple interface for interacting with the Data Layer</h2>
<p>Since we want to be slightly more ambitious, we can actually create an interface (or module) for interacting with the Data Layer. This way you can create elegant code in your app, simplifying some of the complex interactions and mitigating the risk of human error (e.g. typos).</p>
<p>Create a new file called <strong>Analytics.swift</strong>. Add the following code within:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Foundation</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Analytics</span> {
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">let</span> dataLayer = TAGManager.instance().dataLayer
    
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">DataLayerMessage</span> {
        <span style="color:#66d9ef">let</span> event: String
        <span style="color:#66d9ef">let</span> ScreenName: String

        <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">getPayload</span>() -&gt; [String:AnyObject] {
            <span style="color:#66d9ef">return</span> [<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">event</span><span style="color:#e6db74">&#34;</span> : <span style="color:#66d9ef">self</span>.event, <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">screenName</span><span style="color:#e6db74">&#34;</span> : <span style="color:#66d9ef">self</span>.screenName]
        }
    }
 
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">pushScreen</span>(screenName: String) {
        <span style="color:#66d9ef">let</span> screenViewData = DataLayerMessage(event: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">screenView</span><span style="color:#e6db74">&#34;</span>, screenName: screenName)
        dataLayer.push(screenViewData.getPayload())
    }

}</code></pre></div>
<p>Here, you create a new class called <code>Analytics</code>. Within, you define some variables, structs and methods that can be used by other parts of your app.</p>
<p>You can expand the <code>DataLayerMessage</code> struct and the <code>pushScreen</code> method to include more extensive payloads, such as event objects (with category, action, label, and value), custom definitions, content groups and so forth.</p>
<p>To send a screen view with this interface, all you need is the following command:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">Analytics.pushScreen(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Some screen name</span><span style="color:#e6db74">&#34;</span>)</code></pre></div>
<p>The class will take care of the rest.</p>
<p>It might seem complex, but it actually reduces a lot of overhead, since everything is neatly encapsulated in this single Analytics module.</p>
<p>In later articles we'll use a similar structure in all the GTM interactions, so that things will stay nice and functional.</p>
<h2 id="comments-on-google-tag-manager-for-ios">Comments on Google Tag Manager for iOS</h2>
<p>It's not perfect, I'll give you that. You might wonder what the actual benefit is to just using the Google Analytics SDK, and you're right to feel a bit confused.</p>
<p>However, as with GTM for web, the main benefit is with the Data Layer. Using the Data Layer interface lets you collect arbitrary semantic information from the app, and push it into the message queue without having to consider platform-specific implications. Instead, you can trust that whatever app uses the Data Layer will be able to transform the data to the form required by whatever endpoint it communicates with.</p>
<p>And that's exactly why we spent some time to create a custom interface for interacting with Google Tag Manager. We want to <strong>decouple</strong> semantic information from actual app logic, only sending generic strings and dictionaries through the interface.</p>
<p>This way, when GTM for apps hopefully expands and becomes richer and larger, you'll have the general infrastructure in place already, and implementing expansions and additions will happen organically and in a controlled, fluid manner, which leaves your app none the worse for wear.</p>
<h2 id="summary">Summary</h2>
<p>This has been a rather extensive tutorial for something as &ldquo;simple&rdquo; as setting up Google Tag Manager in your mobile app. Well, I hope that bubble has burst. It's not simple. It's not meant to be. You're messing with a <em>software project</em> for goodness sake. You don't want to mess up your chances with App Store review, or the hundreds of thousands of eager users that cringe if even the smallest thing is amiss in your beautiful app.</p>
<p>GTM for mobile is not perfect. Far from it. There's still a lot to be done, and I hope the developers come up with some solid selling points for the platform, before people dismiss it entirely in favor of the pretty robust Google Analytics SDKs.</p>
<p>To me, one of the biggest issues is, funnily enough, the terminology used. GTM for mobile <em>is so far removed</em> from GTM for web that it's weird they even share the same name. There are no &ldquo;tags&rdquo; in mobile development. It's just variables, classes, structs, dictionaries, functions, objects, etc.</p>
<p>It's not &ldquo;tag management&rdquo;, it's app management, and as such it carries with it far greater risks than anything you could unleash on your website.</p>
<p>And the risks are the main reason I want to stay far away from the value collection methods and the whole idea of updating configuration values of the app through GTM. A mobile app, being a software project, should be governed by the code base, and not some outside dependency.</p>
<p>I don't understand why you'd want to delegate app operations to a web-based control panel, when all it takes is a single failed network request and a slightly outdated default container to screw up the experience for the user. And I'm sure that app users are less forgiving than web visitors, especially if the app costs money.</p>
<p>Things like <strong>automatic screen tracking</strong> or <strong>automatic exception handling</strong> are not things I particularly miss, as creating the Analytics.swift module pretty much gives you a one-liner to track all your screenviews with (and events, if you extend it a little). Thus, ultimately it's the same effort as setting a <code>self.screenName</code> property or something.</p>
<p>Other than the above, setting GTM for apps up is a breeze once you understand the logic. I love how I can use the Data Layer to decouple semantic information stored in the app from the app logic itself. I also love how I don't have to write analytics-specific syntax, and I can just use a generic Data Layer syntax instead. Perfection!</p>
<p>I'm looking forward to writing more about GTM for mobile soon. There are many ways you can improve the analytics tracking, and the SDK still has many tricks up its sleeve that you can use to facilitate your app tracking even further.</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/apps/">apps</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-analytics/">google analytics</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">Google Tag Manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/guide/">Guide</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/ios/">ios</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/mobile/">mobile</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/swift/">swift</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/iframe-cross-domain-tracking-in-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/measure-ad-content-blocker-impact-on-traffic/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Setup%20Google%20Tag%20Manager%20iOS%20With%20Swift%20https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/iframe-cross-domain-tracking-in-google-tag-manager/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/measure-ad-content-blocker-impact-on-traffic/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Setup%20Google%20Tag%20Manager%20iOS%20With%20Swift%20https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Setup%20Google%20Tag%20Manager%20iOS%20With%20Swift%20https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/setup-google-tag-manager-ios-with-swift/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

