

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "#GTMTips: Send Page Visibility State To Google Analytics | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2019\/06\/send-page-visibility-state-to-ga.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/send-page-visibility-state-to-ga\/",
  "datePublished": "2019-06-18T09:07:40\x2b03:00",
  "dateModified": "2019-06-18T09:07:40\x2b03:00",
  "description": "Use a simple JavaScript variable to send the document hidden state (true\/false) to Google Analytics as a custom dimension. This can be used to qualify the hits being collected.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.59.1 with theme Tranquilpeak 0.4.3-BETA">
    <title>#GTMTips: Send Page Visibility State To Google Analytics | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article'});
    </script>
    

    

    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://www.googletagmanager.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <script src="//simoahava.disqus.com/count.js" id="dsq-count-scr" async></script>
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/send-page-visibility-state-to-ga/">
    
    <meta name="description" content="Use a simple JavaScript variable to send the document hidden state (true/false) to Google Analytics as a custom dimension. This can be used to qualify the hits being collected.">
    <meta property="og:description" content="Use a simple JavaScript variable to send the document hidden state (true/false) to Google Analytics as a custom dimension. This can be used to qualify the hits being collected.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="#GTMTips: Send Page Visibility State To Google Analytics">
    <meta property="og:url" content="/analytics/send-page-visibility-state-to-ga/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="#GTMTips: Send Page Visibility State To Google Analytics">
    <meta name="twitter:description" content="Use a simple JavaScript variable to send the document hidden state (true/false) to Google Analytics as a custom dimension. This can be used to qualify the hits being collected.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
      <meta property="og:image" content="https://www.simoahava.com/images/simo.png">
    

    
      <meta name="twitter:image" content="https://www.simoahava.com/images/2019/06/send-page-visibility-state-to-ga.jpg">  
      <meta property="og:image" content="https://www.simoahava.com/images/2019/06/send-page-visibility-state-to-ga.jpg">
    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    
    
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          
          
            <div class="post-header main-content-wrap text-left">

  

    <h1>
      #GTMTips: Send Page Visibility State To Google Analytics
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2019-06-18T09:07:40&#43;03:00">
        
  June 18, 2019

      </time>
    
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/gtm-tips">GTM Tips</a>
    
  


       | <a href="https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/#disqus_thread">Comments</a>
  </div>


</div>

          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              

<p>One of my pet peeves about <a href="https://analytics.google.com">Google Analytics</a> has to do with nomenclature. For example, a <strong>User</strong> isn&rsquo;t really a user but a <strong>browser instance</strong>, and <strong>Direct</strong> traffic isn&rsquo;t necessarily &ldquo;direct&rdquo; at all, but rather just traffic that has no discernible source. But being so invested in <strong>content</strong> analytics, my biggest gripe has to do with <strong>Pageviews</strong>.</p>

<p>A <strong>Pageview</strong> in Google Analytics is collected when a hit with the hit type <code>pageview</code> is received successfully by the Google Analytics endpoint. This hit is dispatched most often with a JavaScript library such as <a href="https://tagmanager.google.com">Google Tag Manager</a> or <a href="https://developers.google.com/analytics/devguides/collection/gtagjs/">gtag.js</a>.</p>

<p>The problem with the name is that it doesn&rsquo;t really tell you at all <strong>whether the page was <em>viewed</em> or not</strong>. It just tells you that a line of JavaScript was executed on the page.</p>

<p>Luckily, pageviews aren&rsquo;t typically at the top of the list of Most Actionable KPIs, but you still see them being referenced especially in journals that rely on clicks rather than engagement.</p>

<p>With this <a href="https://www.simoahava.com/categories/gtm-tips/">#GTMTips</a> post (my <strong>one hundredth!</strong>), I want to show you an extremely simple way of adding this crucial metadata of page visibility to your Google Analytics hits, so that you can segment your data for <em>qualified</em> pageviews, and maybe even <em>ignore</em> events that happen when the page is not visible.</p>

<h2 id="tip-100-send-page-visibility-state-as-a-custom-dimension-to-ga">Tip 100: Send page visibility state as a custom dimension to GA</h2>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2019/06/send-page-visibility-state-to-ga.jpg" title="Send Page Visibility State To Google Analytics">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2019/06/send-page-visibility-state-to-ga.jpg#ZgotmplZ" alt="Send Page Visibility State To Google Analytics">
  
    </a>
  
  
</div>



<p>The steps are simple:</p>

<ol>
<li><p><a href="https://support.google.com/analytics/answer/2709829?hl=en">Create a <strong>Hit-scoped Custom Dimension</strong> in Google Analytics</a>, and make note of its index.</p></li>

<li><p>In Google Tag Manager, create a new <strong>JavaScript</strong> variable for <code>document.hidden</code> (see below).</p></li>

<li><p>Then, still in GTM, edit your <a href="https://www.simoahava.com/analytics/google-analytics-settings-variable-in-gtm/">Google Analytics Settings variable</a>, and add a new Custom Dimension with the index from step (1) and the variable from step (2).</p></li>
</ol>

<p>This is what the <strong>JavaScript variable</strong> looks like:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2019/06/document-hidden.jpg" title="Document hidden">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2019/06/document-hidden.jpg#ZgotmplZ" alt="Document hidden">
  
    </a>
  
  
</div>



<p>Note the <a href="https://www.simoahava.com/analytics/format-value-option-in-google-tag-manager-variables/">Format Value</a> settings. You need to <em>cast</em> the Boolean <code>true</code> and <code>value</code> (returned by <code>document.hidden</code>) into their string counterparts <code>&quot;true&quot;</code> and <code>&quot;false&quot;</code>. Otherwise analytics.js has the annoying habit of converting Booleans to <code>1</code> and <code>0</code> which makes the reports difficult to intepret.</p>

<p>The <code>document.hidden</code> property is nicely <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/hidden#Browser_compatibility">supported by all the major browsers</a>.</p>

<p>You don&rsquo;t have to add the Custom Dimension to all your hits, but I personally think it makes sense. Why qualify just the pageviews? Events can happen &ldquo;off-viewport&rdquo; too, and it might make sense to focus only on the ones that happen in an active browser window. This is what the Google Analytics Settings variable would look like, assuming the index of the Custom Dimension is <code>13</code> and the variable name is <strong>{{document.hidden}}</strong>:</p>




<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2019/06/custom-dimension.jpg" title="Custom Dimension">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2019/06/custom-dimension.jpg#ZgotmplZ" alt="Custom Dimension">
  
    </a>
  
  
</div>



<p>Finally, I&rsquo;m not illusioned enough to think that this somehow &ldquo;fixes&rdquo; anything. Collecting <em>visibility state</em> doesn&rsquo;t guarantee that the user is actually <em>viewing</em> anything, as they might be fetching their cup of coffee or dozing off in front of the screen. But I&rsquo;m pretty convinced that this is an <em>improvement</em> especially when you want to consider page<strong>views</strong> to be true to their name.</p>

<p>So, that&rsquo;s <strong>one hundred GTM tips</strong> all done. And it took me almost five years. I promise to get the next hundred done much, much faster!</p>

              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/gtmtips/">gtmtips</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/javascript/">javascript</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/enhanced-ecommerce-builder-custom-variable-template/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/google-cloud/create-cookie-rewrite-web-service-google-cloud/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Page%20Visibility%20State%20To%20Google%20Analytics%20https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <span id="disqus"></span>
<div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2019 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/analytics/enhanced-ecommerce-builder-custom-variable-template/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/google-cloud/create-cookie-rewrite-web-service-google-cloud/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Page%20Visibility%20State%20To%20Google%20Analytics%20https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/%20via%20@SimoAhava">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%23GTMTips:%20Send%20Page%20Visibility%20State%20To%20Google%20Analytics%20https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/%20via%20@SimoAhava">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/send-page-visibility-state-to-ga/">
          <i class="fa fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




  
    
      <script>
        





        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'simoahava';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  


    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>

    
  </body>
</html>

