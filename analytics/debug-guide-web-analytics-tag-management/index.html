

  
    
  


  





  


  

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta name="google-site-verification" content="xQwWI2KUfP9LbFKhw2CVLFtrMY6Czrla7L3PD2aBolA" />


<script type="application/ld+json">
{
  "@context": "http://schema.org", 
  "@type": "BlogPosting",
  "headline": "Debug Guide For Web Analytics And Tag Management | Simo Ahava's blog",
  "image": "https:\/\/www.simoahava.com\/images\/2022\/01\/developer-tools-keyboard-shortcuts.jpg",
  "editor": "Simo Ahava",
  "publisher": {
    "@type": "Organization",
    "name": "Simo Ahava's blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/www.simoahava.com\/images\/simo.png",
      "height": "393",
      "width": "407"
    }
  },
  "url": "https:\/\/www.simoahava.com\/analytics\/debug-guide-web-analytics-tag-management\/",
  "datePublished": "2022-01-13T09:22:36\u002b02:00",
  "dateModified": "2022-01-13T09:22:36\u002b02:00",
  "description": "Guide to using browser debug tools and extensions to better understand web analytics and tag management systems.",
  "author": {
    "@type": "Person",
    "name": "Simo Ahava"
  }
}
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Debug Guide For Web Analytics And Tag Management | Simo Ahava's blog</title>
    
    <script>
      window.dataLayer=window.dataLayer||[];window.dataLayer.push({pageType: 'article', environment:  null });
    </script>
    

    
    
    <script src="https://www.simoahava.com/x-js/lazyload.iife.min.js"></script>

    

    
    <script>
      (function(S,i,m,o){
        window[m]=window[m]||[];
        window[m].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
        var f=S.getElementsByTagName(i)[0],j=S.createElement(i),dl=m!='dataLayer'?'&l='+m:'';
        j.async=true;
        j.src='https://sgtm.simoahava.com/gtm.js?id='+o+dl;
        f.parentNode.insertBefore(j,f);
      })(document,'script','dataLayer','GTM-PZ7GMV9');
    </script>
    
    <meta name="author" content="Simo Ahava">
    <meta name="keywords" content="">

    <link rel="icon" href="https://www.simoahava.com/images/favicon.ico">
    
    <link rel="amphtml" href="https://www.simoahava.com/amp/analytics/debug-guide-web-analytics-tag-management/">
    
    <meta name="description" content="Guide to using browser debug tools and extensions to better understand web analytics and tag management systems.">
    <meta property="og:description" content="Guide to using browser debug tools and extensions to better understand web analytics and tag management systems.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Debug Guide For Web Analytics And Tag Management">
    <meta property="og:url" content="https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
    <meta property="og:site_name" content="Simo Ahava&#39;s blog">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Debug Guide For Web Analytics And Tag Management">
    <meta name="twitter:description" content="Guide to using browser debug tools and extensions to better understand web analytics and tag management systems.">
    
      <meta name="twitter:creator" content="@SimoAhava">
      
    

    
    

    
	  <meta property="og:image" content="https://www.simoahava.com/images/2022/01/debug-guide-web-analytics-tag-management.jpg">
      <meta name="twitter:image" content="https://www.simoahava.com/images/2022/01/debug-guide-web-analytics-tag-management.jpg">
    


    

      
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha512-xh6O/CkQoPOWDdYTDqeRdPCVd1SpvCA9XXcUnZS2FmJNp1coAFzvtCN9BmamE+4aHK8yyUHUSCcJHgXloTyT2A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
      
    
    <link rel="stylesheet" href="https://www.simoahava.com/css/style.css" />
    
    

    
      
    
    
  </head>

  <body>
    
    <div id="_progress"></div>
    
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.simoahava.com/">Simo Ahava&#39;s blog</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.simoahava.com/">
          <img class="sidebar-profile-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Simo Ahava</h4>
        
          <h5 class="sidebar-profile-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tags/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/categories/gtm-tips/">
    
      <i class="sidebar-button-icon fa fa-lg fa-magic"></i>
      
      <span class="sidebar-button-desc">GTM Tips</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/about-simo-ahava/">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/tools/">
    
      <i class="sidebar-button-icon fa fa-lg fa-wrench"></i>
      
      <span class="sidebar-button-desc">Tools</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/blog-statistics/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bar-chart"></i>
      
      <span class="sidebar-button-desc">Blog statistics</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/sahava" target="_blank" rel="noopener ">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/upcoming-talks/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bullhorn"></i>
      
      <span class="sidebar-button-desc">Upcoming talks</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/custom-templates/">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Templates</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.simoahava.com/newsletter/">
    
      <i class="sidebar-button-icon fa fa-lg fa-bell"></i>
      
      <span class="sidebar-button-desc">Newsletter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://masto.measure.chat/@SimoAhava" target="_blank" rel="noopener me">
    
      <i class="sidebar-button-icon fa fa-lg fa-brands fa-mastodon"></i>
      
      <span class="sidebar-button-desc">Mastodon</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post">
	  <form id="search" action="https://www.simoahava.com/search/">
  <input name="q" type="text" class="form-control input--xlarge" placeholder="Search blog..." autocomplete="off">
  </form>

          <div class="post-header main-content-wrap text-left">
  
    <div class="figure nocaption">
      <img class="cover" src="https://www.simoahava.com/images/2022/01/debug-guide-web-analytics-tag-management.jpg">
    </div>
  
  

    <h1>
      Debug Guide For Web Analytics And Tag Management
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2022-01-13T09:22:36&#43;02:00">
        
  January 13, 2022

      </time>
      
      
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.simoahava.com/categories/analytics">Analytics</a>
    
  


      | <a href="https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/#commento">Comments</a>
      
  </div>


</div>

          <div class="post-content markdown">
            <div class="main-content-wrap">
	      
                
  	        <p>One of the key skills for <em>anyone</em> working with <strong>web analytics</strong> and <strong>tag management</strong> is understanding how to identify where things went wrong, why they went wrong, and ideally how to fix them.</p>
<p>There are plenty of excellent browser extensions for helping you debug, and we&rsquo;ll discuss these in the guide, too. But most of all we&rsquo;re going to use <strong>browsers&rsquo; own developer tools</strong>, as they are always the best source of truth for anything that happens within the browser window.</p>
<p>In the guide, we&rsquo;ll use <a href="https://developers.google.com/analytics/devguides/collection/ga4">Google Analytics 4</a> and <a href="https://tagmanager.google.com/">Google Tag Manager</a> as examples. However, the guide&rsquo;s topics can be extended to <em>any</em> web analytics tools and tag management solutions out there, because the use cases are universal.</p>

                <span class="simmer">
  <span class="close">X</span>
  <p>
    <span class="fa fa-md fa-bell"></span>
    <strong>The Simmer Newsletter</strong>
  </p>
  <p>
    Subscribe to the <a href="https://www.simoahava.com/newsletter/">Simmer newsletter</a> to get the latest news and content from Simo Ahava into your email inbox!
  </p>
  </span>

                
                  <h2 id="browser-developer-tools">Browser developer tools</h2>
<p>Your best friend in debugging issues with your web analytics and tag management systems in the web browser are the <strong>browsers&rsquo; own developer tools</strong>.</p>
<p>Developer tools are a suite of utilities that you can use to investigate various different aspects of the dynamic web page the user is inspecting.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/developer-tools-keyboard-shortcuts.jpg" title="Shortcuts for opening the developer tools">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/developer-tools-keyboard-shortcuts.jpg#ZgotmplZ" alt="Shortcuts for opening the developer tools" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 4222 2474'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The image above lists the <strong>keyboard shortcuts</strong> for opening the developer tools in various browsers and operating systems.</p>
<blockquote>
<p>Note that on <strong>Safari</strong>, you&rsquo;ll want to open <strong>Safari</strong> -&gt; <strong>Preferences</strong> -&gt; <strong>Advanced</strong> and check the button next to <strong>Show Develop menu in menu bar</strong>.</p>
</blockquote>
<p>All of the browsers above utilize a similar set of developer tools with just small differences in the UI and the chosen semantics. The most useful tools we&rsquo;ll focus on are:</p>
<ul>
<li>
<p>The <strong>element inspector</strong>, which lets you look at the dynamic representation of the web page (<strong>D</strong>ocument <strong>O</strong>bject <strong>M</strong>odel). This is particularly useful for inspecting injected tracking scripts and custom HTML elements added by tag management solutions.</p>
</li>
<li>
<p>The <strong>network debugger</strong>, which lets you inspect and analyze outgoing <strong>HTTP requests</strong> sent from the page (or embedded frames). This is one of the most important tools for you, as it will tell you the <strong>truth</strong> about what is actually sent from the user&rsquo;s browser.</p>
</li>
<li>
<p>The <strong>JavaScript console</strong>, which lets you run JavaScript code in the context of the current page (or embedded frame). Vital for recognizing issues with the JavaScript implementations of your analytics scripts.</p>
</li>
<li>
<p>The <strong>sources browser</strong>, which lets you browse through the JavaScript resources loaded on the current page (or embedded frames). Great for identifying mismatches between what you expected the JavaScript file to contain vs. what&rsquo;s <em>actually</em> contained within.</p>
</li>
<li>
<p>The <strong>application storage</strong>, which lets you investigate the browser storage (cookies, <code>localStorage</code>, etc.) utilized on the current page (or embedded frames). Instrumental for understanding why some trackers might not be able to persist data consistently.</p>
</li>
</ul>
<p>In this section, we&rsquo;ll walk through these different tools with more detail, so that you&rsquo;ll have a better understanding of how to use them to unravel some of the more complicated debugging cases you run into.</p>
<blockquote>
<p>Note! This section uses mainly Chrome&rsquo;s developer tools in examples. It&rsquo;s possible the actual actions are (slightly) different in other browsers.</p>
</blockquote>
<h3 id="element-inspector">Element inspector</h3>
<p>The <strong>element inspector</strong> lets you analyze the DOM (Document Object Model) of the page.</p>
<p>When the browser loads the HTML source it retrieves from the site&rsquo;s web server, it renders it into a dynamic tree model, accessible via JavaScript. This dynamic representation is the DOM.</p>
<p>Whenever an analytics snippet or a tag manager interacts with the page, such as by loading a third-party JavaScript library or adding a click listener somewhere, they modify the DOM.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/element-inspector.jpg" title="Element Inspector">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/element-inspector.jpg#ZgotmplZ" alt="Element Inspector" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1724 532'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Thus, if you have problems with your implementation, it&rsquo;s useful to search through the element inspector to find what the issue could be.</p>
<p>The element inspector is also extremely useful when you&rsquo;re building <strong>triggers</strong> or <strong>variables</strong> in your tag management system with the purpose of scraping some information from the page or adding listeners to and injecting elements into the document.</p>
<p>Here are a couple of cool tricks you can try in the element inspector.</p>
<h4 id="search-for-a-specific-element-in-the-inspector">Search for a specific element in the inspector</h4>
<p>Hit <strong>CMD + F</strong> / <strong>CTRL + F</strong> to open a search bar. You can then search for a <strong>string</strong> (e.g. text content) or a <a href="https://www.simoahava.com/analytics/css-selector-guide-google-tag-manager/">CSS selector</a> to have the inspector locate a specific element.</p>
<p>For example, to search for all elements with the class name <code>simmer</code>, you can type <code>.simmer</code> into the search bar and the inspector will return all the matches.</p>
<p>If you&rsquo;re unsure whether Google Tag Manager actually added the Google Analytics 4 script on the page, for exampled, you could search for <code>gtag/js</code> to find all elements that have that particular string <em>somewhere</em> in them. Since GA4 is loaded from the <code>/gtag/js?id=G-...</code> URL, the inspector should find the GA4 script element, unless it&rsquo;s actually missing.</p>
<h4 id="select-a-specific-element-on-the-page-itself">Select a specific element on the page itself</h4>
<p>You can also do the reverse. If you click the little element selector icon (this differs from browser to browser) in the developer tools panel, you can actually select an element on the page to reveal it in the element inspector.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/element-selector.jpg" title="Element selector">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/element-selector.jpg#ZgotmplZ" alt="Element selector" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1862 690'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>In addition to pinpointing it in the element inspector, the tool also displays some useful information about the element in question.</p>
<h4 id="interact-with-the-element-context-menu">Interact with the element context menu</h4>
<p>When you select an element in the inspector with the right mouse button, you&rsquo;ll see a context menu.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/element-context-menu.jpg" title="Element context menu">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/element-context-menu.jpg#ZgotmplZ" alt="Element context menu" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1084 928'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can do a <strong>lot</strong> of cool stuff with this, such as:</p>
<ul>
<li>
<p><strong>Add / edit</strong> the element&rsquo;s attributes. I use this a lot to change link URLs to something else, when I want to test a specific outgoing link, for example.</p>
</li>
<li>
<p><strong>Edit / delete</strong> the element itself. Sometimes it&rsquo;s useful to just delete an element entirely (e.g. an overlay that hides the page underneath). And sometimes you&rsquo;ll want to edit the entire HTML structure of an element when you want to add new contents to it for testing a click listener, for example.</p>
</li>
<li>
<p><strong>Copy selector</strong>, as this lets you copy a <strong>CSS selector</strong> path to the element itself. Extremely useful when configuring triggers in Google Tag Manager, for example. Just note that the CSS selector path is usually needlessly complex, and you can trim it down to be more generic in order to avoid subtle changes in the DOM from breaking your triggers.</p>
</li>
<li>
<p><strong>Break on&hellip;</strong> lets you pause the page whenever the element or its subtree (nested elements) <em>changes</em>. This is pretty useful when you want to inspect what happens when an element becomes visible or when an element&rsquo;s content is dynamically changed (think form validation error messages, for example).</p>
</li>
</ul>
<h4 id="change-element-styles">Change element styles</h4>
<p>When you&rsquo;ve selected the element, you can change the associated <strong>styles</strong> with the developer tools.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/change-element-style.jpg" title="Change element styles">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/change-element-style.jpg#ZgotmplZ" alt="Change element styles" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2150 652'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>This might have marginal use for analytics debugging, but occasionally you might use it to make an element visible or move it around when you can&rsquo;t find it in the actual page.</p>
<h3 id="network-debugger">Network debugger</h3>
<p>Often you&rsquo;ll find that your tag management system and/or your analytics debugger extension claims that your hit has <strong>fired</strong>, but no data is collected into the vendor endpoint.</p>
<p>At this point, you need to open the <strong>Network</strong> tab in the developer tools, as this lists <strong>all the HTTP requests</strong> sent from the browser.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/network-debugger.jpg" title="Network debugger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/network-debugger.jpg#ZgotmplZ" alt="Network debugger" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2154 454'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The network debugger is <strong>the ultimate truth</strong>. If a request doesn&rsquo;t appear here, then the browser has not sent it. So if your tag management system says that a GA4 hit has <strong>fired</strong> but you see no evidence of a <code>collect?v=2</code> request in the network debugger, then the hit has <strong>not</strong> been sent.</p>
<p>It might be useful to check the <strong>Preserve log</strong> option, as this doesn&rsquo;t clear the log of requests between page loads. This is very useful when you want to debug what happened on a previous page.</p>
<p>For a more detailed walkthrough of the network debugger, check out <a href="https://developer.chrome.com/docs/devtools/network/reference/">this excellent resource</a>.</p>
<p>Here are some of the things you can do with the network debugger.</p>
<h4 id="filter-for-specific-requests">Filter for specific requests</h4>
<p>By typing something into the filter field, you can show only the HTTP requests that match the filter.</p>
<p>The filter searches through the request URL and the request body.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/network-filter.jpg" title="Network filter">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/network-filter.jpg#ZgotmplZ" alt="Network filter" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1502 412'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>When you select a request in the debugger, a small overlay opens with various tabs.</p>
<ul>
<li>
<p><strong>Headers</strong> includes all the HTTP headers of the <em>request</em> and the <em>response</em>. This is useful for debugging things like cookies, referrer values, and where the request was actually sent.</p>
</li>
<li>
<p><strong>Payload</strong> contains the <strong>query parameters</strong> and the <strong>request body</strong>. Extremely important when analyzing what was actually sent to the analytics platform.</p>
</li>
<li>
<p><strong>Response</strong> shows what the web server actually responded with. This is often empty or nonsensical with pixel requests, but it&rsquo;s useful when analyzing <strong>API responses</strong> or JavaScript files.</p>
</li>
<li>
<p><strong>Cookies</strong> lists all the cookies that were <strong>sent with the request</strong> and <strong>set in the response</strong>.</p>
</li>
</ul>
<h4 id="block-a-request-from-future-loads">Block a request from future loads</h4>
<p>You can right-click any request in the list and choose <strong>Block request URL</strong> or <strong>Block request domain</strong> to prevent the page from being able to send the request until the block is removed.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/block-url.jpg" title="Block URL">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/block-url.jpg#ZgotmplZ" alt="Block URL" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1366 668'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>When the resource URL (or domain) is blocked, then any requests that match the URL (or domain) will be blocked in future requests.</p>
<p>This is <strong>extremely</strong> useful when you want to figure out which JavaScript resource is causing conflicts on the page. By blocking each one-by-one and then reloading the page, you&rsquo;ll be able to pinpoint the file that causes issues.</p>
<p>To <strong>unblock</strong> a resource, press the <strong>ESC</strong> key to toggle the <strong>Drawer</strong>, select the <strong>Network request blocking</strong> tab and uncheck the box next to the request (or delete it from the respective buttons). If you don&rsquo;t see the tab, you can select it by clicking the Drawer menu (the three vertical dots) in the top-left corner of the Drawer.</p>
<blockquote>
<p>You can also right-click the blocked resource in the network debugger and choose <strong>Unblock&hellip;</strong>.</p>
</blockquote>
<h4 id="manually-throttle-the-page-speed">Manually throttle the page speed</h4>
<p>If you want to test how the page loads like on a slower connection (might be useful every now and then), you can choose a <strong>throttling speed</strong> from the network tools.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/throttling.jpg" title="Throttling speed">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/throttling.jpg#ZgotmplZ" alt="Throttling speed" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1090 394'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Remember to switch back to <strong>No throttling</strong> when done, though, or you&rsquo;ll have to continue suffering with slowly loading pages.</p>
<h4 id="pinpoint-the-initiator-of-the-request">Pinpoint the initiator of the request</h4>
<p>In the <strong>Initiator</strong> column, you can see the resource or process that caused the redirect to fire.</p>
<p>By clicking the resource in the column, it will jump to the relevant part of the developer tools to show what process initiated the request.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/network-initiator.jpg" title="Network initiator">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/network-initiator.jpg#ZgotmplZ" alt="Network initiator" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1070 302'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>If the initiator is <code>(index)</code>, it means the request originated from a resource injected into the DOM, which means clicking it will open the <strong>element inspector</strong> with the element selected.</p>
<p>If the initiator is a JavaScript file or a CSS file, for example, then developer tools will open the <strong>Sources</strong> tab with the relevant part of the source file code selected. This might not be very useful in itself, but you can use the Sources panel to add a breakpoint to the injection moment in order to replay through the stack after a page reload (more on this below in the <a href="#sources">Sources section</a>).</p>
<h3 id="javascript-console">JavaScript console</h3>
<p>The JavaScript console lets you execute <strong>any</strong> JavaScript commands in <strong>the context of the current page</strong>.</p>
<p>The context of the page is the DOM, and you can use <a href="https://www.w3schools.com/js/js_htmldom_methods.asp">DOM methods</a> to interact with page elements.</p>
<p>Here are some use cases for the JavaScript console.</p>
<h4 id="inspect-logs">Inspect logs</h4>
<p>Many tools output debug messages to the JavaScript console, so the <strong>first course of action</strong> whenever you run into trouble is to open the JavaScript console to see if there are any relevant errors shown.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/console-log.jpg" title="Console log messages">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/console-log.jpg#ZgotmplZ" alt="Console log messages" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1676 864'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>It&rsquo;s a good idea to add some <code>console.log(msg)</code> calls in whatever code you add yourself via a tag management system, for example. That way you can debug the log output in the JavaScript console – often this is the easiest way to debug code execution.</p>
<h4 id="check-the-value-of-global-variables">Check the value of global variables</h4>
<p>In browser JavaScript, global variables are stored in the <code>window</code> object.</p>
<p>If you want to check whether a global <code>dataLayer</code> array exists, you can simply type <code>window.dataLayer</code> and press enter. If the console shows <code>undefined</code>, it means that <code>dataLayer</code> does not exist in global scope.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/undefined-datalayer.jpg" title="Undefined dataLayer">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/undefined-datalayer.jpg#ZgotmplZ" alt="Undefined dataLayer" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1028 232'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can also <em>set</em> new global variables simply by initializing them in the <code>window</code> object:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.myGlobalVariable = <span style="color:#a50">&#34;Hello, I am a global variable.&#34;</span>;
</code></pre></div>
<h4 id="add-an-event-listener-with-a-breakpoint">Add an event listener with a breakpoint</h4>
<p>This is a cool trick. Whenever any JavaScript that runs on the page uses the <code>debugger;</code> keyword, the page will pause and you will be diverted to the <strong>Sources</strong> tab where you can then walk through the stack (more on this below).</p>
<p>If you want to try this out, you can add a click listener on the page with <code>debugger;</code> in the callback. Then, when you click anywhere on the page, the execution will pause and you&rsquo;ll be taken to the Sources tab.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.addEventListener(<span style="color:#a50">&#39;click&#39;</span>, () =&gt; { <span style="color:#00a">debugger</span>; })
</code></pre></div>
<h4 id="change-the-context-to-an-iframe">Change the context to an iframe</h4>
<p>The JavaScript console is initially bound to the context of the top frame (the URL the user is currently navigating).</p>
<p>If the page embeds other content in iframes, you can use the frame selector in the console to change context to the iframe.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/iframe-selector-chrome.jpg" title="Iframe selector chrome">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/iframe-selector-chrome.jpg#ZgotmplZ" alt="Iframe selector chrome" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 930 460'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>This is, of course, particularly useful when debugging embedded content such as third-party shopping carts or widgets.</p>
<blockquote>
<p>Note that the frame selector is confusingly in different parts of the developer tools across different browsers. The screenshot above is from <strong>Chrome</strong> (and it&rsquo;s the same on <strong>Edge</strong>). With <a href="https://developer.mozilla.org/en-US/docs/Tools/Working_with_iframes">Firefox</a> the context picker is in the top-right corner of the developer tools, and with Safari it&rsquo;s in the bottom-right corner of the developer console.</p>
</blockquote>
<h3 id="sources">Sources</h3>
<p>The <strong>sources</strong> panel can be game-changing but it can also be very overwhelming to use.</p>
<p>The panel lists <strong>all of the subresources</strong> (images, scripts, frames, etc.) loaded on the current page.</p>
<p>The list is sorted by URL, starting with the <em>origin</em> and then drilling own to paths and files.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/sources.jpg" title="Sources">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/sources.jpg#ZgotmplZ" alt="Sources" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1008 814'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The sources panel would deserve a separate article in itself due to the many, many different things you can do with it. However, here I&rsquo;ve listed some of the most useful things you can tamper with.</p>
<h4 id="open-a-file-pretty-print-it-and-search-through-it">Open a file, pretty-print it, and search through it</h4>
<p>When you open a <strong>minified</strong> JavaScript file (as they tend to be in order to save space and bandwidth), the panel prompts you if you want to <em>pretty-print</em> the file.</p>
<p><strong>Always do this</strong>.</p>
<p>By pretty-printing the file, the code is displayed in a more readable format, even if the code itself is still minified.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/pretty-print.jpg" title="Pretty-print">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/pretty-print.jpg#ZgotmplZ" alt="Pretty-print" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1172 798'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can then hit CMD + F (or CTRL + F) to open the search bar. The search will look through the formatted file for all references to the searched string.</p>
<h4 id="add-a-breakpoint-to-the-file">Add a breakpoint to the file</h4>
<p>A <strong>breakpoint</strong> is an instruction for the brower to halt page execution and allow the user to see the exact state of the page at the time of the breakpoint.</p>
<p>To add a breakpoint, open a file in the Sources panel, right-click the row number you want to halt execution on and choose <strong>Add breakpoint</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/add-breakpoint.jpg" title="Add breakpoint">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/add-breakpoint.jpg#ZgotmplZ" alt="Add breakpoint" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1176 662'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>When you then reload the page (or cause the code to be evaluated some other way), the browser will stop at the breakpoint and give you bunch of options how to proceed.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/paused-on-breakpoint.jpg" title="Paused on breakpoint">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/paused-on-breakpoint.jpg#ZgotmplZ" alt="Paused on breakpoint" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2054 960'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Some useful tools here include:</p>
<ul>
<li>
<p>Look through the <strong>Scope</strong> list. Here are listed all the variables in <strong>Local</strong> (current function context) scope, <strong>Closure</strong> (scope of the function that initiated the closure code), and <strong>Global</strong> scope.</p>
</li>
<li>
<p>Walk back through the <strong>Call Stack</strong> menu, as this will let you inspect the full execution thread all the way to where it was initialized. This is a great way to find just where the JavaScript started breaking down.</p>
</li>
<li>
<p>Use the <strong>step methods</strong> (see screenshot below) to continue progressing through the code, pausing after every line.</p>
</li>
</ul>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/step-tools.jpg" title="Step tools">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/step-tools.jpg#ZgotmplZ" alt="Step tools" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1094 490'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>To remove the breakpoint (good idea once you&rsquo;re done debugging), expand the <strong>Breakpoints</strong> list and uncheck the breakpoints you want to deactivate.</p>
<h4 id="search-through-the-sources">Search through the sources</h4>
<p>Sometimes it can be useful to simply do a string search through the sources. For example, if you find GTM&rsquo;s <code>dataLayer</code> is overwritten, you could even search for something as simple as <code>dataLayer=</code> in order to find if it&rsquo;s been overwritten by custom code in some other file.</p>
<p>You can find the search tool by opening the <strong>Drawer</strong> (press ESC) and selecting the <strong>Search</strong> tab. Here, you can do a string search and developer tools will search through all the source files for a match.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/search-sources.jpg" title="Search sources">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/search-sources.jpg#ZgotmplZ" alt="Search sources" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 990 496'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>If you do find a match, you can click it to jump to the relevant part of the source file.</p>
<h4 id="add-local-overrides">Add local overrides</h4>
<p>This can be <strong>extremely helpful</strong> in testing your page. You can actually edit / add / remove things in the page HTML or the linked JavaScript resources by adding <strong>local overrides</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/local-overrides.jpg" title="Local overrides">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/local-overrides.jpg#ZgotmplZ" alt="Local overrides" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1896 620'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>When you give the browser permission to write local overrides, you can then freely edit any of the files in the Sources panel, save them, and when you reload the page the saved and modified file will be used instead of the one loaded over the network.</p>
<p>In Chrome, you&rsquo;ll see a little purple button next to the file if it has a local override.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/local-override.jpg" title="Local overrides">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/local-override.jpg#ZgotmplZ" alt="Local overrides" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1116 768'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>To stop using overrides, just open the Overrides tab in the Sources panel and uncheck &ldquo;Enable Local Overrides&rdquo;.</p>
<h3 id="application-storage">Application storage</h3>
<p>The <strong>application storage</strong> tab shows all the <em>browser</em> storage used on the current page (and in embedded frames).</p>
<p>This includes things like <strong>cookies</strong>, <strong>localStorage</strong>, and <strong>sessionStorage</strong>.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/browser-cookies.jpg" title="Browser cookies">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/browser-cookies.jpg#ZgotmplZ" alt="Browser cookies" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1418 630'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can use this tab to create, edit, and delete items in browser storage.</p>
<p>It&rsquo;s a great resource to identify problems with <strong>persistence</strong> in your analytics tools, for example.</p>
<p>Here are some of the things you can do with application storage.</p>
<h4 id="inspect-first-party-and-third-party-storage">Inspect first-party and third-party storage</h4>
<p>It&rsquo;s a bit confusing, but you can see multiple domains in both the navigation column as well as in the actual storage list.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/domains-storage.jpg" title="Domains storage">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/domains-storage.jpg#ZgotmplZ" alt="Domains storage" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1368 642'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>First, all the domains listed in the navigation column (<code>simoahava.com</code> and <code>gtmtools.com</code> in the screenshot above), represent URL origins loaded in <strong>frames</strong>. For example, in this case <code>simoahava.com</code> was the URL of the top frame, and the page I was on loaded an iframe from <code>gtmtools.com</code>. In the Application tab I can choose <code>gtmtools.com</code> to inspect the cookies of that particular context.</p>
<p>In the list of cookies, on the other hand, if you see multiple different domains listed it&rsquo;s because the page is sending requests to these domains. If the browser supports <strong>third-party cookies</strong>, you&rsquo;ll see all the cookies set on the domains the browser is communicating with.</p>
<p>If the browser blocks third-party cookies, you&rsquo;ll only see cookies set on the site of the top frame (the URL the user is browsing).</p>
<h4 id="create-edit-and-delete-storage">Create, edit, and delete storage</h4>
<p>By clicking any storage entry and pressing backspace / delete, you can remove that particular item from the browser storage.</p>
<p>You can edit any storage values by double-clicking the value you want to edit in the relevant column.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/edit-cookie-value.jpg" title="Edit cookie value">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/edit-cookie-value.jpg#ZgotmplZ" alt="Edit cookie value" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1198 556'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can create a new cookie (or other storage entry) by double-clicking the empty row at the bottom of the storage list. You can then input any values you want into the columns.</p>

                
                  <h2 id="debug-web-analytics-implementations">Debug web analytics implementations</h2>
<p>Once you have a <em>feel</em> for the developer tools, you can start debugging actual issues with your implementations.</p>
<p>Please note that since the scope of things you can do with JavaScript is so <strong>immensely vast</strong>, it&rsquo;s impossible to exhaustively list all the things that you should do when debugging your setup.</p>
<p>In this chapter, I&rsquo;ve listed some of the more common ways to approach implementation issues.</p>
<blockquote>
<p>If you have other, common use cases you think should be listed here, please let me know in the <strong>comments</strong>!</p>
</blockquote>
<h3 id="check-browser-cookies">Check browser cookies</h3>
<p>Many analytics tools utilize <strong>browser storage</strong> to persist things like user and client identifiers.</p>
<p>Google Analytics 4 uses the <code>_ga</code> and <code>_ga_&lt;measurementId&gt;</code> cookies to store information about the user and the session, respectively.</p>
<p>If you see too many (or too few) users in your GA4 data compared to the count of sessions, for example, it might be that there&rsquo;s something wrong with the browser cookies. So open the <strong>Application</strong> tab and look for <code>_ga</code>.</p>
<p>If you don&rsquo;t find any cookies with that name or prefix, it&rsquo;s possible that there&rsquo;s something wrong with your implementation and the cookie is either not being set or it&rsquo;s being set incorrectly.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/ga-cookies.jpg" title="GA cookies">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/ga-cookies.jpg#ZgotmplZ" alt="GA cookies" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1802 196'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>A typical mistake is overwriting the <code>cookie_domain</code> field with something incorrect. The tracker tries to set the cookie on an invalid domain and the cookie write fails.</p>
<p>It might be useful to have the <a href="https://chrome.google.com/webstore/detail/google-analytics-debugger/jnkmfdileelhofjcijamephohjechhna">GA Debugger</a> extension enabled, as the JavaScript console will inform you if the cookie write failed for some reason.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/cookie-write-failed.jpg" title="Cookie write failed">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/cookie-write-failed.jpg#ZgotmplZ" alt="Cookie write failed" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 502'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Another very common reason for cookies failing is because the page is actually running in a <strong>cross-site</strong> embedded iframe, and due to third-party cookie restrictions the page is unable to set the cookies correctly.</p>
<h3 id="filter-network-requests">Filter network requests</h3>
<p>You&rsquo;ll also want to look through the network requests to see if your endpoint is actually receiving the data.</p>
<p>Google Analytics requests are sent to the <code>/collect</code> path, with the domain <code>www.google-analytics.com</code> or <code>analytics.google.com</code> (latter if Google Signals is enabled).</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/collect-request.jpg" title="Collect request">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/collect-request.jpg#ZgotmplZ" alt="Collect request" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2358 1088'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>If you see a request to <code>/collect</code> with a status code of <code>200</code>, it means that your request was most likely collected by the endpoint successfully.</p>
<p>If you see an aborted request (or some other error), it&rsquo;s typically because the request happened just as the user was navigating away from the page (although this is less common with Google Analytics 4).</p>
<p>If you don&rsquo;t see the request at all, it means that something is preventing the request from being dispatched. Again, using the GA Debugger extension is a good idea, because the extension logs information into the console that might be of use.</p>
<h3 id="identify-conflicts-in-global-methods">Identify conflicts in global methods</h3>
<p>Sometimes, rarely, the global methods used by your web analytics tool have been overwritten by some other tool.</p>
<p>This is a constant danger when using global methods, and Google Analytics using the <code>ga</code> namespace for Universal Analytics is an example of a global name that can easily be taken by some other, unrelated tool.</p>
<p>Sometimes it&rsquo;s difficult to find issues with the global namespace, because using tools like Google Tag Manager might make global methods irrelevant.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/overwritten-ga-method.jpg" title="Overwritten GA method">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/overwritten-ga-method.jpg#ZgotmplZ" alt="Overwritten GA method" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1202 294'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>But if you&rsquo;re having trouble with your requests working, you can always check if the global methods that your tool uses (e.g. <code>ga</code>, <code>gtag</code>, <code>dataLayer</code>) are either <code>undefined</code> or set to something that doesn&rsquo;t resemble your analytics platform code at all.</p>
<h3 id="note-about-iframes">Note about iframes</h3>
<p>If you embed content in a <strong>cross-site</strong> (or third-party) iframe, remember that anything that happens in the iframe happens in third-party context.</p>
<p>This means that if you&rsquo;re running Google Analytics in the iframe, it will not work because by default the GA cookies are <a href="https://www.simoahava.com/analytics/cookieflags-field-google-analytics/">not treated in a way that would make them work</a> in third-party context.</p>
<p>You&rsquo;ll see the <strong>Cookie write failed</strong> error message in the console when using the GA debugger, if this is the case.</p>
<p>Furthermore, even if you update the cookies to use the required <code>samesite=none</code> and <code>secure</code> flags, browsers like <strong>Safari</strong> and <strong>Brave</strong> outright block third-party storage.</p>

                
                  <h2 id="debug-tag-management-solutions">Debug tag management solutions</h2>
<p>Since tag management solutions are more like a framework for deploying analytics and advertising pixels, if they fail then everything that&rsquo;s loaded through them fails too.</p>
<p>In this chapter, we&rsquo;ll take a look at some of the ways you can debug a TMS implementation gone awry.</p>
<h3 id="check-data-layer-queue-for-conflicts">Check Data Layer queue for conflicts</h3>
<p>First, if you&rsquo;re seeing issues with your setup, check if the global <code>dataLayer</code> queue has been overwritten or is otherwise compromised.</p>
<p>With Google Tag Manager, type <code>dataLayer.push</code> into the console and check what it returns. If it outputs something like <code>[native code]</code>, it means that <code>dataLayer</code> has been reset to its initial state, and Google Tag Manager&rsquo;s listeners no longer work with it.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/datalayer-overwritten.jpg" title="datalayer-overwritten.jpg">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/datalayer-overwritten.jpg#ZgotmplZ" alt="datalayer-overwritten.jpg" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1038 242'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Alternatively, if you see something other than a variation of the below, it means that <code>dataLayer</code> has possible been overwritten in a way that doesn&rsquo;t correctly work with GTM. This is a difficult scenario to debug, and requires that you add a <strong>breakpoint</strong> to the dataLayer processing in order to see if some other tool is cannibalizing the array and not passing the arguments to GTM.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/datalayer-correct.jpg" title="dataLayer setup correctly">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/datalayer-correct.jpg#ZgotmplZ" alt="dataLayer setup correctly" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1958 274'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>You can mock this with something like:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#0aa">window</span>.dataLayer.push(<span style="color:#00a">function</span>() { <span style="color:#00a">debugger</span>; });
</code></pre></div>
<p>Then step through the stack and see if the <code>gtm.js</code> library is ever visited when stepping through the methods. If GTM is never referenced, it means that some other tool has taken control of <code>dataLayer</code> and you need to resolve this conflict elsewhere.</p>
<blockquote>
<p>This is a notoriously difficult scenario to debug, so you just need to patiently look through the Sources to find the culprit. <a href="#search-through-the-sources">Search for references</a> to <code>dataLayer</code>, for example. <a href="#block-a-request-from-future-loads">Block JavaScript files</a> one by one in the network debugger to find the one that is causing the conflict.</p>
</blockquote>
<h3 id="search-through-the-element-inspector">Search through the element inspector</h3>
<p>Sometimes it might be useful to search through the element inspector to find the Custom HTML tags and script elements injected by Google Tag Manager.</p>
<p>You can simply search for a string that you know to be within the injected code, but just remember that <strong>Google Tag Manager minifies all injected code automatically</strong>, so searching for a specific variable name might not be very useful. Search for content within strings or script URLs instead.</p>
<p>If you don&rsquo;t see any references to the elements you&rsquo;d expect GTM to inject, it means that GTM did not add those elements to the page. Typically this is because the tag never fired or the tag was misconfigured. Sometimes it can be because of a <a href="https://developers.google.com/tag-platform/tag-manager/web/csp">CSP conflict</a> that you need to resolve.</p>
<h3 id="look-for-requests-in-network-tools">Look for requests in network tools</h3>
<p>With GTM, too, it&rsquo;s always useful to look for requests in the network tools. This is always the <strong>ultimate truth</strong> when it comes to debugging the end-to-end flow of pixel requests.</p>
<p>If Tag Assistant says that the tag fired but you can&rsquo;t see anything in your analytics platform, then you need to open the network debugger and see if the request was ever sent.</p>
<p>Remember to check <strong>Preserve log</strong> to make sure that the requests aren&rsquo;t gobbled up by page navigation.</p>
<p>If you don&rsquo;t see the requests anywhere, it means that the tags never managed to dispatch them.</p>
<p>Note that this is only the <strong>first step</strong> of potentially a <em>very</em> complex debugging flow, because there can be a million different reasons for a failed request.</p>
<p>Sometimes you <em>do</em> see the request but you still don&rsquo;t see data in your analytics tool. In this case, meticulously sift through the headers and the payload of the request to see if it has all the information you expect it to contain.</p>
<h3 id="search-through-sources">Search through sources</h3>
<p>Finally, searching through sources can be <strong>very</strong> useful in identifying issues with your tag management system.</p>
<p>With GTM, it&rsquo;s often the case that the version wasn&rsquo;t actually published to the live <a href="https://www.simoahava.com/analytics/better-qa-with-google-tag-manager-environments/">environment</a> but rather to a staging context.</p>
<p>It might be useful to take a tag that you expect the most recent version to have, and then search for something in that tag&rsquo;s code (an ID, a parameter, a key-value pair) within the <code>gtm.js</code> library.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/search-gtm-js.jpg" title="Search through gtm.js">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/search-gtm-js.jpg#ZgotmplZ" alt="Search through gtm.js" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2244 564'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Sometimes searching through the sources is an exercise in futility, especially because the code is so minified that you can&rsquo;t make any heads or tails of it. Trying to narrow down with more specific search terms often helps.</p>

                
                  <h2 id="useful-browser-extensions">Useful browser extensions</h2>
<p>I&rsquo;ve already mentioned GA Debugger above, but there are other useful extensions you might consider installing in your browser (Chrome, most often) which make debugging your analytics setup a breeze.</p>
<p>Many of these extensions take the existing capabilities of browser developer tools and hone them to suit a specific set of use cases in the analytics world.</p>
<p>I still recommend to always use developer tools as your main tool of choice, but do take a look at these extensions and see if they could help alleviate some of the pain of debugging your analytics or tag manager implementation.</p>
<h3 id="gtmga-debugger">GTM/GA Debugger</h3>
<p><a href="https://twitter.com/thyng">David Vallejo&rsquo;s</a> Chrome extension, <a href="https://chrome.google.com/webstore/detail/gtmga-debugger/ilnpmccnfdjdjjikgkefkcegefikecdc">GTM/GA Debugger</a>, is certainly the most ambitious and the most impressive browser extension for debugging Google Analytics and Google Tag Manager implementations.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/gtm-ga-debug.jpg" title="GTM/GA Debugger">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/gtm-ga-debug.jpg#ZgotmplZ" alt="GTM/GA Debugger" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2066 1068'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>The feature set is so incredibly rich that it doesn&rsquo;t make sense to go through all the functionality here, but here&rsquo;s just a short overview of things you can do with the extension:</p>
<ul>
<li>Block GA3/GA4 hits</li>
<li>Inspect server-side tagging hits</li>
<li>Export as a table, copy objects</li>
<li>Enhanced ecommerce reports</li>
<li>Analyze dataLayer and the outgoing requests</li>
<li>Show POST data in a meaningful way</li>
<li>View <em>all</em> <code>dataLayer</code> messages (not just the ones sent on the current page)</li>
</ul>
<p>Everything is just displayed so nicely and so intuitively. You don&rsquo;t have to sift through complicated headers and messy payloads – it&rsquo;s all visually displayed in rich tables and with purposeful structure.</p>
<h3 id="ga-debugger">GA Debugger</h3>
<p><a href="https://chrome.google.com/webstore/detail/google-analytics-debugger/jnkmfdileelhofjcijamephohjechhna">GA Debugger</a> is the <strong>official</strong> Universal Analytics, Google Analytics 4, and Google Tag Manager debugger.</p>
<p>It outputs information about the aforementioned platforms into the console.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/console-log-debugger.jpg" title="GA debugger and console log">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/console-log-debugger.jpg#ZgotmplZ" alt="GA debugger and console log" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1780 422'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>I love this tool because once the information is in the console, searching through it is easy with the JavaScript console&rsquo;s own search tools.</p>
<p>The GA Debugger helpfully informs you <strong>why</strong> something went wrong rather than just showing a non-descript error message. Naturally, in some cases you still need to continue investigating, but the console output can be very helpful in collecting the initial set of leads for your research.</p>
<blockquote>
<p>Note! This extension doesn&rsquo;t work if you load your files from or collect hits to <a href="https://www.simoahava.com/analytics/server-side-tagging-google-tag-manager/">a server-side endpoint</a>.</p>
</blockquote>
<h3 id="live-http-headers">Live HTTP Headers</h3>
<p><a href="https://chrome.google.com/webstore/detail/live-http-headers/ianhploojoffmpcpilhgpacbeaifanid">Live HTTP Headers</a> is my favorite extension for debugging HTTP traffic. It&rsquo;s an easy way to inspect the headers of all the HTTP requests dispatched by the browser.</p>



<div class="figure nocaption" >
  
    <a href="https://www.simoahava.com/images/2022/01/live-http-headers.jpg" title="Live HTTP headers">
  
    <img class="fig-img lazy" data-src="https://www.simoahava.com/images/2022/01/live-http-headers.jpg#ZgotmplZ" alt="Live HTTP headers" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 2182 678'%3E%3C/svg%3E">
  
    </a>
  
  
</div>


<p>Although today you can get pretty much all the same information in the network debugger of the developer tools, I still prefer the visual output of this extension and use it diligently whenever I want to quickly look through redirects or HTTP headers.</p>

                
                  <h2 id="summary">Summary</h2>
<p>Even though this article is long and full of words and pictures, it covers only a fraction of the approaches you can take when debugging your analytics and tag management implementations.</p>
<p>The idea wasn&rsquo;t to list everything that can go wrong and give you the solution how to fix it. Instead, the purpose of this guide is to give you the tools and the <em>confidence</em> to start collecting leads for your own investigations.</p>
<p>Debugging the complexity of what happens within a web browser is a daunting task. But the debugging steps themselves are often very predictable and can be repeated from one scenario to the next.</p>
<p>My workflow is pretty simple:</p>
<ol>
<li>Always start with inspecting the <strong>network requests</strong>. Try to find the requests that you&rsquo;re debugging. If you find them, look through the headers and the payload to see if they contain the data you expect them to have.</li>
<li>Search through the <strong>sources</strong> to find inconsistencies in the libraries you use (particularly Google Tag Manager). If you can&rsquo;t find references to a specific tag you expect to be in GTM, it means that you might be previewing the wrong version or that you never actually published a version.</li>
<li>Look through <strong>cookies</strong> to see if the values used by your analytics tool persist from one page load to the next. If the values change, then it means that the cookies are being reset or overwritten for some reason (typically a <strong>consent management platform</strong> is to blame).</li>
<li>Utilize the <strong>element inspector</strong> especially when you are certain that the page should include some element or tag deployed through Google Tag Manager.</li>
</ol>
<p>If you have additional ideas for the debugging flow that you think should be included in this guide, please let me know in the comments.</p>
<p>What are your favorite ways of debugging analytics and tag management solution issues?</p>

                
              
              

            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-tag-manager/">google tag manager</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/debug/">debug</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/developer-tools/">developer tools</a>

  <a class="tag tag--primary tag--small" href="https://www.simoahava.com/tags/google-analytics/">google analytics</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtmtips/setup-google-tag-manager-server-cloud-run/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/manipulate-response-headers-server-side-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Debug%20Guide%20For%20Web%20Analytics%20And%20Tag%20Management%20https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


            
              <span id="commento_thread"></span>
<div id="commento"></div>
<script defer src="https://commento.simoahava.com/js/commento.js" data-no-livereload="true"></script>

            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2023 Simo Ahava. All Rights Reserved
  </span>
</footer>

      </div>
      
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtmtips/setup-google-tag-manager-server-cloud-run/">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default" href="https://www.simoahava.com/gtm-tips/manipulate-response-headers-server-side-google-tag-manager/">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
              <i class="fa fa-brands fa-facebook"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=Debug%20Guide%20For%20Web%20Analytics%20And%20Tag%20Management%20https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/%20via%20@SimoAhava">
              <i class="fa fa-brands fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
              <i class="fa fa-brands fa-linkedin"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#commento_thread">
            <i class="fa-regular fa-comments"></i>
          </a>
        </li>
      
      <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#">
          <i class="fa fa-search"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
          <i class="fa fa-brands fa-facebook"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=Debug%20Guide%20For%20Web%20Analytics%20And%20Tag%20Management%20https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/%20via%20@SimoAhava">
          <i class="fa fa-brands fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.linkedin.com/cws/share?url=https://www.simoahava.com/analytics/debug-guide-web-analytics-tag-management/">
          <i class="fa fa-brands fa-linkedin"></i><span>Share on LinkedIn</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.simoahava.com/images/simo.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Simo Ahava</h4>
    
      <div id="about-card-bio">Husband | Father | Analytics developer<br>simo (at) simoahava.com</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Senior Data Advocate at Reaktor
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Finland
      </div>
    
  </div>
</div>

    
  
    
    <div id="cover" style="background-image:url('https://www.simoahava.com/images/maisema.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>




<script src="https://www.simoahava.com/js/script.js"></script>




<script src="https://commento.simoahava.com/js/count.js"></script>

    <script>
      !function(){var e=document.querySelector(".simmer"),t=document.querySelector(".simmer .close"),o=window.sessionStorage&&window.sessionStorage.getItem("nosimmer");if(e){if(o){e.style.display="none"}t.addEventListener("click",function(){window.sessionStorage.setItem("nosimmer","true"),e.style.display="none"})}}();
    </script>
    <script>
      var mylazyload = new LazyLoad({elements_selector: '.lazy'});
      </script>
    <style>
      .ads {
	  width: 1px;
      }
      </style>
         

    
  </body>
</html>

